main start at this time 1733045712.253454
-----------------------------------------before load data 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 0.51904296875 GB
    Memory Allocated: 0.000934600830078125  GigaBytes
Max Memory Allocated: 0.000934600830078125  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 0.52099609375 GB
    Memory Allocated: 0.000934600830078125  GigaBytes
Max Memory Allocated: 0.000934600830078125  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 3.326 seconds, peak memory: 23.891 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 23.891 GB
Metis partitioning: 12.202 seconds, peak memory: 25.182 GB
Split the graph: 5.537 seconds
Construct subgraphs: 0.396 seconds
REG metis partition end ----................................
REG construction  time spent:  70.27541923522949
pure dgl.metis_partition the time spent:  21.506386041641235
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  5.777707099914551

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  19.269299507141113

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 0.52099609375 GB
    Memory Allocated: 0.000934600830078125  GigaBytes
Max Memory Allocated: 0.000934600830078125  GigaBytes

connection checking time:  13.663342952728271
block generation total time  25.047006607055664
average batch blocks generation time:  2.087250550587972
block dataloader generation time/epoch 134.62480330467224
pseudo mini batch 0 input nodes size: 323398
----------------------------------------before load block subtensor 
 Nvidia-smi: 0.52099609375 GB
    Memory Allocated: 0.000934600830078125  GigaBytes
Max Memory Allocated: 0.000934600830078125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 0.52099609375 GB
    Memory Allocated: 0.000934600830078125  GigaBytes
Max Memory Allocated: 0.000934600830078125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 0.64208984375 GB
    Memory Allocated: 0.12202835083007812  GigaBytes
Max Memory Allocated: 0.12202835083007812  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 0.64208984375 GB
    Memory Allocated: 0.12214899063110352  GigaBytes
Max Memory Allocated: 0.12214899063110352  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 0.64208984375 GB
    Memory Allocated: 0.12214899063110352  GigaBytes
Max Memory Allocated: 0.12214899063110352  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 14114, 14: 127, 16: 123, 23: 121, 15: 119, 10: 117, 18: 116, 11: 115, 22: 113, 21: 106, 12: 100, 19: 99, 24: 91, 17: 90, 13: 89, 20: 86, 9: 84, 7: 73, 8: 64, 6: 61, 4: 46, 5: 33, 3: 28, 2: 9, 1: 7})

----------------------------------------after blocks to device 
 Nvidia-smi: 0.66162109375 GB
    Memory Allocated: 0.13651180267333984  GigaBytes
Max Memory Allocated: 0.13651180267333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 0.66162109375 GB
    Memory Allocated: 0.13651180267333984  GigaBytes
Max Memory Allocated: 0.13651180267333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.82177734375 GB
    Memory Allocated: 9.688688278198242  GigaBytes
Max Memory Allocated: 10.04249382019043  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.82177734375 GB
    Memory Allocated: 9.691812515258789  GigaBytes
Max Memory Allocated: 10.04249382019043  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.01513671875 GB
    Memory Allocated: 0.17048168182373047  GigaBytes
Max Memory Allocated: 10.04249382019043  GigaBytes

pseudo mini batch 1 input nodes size: 498633
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.01513671875 GB
    Memory Allocated: 0.15190744400024414  GigaBytes
Max Memory Allocated: 10.04249382019043  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.01513671875 GB
    Memory Allocated: 0.15190744400024414  GigaBytes
Max Memory Allocated: 10.04249382019043  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.01513671875 GB
    Memory Allocated: 0.3376631736755371  GigaBytes
Max Memory Allocated: 10.04249382019043  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 11.01513671875 GB
    Memory Allocated: 0.3377861976623535  GigaBytes
Max Memory Allocated: 10.04249382019043  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.01513671875 GB
    Memory Allocated: 0.21657180786132812  GigaBytes
Max Memory Allocated: 10.04249382019043  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 14253, 7: 177, 14: 171, 10: 158, 6: 139, 5: 118, 8: 110, 16: 105, 9: 105, 12: 101, 3: 100, 11: 100, 4: 94, 24: 94, 18: 91, 13: 88, 20: 75, 23: 63, 22: 62, 17: 59, 15: 56, 21: 54, 19: 48, 2: 36, 1: 12})

----------------------------------------after blocks to device 
 Nvidia-smi: 11.01513671875 GB
    Memory Allocated: 0.2349257469177246  GigaBytes
Max Memory Allocated: 10.04249382019043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.01513671875 GB
    Memory Allocated: 0.2349257469177246  GigaBytes
Max Memory Allocated: 10.04249382019043  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 12.29347276687622  GigaBytes
Max Memory Allocated: 12.653207302093506  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 12.296527862548828  GigaBytes
Max Memory Allocated: 12.653207302093506  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.25087404251098633  GigaBytes
Max Memory Allocated: 12.653207302093506  GigaBytes

pseudo mini batch 2 input nodes size: 436855
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.22628450393676758  GigaBytes
Max Memory Allocated: 12.653207302093506  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.22628450393676758  GigaBytes
Max Memory Allocated: 12.653207302093506  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.3890256881713867  GigaBytes
Max Memory Allocated: 12.653207302093506  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.3891448974609375  GigaBytes
Max Memory Allocated: 12.653207302093506  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.20326614379882812  GigaBytes
Max Memory Allocated: 12.653207302093506  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 14207, 15: 170, 24: 103, 23: 102, 20: 99, 21: 98, 19: 98, 11: 88, 12: 86, 18: 80, 13: 76, 7: 75, 22: 71, 9: 70, 16: 67, 17: 66, 3: 58, 14: 58, 4: 56, 6: 54, 10: 53, 5: 34, 8: 31, 2: 22, 1: 19})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.21986055374145508  GigaBytes
Max Memory Allocated: 12.653207302093506  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.21986055374145508  GigaBytes
Max Memory Allocated: 12.653207302093506  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 10.561752796173096  GigaBytes
Max Memory Allocated: 12.653207302093506  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 10.564544677734375  GigaBytes
Max Memory Allocated: 12.653207302093506  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.23625421524047852  GigaBytes
Max Memory Allocated: 12.653207302093506  GigaBytes

pseudo mini batch 3 input nodes size: 389859
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.2154536247253418  GigaBytes
Max Memory Allocated: 12.653207302093506  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.2154536247253418  GigaBytes
Max Memory Allocated: 12.653207302093506  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.3606877326965332  GigaBytes
Max Memory Allocated: 12.653207302093506  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.3608131408691406  GigaBytes
Max Memory Allocated: 12.653207302093506  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.1979527473449707  GigaBytes
Max Memory Allocated: 12.653207302093506  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 16481, 7: 38, 24: 25, 22: 21, 18: 20, 20: 19, 23: 18, 19: 17, 16: 17, 10: 17, 9: 17, 14: 15, 21: 15, 15: 14, 12: 13, 8: 13, 11: 12, 17: 12, 13: 10, 5: 9, 3: 6, 2: 3, 1: 3, 6: 3, 4: 3})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.2159271240234375  GigaBytes
Max Memory Allocated: 12.653207302093506  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.2159271240234375  GigaBytes
Max Memory Allocated: 12.653207302093506  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 11.531062602996826  GigaBytes
Max Memory Allocated: 12.653207302093506  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 11.53425407409668  GigaBytes
Max Memory Allocated: 12.653207302093506  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.2330317497253418  GigaBytes
Max Memory Allocated: 12.653207302093506  GigaBytes

pseudo mini batch 4 input nodes size: 417277
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.20977067947387695  GigaBytes
Max Memory Allocated: 12.653207302093506  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.20977067947387695  GigaBytes
Max Memory Allocated: 12.653207302093506  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.3652186393737793  GigaBytes
Max Memory Allocated: 12.653207302093506  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.3653430938720703  GigaBytes
Max Memory Allocated: 12.653207302093506  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.21998357772827148  GigaBytes
Max Memory Allocated: 12.653207302093506  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 16509, 9: 16, 22: 11, 10: 10, 7: 10, 18: 10, 12: 9, 20: 9, 24: 9, 19: 8, 14: 8, 15: 8, 17: 8, 21: 8, 11: 7, 13: 7, 5: 6, 16: 6, 23: 6, 6: 5, 4: 4, 8: 3, 1: 1, 3: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.23911285400390625  GigaBytes
Max Memory Allocated: 12.653207302093506  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.23911285400390625  GigaBytes
Max Memory Allocated: 12.653207302093506  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 12.328388214111328  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 12.332175731658936  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.2565884590148926  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

pseudo mini batch 5 input nodes size: 393593
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.23131418228149414  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.23131418228149414  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.37793922424316406  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.3780632019042969  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.22249078750610352  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 16385, 24: 23, 23: 22, 13: 21, 12: 16, 21: 16, 6: 16, 3: 14, 22: 11, 2: 11, 9: 8, 18: 8, 8: 7, 20: 7, 4: 7, 19: 7, 14: 6, 5: 5, 17: 5, 11: 4, 16: 4, 10: 3, 7: 3, 1: 1, 15: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.24023103713989258  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.24023103713989258  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 11.875099182128906  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 11.878886699676514  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.25552797317504883  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

pseudo mini batch 6 input nodes size: 345136
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.2323627471923828  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.2323627471923828  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.36093616485595703  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.3610568046569824  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.2143077850341797  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 15067, 22: 60, 1: 55, 12: 53, 23: 52, 11: 52, 7: 52, 19: 50, 20: 49, 14: 48, 13: 48, 5: 47, 17: 47, 10: 46, 16: 45, 6: 44, 15: 41, 4: 40, 18: 40, 21: 40, 24: 39, 2: 38, 8: 37, 3: 34, 9: 33})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.2308816909790039  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.2308816909790039  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 10.327448844909668  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 10.330437660217285  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.24462366104125977  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

pseudo mini batch 7 input nodes size: 397015
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.22385692596435547  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.22385692596435547  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.37175655364990234  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.37187623977661133  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.24318218231201172  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 14856, 23: 70, 13: 62, 11: 61, 22: 60, 24: 58, 18: 57, 6: 57, 21: 56, 15: 56, 16: 55, 7: 55, 19: 55, 14: 54, 20: 52, 10: 52, 12: 50, 8: 49, 17: 47, 9: 42, 4: 41, 5: 39, 3: 29, 2: 20, 1: 11})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.26054859161376953  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.26054859161376953  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 10.952577114105225  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 10.955387115478516  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.27491235733032227  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

pseudo mini batch 8 input nodes size: 309605
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.252377986907959  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.252377986907959  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.36771488189697266  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.3678402900695801  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.21982097625732422  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 15512, 14: 82, 13: 76, 23: 75, 17: 74, 21: 66, 16: 65, 10: 65, 24: 61, 15: 59, 20: 59, 19: 59, 22: 56, 9: 55, 18: 54, 11: 54, 5: 47, 7: 46, 6: 45, 12: 45, 8: 45, 4: 35, 3: 28, 2: 21, 1: 13})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.2348461151123047  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.2348461151123047  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 10.138096809387207  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 10.141038417816162  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.24854373931884766  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

pseudo mini batch 9 input nodes size: 345195
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.23025274276733398  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.23025274276733398  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.35884809494018555  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.35897254943847656  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.24351024627685547  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 16270, 15: 25, 17: 25, 9: 22, 24: 20, 21: 20, 16: 19, 13: 18, 22: 18, 11: 18, 18: 18, 23: 18, 12: 17, 14: 16, 8: 14, 19: 14, 5: 14, 10: 13, 4: 12, 7: 12, 20: 11, 6: 10, 3: 10, 1: 8, 2: 4})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.2602982521057129  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.2602982521057129  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 11.041635036468506  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 11.044818878173828  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.2744603157043457  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

pseudo mini batch 10 input nodes size: 209403
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.25337839126586914  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.25337839126586914  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.3313875198364258  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.33150672912597656  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.20278692245483398  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 14015, 8: 104, 17: 100, 7: 98, 19: 92, 13: 91, 6: 90, 10: 90, 15: 89, 24: 86, 4: 86, 9: 85, 14: 85, 16: 84, 18: 82, 11: 81, 22: 79, 5: 79, 23: 77, 21: 77, 12: 74, 20: 67, 3: 54, 2: 45, 1: 32})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.2168731689453125  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.2168731689453125  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 8.569486141204834  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 8.572724342346191  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.2282695770263672  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

pseudo mini batch 11 input nodes size: 358227
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.21363353729248047  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.21363353729248047  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.34708356857299805  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.34720563888549805  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.2690773010253906  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 15709, 9: 39, 20: 39, 19: 37, 24: 36, 8: 35, 15: 35, 11: 32, 4: 32, 22: 30, 21: 30, 13: 29, 18: 28, 6: 26, 14: 25, 23: 24, 16: 24, 17: 23, 12: 19, 7: 16, 10: 16, 5: 14, 3: 12, 2: 12, 1: 11})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.2850937843322754  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.2850937843322754  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 10.337566375732422  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 10.341129302978516  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.29912471771240234  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.3009939193725586  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.30005931854248047  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.10029743115107219 |0.024207969506581623 |0.3120866616566976 |0.0012669761975606282 |0.10713950792948405 |0.10930442810058594 |
----------------------------------------------------------pseudo_mini_loss sum 5.209140300750732
Total (block generation + training)time/epoch 141.41109156608582
Training time/epoch 6.785994291305542
Training time without block to device /epoch 6.4954986572265625
Training time without total dataloading part /epoch 5.155222177505493
load block tensor time/epoch 1.2035691738128662
block to device time/epoch 0.2904956340789795
input features size transfer per epoch 1.7881393432617188e-06
blocks size to device per epoch 9.834766387939453e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6045738
Number of first layer input nodes during this epoch:  4424196
Number of first layer output nodes during this epoch:  1621542
----------------------------------------before generate dataloader block 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.18574857711791992  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 3.397 seconds, peak memory: 48.071 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 48.071 GB
Metis partitioning: 11.864 seconds, peak memory: 49.403 GB
Split the graph: 4.434 seconds
Construct subgraphs: 0.431 seconds
REG metis partition end ----................................
REG construction  time spent:  69.41626167297363
pure dgl.metis_partition the time spent:  20.173381090164185
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  5.956018924713135

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  19.195748329162598

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.18574857711791992  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

connection checking time:  13.284763097763062
block generation total time  25.151767253875732
average batch blocks generation time:  2.0959806044896445
block dataloader generation time/epoch 133.48902475833893
pseudo mini batch 0 input nodes size: 334475
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.1669774055480957  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.1669774055480957  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.2915792465209961  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.2917046546936035  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.15813255310058594  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 16444, 15: 24, 9: 19, 21: 19, 24: 18, 18: 18, 23: 18, 22: 17, 19: 17, 14: 17, 11: 17, 20: 16, 6: 15, 16: 15, 7: 15, 17: 15, 12: 14, 13: 13, 8: 13, 10: 13, 5: 9, 4: 9, 3: 8, 1: 6, 2: 6})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.1743001937866211  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.1743001937866211  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 10.907806873321533  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 10.91137409210205  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.17889976501464844  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

pseudo mini batch 1 input nodes size: 216111
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.15814542770385742  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.15814542770385742  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.23865318298339844  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.23877382278442383  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.11404657363891602  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 14192, 8: 107, 17: 103, 6: 96, 7: 96, 19: 93, 13: 92, 15: 92, 24: 90, 5: 87, 16: 87, 10: 87, 4: 87, 9: 87, 14: 86, 18: 84, 11: 83, 21: 80, 22: 80, 12: 78, 23: 74, 20: 68, 3: 60, 2: 50, 1: 33})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.12738943099975586  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.12738943099975586  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 8.582626342773438  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 8.585833072662354  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.13856077194213867  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

pseudo mini batch 2 input nodes size: 347171
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.1236429214477539  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.1236429214477539  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.2529745101928711  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.2530946731567383  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.17246627807617188  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 15550, 1: 38, 9: 36, 20: 32, 4: 31, 15: 29, 24: 28, 22: 27, 2: 26, 17: 23, 11: 22, 19: 22, 21: 22, 18: 22, 14: 21, 16: 21, 13: 20, 6: 19, 8: 19, 10: 18, 3: 17, 23: 16, 7: 13, 12: 13, 5: 12})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.18846845626831055  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.18846845626831055  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 10.282668113708496  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 10.285892009735107  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.20190763473510742  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

pseudo mini batch 3 input nodes size: 415709
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.18291330337524414  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.18291330337524414  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.33777713775634766  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.3379030227661133  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.2084512710571289  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 15997, 22: 52, 15: 50, 19: 50, 23: 50, 24: 46, 21: 42, 20: 42, 18: 41, 13: 41, 12: 40, 11: 40, 8: 39, 17: 39, 14: 38, 7: 36, 10: 35, 9: 33, 16: 33, 6: 32, 5: 29, 4: 28, 3: 18, 2: 11, 1: 6})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.2262425422668457  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.2262425422668457  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 11.507557392120361  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 11.51051139831543  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.24204587936401367  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

pseudo mini batch 4 input nodes size: 323430
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.2198328971862793  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.2198328971862793  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.3403201103210449  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.34044551849365234  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.1854557991027832  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 15533, 23: 80, 13: 80, 14: 79, 17: 67, 21: 66, 10: 65, 19: 63, 22: 61, 24: 61, 20: 61, 16: 60, 9: 58, 15: 57, 11: 53, 18: 52, 12: 52, 5: 46, 7: 45, 8: 45, 6: 43, 4: 32, 3: 29, 2: 18, 1: 9})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.20219898223876953  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.20219898223876953  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 10.29160737991333  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 10.295153141021729  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.21570587158203125  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

pseudo mini batch 5 input nodes size: 373571
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.196197509765625  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.196197509765625  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.33536386489868164  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.3354830741882324  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.21487045288085938  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 14637, 11: 78, 23: 73, 13: 70, 22: 65, 10: 65, 16: 64, 14: 63, 7: 62, 17: 61, 6: 59, 20: 59, 18: 58, 12: 58, 21: 57, 24: 57, 19: 56, 8: 55, 15: 50, 5: 48, 4: 46, 9: 40, 2: 31, 3: 24, 1: 23})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.23104238510131836  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.23104238510131836  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 10.51363468170166  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 10.516429424285889  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.24396896362304688  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

pseudo mini batch 6 input nodes size: 429731
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.22376394271850586  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.22376394271850586  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.3838515281677246  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.38397693634033203  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.2446913719177246  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 16440, 24: 27, 22: 24, 18: 24, 16: 23, 10: 22, 23: 21, 11: 21, 20: 20, 19: 20, 21: 18, 14: 17, 17: 15, 12: 15, 13: 14, 7: 13, 8: 13, 9: 13, 15: 12, 4: 9, 5: 8, 6: 7, 3: 5, 1: 4, 2: 3})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.26318883895874023  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.26318883895874023  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 12.320368766784668  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 12.324222087860107  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.2811722755432129  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

pseudo mini batch 7 input nodes size: 393391
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.2569303512573242  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.2569303512573242  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.40348005294799805  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.40360593795776367  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.2433929443359375  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 16629, 24: 29, 19: 25, 13: 24, 23: 22, 21: 15, 12: 15, 18: 12, 9: 12, 20: 10, 22: 10, 14: 9, 17: 9, 2: 9, 6: 9, 16: 6, 8: 5, 3: 5, 5: 5, 11: 4, 4: 3, 15: 3, 10: 2, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.26157188415527344  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.26157188415527344  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 11.984771251678467  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 11.98829460144043  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.2772493362426758  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

pseudo mini batch 8 input nodes size: 425089
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.2541961669921875  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.2541961669921875  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.4125542640686035  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.4126739501953125  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.26599836349487305  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 15803, 7: 23, 12: 13, 9: 12, 3: 11, 21: 11, 15: 10, 22: 10, 24: 10, 18: 10, 14: 10, 19: 10, 23: 9, 17: 9, 5: 8, 11: 8, 13: 8, 16: 8, 10: 7, 6: 6, 8: 6, 4: 5, 20: 4, 1: 2, 2: 2})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.2846541404724121  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.2846541404724121  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 12.2445650100708  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 12.247583866119385  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.30086517333984375  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

pseudo mini batch 9 input nodes size: 324162
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.27668094635009766  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.27668094635009766  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.39744091033935547  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.39756250381469727  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.23908472061157227  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 14289, 10: 123, 14: 121, 11: 119, 16: 118, 15: 114, 22: 113, 18: 113, 23: 109, 21: 103, 19: 99, 12: 96, 17: 88, 20: 84, 9: 80, 13: 79, 7: 77, 24: 76, 6: 63, 8: 59, 4: 47, 5: 35, 3: 30, 1: 20, 2: 14})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.2537398338317871  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27685546875 GB
    Memory Allocated: 0.2537398338317871  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 9.891018867492676  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 9.89403772354126  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.2663235664367676  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

pseudo mini batch 10 input nodes size: 513975
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.24836397171020508  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.24836397171020508  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.4398345947265625  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.4399533271789551  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.31907176971435547  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 13956, 7: 138, 14: 124, 3: 117, 24: 117, 6: 111, 18: 103, 13: 102, 5: 93, 16: 91, 23: 87, 4: 84, 20: 78, 11: 77, 21: 75, 12: 75, 8: 74, 22: 71, 17: 66, 9: 62, 15: 61, 10: 61, 19: 41, 2: 35, 1: 12})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.3363523483276367  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.3363523483276367  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 11.901823997497559  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 11.904870510101318  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.35207319259643555  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

pseudo mini batch 11 input nodes size: 441556
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.3287835121154785  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.3287835121154785  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.49327611923217773  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.4933953285217285  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.3018059730529785  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 13908, 15: 171, 10: 142, 7: 136, 9: 124, 12: 114, 14: 110, 11: 102, 20: 98, 6: 90, 23: 89, 16: 88, 19: 88, 24: 86, 21: 78, 8: 77, 4: 75, 13: 72, 18: 67, 5: 65, 22: 62, 17: 61, 3: 50, 1: 20, 2: 16})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.3191256523132324  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.3191256523132324  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 10.936944484710693  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 10.940148830413818  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.3335108757019043  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.3335108757019043  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.33257627487182617  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.10567174355189006 |0.017976224422454834 |0.11092706521352132 |0.00011161963144938151 |0.07886683940887451 |0.002549886703491211 |
----------------------------------------------------------pseudo_mini_loss sum 3.543281316757202
Total (block generation + training)time/epoch 138.8519902229309
Training time/epoch 3.9393906593322754
Training time without block to device /epoch 3.7236759662628174
Training time without total dataloading part /epoch 2.281416177749634
load block tensor time/epoch 1.2680609226226807
block to device time/epoch 0.215714693069458
input features size transfer per epoch 1.7881393432617188e-06
blocks size to device per epoch 9.834766387939453e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6188836
Number of first layer input nodes during this epoch:  4538371
Number of first layer output nodes during this epoch:  1650465
----------------------------------------before generate dataloader block 
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.2188582420349121  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 3.306 seconds, peak memory: 50.026 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 50.026 GB
Metis partitioning: 11.836 seconds, peak memory: 50.145 GB
Split the graph: 5.071 seconds
Construct subgraphs: 0.431 seconds
REG metis partition end ----................................
REG construction  time spent:  69.17360424995422
pure dgl.metis_partition the time spent:  20.688775300979614
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  6.392750978469849

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  18.88099193572998

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.2188582420349121  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

connection checking time:  13.263517141342163
block generation total time  25.27374291419983
average batch blocks generation time:  2.1061452428499856
block dataloader generation time/epoch 133.2590905825297
pseudo mini batch 0 input nodes size: 339224
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.19707298278808594  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.19707298278808594  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.3234438896179199  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.32356977462768555  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.15895795822143555  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 16559, 9: 37, 15: 22, 21: 19, 13: 17, 18: 16, 17: 16, 24: 15, 19: 14, 14: 13, 23: 13, 10: 12, 22: 12, 12: 12, 16: 11, 11: 11, 8: 10, 20: 10, 5: 9, 7: 8, 2: 6, 4: 6, 6: 6, 1: 4, 3: 3})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.17624807357788086  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.17624807357788086  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 11.302241802215576  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 11.305514812469482  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.1823868751525879  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

pseudo mini batch 1 input nodes size: 342396
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.1605367660522461  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.1605367660522461  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.2880892753601074  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.28821468353271484  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.16171789169311523  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 16241, 20: 40, 22: 34, 15: 31, 19: 31, 24: 30, 4: 28, 13: 27, 21: 26, 14: 26, 18: 26, 8: 25, 23: 24, 11: 24, 17: 24, 16: 22, 10: 20, 6: 20, 12: 19, 9: 18, 7: 11, 3: 11, 2: 9, 5: 8, 1: 6})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.17893218994140625  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.17893218994140625  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 10.41456937789917  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 10.418354988098145  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.19275140762329102  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

pseudo mini batch 2 input nodes size: 218804
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.17320489883422852  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.17320489883422852  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.2547159194946289  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.2548379898071289  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.12716007232666016  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 14330, 8: 111, 17: 101, 7: 101, 6: 98, 13: 93, 15: 92, 10: 92, 19: 91, 24: 90, 4: 90, 11: 87, 9: 86, 14: 86, 16: 84, 5: 83, 18: 82, 21: 80, 22: 79, 23: 77, 12: 76, 20: 66, 3: 59, 2: 54, 1: 41})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.1413884162902832  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.1413884162902832  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 8.661571979522705  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 8.66443157196045  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.1526508331298828  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

pseudo mini batch 3 input nodes size: 386464
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.1358962059020996  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.1358962059020996  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.2798652648925781  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.27998924255371094  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.19835615158081055  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 15586, 22: 59, 23: 53, 7: 51, 14: 51, 15: 50, 18: 50, 19: 49, 11: 48, 12: 47, 5: 47, 1: 46, 24: 45, 21: 44, 6: 42, 17: 41, 10: 39, 3: 39, 20: 38, 9: 37, 4: 36, 13: 35, 16: 34, 8: 30, 2: 21})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.21508550643920898  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.21508550643920898  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 10.821998119354248  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 10.825854301452637  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.22993993759155273  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

pseudo mini batch 4 input nodes size: 415449
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.2097492218017578  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.2097492218017578  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.3645162582397461  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.36463499069213867  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.22054195404052734  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 14594, 11: 70, 13: 65, 23: 64, 12: 64, 16: 62, 20: 61, 8: 61, 22: 61, 7: 60, 17: 60, 6: 59, 15: 59, 10: 59, 19: 59, 21: 59, 24: 57, 14: 55, 5: 51, 18: 48, 4: 48, 9: 44, 3: 32, 2: 32, 1: 19})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.23755788803100586  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.23755788803100586  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 10.796568393707275  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 10.799511432647705  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.25072288513183594  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

pseudo mini batch 5 input nodes size: 320783
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.2302541732788086  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.2302541732788086  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.34975528717041016  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.3498811721801758  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.19499540328979492  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 15490, 13: 86, 14: 83, 23: 82, 16: 73, 17: 71, 21: 70, 10: 68, 24: 64, 20: 63, 19: 61, 22: 61, 11: 61, 9: 58, 18: 57, 15: 55, 7: 51, 8: 51, 6: 50, 12: 47, 5: 44, 4: 35, 3: 27, 2: 21, 1: 12})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.21069812774658203  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.21069812774658203  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 10.321023941040039  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 10.324290752410889  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.22548675537109375  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

pseudo mini batch 6 input nodes size: 390863
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.20633649826049805  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.20633649826049805  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.3519444465637207  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.3520636558532715  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.2324366569519043  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 13999, 16: 121, 10: 119, 23: 119, 14: 117, 18: 115, 11: 115, 22: 113, 15: 113, 21: 104, 19: 103, 12: 98, 20: 95, 24: 90, 13: 89, 17: 88, 9: 79, 7: 74, 8: 63, 6: 52, 4: 44, 5: 38, 3: 22, 2: 4, 1: 4})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.24814558029174805  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.27880859375 GB
    Memory Allocated: 0.24814558029174805  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.28662109375 GB
    Memory Allocated: 10.432407855987549  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.28662109375 GB
    Memory Allocated: 10.435674667358398  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.26222801208496094  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

pseudo mini batch 7 input nodes size: 396308
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.24262237548828125  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.24262237548828125  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.3902587890625  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.3903789520263672  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.24465179443359375  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 15890, 19: 22, 23: 21, 13: 19, 6: 18, 12: 14, 9: 13, 21: 10, 22: 10, 17: 9, 2: 9, 8: 7, 3: 7, 24: 7, 14: 7, 16: 6, 15: 5, 5: 5, 18: 4, 1: 4, 11: 3, 20: 3, 4: 2, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.2613649368286133  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.2613649368286133  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 11.399724006652832  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 11.4026198387146  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.27661991119384766  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

pseudo mini batch 8 input nodes size: 417997
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.25496387481689453  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.25496387481689453  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.41068029403686523  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.41080236434936523  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.2630457878112793  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 16123, 24: 27, 23: 16, 9: 16, 21: 15, 18: 14, 12: 13, 10: 11, 13: 11, 22: 11, 14: 10, 6: 10, 19: 9, 7: 9, 3: 9, 20: 9, 15: 8, 17: 8, 5: 7, 16: 6, 11: 5, 4: 4, 8: 4, 2: 2, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.2815666198730469  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.2815666198730469  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 12.134157180786133  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 12.137692928314209  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.2982330322265625  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

pseudo mini batch 9 input nodes size: 421150
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.27483701705932617  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.27483701705932617  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.43172788619995117  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.4318537712097168  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.2760152816772461  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 16567, 22: 23, 24: 21, 20: 19, 18: 19, 12: 16, 16: 15, 14: 14, 10: 14, 7: 13, 17: 13, 23: 13, 19: 13, 9: 12, 8: 12, 11: 12, 4: 10, 21: 9, 13: 8, 15: 8, 5: 8, 3: 7, 6: 4, 1: 2})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.29418087005615234  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.29418087005615234  GigaBytes
Max Memory Allocated: 12.73143720626831  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 12.467465877532959  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 12.471001625061035  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.31146764755249023  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 10 input nodes size: 484437
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.28744077682495117  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.28744077682495117  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.46800708770751953  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.4681262969970703  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.3111095428466797  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 14242, 7: 118, 14: 117, 24: 109, 18: 94, 3: 88, 16: 88, 5: 88, 13: 87, 6: 81, 11: 74, 12: 71, 4: 69, 21: 69, 20: 65, 8: 63, 23: 61, 17: 59, 10: 57, 22: 54, 15: 51, 9: 48, 19: 48, 2: 36, 1: 9})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.32899904251098633  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.32899904251098633  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 11.851006507873535  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 11.854216575622559  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.34502696990966797  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 11 input nodes size: 468302
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.32174110412597656  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.32174110412597656  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.4961972236633301  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.49631690979003906  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.3156313896179199  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 13757, 15: 179, 7: 158, 10: 149, 9: 128, 14: 116, 11: 114, 6: 110, 12: 106, 23: 105, 20: 103, 16: 92, 24: 90, 4: 84, 19: 84, 21: 81, 18: 79, 13: 78, 8: 75, 22: 75, 3: 70, 17: 66, 5: 57, 2: 27, 1: 25})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.3327326774597168  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.3327326774597168  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 11.04127025604248  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 11.044497013092041  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.34755563735961914  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.34755563735961914  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.346621036529541  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.10315283139546712 |0.02093617121378581 |0.11063291629155476 |0.00011110305786132812 |0.0792122483253479 |0.002191781997680664 |
----------------------------------------------------------pseudo_mini_loss sum 2.7920308113098145
Total (block generation + training)time/epoch 138.14856108029684
Training time/epoch 3.942218780517578
Training time without block to device /epoch 3.6909847259521484
Training time without total dataloading part /epoch 2.2816669940948486
load block tensor time/epoch 1.2378339767456055
block to device time/epoch 0.2512340545654297
input features size transfer per epoch 1.7881393432617188e-06
blocks size to device per epoch 9.834766387939453e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  6257607
Number of first layer input nodes during this epoch:  4602177
Number of first layer output nodes during this epoch:  1655430
----------------------------------------before generate dataloader block 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.22902679443359375  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 2.729 seconds, peak memory: 50.428 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 50.428 GB
Metis partitioning: 11.699 seconds, peak memory: 50.428 GB
Split the graph: 5.014 seconds
Construct subgraphs: 0.421 seconds
REG metis partition end ----................................
REG construction  time spent:  68.84677004814148
pure dgl.metis_partition the time spent:  19.90735101699829
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  5.880554676055908

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  18.49702024459839

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.22902679443359375  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

connection checking time:  12.81559681892395
block generation total time  24.377574920654297
average batch blocks generation time:  2.0314645767211914
block dataloader generation time/epoch 132.45767039060593
pseudo mini batch 0 input nodes size: 383746
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.2058544158935547  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.2058544158935547  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.34881114959716797  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.34893035888671875  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.17435455322265625  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 15122, 1: 56, 22: 51, 14: 46, 18: 44, 11: 44, 23: 42, 15: 39, 6: 38, 7: 37, 19: 37, 17: 37, 10: 35, 5: 35, 21: 35, 12: 32, 20: 32, 3: 32, 13: 30, 24: 30, 9: 26, 8: 24, 4: 24, 16: 24, 2: 16})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.19043397903442383  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.19043397903442383  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 10.50907850265503  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 10.512094497680664  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.19659662246704102  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 1 input nodes size: 347931
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.17686891555786133  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.17686891555786133  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.30648374557495117  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.3066096305847168  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.16353368759155273  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 15453, 13: 88, 23: 87, 14: 75, 11: 74, 16: 73, 22: 69, 10: 68, 24: 68, 17: 67, 21: 65, 20: 64, 9: 64, 8: 64, 19: 63, 18: 59, 15: 57, 12: 55, 6: 49, 7: 46, 5: 43, 4: 37, 3: 30, 2: 18, 1: 11})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.17944955825805664  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.17944955825805664  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 10.777441024780273  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 10.780391693115234  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.19469261169433594  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 2 input nodes size: 317259
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.1739339828491211  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.1739339828491211  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.29212236404418945  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.29224491119384766  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.1625041961669922  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 15095, 16: 73, 7: 70, 14: 70, 23: 69, 13: 69, 21: 67, 20: 64, 17: 64, 12: 63, 15: 63, 24: 61, 22: 59, 6: 59, 11: 59, 10: 58, 19: 58, 5: 51, 8: 50, 18: 48, 4: 43, 9: 42, 2: 32, 3: 30, 1: 19})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.17720842361450195  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.17720842361450195  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 9.876163959503174  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 9.879241466522217  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.18914461135864258  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 3 input nodes size: 221288
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.17119789123535156  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.17119789123535156  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.2536344528198242  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.2537569999694824  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.13544607162475586  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 14402, 8: 107, 17: 104, 7: 103, 6: 97, 15: 93, 19: 93, 13: 93, 10: 92, 4: 90, 14: 89, 24: 89, 9: 87, 11: 86, 18: 86, 16: 84, 5: 83, 22: 80, 21: 80, 23: 80, 12: 77, 20: 67, 3: 58, 2: 50, 1: 34})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.1504368782043457  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.1504368782043457  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 8.710217475891113  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 8.713791847229004  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.16254806518554688  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 4 input nodes size: 361239
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.14672088623046875  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.14672088623046875  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.2812929153442383  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.2814188003540039  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.19885969161987305  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 16532, 9: 42, 15: 25, 24: 21, 11: 18, 22: 18, 19: 18, 21: 17, 13: 17, 18: 15, 17: 14, 16: 13, 23: 13, 20: 13, 14: 12, 10: 12, 12: 11, 8: 11, 4: 10, 7: 9, 5: 9, 6: 9, 1: 5, 2: 4, 3: 3})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.21709299087524414  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.21709299087524414  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 11.35322618484497  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 11.3569917678833  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.23280620574951172  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 5 input nodes size: 340101
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.21149539947509766  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.21149539947509766  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.3381929397583008  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.3383140563964844  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.20361614227294922  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 15661, 20: 36, 24: 34, 22: 32, 15: 32, 4: 31, 19: 30, 18: 27, 21: 26, 8: 25, 13: 25, 14: 24, 11: 23, 6: 23, 17: 22, 23: 21, 16: 20, 12: 19, 9: 19, 10: 17, 2: 16, 3: 15, 7: 12, 5: 8, 1: 6})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.21979570388793945  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.21979570388793945  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 10.256011962890625  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 10.259493827819824  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.23375511169433594  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 6 input nodes size: 417834
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.21436023712158203  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.21436023712158203  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.37001562118530273  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.37014150619506836  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.24332284927368164  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 16596, 12: 21, 24: 21, 22: 15, 10: 15, 20: 14, 14: 14, 23: 13, 21: 13, 11: 12, 18: 12, 15: 11, 16: 11, 13: 11, 8: 10, 17: 10, 9: 9, 19: 8, 7: 6, 5: 5, 4: 4, 3: 4, 6: 2, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.2619013786315918  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.2619013786315918  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 12.379751205444336  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 12.383008480072021  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.2786436080932617  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 7 input nodes size: 534921
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.2541332244873047  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.2541332244873047  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.45340728759765625  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.45352649688720703  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.2977452278137207  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 14150, 7: 120, 24: 117, 14: 111, 20: 94, 5: 93, 6: 92, 18: 86, 10: 86, 13: 83, 11: 82, 16: 76, 23: 75, 4: 75, 8: 73, 22: 73, 3: 72, 21: 71, 15: 68, 17: 62, 19: 61, 12: 58, 9: 42, 2: 35, 1: 5})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.3154745101928711  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.3154745101928711  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.47021484375 GB
    Memory Allocated: 12.404545783996582  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.47021484375 GB
    Memory Allocated: 12.40818166732788  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.47021484375 GB
    Memory Allocated: 0.33173322677612305  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 8 input nodes size: 502841
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.47021484375 GB
    Memory Allocated: 0.30719423294067383  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.47021484375 GB
    Memory Allocated: 0.30719423294067383  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.47021484375 GB
    Memory Allocated: 0.49451732635498047  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.47021484375 GB
    Memory Allocated: 0.49463748931884766  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.47021484375 GB
    Memory Allocated: 0.2952442169189453  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 13770, 15: 168, 10: 145, 9: 140, 7: 132, 12: 127, 14: 123, 6: 115, 23: 110, 16: 105, 11: 99, 3: 92, 24: 90, 19: 90, 18: 89, 13: 86, 20: 85, 4: 83, 21: 83, 8: 75, 5: 73, 17: 71, 22: 59, 2: 31, 1: 25})

----------------------------------------after blocks to device 
 Nvidia-smi: 13.47021484375 GB
    Memory Allocated: 0.31252479553222656  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.47021484375 GB
    Memory Allocated: 0.31252479553222656  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.51904296875 GB
    Memory Allocated: 11.356397151947021  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.51904296875 GB
    Memory Allocated: 11.35960054397583  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.51904296875 GB
    Memory Allocated: 0.32745981216430664  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 9 input nodes size: 375453
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.51904296875 GB
    Memory Allocated: 0.3055610656738281  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.51904296875 GB
    Memory Allocated: 0.3055610656738281  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.51904296875 GB
    Memory Allocated: 0.44542837142944336  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.51904296875 GB
    Memory Allocated: 0.44554853439331055  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.51904296875 GB
    Memory Allocated: 0.2581052780151367  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 14197, 16: 118, 14: 117, 11: 117, 18: 112, 22: 111, 15: 110, 23: 107, 21: 105, 10: 101, 19: 99, 12: 95, 17: 89, 13: 84, 20: 83, 9: 80, 24: 77, 7: 75, 8: 58, 6: 52, 4: 47, 5: 31, 3: 20, 1: 9, 2: 4})

----------------------------------------after blocks to device 
 Nvidia-smi: 13.51904296875 GB
    Memory Allocated: 0.27435827255249023  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.51904296875 GB
    Memory Allocated: 0.27435827255249023  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.51904296875 GB
    Memory Allocated: 10.462259769439697  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.51904296875 GB
    Memory Allocated: 10.465364456176758  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.51904296875 GB
    Memory Allocated: 0.2875514030456543  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 10 input nodes size: 351590
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.51904296875 GB
    Memory Allocated: 0.2680964469909668  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.51904296875 GB
    Memory Allocated: 0.2680964469909668  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.51904296875 GB
    Memory Allocated: 0.39907407760620117  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.51904296875 GB
    Memory Allocated: 0.3991966247558594  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.51904296875 GB
    Memory Allocated: 0.25920915603637695  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 16179, 7: 36, 24: 20, 19: 15, 9: 12, 22: 12, 2: 11, 23: 10, 3: 10, 12: 10, 4: 9, 18: 9, 14: 7, 17: 7, 21: 7, 16: 7, 20: 6, 13: 6, 11: 6, 15: 4, 5: 4, 6: 3, 8: 3, 10: 3, 1: 2})

----------------------------------------after blocks to device 
 Nvidia-smi: 13.51904296875 GB
    Memory Allocated: 0.27655744552612305  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.51904296875 GB
    Memory Allocated: 0.27655744552612305  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.86865234375 GB
    Memory Allocated: 11.388579845428467  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.86865234375 GB
    Memory Allocated: 11.39152193069458  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.86865234375 GB
    Memory Allocated: 0.29315614700317383  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 11 input nodes size: 428946
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.86865234375 GB
    Memory Allocated: 0.2707400321960449  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.86865234375 GB
    Memory Allocated: 0.2707400321960449  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.86865234375 GB
    Memory Allocated: 0.4307241439819336  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.86865234375 GB
    Memory Allocated: 0.43084716796875  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.86865234375 GB
    Memory Allocated: 0.2997469902038574  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 16221, 13: 23, 23: 21, 24: 17, 18: 17, 21: 17, 12: 15, 20: 14, 22: 13, 9: 13, 19: 12, 8: 12, 6: 11, 16: 10, 5: 10, 7: 9, 17: 9, 3: 8, 10: 8, 14: 7, 11: 4, 2: 4, 4: 3, 15: 3})

----------------------------------------after blocks to device 
 Nvidia-smi: 13.86865234375 GB
    Memory Allocated: 0.31807422637939453  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.86865234375 GB
    Memory Allocated: 0.31807422637939453  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 12.202067375183105  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 12.205487728118896  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.334932804107666  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.334932804107666  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.3339982032775879  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.10620673497517903 |0.01708255211512248 |0.13489548365275064 |0.0001152952512105306 |0.07813807328542073 |0.002050161361694336 |
----------------------------------------------------------pseudo_mini_loss sum 2.3271758556365967
Total (block generation + training)time/epoch 137.17639118433
Training time/epoch 4.206285715103149
Training time without block to device /epoch 4.00129508972168
Training time without total dataloading part /epoch 2.5598363876342773
load block tensor time/epoch 1.2744808197021484
block to device time/epoch 0.20499062538146973
input features size transfer per epoch 1.7881393432617188e-06
blocks size to device per epoch 9.834766387939453e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  6240127
Number of first layer input nodes during this epoch:  4583149
Number of first layer output nodes during this epoch:  1656978
----------------------------------------before generate dataloader block 
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.21774959564208984  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 3.415 seconds, peak memory: 50.428 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 50.428 GB
Metis partitioning: 12.045 seconds, peak memory: 50.428 GB
Split the graph: 4.383 seconds
Construct subgraphs: 0.437 seconds
REG metis partition end ----................................
REG construction  time spent:  78.17479753494263
pure dgl.metis_partition the time spent:  20.325335264205933
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  10.628304243087769

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  22.986693382263184

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.21774959564208984  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

connection checking time:  16.070378303527832
block generation total time  33.61499762535095
average batch blocks generation time:  2.8012498021125793
block dataloader generation time/epoch 136.47927289009095
pseudo mini batch 0 input nodes size: 326979
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.19368362426757812  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.19368362426757812  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.315493106842041  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.3156166076660156  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.15550947189331055  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 14636, 14: 125, 10: 117, 11: 115, 23: 112, 18: 110, 16: 110, 15: 109, 22: 108, 12: 99, 21: 98, 19: 91, 13: 91, 17: 87, 20: 80, 9: 79, 24: 75, 7: 73, 8: 60, 6: 50, 4: 44, 5: 31, 3: 22, 2: 7, 1: 3})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.171234130859375  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.171234130859375  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 9.955564022064209  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 9.958466529846191  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.17475414276123047  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 1 input nodes size: 344141
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.15561246871948242  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.15561246871948242  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.2838153839111328  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.2839365005493164  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.1620035171508789  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 15454, 9: 48, 20: 42, 4: 41, 24: 40, 15: 39, 19: 38, 22: 34, 6: 34, 14: 33, 17: 33, 8: 32, 13: 31, 18: 31, 2: 29, 23: 29, 11: 29, 21: 28, 16: 26, 10: 24, 3: 23, 12: 22, 7: 19, 1: 19, 5: 16})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.17766141891479492  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.17766141891479492  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 10.008111000061035  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 10.01101303100586  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.19145679473876953  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 2 input nodes size: 212471
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.1723928451538086  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.1723928451538086  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.2515444755554199  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.2516636848449707  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.12333965301513672  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 14002, 8: 105, 7: 97, 17: 95, 6: 94, 10: 90, 19: 90, 13: 89, 15: 86, 24: 86, 14: 86, 11: 86, 16: 84, 21: 82, 18: 82, 9: 82, 5: 82, 4: 82, 23: 78, 22: 76, 12: 76, 20: 69, 3: 57, 2: 51, 1: 33})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.1372814178466797  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.1372814178466797  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 8.494336128234863  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 8.497329711914062  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.14906835556030273  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 3 input nodes size: 403772
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.13291645050048828  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.13291645050048828  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.28333330154418945  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.28345251083374023  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.20418167114257812  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 15118, 22: 50, 18: 49, 11: 47, 15: 44, 24: 41, 14: 41, 17: 40, 12: 38, 7: 37, 19: 37, 9: 37, 23: 36, 10: 36, 20: 35, 16: 35, 13: 34, 6: 32, 21: 30, 5: 27, 4: 27, 8: 25, 3: 19, 1: 12, 2: 12})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.2208871841430664  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.2208871841430664  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 10.393982410430908  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 10.39749813079834  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.23504161834716797  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 4 input nodes size: 323676
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.21573162078857422  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.21573162078857422  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.3368253707885742  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.33695125579833984  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.1864151954650879  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 15471, 23: 84, 13: 83, 14: 82, 17: 78, 21: 75, 16: 72, 10: 67, 24: 67, 19: 65, 11: 64, 15: 62, 22: 60, 20: 59, 9: 56, 12: 54, 8: 53, 18: 52, 7: 52, 6: 48, 5: 40, 3: 29, 4: 28, 2: 22, 1: 14})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.20194482803344727  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.20194482803344727  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 10.429758071899414  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 10.432706832885742  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.21642112731933594  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 5 input nodes size: 356285
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.1972031593322754  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.1972031593322754  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.32992982864379883  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.33005380630493164  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.20883417129516602  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 15298, 23: 72, 22: 67, 7: 65, 20: 65, 13: 63, 6: 61, 15: 61, 16: 61, 12: 60, 14: 59, 11: 57, 19: 57, 24: 56, 8: 56, 5: 56, 17: 55, 21: 54, 4: 53, 10: 53, 18: 53, 9: 43, 3: 30, 2: 29, 1: 14})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.22465085983276367  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.22465085983276367  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 10.7001371383667  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 10.70339584350586  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.23771429061889648  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 6 input nodes size: 434983
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.2178049087524414  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.2178049087524414  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.3799142837524414  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.3800334930419922  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.24718284606933594  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 15675, 9: 19, 7: 17, 12: 17, 15: 16, 13: 15, 19: 15, 11: 14, 24: 14, 22: 13, 23: 13, 21: 13, 5: 11, 4: 11, 17: 11, 10: 10, 8: 9, 16: 9, 18: 8, 6: 7, 14: 7, 2: 6, 1: 6, 20: 6, 3: 5})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.26427316665649414  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.26427316665649414  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 11.818341255187988  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 11.822004318237305  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.2805180549621582  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 7 input nodes size: 362181
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.2567439079284668  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.2567439079284668  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.39166688919067383  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.39179229736328125  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.22956371307373047  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 16525, 24: 25, 18: 20, 20: 19, 22: 18, 19: 16, 9: 16, 17: 15, 21: 15, 14: 14, 23: 14, 16: 13, 10: 13, 5: 9, 8: 9, 7: 9, 11: 8, 12: 7, 15: 7, 13: 5, 3: 5, 4: 3, 6: 3, 2: 1, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.2477273941040039  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.28271484375 GB
    Memory Allocated: 0.2477273941040039  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.47998046875 GB
    Memory Allocated: 11.812965869903564  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.47998046875 GB
    Memory Allocated: 11.81673812866211  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.47998046875 GB
    Memory Allocated: 0.26328420639038086  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 8 input nodes size: 430448
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.47998046875 GB
    Memory Allocated: 0.24064350128173828  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.47998046875 GB
    Memory Allocated: 0.24064350128173828  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.47998046875 GB
    Memory Allocated: 0.4009981155395508  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.47998046875 GB
    Memory Allocated: 0.4011240005493164  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.47998046875 GB
    Memory Allocated: 0.26607561111450195  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 16630, 19: 24, 13: 21, 23: 21, 6: 19, 24: 18, 12: 17, 22: 15, 21: 12, 9: 11, 18: 10, 2: 10, 14: 8, 15: 8, 3: 7, 20: 7, 5: 6, 17: 6, 8: 6, 10: 5, 16: 4, 11: 4, 1: 2, 4: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.47998046875 GB
    Memory Allocated: 0.2848544120788574  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.47998046875 GB
    Memory Allocated: 0.2848544120788574  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 12.410261154174805  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 12.413331508636475  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.30145740509033203  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 9 input nodes size: 409238
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.2774014472961426  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.2774014472961426  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.4298548698425293  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.4299798011779785  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.2694993019104004  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 16275, 21: 37, 19: 34, 1: 34, 22: 31, 16: 31, 24: 29, 3: 25, 18: 24, 15: 24, 23: 19, 20: 18, 7: 15, 9: 15, 17: 14, 10: 12, 14: 12, 4: 11, 12: 9, 6: 9, 13: 8, 5: 7, 8: 7, 2: 5, 11: 5})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.2881202697753906  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.2881202697753906  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 12.232213020324707  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 12.2351393699646  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.3053879737854004  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 10 input nodes size: 486660
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.2813420295715332  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.2813420295715332  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.46263742446899414  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.4627566337585449  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.310178279876709  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 13646, 15: 176, 7: 159, 10: 154, 9: 133, 6: 120, 11: 117, 14: 116, 12: 109, 20: 107, 23: 104, 24: 94, 16: 92, 4: 87, 19: 86, 13: 81, 21: 79, 5: 78, 3: 78, 18: 78, 8: 76, 22: 64, 17: 63, 1: 29, 2: 27})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.3277926445007324  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.3277926445007324  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 11.189473152160645  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 11.19290828704834  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.34207630157470703  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 11 input nodes size: 475404
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.32000732421875  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.32000732421875  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.49710941314697266  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.49723100662231445  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.31581640243530273  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 14648, 14: 112, 7: 111, 24: 100, 13: 94, 18: 87, 5: 82, 11: 78, 16: 77, 12: 75, 8: 74, 3: 74, 6: 73, 4: 68, 23: 66, 20: 65, 21: 63, 10: 59, 17: 59, 22: 56, 15: 41, 9: 37, 19: 31, 2: 22, 1: 6})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.33403778076171875  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.33403778076171875  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 12.077572345733643  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 12.080883979797363  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.3502082824707031  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.3502082824707031  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.349273681640625  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08804537852605183 |0.025838593641916912 |0.12001156806945801 |0.00013909737269083658 |0.08116964499155681 |0.005171060562133789 |
----------------------------------------------------------pseudo_mini_loss sum 1.8762331008911133
Total (block generation + training)time/epoch 141.0550286769867
Training time/epoch 4.003465414047241
Training time without block to device /epoch 3.6934022903442383
Training time without total dataloading part /epoch 2.4210147857666016
load block tensor time/epoch 1.056544542312622
block to device time/epoch 0.31006312370300293
input features size transfer per epoch 1.7881393432617188e-06
blocks size to device per epoch 9.834766387939453e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  6220702
Number of first layer input nodes during this epoch:  4566238
Number of first layer output nodes during this epoch:  1654464
----------------------------------------before generate dataloader block 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.23406219482421875  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 3.644 seconds, peak memory: 50.428 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 50.428 GB
Metis partitioning: 12.960 seconds, peak memory: 50.428 GB
Split the graph: 4.540 seconds
Construct subgraphs: 0.556 seconds
REG metis partition end ----................................
REG construction  time spent:  77.54342460632324
pure dgl.metis_partition the time spent:  21.749625205993652
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  6.060128211975098

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  25.408696174621582

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.23406219482421875  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

connection checking time:  21.878684759140015
block generation total time  31.46882438659668
average batch blocks generation time:  2.62240203221639
block dataloader generation time/epoch 140.08331175645193
pseudo mini batch 0 input nodes size: 400883
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.21001291275024414  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.21001291275024414  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.35935354232788086  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.3594794273376465  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.18225574493408203  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 16496, 9: 33, 1: 26, 8: 19, 21: 18, 12: 17, 14: 17, 22: 16, 6: 16, 19: 15, 24: 15, 20: 14, 10: 14, 11: 13, 13: 13, 18: 13, 15: 12, 17: 11, 3: 11, 7: 10, 16: 10, 23: 9, 5: 6, 2: 5, 4: 4})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.20004940032958984  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.20004940032958984  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 11.872756958007812  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 11.875726699829102  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.20653247833251953  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 1 input nodes size: 211808
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.1832871437072754  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.1832871437072754  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.2621917724609375  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.2623105049133301  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.11284399032592773  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 13954, 8: 101, 7: 100, 6: 99, 17: 98, 13: 92, 10: 92, 19: 90, 15: 88, 14: 87, 11: 86, 24: 85, 9: 85, 16: 83, 5: 83, 18: 82, 4: 82, 21: 81, 22: 81, 23: 78, 12: 75, 20: 70, 3: 57, 2: 56, 1: 39})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.1262359619140625  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.1262359619140625  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 8.460766315460205  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 8.46394395828247  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.13786554336547852  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 2 input nodes size: 374169
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.12256669998168945  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.12256669998168945  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.26195573806762695  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.26207447052001953  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.18305110931396484  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 15170, 4: 46, 20: 44, 24: 43, 19: 43, 15: 41, 22: 39, 8: 37, 14: 33, 17: 33, 16: 31, 13: 31, 9: 31, 23: 31, 21: 29, 18: 29, 6: 26, 11: 26, 7: 25, 12: 25, 10: 24, 3: 20, 5: 19, 2: 15, 1: 12})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.19798040390014648  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.19798040390014648  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 10.046083450317383  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 10.04905366897583  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.21213436126708984  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 3 input nodes size: 350785
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.1936783790588379  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.1936783790588379  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.3243560791015625  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.3244748115539551  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.184967041015625  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 15141, 22: 49, 15: 47, 11: 43, 18: 43, 19: 42, 17: 42, 24: 40, 14: 38, 23: 37, 13: 36, 12: 36, 9: 35, 21: 34, 7: 33, 10: 33, 16: 32, 20: 30, 5: 28, 8: 25, 4: 25, 6: 24, 3: 16, 1: 15, 2: 8})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.20046186447143555  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.20046186447143555  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 9.776883602142334  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 9.780158042907715  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.21323347091674805  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 4 input nodes size: 376754
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.19500398635864258  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.19500398635864258  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.3353562355041504  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.3354811668395996  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.20468473434448242  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 15310, 13: 88, 23: 83, 14: 83, 24: 77, 17: 74, 16: 73, 21: 68, 10: 68, 11: 67, 7: 62, 15: 62, 20: 59, 8: 59, 6: 58, 18: 56, 19: 55, 9: 54, 12: 54, 5: 49, 22: 47, 4: 41, 3: 35, 2: 24, 1: 17})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.22173309326171875  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.22173309326171875  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 11.272408962249756  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 11.275679588317871  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.2373824119567871  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 5 input nodes size: 304559
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.2160348892211914  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.2160348892211914  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.32949209213256836  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.329617977142334  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.18914079666137695  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 15581, 22: 81, 23: 70, 20: 66, 11: 65, 19: 64, 13: 63, 21: 62, 12: 61, 16: 60, 15: 59, 17: 58, 14: 57, 18: 55, 10: 53, 6: 52, 5: 52, 8: 50, 7: 50, 24: 50, 9: 49, 4: 37, 2: 29, 3: 29, 1: 20})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.20497655868530273  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.20497655868530273  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 10.127083778381348  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 10.130038738250732  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.21815252304077148  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 6 input nodes size: 355773
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.19907093048095703  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.19907093048095703  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.3316068649291992  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.3317294120788574  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.21814632415771484  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 14548, 11: 123, 10: 120, 18: 115, 14: 111, 22: 107, 16: 107, 15: 107, 23: 105, 21: 100, 12: 94, 19: 91, 17: 88, 13: 85, 20: 83, 24: 81, 9: 79, 7: 69, 8: 57, 6: 50, 5: 30, 4: 24, 3: 22, 2: 6, 1: 3})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.2341914176940918  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.2341914176940918  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 10.568938255310059  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 10.572126865386963  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.24785709381103516  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 7 input nodes size: 450198
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.22775554656982422  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.22775554656982422  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.39603471755981445  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.39615440368652344  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.26349592208862305  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 13069, 7: 247, 14: 215, 10: 188, 6: 187, 11: 170, 4: 151, 3: 137, 16: 123, 5: 123, 20: 122, 8: 122, 23: 118, 18: 116, 15: 115, 24: 114, 12: 111, 13: 108, 9: 107, 22: 83, 21: 83, 17: 74, 19: 52, 2: 50, 1: 22})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.27918100357055664  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.71240234375 GB
    Memory Allocated: 0.27918100357055664  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.73779296875 GB
    Memory Allocated: 10.754246234893799  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.73779296875 GB
    Memory Allocated: 10.75771427154541  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.73779296875 GB
    Memory Allocated: 0.29341650009155273  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 8 input nodes size: 431157
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.73779296875 GB
    Memory Allocated: 0.2726302146911621  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.73779296875 GB
    Memory Allocated: 0.2726302146911621  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.73779296875 GB
    Memory Allocated: 0.43324899673461914  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.73779296875 GB
    Memory Allocated: 0.43337106704711914  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.73779296875 GB
    Memory Allocated: 0.2649722099304199  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 15108, 15: 118, 19: 101, 24: 92, 21: 80, 12: 76, 16: 75, 23: 72, 9: 65, 18: 62, 13: 61, 17: 56, 20: 56, 22: 50, 7: 39, 4: 33, 14: 31, 5: 31, 10: 24, 8: 24, 3: 24, 6: 17, 1: 16, 11: 14, 2: 11})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.73779296875 GB
    Memory Allocated: 0.2816152572631836  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.73779296875 GB
    Memory Allocated: 0.2816152572631836  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.73779296875 GB
    Memory Allocated: 11.21629810333252  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.73779296875 GB
    Memory Allocated: 11.219159126281738  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.73779296875 GB
    Memory Allocated: 0.29602909088134766  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 9 input nodes size: 421652
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.73779296875 GB
    Memory Allocated: 0.274810791015625  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.73779296875 GB
    Memory Allocated: 0.274810791015625  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.73779296875 GB
    Memory Allocated: 0.4318885803222656  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.73779296875 GB
    Memory Allocated: 0.4320082664489746  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.73779296875 GB
    Memory Allocated: 0.2712674140930176  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 15738, 9: 22, 7: 17, 18: 17, 10: 15, 15: 15, 19: 14, 5: 14, 23: 14, 22: 13, 17: 12, 24: 12, 20: 11, 12: 11, 21: 10, 11: 10, 13: 9, 16: 9, 8: 9, 4: 8, 3: 8, 2: 7, 6: 7, 14: 6, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.73779296875 GB
    Memory Allocated: 0.2895832061767578  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.73779296875 GB
    Memory Allocated: 0.2895832061767578  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.73779296875 GB
    Memory Allocated: 11.662323474884033  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.73779296875 GB
    Memory Allocated: 11.665137767791748  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.73779296875 GB
    Memory Allocated: 0.3040313720703125  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 10 input nodes size: 406848
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.73779296875 GB
    Memory Allocated: 0.2814903259277344  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.73779296875 GB
    Memory Allocated: 0.2814903259277344  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.73779296875 GB
    Memory Allocated: 0.43305301666259766  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.73779296875 GB
    Memory Allocated: 0.4331789016723633  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.73779296875 GB
    Memory Allocated: 0.27598142623901367  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 16708, 23: 18, 13: 16, 12: 13, 24: 12, 6: 11, 21: 11, 20: 9, 22: 8, 14: 7, 17: 7, 18: 7, 9: 7, 3: 6, 16: 6, 8: 6, 5: 5, 19: 5, 10: 2, 2: 2, 15: 2, 11: 2, 7: 1, 1: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.73779296875 GB
    Memory Allocated: 0.2944183349609375  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.73779296875 GB
    Memory Allocated: 0.2944183349609375  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 12.340357780456543  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 12.343722343444824  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.31079721450805664  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 11 input nodes size: 395703
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.2868075370788574  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.2868075370788574  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.4342184066772461  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.4343433380126953  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.2826547622680664  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 16555, 24: 24, 22: 18, 13: 13, 23: 13, 19: 12, 14: 10, 12: 10, 21: 10, 9: 9, 3: 9, 18: 9, 2: 8, 20: 8, 10: 7, 15: 7, 11: 5, 5: 5, 16: 5, 4: 4, 17: 3, 8: 3, 6: 3, 7: 2, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.30141353607177734  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.30141353607177734  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 12.175008773803711  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 12.17865800857544  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.31749582290649414  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.31749582290649414  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.316561222076416  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08202211062113444 |0.016814668973286945 |0.11824492613474528 |0.0001459519068400065 |0.08445318539937337 |0.008636236190795898 |
----------------------------------------------------------pseudo_mini_loss sum 1.6376947164535522
Total (block generation + training)time/epoch 144.53659494717917
Training time/epoch 3.8404550552368164
Training time without block to device /epoch 3.638679027557373
Training time without total dataloading part /epoch 2.4427649974823
load block tensor time/epoch 0.9842653274536133
block to device time/epoch 0.20177602767944336
input features size transfer per epoch 1.7881393432617188e-06
blocks size to device per epoch 9.834766387939453e-07
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  6113759
Number of first layer input nodes during this epoch:  4480289
Number of first layer output nodes during this epoch:  1633470
----------------------------------------before generate dataloader block 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.20473575592041016  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 3.443 seconds, peak memory: 50.428 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 50.428 GB
Metis partitioning: 12.706 seconds, peak memory: 50.428 GB
Split the graph: 5.809 seconds
Construct subgraphs: 0.451 seconds
REG metis partition end ----................................
REG construction  time spent:  75.19713544845581
pure dgl.metis_partition the time spent:  22.458557844161987
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  6.137819051742554

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  19.162256717681885

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.20473575592041016  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

connection checking time:  13.633721828460693
block generation total time  25.30007576942444
average batch blocks generation time:  2.1083396474520364
block dataloader generation time/epoch 140.25536244256156
pseudo mini batch 0 input nodes size: 345149
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.18146705627441406  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.18146705627441406  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.3100452423095703  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.3101673126220703  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.16263151168823242  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 14467, 23: 122, 16: 120, 10: 119, 15: 115, 18: 115, 14: 114, 11: 113, 22: 112, 21: 100, 19: 96, 12: 94, 17: 85, 20: 84, 13: 83, 9: 78, 24: 78, 7: 74, 6: 56, 8: 55, 4: 42, 5: 31, 3: 17, 2: 6, 1: 4})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.17912817001342773  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.17912817001342773  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 10.279017448425293  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 10.282054901123047  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.18186330795288086  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 1 input nodes size: 484631
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.16236352920532227  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.16236352920532227  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.34290266036987305  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.34302186965942383  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.21432161331176758  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 14224, 14: 119, 7: 116, 24: 100, 5: 94, 6: 86, 13: 84, 11: 83, 8: 81, 18: 80, 16: 79, 4: 76, 20: 74, 23: 73, 3: 70, 17: 67, 21: 65, 10: 64, 22: 63, 19: 63, 12: 54, 15: 52, 9: 51, 2: 30, 1: 13})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.23195791244506836  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.23195791244506836  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 11.717209815979004  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 11.720115184783936  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.2489795684814453  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 2 input nodes size: 430026
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.2255115509033203  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.2255115509033203  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.3857088088989258  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.38582801818847656  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.205169677734375  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 13588, 15: 183, 7: 158, 10: 148, 9: 139, 12: 125, 14: 120, 6: 120, 20: 108, 24: 107, 23: 102, 11: 102, 16: 101, 3: 98, 21: 98, 19: 96, 13: 95, 18: 94, 4: 80, 22: 75, 8: 72, 17: 71, 5: 63, 2: 28, 1: 26})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.22164201736450195  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.22164201736450195  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 10.338567733764648  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 10.341690063476562  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.23667621612548828  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 3 input nodes size: 398490
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.215789794921875  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.215789794921875  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.3642392158508301  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.3643617630004883  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.20404529571533203  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 16105, 24: 24, 16: 23, 12: 21, 19: 19, 22: 19, 20: 17, 18: 16, 10: 14, 23: 14, 21: 14, 9: 14, 11: 14, 8: 13, 7: 13, 15: 12, 14: 11, 4: 10, 17: 9, 3: 8, 13: 8, 5: 7, 1: 6, 6: 5, 2: 3})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.2226271629333496  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.2226271629333496  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 11.593139171600342  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 11.596131324768066  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.23894786834716797  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 4 input nodes size: 363205
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.21580123901367188  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.21580123901367188  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.3511056900024414  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.351229190826416  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.20265722274780273  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 16383, 24: 26, 9: 11, 13: 10, 19: 9, 18: 9, 12: 9, 22: 9, 5: 9, 2: 9, 7: 9, 20: 8, 21: 8, 14: 8, 23: 8, 17: 7, 11: 5, 10: 4, 4: 4, 15: 3, 16: 3, 8: 2, 6: 2, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.22102022171020508  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.22102022171020508  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 11.67927885055542  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 11.682279586791992  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.23590326309204102  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 5 input nodes size: 429016
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.21278905868530273  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.21278905868530273  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.3731379508972168  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.373262882232666  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.23783493041992188  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 16467, 23: 27, 13: 26, 12: 18, 21: 18, 3: 15, 24: 14, 14: 13, 22: 12, 4: 10, 11: 10, 18: 10, 6: 10, 9: 10, 19: 9, 15: 9, 8: 9, 10: 7, 7: 7, 20: 7, 17: 7, 16: 6, 2: 3, 1: 3, 5: 2})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.2568473815917969  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.2568473815917969  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 12.159958362579346  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 12.163785934448242  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.27320289611816406  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 6 input nodes size: 338133
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.24942541122436523  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.24942541122436523  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.37539005279541016  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.3755159378051758  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.2150421142578125  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 16534, 9: 40, 15: 24, 21: 20, 23: 17, 11: 17, 18: 17, 13: 15, 22: 15, 16: 14, 19: 14, 24: 14, 20: 13, 12: 12, 17: 12, 14: 12, 8: 11, 6: 11, 1: 10, 4: 10, 10: 10, 5: 10, 7: 9, 3: 8, 2: 4})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.23249197006225586  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.23249197006225586  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 11.043698787689209  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 11.046994686126709  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.24794435501098633  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 7 input nodes size: 307749
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.2267780303955078  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.2267780303955078  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.34142351150512695  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.34154415130615234  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.2154536247253418  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 15753, 20: 31, 15: 27, 24: 27, 4: 27, 8: 25, 22: 24, 14: 22, 21: 21, 18: 21, 19: 20, 6: 18, 16: 16, 11: 16, 17: 15, 13: 15, 12: 15, 10: 15, 9: 15, 23: 14, 7: 11, 1: 11, 3: 9, 2: 9, 5: 8})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.2307424545288086  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.2307424545288086  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 9.976333141326904  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 9.979598999023438  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.24415969848632812  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 8 input nodes size: 212959
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.22558927536010742  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.22558927536010742  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.30492305755615234  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.30504369735717773  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.1902775764465332  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 14203, 8: 106, 17: 100, 7: 99, 6: 96, 19: 93, 13: 93, 15: 91, 10: 90, 24: 89, 4: 86, 14: 86, 16: 86, 9: 85, 18: 84, 11: 82, 5: 82, 21: 80, 22: 79, 12: 76, 23: 75, 20: 65, 3: 64, 2: 51, 1: 32})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.20402908325195312  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.20402908325195312  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 8.583813667297363  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 8.586970806121826  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.21549034118652344  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 9 input nodes size: 392707
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.19994211196899414  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.19994211196899414  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.3462371826171875  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.3463606834411621  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.2669062614440918  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 15561, 22: 57, 11: 53, 15: 53, 23: 51, 14: 49, 7: 49, 12: 49, 17: 47, 24: 46, 19: 44, 18: 43, 20: 40, 5: 38, 10: 38, 8: 36, 16: 36, 6: 36, 13: 34, 21: 33, 9: 33, 4: 32, 1: 26, 3: 26, 2: 25})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.28314638137817383  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.28314638137817383  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 11.023212909698486  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 11.026142597198486  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.29764366149902344  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 10 input nodes size: 429615
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.27707815170288086  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.27707815170288086  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.4374270439147949  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.4375457763671875  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.29112720489501953  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 14595, 22: 71, 13: 70, 11: 66, 20: 66, 23: 63, 10: 62, 16: 61, 17: 59, 14: 59, 12: 58, 7: 58, 6: 58, 19: 56, 21: 56, 5: 56, 18: 56, 24: 55, 8: 52, 4: 48, 15: 46, 9: 38, 2: 36, 3: 31, 1: 27})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.30726003646850586  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.30726003646850586  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 11.078614234924316  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 11.081543922424316  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.32297849655151367  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

pseudo mini batch 11 input nodes size: 326084
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.3013734817504883  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.3013734817504883  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.4228496551513672  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.4229755401611328  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.26250791549682617  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 15498, 14: 82, 13: 82, 23: 82, 17: 77, 21: 73, 16: 69, 10: 69, 19: 65, 24: 65, 11: 63, 9: 62, 20: 59, 18: 59, 15: 58, 22: 56, 7: 52, 12: 52, 6: 52, 8: 50, 5: 45, 4: 31, 3: 28, 2: 17, 1: 14})

----------------------------------------after blocks to device 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.278228759765625  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.278228759765625  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 10.46879529953003  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 10.472078323364258  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.2921013832092285  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.2921013832092285  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 14.93701171875 GB
    Memory Allocated: 0.2911667823791504  GigaBytes
Max Memory Allocated: 12.87250804901123  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.086276113986969 |0.015293737252553305 |0.11424754063288371 |0.00012193123499552409 |0.08299062649408977 |0.004967212677001953 |
----------------------------------------------------------pseudo_mini_loss sum 1.5125806331634521
Total (block generation + training)time/epoch 144.61603886740548
Training time/epoch 3.804718255996704
Training time without block to device /epoch 3.6211934089660645
Training time without total dataloading part /epoch 2.37328839302063
load block tensor time/epoch 1.035313367843628
block to device time/epoch 0.18352484703063965
input features size transfer per epoch 1.7881393432617188e-06
blocks size to device per epoch 9.834766387939453e-07
