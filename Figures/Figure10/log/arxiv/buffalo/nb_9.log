main start at this time 1733009813.8147697
-----------------------------------------before load data 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  9
G_BUCKET_ID_list [[6, 8, 0], [3, 7, 15], [13, 18, 23, 21], [5, 10, 12], [2, 1, 14], [16, 19, 20, 22], [4, 9, 17], [11]]
Groups_mem_list  [[1881, 1805, 1514], [1929, 1853, 1418], [1544, 1351, 1159, 1144], [1921, 1685, 1591], [1901, 1785, 1508], [1415, 1326, 1281, 1148], [1966, 1779, 1370], [1683], [1683]]
G_BUCKET_ID_list length 8
backpack scheduling spend time (sec) 0.44264769554138184
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  9
current group_mem  5.201805527909279
current group_mem  5.202517399365936
current group_mem  5.199238820321183
current group_mem  5.198348641163134
current group_mem  5.195670640767341
current group_mem  5.1720456034144355
current group_mem  5.117142140628218
current group_mem  1.6838659180332751
batches output list generation spend  0.0007681846618652344
self.weights_list  [0.2364280137671677, 0.14245499829559824, 0.04841600598190035, 0.10753125652895834, 0.2564739776338505, 0.04535907896328389, 0.11898923477859272, 0.032867463520304376, 0.01147997053034385]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.007853269577026367
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.44362926483154297
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.7038998603820801
self.buckets_partition() spend  sec:  0.45150279998779297
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 0.63818359375 GB
    Memory Allocated: 0.10068845748901367  GigaBytes
Max Memory Allocated: 0.10068845748901367  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 9.961064338684082  GigaBytes
Max Memory Allocated: 10.484805583953857  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.37255859375 GB
    Memory Allocated: 9.964323043823242  GigaBytes
Max Memory Allocated: 10.484805583953857  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.74560546875 GB
    Memory Allocated: 0.15225982666015625  GigaBytes
Max Memory Allocated: 10.484805583953857  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.85498046875 GB
    Memory Allocated: 10.267654418945312  GigaBytes
Max Memory Allocated: 10.755385875701904  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.85498046875 GB
    Memory Allocated: 10.269653797149658  GigaBytes
Max Memory Allocated: 10.755385875701904  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.24169921875 GB
    Memory Allocated: 0.14353656768798828  GigaBytes
Max Memory Allocated: 10.755385875701904  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.26904296875 GB
    Memory Allocated: 8.77049732208252  GigaBytes
Max Memory Allocated: 10.755385875701904  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 13.26904296875 GB
    Memory Allocated: 8.771153926849365  GigaBytes
Max Memory Allocated: 10.755385875701904  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 13.26904296875 GB
    Memory Allocated: 0.15189027786254883  GigaBytes
Max Memory Allocated: 10.755385875701904  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.29638671875 GB
    Memory Allocated: 10.188015460968018  GigaBytes
Max Memory Allocated: 10.755385875701904  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 14.29638671875 GB
    Memory Allocated: 10.189541816711426  GigaBytes
Max Memory Allocated: 10.755385875701904  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 14.68310546875 GB
    Memory Allocated: 0.16247844696044922  GigaBytes
Max Memory Allocated: 10.755385875701904  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.39599609375 GB
    Memory Allocated: 10.06844425201416  GigaBytes
Max Memory Allocated: 10.755385875701904  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.39599609375 GB
    Memory Allocated: 10.071923732757568  GigaBytes
Max Memory Allocated: 10.755385875701904  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.76708984375 GB
    Memory Allocated: 0.15207290649414062  GigaBytes
Max Memory Allocated: 10.755385875701904  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.77490234375 GB
    Memory Allocated: 8.752376556396484  GigaBytes
Max Memory Allocated: 10.755385875701904  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.77490234375 GB
    Memory Allocated: 8.752992153167725  GigaBytes
Max Memory Allocated: 10.755385875701904  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.77490234375 GB
    Memory Allocated: 0.16035079956054688  GigaBytes
Max Memory Allocated: 10.755385875701904  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.77490234375 GB
    Memory Allocated: 10.171680450439453  GigaBytes
Max Memory Allocated: 10.755385875701904  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.77490234375 GB
    Memory Allocated: 10.17334794998169  GigaBytes
Max Memory Allocated: 10.755385875701904  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.77490234375 GB
    Memory Allocated: 0.1483016014099121  GigaBytes
Max Memory Allocated: 10.755385875701904  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85107421875 GB
    Memory Allocated: 5.599437713623047  GigaBytes
Max Memory Allocated: 10.755385875701904  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.85107421875 GB
    Memory Allocated: 5.599884033203125  GigaBytes
Max Memory Allocated: 10.755385875701904  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85107421875 GB
    Memory Allocated: 0.13228607177734375  GigaBytes
Max Memory Allocated: 10.755385875701904  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85107421875 GB
    Memory Allocated: 3.188995361328125  GigaBytes
Max Memory Allocated: 10.755385875701904  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.85107421875 GB
    Memory Allocated: 3.1891517639160156  GigaBytes
Max Memory Allocated: 10.755385875701904  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 15.85107421875 GB
    Memory Allocated: 0.16697931289672852  GigaBytes
Max Memory Allocated: 10.755385875701904  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7753703594207764
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  9
G_BUCKET_ID_list [[6, 8, 0], [3, 7, 15], [13, 18, 23, 21], [5, 10, 12], [2, 1, 14], [16, 19, 20, 22], [4, 9, 17], [11]]
Groups_mem_list  [[1881, 1805, 1514], [1929, 1853, 1418], [1544, 1351, 1159, 1144], [1921, 1685, 1591], [1901, 1785, 1508], [1415, 1326, 1281, 1148], [1966, 1779, 1370], [1683], [1683]]
G_BUCKET_ID_list length 8
backpack scheduling spend time (sec) 0.4150207042694092
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  9
current group_mem  5.201805527909279
current group_mem  5.202517399365936
current group_mem  5.199238820321183
current group_mem  5.198348641163134
current group_mem  5.195670640767341
current group_mem  5.1720456034144355
current group_mem  5.117142140628218
current group_mem  1.6838659180332751
batches output list generation spend  0.00032711029052734375
self.weights_list  [0.2364280137671677, 0.14245499829559824, 0.04841600598190035, 0.10753125652895834, 0.2564739776338505, 0.04535907896328389, 0.11898923477859272, 0.032867463520304376, 0.01147997053034385]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0074541568756103516
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4154791831970215
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.6459789276123047
self.buckets_partition() spend  sec:  0.42295384407043457
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85107421875 GB
    Memory Allocated: 0.18360471725463867  GigaBytes
Max Memory Allocated: 10.755385875701904  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85107421875 GB
    Memory Allocated: 10.029493808746338  GigaBytes
Max Memory Allocated: 10.755385875701904  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.85107421875 GB
    Memory Allocated: 10.032080173492432  GigaBytes
Max Memory Allocated: 10.755385875701904  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85107421875 GB
    Memory Allocated: 0.21897554397583008  GigaBytes
Max Memory Allocated: 10.755385875701904  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85107421875 GB
    Memory Allocated: 10.341901779174805  GigaBytes
Max Memory Allocated: 10.829108715057373  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.85107421875 GB
    Memory Allocated: 10.344160556793213  GigaBytes
Max Memory Allocated: 10.829108715057373  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85107421875 GB
    Memory Allocated: 0.20911264419555664  GigaBytes
Max Memory Allocated: 10.829108715057373  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85107421875 GB
    Memory Allocated: 8.84390115737915  GigaBytes
Max Memory Allocated: 10.829108715057373  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.85107421875 GB
    Memory Allocated: 8.844557762145996  GigaBytes
Max Memory Allocated: 10.829108715057373  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85107421875 GB
    Memory Allocated: 0.21787023544311523  GigaBytes
Max Memory Allocated: 10.829108715057373  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85107421875 GB
    Memory Allocated: 10.277151584625244  GigaBytes
Max Memory Allocated: 10.829108715057373  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.85107421875 GB
    Memory Allocated: 10.278677940368652  GigaBytes
Max Memory Allocated: 10.829108715057373  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85107421875 GB
    Memory Allocated: 0.22825336456298828  GigaBytes
Max Memory Allocated: 10.829108715057373  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85107421875 GB
    Memory Allocated: 10.184346675872803  GigaBytes
Max Memory Allocated: 10.829108715057373  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.85107421875 GB
    Memory Allocated: 10.187826156616211  GigaBytes
Max Memory Allocated: 10.829108715057373  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85107421875 GB
    Memory Allocated: 0.21723365783691406  GigaBytes
Max Memory Allocated: 10.829108715057373  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85107421875 GB
    Memory Allocated: 8.793355941772461  GigaBytes
Max Memory Allocated: 10.829108715057373  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.85107421875 GB
    Memory Allocated: 8.793971538543701  GigaBytes
Max Memory Allocated: 10.829108715057373  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85107421875 GB
    Memory Allocated: 0.22629213333129883  GigaBytes
Max Memory Allocated: 10.829108715057373  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85107421875 GB
    Memory Allocated: 10.251274585723877  GigaBytes
Max Memory Allocated: 10.829108715057373  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.85107421875 GB
    Memory Allocated: 10.252942085266113  GigaBytes
Max Memory Allocated: 10.829108715057373  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85107421875 GB
    Memory Allocated: 0.21254444122314453  GigaBytes
Max Memory Allocated: 10.829108715057373  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 5.646806716918945  GigaBytes
Max Memory Allocated: 10.829108715057373  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 5.647253036499023  GigaBytes
Max Memory Allocated: 10.829108715057373  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 0.1984729766845703  GigaBytes
Max Memory Allocated: 10.829108715057373  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 3.2517380714416504  GigaBytes
Max Memory Allocated: 10.829108715057373  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 3.251894474029541  GigaBytes
Max Memory Allocated: 10.829108715057373  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 0.16706132888793945  GigaBytes
Max Memory Allocated: 10.829108715057373  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.1903696060180664
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  9
G_BUCKET_ID_list [[6, 8, 0], [3, 7, 15], [13, 18, 23, 21], [5, 10, 12], [2, 1, 14], [16, 19, 20, 22], [4, 9, 17], [11]]
Groups_mem_list  [[1881, 1805, 1514], [1929, 1853, 1418], [1544, 1351, 1159, 1144], [1921, 1685, 1591], [1901, 1785, 1508], [1415, 1326, 1281, 1148], [1966, 1779, 1370], [1683], [1683]]
G_BUCKET_ID_list length 8
backpack scheduling spend time (sec) 0.4290742874145508
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  9
current group_mem  5.201805527909279
current group_mem  5.202517399365936
current group_mem  5.199238820321183
current group_mem  5.198348641163134
current group_mem  5.195670640767341
current group_mem  5.1720456034144355
current group_mem  5.117142140628218
current group_mem  1.6838659180332751
batches output list generation spend  0.0003819465637207031
self.weights_list  [0.2364280137671677, 0.14245499829559824, 0.04841600598190035, 0.10753125652895834, 0.2564739776338505, 0.04535907896328389, 0.11898923477859272, 0.032867463520304376, 0.01147997053034385]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.007455587387084961
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.42960643768310547
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.6872537136077881
self.buckets_partition() spend  sec:  0.43709230422973633
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 0.1834721565246582  GigaBytes
Max Memory Allocated: 10.829108715057373  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 10.026880264282227  GigaBytes
Max Memory Allocated: 10.829108715057373  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 10.02946662902832  GigaBytes
Max Memory Allocated: 10.829108715057373  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 0.2197866439819336  GigaBytes
Max Memory Allocated: 10.829108715057373  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 10.345691680908203  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 10.347691059112549  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 0.2090764045715332  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 8.85426378250122  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 8.854920387268066  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 0.21857881546020508  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 10.268054008483887  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 10.269580364227295  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 0.22904253005981445  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 10.180869579315186  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 10.184349060058594  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 0.2173466682434082  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 8.807126998901367  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 8.807742595672607  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 0.2270665168762207  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 10.239413738250732  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 10.241083145141602  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 0.21312761306762695  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 5.659169673919678  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 5.659615993499756  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 0.19834423065185547  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 3.246598720550537  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 3.2467551231384277  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 0.16691923141479492  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.6015074253082275
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  9
G_BUCKET_ID_list [[6, 8, 0], [3, 7, 15], [13, 18, 23, 21], [5, 10, 12], [2, 1, 14], [16, 19, 20, 22], [4, 9, 17], [11]]
Groups_mem_list  [[1881, 1805, 1514], [1929, 1853, 1418], [1544, 1351, 1159, 1144], [1921, 1685, 1591], [1901, 1785, 1508], [1415, 1326, 1281, 1148], [1966, 1779, 1370], [1683], [1683]]
G_BUCKET_ID_list length 8
backpack scheduling spend time (sec) 0.28114962577819824
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  9
current group_mem  5.201805527909279
current group_mem  5.202517399365936
current group_mem  5.199238820321183
current group_mem  5.198348641163134
current group_mem  5.195670640767341
current group_mem  5.1720456034144355
current group_mem  5.117142140628218
current group_mem  1.6838659180332751
batches output list generation spend  0.00037598609924316406
self.weights_list  [0.2364280137671677, 0.14245499829559824, 0.04841600598190035, 0.10753125652895834, 0.2564739776338505, 0.04535907896328389, 0.11898923477859272, 0.032867463520304376, 0.01147997053034385]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.008204221725463867
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.28166675567626953
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.5412149429321289
self.buckets_partition() spend  sec:  0.2899036407470703
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 0.1835465431213379  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 10.03139066696167  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 10.03397798538208  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 0.2189769744873047  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 10.338487148284912  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 10.340486526489258  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 0.2100811004638672  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 8.852831840515137  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 8.853488445281982  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 0.21770763397216797  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 10.265393733978271  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 10.26692008972168  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 0.22825336456298828  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 10.129451274871826  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 10.132930755615234  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 0.21741867065429688  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 8.79824686050415  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 8.79886245727539  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 0.2260756492614746  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 10.236271858215332  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 10.237939357757568  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 0.21256780624389648  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 5.649686336517334  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 5.650132656097412  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 0.1979227066040039  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 3.2396368980407715  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 3.239793300628662  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 0.16650152206420898  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0828685760498047
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  9
G_BUCKET_ID_list [[6, 8, 0], [3, 7, 15], [13, 18, 23, 21], [5, 10, 12], [2, 1, 14], [16, 19, 20, 22], [4, 9, 17], [11]]
Groups_mem_list  [[1881, 1805, 1514], [1929, 1853, 1418], [1544, 1351, 1159, 1144], [1921, 1685, 1591], [1901, 1785, 1508], [1415, 1326, 1281, 1148], [1966, 1779, 1370], [1683], [1683]]
G_BUCKET_ID_list length 8
backpack scheduling spend time (sec) 0.4198877811431885
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  9
current group_mem  5.201805527909279
current group_mem  5.202517399365936
current group_mem  5.199238820321183
current group_mem  5.198348641163134
current group_mem  5.195670640767341
current group_mem  5.1720456034144355
current group_mem  5.117142140628218
current group_mem  1.6838659180332751
batches output list generation spend  0.000347137451171875
self.weights_list  [0.2364280137671677, 0.14245499829559824, 0.04841600598190035, 0.10753125652895834, 0.2564739776338505, 0.04535907896328389, 0.11898923477859272, 0.032867463520304376, 0.01147997053034385]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.00783991813659668
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4203622341156006
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.6817257404327393
self.buckets_partition() spend  sec:  0.42823147773742676
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 0.18344640731811523  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 10.009745121002197  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 10.012332439422607  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 0.21897220611572266  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 10.338434219360352  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 10.340433597564697  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 0.21011734008789062  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 8.853659629821777  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 8.854316234588623  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 0.21760892868041992  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 10.263247013092041  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 10.26477336883545  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 0.22825145721435547  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 10.195969104766846  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 10.199448585510254  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 0.21737194061279297  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 8.8010892868042  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 8.80170488357544  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 0.22620916366577148  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 10.240302085876465  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 10.241990566253662  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 0.21262264251708984  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 5.647994518280029  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 5.648440837860107  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 0.19858074188232422  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 3.247499465942383  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 3.2476558685302734  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 0.16716909408569336  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.067028522491455
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  9
G_BUCKET_ID_list [[6, 8, 0], [3, 7, 15], [13, 18, 23, 21], [5, 10, 12], [2, 1, 14], [16, 19, 20, 22], [4, 9, 17], [11]]
Groups_mem_list  [[1881, 1805, 1514], [1929, 1853, 1418], [1544, 1351, 1159, 1144], [1921, 1685, 1591], [1901, 1785, 1508], [1415, 1326, 1281, 1148], [1966, 1779, 1370], [1683], [1683]]
G_BUCKET_ID_list length 8
backpack scheduling spend time (sec) 0.4580659866333008
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  9
current group_mem  5.201805527909279
current group_mem  5.202517399365936
current group_mem  5.199238820321183
current group_mem  5.198348641163134
current group_mem  5.195670640767341
current group_mem  5.1720456034144355
current group_mem  5.117142140628218
current group_mem  1.6838659180332751
batches output list generation spend  0.00036525726318359375
self.weights_list  [0.2364280137671677, 0.14245499829559824, 0.04841600598190035, 0.10753125652895834, 0.2564739776338505, 0.04535907896328389, 0.11898923477859272, 0.032867463520304376, 0.01147997053034385]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.007855653762817383
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.458573579788208
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.6910049915313721
self.buckets_partition() spend  sec:  0.46645236015319824
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 0.18356704711914062  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 10.027122974395752  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 10.029709339141846  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 0.21896696090698242  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 10.319528102874756  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 10.321490287780762  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 0.20904827117919922  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 8.850542545318604  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 8.85119915008545  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 0.21767473220825195  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 10.254125118255615  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 10.255651473999023  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 0.22825145721435547  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 10.155009269714355  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 10.158488750457764  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 0.2174205780029297  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 8.809401512145996  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 8.810017108917236  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 0.22620153427124023  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 10.239253997802734  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 10.240931034088135  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.85888671875 GB
    Memory Allocated: 0.21280574798583984  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 5.649139881134033  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 5.649586200714111  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 0.19797229766845703  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 3.2408461570739746  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 3.2410025596618652  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 0.16653871536254883  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0659823417663574
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  9
G_BUCKET_ID_list [[6, 8, 0], [3, 7, 15], [13, 18, 23, 21], [5, 10, 12], [2, 1, 14], [16, 19, 20, 22], [4, 9, 17], [11]]
Groups_mem_list  [[1881, 1805, 1514], [1929, 1853, 1418], [1544, 1351, 1159, 1144], [1921, 1685, 1591], [1901, 1785, 1508], [1415, 1326, 1281, 1148], [1966, 1779, 1370], [1683], [1683]]
G_BUCKET_ID_list length 8
backpack scheduling spend time (sec) 0.44364380836486816
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  9
current group_mem  5.201805527909279
current group_mem  5.202517399365936
current group_mem  5.199238820321183
current group_mem  5.198348641163134
current group_mem  5.195670640767341
current group_mem  5.1720456034144355
current group_mem  5.117142140628218
current group_mem  1.6838659180332751
batches output list generation spend  0.0003826618194580078
self.weights_list  [0.2364280137671677, 0.14245499829559824, 0.04841600598190035, 0.10753125652895834, 0.2564739776338505, 0.04535907896328389, 0.11898923477859272, 0.032867463520304376, 0.01147997053034385]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.007961273193359375
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4441702365875244
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.702965259552002
self.buckets_partition() spend  sec:  0.45215725898742676
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 0.18341302871704102  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 10.020266056060791  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 10.022853374481201  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 0.21897411346435547  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 10.33546257019043  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 10.3377366065979  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 0.2090926170349121  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 8.849725723266602  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 8.850382328033447  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 0.21778106689453125  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 10.293581485748291  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 10.2951078414917  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 0.22825336456298828  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 10.143715858459473  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 10.14719533920288  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 0.21726751327514648  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 8.8050856590271  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 8.80570125579834  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 0.22609901428222656  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 10.235699653625488  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 10.237367153167725  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 0.21276473999023438  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 5.66351842880249  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 5.663964748382568  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 0.1981678009033203  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 3.2436575889587402  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 3.243813991546631  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 0.16673994064331055  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.028364896774292
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  9
G_BUCKET_ID_list [[6, 8, 0], [3, 7, 15], [13, 18, 23, 21], [5, 10, 12], [2, 1, 14], [16, 19, 20, 22], [4, 9, 17], [11]]
Groups_mem_list  [[1881, 1805, 1514], [1929, 1853, 1418], [1544, 1351, 1159, 1144], [1921, 1685, 1591], [1901, 1785, 1508], [1415, 1326, 1281, 1148], [1966, 1779, 1370], [1683], [1683]]
G_BUCKET_ID_list length 8
backpack scheduling spend time (sec) 0.4163546562194824
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  9
current group_mem  5.201805527909279
current group_mem  5.202517399365936
current group_mem  5.199238820321183
current group_mem  5.198348641163134
current group_mem  5.195670640767341
current group_mem  5.1720456034144355
current group_mem  5.117142140628218
current group_mem  1.6838659180332751
batches output list generation spend  0.0004055500030517578
self.weights_list  [0.2364280137671677, 0.14245499829559824, 0.04841600598190035, 0.10753125652895834, 0.2564739776338505, 0.04535907896328389, 0.11898923477859272, 0.032867463520304376, 0.01147997053034385]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.007950544357299805
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.41690778732299805
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.6756370067596436
self.buckets_partition() spend  sec:  0.4248850345611572
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 0.18339061737060547  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 10.011872291564941  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 10.014459609985352  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 0.21897077560424805  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 10.341383934020996  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 10.343383312225342  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 0.210052490234375  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 8.862514972686768  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 8.863171577453613  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 0.2176980972290039  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 10.254167556762695  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 10.255693912506104  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 0.22825241088867188  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 10.142117023468018  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 10.145596504211426  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 0.21739482879638672  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 8.792171001434326  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 8.792786598205566  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 0.2262706756591797  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 10.249512672424316  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 10.251180171966553  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 0.2125711441040039  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 5.646902561187744  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 5.647348880767822  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 0.19956111907958984  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 3.2614235877990723  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 3.261579990386963  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 0.16816473007202148  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.958716630935669
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  9
G_BUCKET_ID_list [[6, 8, 0], [3, 7, 15], [13, 18, 23, 21], [5, 10, 12], [2, 1, 14], [16, 19, 20, 22], [4, 9, 17], [11]]
Groups_mem_list  [[1881, 1805, 1514], [1929, 1853, 1418], [1544, 1351, 1159, 1144], [1921, 1685, 1591], [1901, 1785, 1508], [1415, 1326, 1281, 1148], [1966, 1779, 1370], [1683], [1683]]
G_BUCKET_ID_list length 8
backpack scheduling spend time (sec) 0.27773094177246094
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  9
current group_mem  5.201805527909279
current group_mem  5.202517399365936
current group_mem  5.199238820321183
current group_mem  5.198348641163134
current group_mem  5.195670640767341
current group_mem  5.1720456034144355
current group_mem  5.117142140628218
current group_mem  1.6838659180332751
batches output list generation spend  0.0003750324249267578
self.weights_list  [0.2364280137671677, 0.14245499829559824, 0.04841600598190035, 0.10753125652895834, 0.2564739776338505, 0.04535907896328389, 0.11898923477859272, 0.032867463520304376, 0.01147997053034385]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.007459878921508789
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.27825045585632324
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.5378265380859375
self.buckets_partition() spend  sec:  0.2857348918914795
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 0.18366527557373047  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 10.030231475830078  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 10.032816886901855  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 0.21897554397583008  GigaBytes
Max Memory Allocated: 10.832898616790771  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 10.346668720245361  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 10.348777294158936  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 0.2090778350830078  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 8.845256328582764  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 8.84591293334961  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 0.21761655807495117  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 10.258285522460938  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 10.259811878204346  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 0.22822046279907227  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 10.179882526397705  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 15.86083984375 GB
    Memory Allocated: 10.183362007141113  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.2174072265625  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.812437534332275  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.813053131103516  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.22619199752807617  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.245145320892334  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.246818542480469  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.21271610260009766  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 5.651717662811279  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 5.652163982391357  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.19850540161132812  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 3.255951404571533  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 3.256107807159424  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.16709661483764648  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.867971897125244
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  9
G_BUCKET_ID_list [[6, 8, 0], [3, 7, 15], [13, 18, 23, 21], [5, 10, 12], [2, 1, 14], [16, 19, 20, 22], [4, 9, 17], [11]]
Groups_mem_list  [[1881, 1805, 1514], [1929, 1853, 1418], [1544, 1351, 1159, 1144], [1921, 1685, 1591], [1901, 1785, 1508], [1415, 1326, 1281, 1148], [1966, 1779, 1370], [1683], [1683]]
G_BUCKET_ID_list length 8
backpack scheduling spend time (sec) 0.4598426818847656
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  9
current group_mem  5.201805527909279
current group_mem  5.202517399365936
current group_mem  5.199238820321183
current group_mem  5.198348641163134
current group_mem  5.195670640767341
current group_mem  5.1720456034144355
current group_mem  5.117142140628218
current group_mem  1.6838659180332751
batches output list generation spend  0.00036454200744628906
self.weights_list  [0.2364280137671677, 0.14245499829559824, 0.04841600598190035, 0.10753125652895834, 0.2564739776338505, 0.04535907896328389, 0.11898923477859272, 0.032867463520304376, 0.01147997053034385]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.007957935333251953
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.46036672592163086
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.7085082530975342
self.buckets_partition() spend  sec:  0.4683501720428467
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.1836080551147461  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.031026840209961  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.033613204956055  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.21897506713867188  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.343336582183838  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.34542989730835  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.20902538299560547  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.852861881256104  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.85351848602295  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.21778392791748047  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.26056432723999  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.262090682983398  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.22825384140014648  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.131988048553467  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.135467529296875  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.21744871139526367  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.79472303390503  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.79533863067627  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.22617387771606445  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.23928689956665  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.24095630645752  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.2129216194152832  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 5.664981842041016  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 5.665428161621094  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.19840145111083984  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 3.244293689727783  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 3.244450092315674  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.16698312759399414  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.767631769180298
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  9
G_BUCKET_ID_list [[6, 8, 0], [3, 7, 15], [13, 18, 23, 21], [5, 10, 12], [2, 1, 14], [16, 19, 20, 22], [4, 9, 17], [11]]
Groups_mem_list  [[1881, 1805, 1514], [1929, 1853, 1418], [1544, 1351, 1159, 1144], [1921, 1685, 1591], [1901, 1785, 1508], [1415, 1326, 1281, 1148], [1966, 1779, 1370], [1683], [1683]]
G_BUCKET_ID_list length 8
backpack scheduling spend time (sec) 0.42630672454833984
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  9
current group_mem  5.201805527909279
current group_mem  5.202517399365936
current group_mem  5.199238820321183
current group_mem  5.198348641163134
current group_mem  5.195670640767341
current group_mem  5.1720456034144355
current group_mem  5.117142140628218
current group_mem  1.6838659180332751
batches output list generation spend  0.0003559589385986328
self.weights_list  [0.2364280137671677, 0.14245499829559824, 0.04841600598190035, 0.10753125652895834, 0.2564739776338505, 0.04535907896328389, 0.11898923477859272, 0.032867463520304376, 0.01147997053034385]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009647369384765625
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.42682838439941406
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.6900148391723633
self.buckets_partition() spend  sec:  0.43649888038635254
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.18335294723510742  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.014925003051758  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.01751184463501  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.21897077560424805  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.338014602661133  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.340424060821533  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.2100811004638672  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.86036729812622  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.861023902893066  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.21770286560058594  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.261798858642578  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.263325214385986  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.22825193405151367  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.138878345489502  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.14235782623291  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.2172374725341797  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.806886196136475  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.807501792907715  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.22616004943847656  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.251686096191406  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.253353595733643  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.21292924880981445  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 5.656828880310059  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 5.657275199890137  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.19823694229125977  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 3.2441439628601074  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 3.244300365447998  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.16681289672851562  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.6733009815216064
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  9
G_BUCKET_ID_list [[6, 8, 0], [3, 7, 15], [13, 18, 23, 21], [5, 10, 12], [2, 1, 14], [16, 19, 20, 22], [4, 9, 17], [11]]
Groups_mem_list  [[1881, 1805, 1514], [1929, 1853, 1418], [1544, 1351, 1159, 1144], [1921, 1685, 1591], [1901, 1785, 1508], [1415, 1326, 1281, 1148], [1966, 1779, 1370], [1683], [1683]]
G_BUCKET_ID_list length 8
backpack scheduling spend time (sec) 0.4005897045135498
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  9
current group_mem  5.201805527909279
current group_mem  5.202517399365936
current group_mem  5.199238820321183
current group_mem  5.198348641163134
current group_mem  5.195670640767341
current group_mem  5.1720456034144355
current group_mem  5.117142140628218
current group_mem  1.6838659180332751
batches output list generation spend  0.0003654956817626953
self.weights_list  [0.2364280137671677, 0.14245499829559824, 0.04841600598190035, 0.10753125652895834, 0.2564739776338505, 0.04535907896328389, 0.11898923477859272, 0.032867463520304376, 0.01147997053034385]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009252548217773438
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.40108275413513184
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.6458864212036133
self.buckets_partition() spend  sec:  0.41036009788513184
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.18349695205688477  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.016655921936035  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.019243240356445  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.21898269653320312  GigaBytes
Max Memory Allocated: 10.83387565612793  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.359185218811035  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.361291408538818  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.20899009704589844  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.830578327178955  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.8312349319458  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.21787786483764648  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.269792556762695  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.271318912506104  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.2282543182373047  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.15018081665039  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.153660297393799  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.21730566024780273  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.805732250213623  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.806347846984863  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.22614717483520508  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.230964183807373  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.232620239257812  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.21265029907226562  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 5.656129837036133  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 5.656576156616211  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.19823026657104492  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 3.24837589263916  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 3.248532295227051  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.1667947769165039  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.6058242321014404
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  9
G_BUCKET_ID_list [[6, 8, 0], [3, 7, 15], [13, 18, 23, 21], [5, 10, 12], [2, 1, 14], [16, 19, 20, 22], [4, 9, 17], [11]]
Groups_mem_list  [[1881, 1805, 1514], [1929, 1853, 1418], [1544, 1351, 1159, 1144], [1921, 1685, 1591], [1901, 1785, 1508], [1415, 1326, 1281, 1148], [1966, 1779, 1370], [1683], [1683]]
G_BUCKET_ID_list length 8
backpack scheduling spend time (sec) 0.4327738285064697
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  9
current group_mem  5.201805527909279
current group_mem  5.202517399365936
current group_mem  5.199238820321183
current group_mem  5.198348641163134
current group_mem  5.195670640767341
current group_mem  5.1720456034144355
current group_mem  5.117142140628218
current group_mem  1.6838659180332751
batches output list generation spend  0.0004353523254394531
self.weights_list  [0.2364280137671677, 0.14245499829559824, 0.04841600598190035, 0.10753125652895834, 0.2564739776338505, 0.04535907896328389, 0.11898923477859272, 0.032867463520304376, 0.01147997053034385]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.007463932037353516
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4333529472351074
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.6905872821807861
self.buckets_partition() spend  sec:  0.4408445358276367
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.1836071014404297  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.028286457061768  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.030873775482178  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.21940040588378906  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.33866834640503  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.340667724609375  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.2105422019958496  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.848005771636963  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.848662376403809  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.21818113327026367  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.26792049407959  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.269446849822998  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.22868013381958008  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.150321960449219  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.153801441192627  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.2178053855895996  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.812440395355225  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.813055992126465  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.22661256790161133  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.229228019714355  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.230905532836914  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.21303558349609375  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 5.655284881591797  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 5.655731201171875  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.19849061965942383  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 3.237330436706543  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 3.2374868392944336  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.16663169860839844  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.558068037033081
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  9
G_BUCKET_ID_list [[6, 8, 0], [3, 7, 15], [13, 18, 23, 21], [5, 10, 12], [2, 1, 14], [16, 19, 20, 22], [4, 9, 17], [11]]
Groups_mem_list  [[1881, 1805, 1514], [1929, 1853, 1418], [1544, 1351, 1159, 1144], [1921, 1685, 1591], [1901, 1785, 1508], [1415, 1326, 1281, 1148], [1966, 1779, 1370], [1683], [1683]]
G_BUCKET_ID_list length 8
backpack scheduling spend time (sec) 0.27894091606140137
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  9
current group_mem  5.201805527909279
current group_mem  5.202517399365936
current group_mem  5.199238820321183
current group_mem  5.198348641163134
current group_mem  5.195670640767341
current group_mem  5.1720456034144355
current group_mem  5.117142140628218
current group_mem  1.6838659180332751
batches output list generation spend  0.0003647804260253906
self.weights_list  [0.2364280137671677, 0.14245499829559824, 0.04841600598190035, 0.10753125652895834, 0.2564739776338505, 0.04535907896328389, 0.11898923477859272, 0.032867463520304376, 0.01147997053034385]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.008315324783325195
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.27944254875183105
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.5253379344940186
self.buckets_partition() spend  sec:  0.2877812385559082
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.18341827392578125  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.011741638183594  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.014329433441162  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.21897554397583008  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.33958911895752  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.341702938079834  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.21011638641357422  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.843919277191162  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.844575881958008  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.21781682968139648  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.26833963394165  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.269865989685059  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.2282261848449707  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.142542362213135  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.146021842956543  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.21750688552856445  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.807908058166504  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.808523654937744  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.2260265350341797  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.226927757263184  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.228633403778076  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.2131972312927246  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 5.650782585144043  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 5.651228904724121  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.19820070266723633  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 3.252622604370117  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 3.252779006958008  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.166778564453125  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.474743127822876
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  9
G_BUCKET_ID_list [[6, 8, 0], [3, 7, 15], [13, 18, 23, 21], [5, 10, 12], [2, 1, 14], [16, 19, 20, 22], [4, 9, 17], [11]]
Groups_mem_list  [[1881, 1805, 1514], [1929, 1853, 1418], [1544, 1351, 1159, 1144], [1921, 1685, 1591], [1901, 1785, 1508], [1415, 1326, 1281, 1148], [1966, 1779, 1370], [1683], [1683]]
G_BUCKET_ID_list length 8
backpack scheduling spend time (sec) 0.43459606170654297
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  9
current group_mem  5.201805527909279
current group_mem  5.202517399365936
current group_mem  5.199238820321183
current group_mem  5.198348641163134
current group_mem  5.195670640767341
current group_mem  5.1720456034144355
current group_mem  5.117142140628218
current group_mem  1.6838659180332751
batches output list generation spend  0.0003631114959716797
self.weights_list  [0.2364280137671677, 0.14245499829559824, 0.04841600598190035, 0.10753125652895834, 0.2564739776338505, 0.04535907896328389, 0.11898923477859272, 0.032867463520304376, 0.01147997053034385]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0077059268951416016
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4351019859313965
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.694270133972168
self.buckets_partition() spend  sec:  0.4429643154144287
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.1836414337158203  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.025793552398682  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.028380393981934  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.2197866439819336  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.337884902954102  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.339866161346436  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.2089395523071289  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.845039367675781  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.845695972442627  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.21859073638916016  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.268386363983154  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.269912719726562  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.2290363311767578  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.150096893310547  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.153576374053955  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.21741819381713867  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.796975135803223  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.797590732574463  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.22702264785766602  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.253530502319336  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.255198001861572  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.21321439743041992  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 5.663237571716309  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 5.663683891296387  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.1981797218322754  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 3.245504379272461  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 3.2456607818603516  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.16675472259521484  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.3975741863250732
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  9
G_BUCKET_ID_list [[6, 8, 0], [3, 7, 15], [13, 18, 23, 21], [5, 10, 12], [2, 1, 14], [16, 19, 20, 22], [4, 9, 17], [11]]
Groups_mem_list  [[1881, 1805, 1514], [1929, 1853, 1418], [1544, 1351, 1159, 1144], [1921, 1685, 1591], [1901, 1785, 1508], [1415, 1326, 1281, 1148], [1966, 1779, 1370], [1683], [1683]]
G_BUCKET_ID_list length 8
backpack scheduling spend time (sec) 0.4459340572357178
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  9
current group_mem  5.201805527909279
current group_mem  5.202517399365936
current group_mem  5.199238820321183
current group_mem  5.198348641163134
current group_mem  5.195670640767341
current group_mem  5.1720456034144355
current group_mem  5.117142140628218
current group_mem  1.6838659180332751
batches output list generation spend  0.00035834312438964844
self.weights_list  [0.2364280137671677, 0.14245499829559824, 0.04841600598190035, 0.10753125652895834, 0.2564739776338505, 0.04535907896328389, 0.11898923477859272, 0.032867463520304376, 0.01147997053034385]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.008460044860839844
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.44649815559387207
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.6791782379150391
self.buckets_partition() spend  sec:  0.4549827575683594
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.18345403671264648  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.016763687133789  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.019320011138916  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.21894454956054688  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.341835021972656  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.343834400177002  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.20910072326660156  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.855113983154297  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.855770587921143  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.21773910522460938  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.26558256149292  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.267108917236328  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.22825241088867188  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.181616306304932  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.18509578704834  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.21722984313964844  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.795417785644531  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.796033382415771  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.22624874114990234  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.242587566375732  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.24427843093872  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.21284914016723633  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 5.65354061126709  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 5.653986930847168  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.19853782653808594  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 3.255890369415283  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 3.256046772003174  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.16711950302124023  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.3220341205596924
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  9
G_BUCKET_ID_list [[6, 8, 0], [3, 7, 15], [13, 18, 23, 21], [5, 10, 12], [2, 1, 14], [16, 19, 20, 22], [4, 9, 17], [11]]
Groups_mem_list  [[1881, 1805, 1514], [1929, 1853, 1418], [1544, 1351, 1159, 1144], [1921, 1685, 1591], [1901, 1785, 1508], [1415, 1326, 1281, 1148], [1966, 1779, 1370], [1683], [1683]]
G_BUCKET_ID_list length 8
backpack scheduling spend time (sec) 0.40313291549682617
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  9
current group_mem  5.201805527909279
current group_mem  5.202517399365936
current group_mem  5.199238820321183
current group_mem  5.198348641163134
current group_mem  5.195670640767341
current group_mem  5.1720456034144355
current group_mem  5.117142140628218
current group_mem  1.6838659180332751
batches output list generation spend  0.0004239082336425781
self.weights_list  [0.2364280137671677, 0.14245499829559824, 0.04841600598190035, 0.10753125652895834, 0.2564739776338505, 0.04535907896328389, 0.11898923477859272, 0.032867463520304376, 0.01147997053034385]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.008124113082885742
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4036858081817627
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.6637396812438965
self.buckets_partition() spend  sec:  0.4118351936340332
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.1835341453552246  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.018597602844238  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.021183967590332  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.21897363662719727  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.343210220336914  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.34520959854126  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.21012163162231445  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.867136001586914  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.86779260635376  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.21781206130981445  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.269270420074463  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.270796775817871  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.22825336456298828  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.1961989402771  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.199678421020508  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.21723270416259766  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.790285110473633  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.790900707244873  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.2260127067565918  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.230926036834717  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.232615947723389  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.21292686462402344  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 5.664125919342041  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 5.664572238922119  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.19842910766601562  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 3.2506957054138184  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 3.250852108001709  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.1670060157775879  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.2490074634552
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  9
G_BUCKET_ID_list [[6, 8, 0], [3, 7, 15], [13, 18, 23, 21], [5, 10, 12], [2, 1, 14], [16, 19, 20, 22], [4, 9, 17], [11]]
Groups_mem_list  [[1881, 1805, 1514], [1929, 1853, 1418], [1544, 1351, 1159, 1144], [1921, 1685, 1591], [1901, 1785, 1508], [1415, 1326, 1281, 1148], [1966, 1779, 1370], [1683], [1683]]
G_BUCKET_ID_list length 8
backpack scheduling spend time (sec) 0.45578837394714355
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  9
current group_mem  5.201805527909279
current group_mem  5.202517399365936
current group_mem  5.199238820321183
current group_mem  5.198348641163134
current group_mem  5.195670640767341
current group_mem  5.1720456034144355
current group_mem  5.117142140628218
current group_mem  1.6838659180332751
batches output list generation spend  0.00041031837463378906
self.weights_list  [0.2364280137671677, 0.14245499829559824, 0.04841600598190035, 0.10753125652895834, 0.2564739776338505, 0.04535907896328389, 0.11898923477859272, 0.032867463520304376, 0.01147997053034385]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.008093833923339844
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.45635461807250977
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.7171540260314941
self.buckets_partition() spend  sec:  0.4644756317138672
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.18351411819458008  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.024327278137207  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.026914119720459  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.218963623046875  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.316773891448975  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.318814754486084  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.21010065078735352  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.849705219268799  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.850361824035645  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.21789121627807617  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.278320789337158  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.279847145080566  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.22825193405151367  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.187615871429443  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.191095352172852  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.21758270263671875  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.829036235809326  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.829651832580566  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.22620534896850586  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.236353874206543  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.23802137374878  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.2127695083618164  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 5.651364326477051  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 5.651810646057129  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.19886207580566406  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 3.258862018585205  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 3.2590184211730957  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.1674637794494629  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.195093870162964
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  9
G_BUCKET_ID_list [[6, 8, 0], [3, 7, 15], [13, 18, 23, 21], [5, 10, 12], [2, 1, 14], [16, 19, 20, 22], [4, 9, 17], [11]]
Groups_mem_list  [[1881, 1805, 1514], [1929, 1853, 1418], [1544, 1351, 1159, 1144], [1921, 1685, 1591], [1901, 1785, 1508], [1415, 1326, 1281, 1148], [1966, 1779, 1370], [1683], [1683]]
G_BUCKET_ID_list length 8
backpack scheduling spend time (sec) 0.286144495010376
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  9
current group_mem  5.201805527909279
current group_mem  5.202517399365936
current group_mem  5.199238820321183
current group_mem  5.198348641163134
current group_mem  5.195670640767341
current group_mem  5.1720456034144355
current group_mem  5.117142140628218
current group_mem  1.6838659180332751
batches output list generation spend  0.00038933753967285156
self.weights_list  [0.2364280137671677, 0.14245499829559824, 0.04841600598190035, 0.10753125652895834, 0.2564739776338505, 0.04535907896328389, 0.11898923477859272, 0.032867463520304376, 0.01147997053034385]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.008883476257324219
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.28673672676086426
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.5481371879577637
self.buckets_partition() spend  sec:  0.29564833641052246
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.18344354629516602  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.02663278579712  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.029218196868896  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.2189793586730957  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.352272510528564  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.35438060760498  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.2090587615966797  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.847537994384766  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.848194599151611  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.21763324737548828  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.241868019104004  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.243394374847412  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.22825336456298828  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.140493869781494  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.143973350524902  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.21723031997680664  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.801067352294922  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.801682949066162  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.22599172592163086  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.228858947753906  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.230539798736572  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.21291065216064453  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 5.655649662017822  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 5.6560959815979  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.19838523864746094  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 3.253699779510498  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 3.2538561820983887  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.16698217391967773  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.1465868949890137
the output layer 
self.num_batch (get_in_degree_bucketing) 9
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  9
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  9
G_BUCKET_ID_list [[6, 8, 0], [3, 7, 15], [13, 18, 23, 21], [5, 10, 12], [2, 1, 14], [16, 19, 20, 22], [4, 9, 17], [11]]
Groups_mem_list  [[1881, 1805, 1514], [1929, 1853, 1418], [1544, 1351, 1159, 1144], [1921, 1685, 1591], [1901, 1785, 1508], [1415, 1326, 1281, 1148], [1966, 1779, 1370], [1683], [1683]]
G_BUCKET_ID_list length 8
backpack scheduling spend time (sec) 0.5427429676055908
len(g_bucket_nids_list)  8
len(local_split_batches_nid_list)  9
current group_mem  5.201805527909279
current group_mem  5.202517399365936
current group_mem  5.199238820321183
current group_mem  5.198348641163134
current group_mem  5.195670640767341
current group_mem  5.1720456034144355
current group_mem  5.117142140628218
current group_mem  1.6838659180332751
batches output list generation spend  0.00041747093200683594
self.weights_list  [0.2364280137671677, 0.14245499829559824, 0.04841600598190035, 0.10753125652895834, 0.2564739776338505, 0.04535907896328389, 0.11898923477859272, 0.032867463520304376, 0.01147997053034385]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009078025817871094
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.543360710144043
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.7835249900817871
self.buckets_partition() spend  sec:  0.5524680614471436
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.18344879150390625  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.01506757736206  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.017653942108154  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.21940279006958008  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.347354412078857  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.349353790283203  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.21053504943847656  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.84114933013916  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.841805934906006  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.21811389923095703  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.256974220275879  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.258496761322021  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.22861385345458984  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.183876514434814  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.187355995178223  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.21788692474365234  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.814311027526855  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 8.814926624298096  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.22655248641967773  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.235725402832031  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 10.237341403961182  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.2132568359375  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 5.657485008239746  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 5.657931327819824  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.19886493682861328  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 3.2477002143859863  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 3.247856616973877  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 16.23193359375 GB
    Memory Allocated: 0.1670222282409668  GigaBytes
Max Memory Allocated: 10.846392154693604  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.086481809616089
epoch_time_list  [8.311884880065918, 5.709680795669556, 5.705402135848999, 5.550538063049316, 5.752485513687134, 5.734612941741943, 5.744118690490723, 5.668501138687134, 5.6047234535217285, 5.711313486099243, 5.752613067626953, 5.637919187545776, 5.578821420669556, 5.639829635620117, 5.601329565048218, 5.734424352645874, 5.694909334182739, 5.850304126739502, 5.7763307094573975, 6.2165141105651855]

loading_time list   [0.0245211124420166, 0.06436586380004883, 0.034796714782714844, 0.02546381950378418, 0.04141736030578613, 0.043756723403930664, 0.030634164810180664, 0.02899456024169922, 0.02976846694946289, 0.04260444641113281, 0.033806800842285156, 0.03313851356506348, 0.024784326553344727, 0.02690267562866211, 0.042908430099487305, 0.02907085418701172, 0.02426910400390625, 0.03638887405395508, 0.04320859909057617, 0.04745912551879883]

 data loader gen time  [1.576467514038086, 1.5544521808624268, 1.5728025436401367, 1.4092981815338135, 1.5909779071807861, 1.5769689083099365, 1.5871663093566895, 1.5171089172363281, 1.4307913780212402, 1.5371875762939453, 1.5882830619812012, 1.473257303237915, 1.4135870933532715, 1.4229955673217773, 1.4279558658599854, 1.5668768882751465, 1.5146236419677734, 1.6298589706420898, 1.5150039196014404, 1.9558517932891846]
	---backpack schedule time  [0.7170498371124268, 0.6568987369537354, 0.6994607448577881, 0.5513966083526611, 0.6913671493530273, 0.7009427547454834, 0.714357852935791, 0.6859238147735596, 0.5481991767883301, 0.7207009792327881, 0.6996915340423584, 0.6548690795898438, 0.7007308006286621, 0.5355949401855469, 0.7050986289978027, 0.6906089782714844, 0.6735742092132568, 0.7276372909545898, 0.5601587295532227, 0.8078939914703369]
	---connection_check_time_list  [0.44905591011047363, 0.4749751091003418, 0.4511728286743164, 0.46991682052612305, 0.44956159591674805, 0.4723796844482422, 0.4570484161376953, 0.48523545265197754, 0.4755973815917969, 0.4555544853210449, 0.4772486686706543, 0.4484217166900635, 0.4518604278564453, 0.46859121322631836, 0.4532797336578369, 0.47029566764831543, 0.4610929489135742, 0.46619176864624023, 0.4866065979003906, 0.6427013874053955]
	---block_gen_time_list  [0.3524932861328125, 0.3660135269165039, 0.36316752433776855, 0.32865357398986816, 0.38994789123535156, 0.34892821311950684, 0.35753965377807617, 0.28562188148498535, 0.34811949729919434, 0.30201172828674316, 0.35073256492614746, 0.3100287914276123, 0.20236778259277344, 0.35792016983032227, 0.2109079360961914, 0.347212553024292, 0.31949567794799805, 0.37668585777282715, 0.4027223587036133, 0.42526793479919434]
training time  [6.7108893394470215, 4.088057279586792, 4.094649791717529, 4.112119913101196, 4.1166770458221436, 4.110198736190796, 4.1229143142700195, 4.118821382522583, 4.14069128036499, 4.128020524978638, 4.126852035522461, 4.128041505813599, 4.1369171142578125, 4.186276912689209, 4.126879453659058, 4.134661436080933, 4.152470827102661, 4.18016242980957, 4.213834285736084, 4.2056920528411865]
---feature block loading time  [1.507307767868042, 1.7154607772827148, 1.716949462890625, 1.7321319580078125, 1.734128475189209, 1.722606897354126, 1.734565019607544, 1.7320001125335693, 1.7470548152923584, 1.7307684421539307, 1.7318754196166992, 1.730423927307129, 1.7380657196044922, 1.7866289615631104, 1.720383644104004, 1.7318055629730225, 1.7442536354064941, 1.7559680938720703, 1.776190996170044, 1.777510404586792]


epoch_time avg   5.7311719208955765
loading_time avg   0.0349445641040802
 data loader gen time avg 1.5467809438705444
	---backpack schedule time avg 0.6760843694210052
	---connection_check_time avg  0.4763541966676712
	---block_gen_time avg  0.3334694057703018
training time  4.145569458603859
---feature block loading time  1.7433893829584122
pure train time per /epoch  [5.194620609283447, 2.2530324459075928, 2.261101007461548, 2.26853084564209, 2.2711524963378906, 2.273916721343994, 2.278799295425415, 2.276310443878174, 2.2750329971313477, 2.2878313064575195, 2.280125856399536, 2.2839670181274414, 2.2885866165161133, 2.2909560203552246, 2.2972054481506348, 2.2911174297332764, 2.287224531173706, 2.3093535900115967, 2.316523313522339, 2.3166706562042236]
pure train time average  2.2878414462594425
