main start at this time 1733010078.9503467
-----------------------------------------before load data 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

the output layer 
self.num_batch (get_in_degree_bucketing) 11
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  11
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  11
G_BUCKET_ID_list [[2, 18, 22], [3, 19, 21], [0, 14, 17], [10, 13, 23], [11, 15, 20], [4, 5], [6, 7], [8, 1], [9, 12], [16]]
Groups_mem_list  [[1901, 1351, 1148], [1929, 1326, 1144], [1514, 1508, 1370], [1685, 1544, 1159], [1683, 1418, 1281], [1966, 1921], [1881, 1853], [1805, 1785], [1779, 1591], [1415], [1415]]
G_BUCKET_ID_list length 10
backpack scheduling spend time (sec) 0.4240896701812744
len(g_bucket_nids_list)  10
len(local_split_batches_nid_list)  11
current group_mem  4.401058628969324
current group_mem  4.401045342543889
current group_mem  4.394056033808697
current group_mem  4.388640456757343
current group_mem  4.383718256965125
current group_mem  3.8889049852154267
current group_mem  3.735089760738637
current group_mem  3.591795788981745
current group_mem  3.3706524621427407
current group_mem  1.4156729754798756
batches output list generation spend  0.0007565021514892578
self.weights_list  [0.12636764495662023, 0.10493616740524075, 0.18171121936200393, 0.05522261686148162, 0.050857149140651634, 0.13140387723908908, 0.09211466775161918, 0.17090201339329894, 0.05624525791447202, 0.02078270527045007, 0.00945668070507252]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.00795435905456543
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4250965118408203
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.7366514205932617
self.buckets_partition() spend  sec:  0.43307948112487793
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 0.63232421875 GB
    Memory Allocated: 0.0943136215209961  GigaBytes
Max Memory Allocated: 0.0943136215209961  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.44287109375 GB
    Memory Allocated: 8.276259422302246  GigaBytes
Max Memory Allocated: 8.65749740600586  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 9.44287109375 GB
    Memory Allocated: 8.277973175048828  GigaBytes
Max Memory Allocated: 8.65749740600586  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 9.74560546875 GB
    Memory Allocated: 0.1456599235534668  GigaBytes
Max Memory Allocated: 8.65749740600586  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.05224609375 GB
    Memory Allocated: 8.376832962036133  GigaBytes
Max Memory Allocated: 8.753780364990234  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.05224609375 GB
    Memory Allocated: 8.378546237945557  GigaBytes
Max Memory Allocated: 8.753780364990234  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.35498046875 GB
    Memory Allocated: 0.14980602264404297  GigaBytes
Max Memory Allocated: 8.753780364990234  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.38427734375 GB
    Memory Allocated: 7.834377765655518  GigaBytes
Max Memory Allocated: 8.753780364990234  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.38427734375 GB
    Memory Allocated: 7.83699893951416  GigaBytes
Max Memory Allocated: 8.753780364990234  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.38427734375 GB
    Memory Allocated: 0.14402389526367188  GigaBytes
Max Memory Allocated: 8.753780364990234  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.46630859375 GB
    Memory Allocated: 8.081591129302979  GigaBytes
Max Memory Allocated: 8.753780364990234  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.46630859375 GB
    Memory Allocated: 8.082340240478516  GigaBytes
Max Memory Allocated: 8.753780364990234  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.76708984375 GB
    Memory Allocated: 0.14396238327026367  GigaBytes
Max Memory Allocated: 8.753780364990234  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.76708984375 GB
    Memory Allocated: 7.999952793121338  GigaBytes
Max Memory Allocated: 8.753780364990234  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 10.76708984375 GB
    Memory Allocated: 8.000642776489258  GigaBytes
Max Memory Allocated: 8.753780364990234  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 10.76708984375 GB
    Memory Allocated: 0.1532764434814453  GigaBytes
Max Memory Allocated: 8.753780364990234  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.50341796875 GB
    Memory Allocated: 8.592971801757812  GigaBytes
Max Memory Allocated: 8.996767520904541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.50341796875 GB
    Memory Allocated: 8.59486436843872  GigaBytes
Max Memory Allocated: 8.996767520904541  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.81591796875 GB
    Memory Allocated: 0.15419483184814453  GigaBytes
Max Memory Allocated: 8.996767520904541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.81591796875 GB
    Memory Allocated: 8.259202003479004  GigaBytes
Max Memory Allocated: 8.996767520904541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.81591796875 GB
    Memory Allocated: 8.260533332824707  GigaBytes
Max Memory Allocated: 8.996767520904541  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.81591796875 GB
    Memory Allocated: 0.1595134735107422  GigaBytes
Max Memory Allocated: 8.996767520904541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.81591796875 GB
    Memory Allocated: 7.852123737335205  GigaBytes
Max Memory Allocated: 8.996767520904541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.81591796875 GB
    Memory Allocated: 7.854443550109863  GigaBytes
Max Memory Allocated: 8.996767520904541  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.81591796875 GB
    Memory Allocated: 0.153228759765625  GigaBytes
Max Memory Allocated: 8.996767520904541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.82958984375 GB
    Memory Allocated: 7.386667251586914  GigaBytes
Max Memory Allocated: 8.996767520904541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.82958984375 GB
    Memory Allocated: 7.387430191040039  GigaBytes
Max Memory Allocated: 8.996767520904541  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.82958984375 GB
    Memory Allocated: 0.14047479629516602  GigaBytes
Max Memory Allocated: 8.996767520904541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.84716796875 GB
    Memory Allocated: 4.577049255371094  GigaBytes
Max Memory Allocated: 8.996767520904541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.84716796875 GB
    Memory Allocated: 4.57733154296875  GigaBytes
Max Memory Allocated: 8.996767520904541  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.84716796875 GB
    Memory Allocated: 0.12961196899414062  GigaBytes
Max Memory Allocated: 8.996767520904541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.88037109375 GB
    Memory Allocated: 2.7340784072875977  GigaBytes
Max Memory Allocated: 8.996767520904541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.88037109375 GB
    Memory Allocated: 2.7342071533203125  GigaBytes
Max Memory Allocated: 8.996767520904541  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 11.88037109375 GB
    Memory Allocated: 0.16414785385131836  GigaBytes
Max Memory Allocated: 8.996767520904541  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.7763075828552246
the output layer 
self.num_batch (get_in_degree_bucketing) 11
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  11
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  11
G_BUCKET_ID_list [[2, 18, 22], [3, 19, 21], [0, 14, 17], [10, 13, 23], [11, 15, 20], [4, 5], [6, 7], [8, 1], [9, 12], [16]]
Groups_mem_list  [[1901, 1351, 1148], [1929, 1326, 1144], [1514, 1508, 1370], [1685, 1544, 1159], [1683, 1418, 1281], [1966, 1921], [1881, 1853], [1805, 1785], [1779, 1591], [1415], [1415]]
G_BUCKET_ID_list length 10
backpack scheduling spend time (sec) 0.39538121223449707
len(g_bucket_nids_list)  10
len(local_split_batches_nid_list)  11
current group_mem  4.401058628969324
current group_mem  4.401045342543889
current group_mem  4.394056033808697
current group_mem  4.388640456757343
current group_mem  4.383718256965125
current group_mem  3.8889049852154267
current group_mem  3.735089760738637
current group_mem  3.591795788981745
current group_mem  3.3706524621427407
current group_mem  1.4156729754798756
batches output list generation spend  0.0003457069396972656
self.weights_list  [0.12636764495662023, 0.10493616740524075, 0.18171121936200393, 0.05522261686148162, 0.050857149140651634, 0.13140387723908908, 0.09211466775161918, 0.17090201339329894, 0.05624525791447202, 0.02078270527045007, 0.00945668070507252]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.008917570114135742
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.39587974548339844
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.7104589939117432
self.buckets_partition() spend  sec:  0.40482330322265625
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.88037109375 GB
    Memory Allocated: 0.17705965042114258  GigaBytes
Max Memory Allocated: 8.996767520904541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.88037109375 GB
    Memory Allocated: 8.326796054840088  GigaBytes
Max Memory Allocated: 8.996767520904541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.88037109375 GB
    Memory Allocated: 8.32796049118042  GigaBytes
Max Memory Allocated: 8.996767520904541  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.88037109375 GB
    Memory Allocated: 0.2118539810180664  GigaBytes
Max Memory Allocated: 8.996767520904541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 8.454496383666992  GigaBytes
Max Memory Allocated: 8.996767520904541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 11.99365234375 GB
    Memory Allocated: 8.456209659576416  GigaBytes
Max Memory Allocated: 8.996767520904541  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 0.21626710891723633  GigaBytes
Max Memory Allocated: 8.996767520904541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 7.9239301681518555  GigaBytes
Max Memory Allocated: 8.996767520904541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 7.926551342010498  GigaBytes
Max Memory Allocated: 8.996767520904541  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 0.21038484573364258  GigaBytes
Max Memory Allocated: 8.996767520904541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 8.164234638214111  GigaBytes
Max Memory Allocated: 8.996767520904541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 8.164983749389648  GigaBytes
Max Memory Allocated: 8.996767520904541  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 0.21029233932495117  GigaBytes
Max Memory Allocated: 8.996767520904541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 8.099231243133545  GigaBytes
Max Memory Allocated: 8.996767520904541  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 8.099921226501465  GigaBytes
Max Memory Allocated: 8.996767520904541  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 0.21957159042358398  GigaBytes
Max Memory Allocated: 8.996767520904541  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 8.678229331970215  GigaBytes
Max Memory Allocated: 9.082197666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 8.680121898651123  GigaBytes
Max Memory Allocated: 9.082197666168213  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 0.22071313858032227  GigaBytes
Max Memory Allocated: 9.082197666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 8.305669784545898  GigaBytes
Max Memory Allocated: 9.082197666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 8.306997776031494  GigaBytes
Max Memory Allocated: 9.082197666168213  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 0.22562456130981445  GigaBytes
Max Memory Allocated: 9.082197666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 7.9247283935546875  GigaBytes
Max Memory Allocated: 9.082197666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 7.927048206329346  GigaBytes
Max Memory Allocated: 9.082197666168213  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 0.21949529647827148  GigaBytes
Max Memory Allocated: 9.082197666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 7.449188232421875  GigaBytes
Max Memory Allocated: 9.082197666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 7.449951171875  GigaBytes
Max Memory Allocated: 9.082197666168213  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 0.20617008209228516  GigaBytes
Max Memory Allocated: 9.082197666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 4.610551834106445  GigaBytes
Max Memory Allocated: 9.082197666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 4.610834121704102  GigaBytes
Max Memory Allocated: 9.082197666168213  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 0.1958022117614746  GigaBytes
Max Memory Allocated: 9.082197666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 2.8127012252807617  GigaBytes
Max Memory Allocated: 9.082197666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 2.8128299713134766  GigaBytes
Max Memory Allocated: 9.082197666168213  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 0.16423988342285156  GigaBytes
Max Memory Allocated: 9.082197666168213  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.1910531520843506
the output layer 
self.num_batch (get_in_degree_bucketing) 11
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  11
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  11
G_BUCKET_ID_list [[2, 18, 22], [3, 19, 21], [0, 14, 17], [10, 13, 23], [11, 15, 20], [4, 5], [6, 7], [8, 1], [9, 12], [16]]
Groups_mem_list  [[1901, 1351, 1148], [1929, 1326, 1144], [1514, 1508, 1370], [1685, 1544, 1159], [1683, 1418, 1281], [1966, 1921], [1881, 1853], [1805, 1785], [1779, 1591], [1415], [1415]]
G_BUCKET_ID_list length 10
backpack scheduling spend time (sec) 0.4197349548339844
len(g_bucket_nids_list)  10
len(local_split_batches_nid_list)  11
current group_mem  4.401058628969324
current group_mem  4.401045342543889
current group_mem  4.394056033808697
current group_mem  4.388640456757343
current group_mem  4.383718256965125
current group_mem  3.8889049852154267
current group_mem  3.735089760738637
current group_mem  3.591795788981745
current group_mem  3.3706524621427407
current group_mem  1.4156729754798756
batches output list generation spend  0.00039267539978027344
self.weights_list  [0.12636764495662023, 0.10493616740524075, 0.18171121936200393, 0.05522261686148162, 0.050857149140651634, 0.13140387723908908, 0.09211466775161918, 0.17090201339329894, 0.05624525791447202, 0.02078270527045007, 0.00945668070507252]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0076029300689697266
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.420299768447876
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.7404868602752686
self.buckets_partition() spend  sec:  0.42794346809387207
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 0.1770634651184082  GigaBytes
Max Memory Allocated: 9.082197666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 8.327090740203857  GigaBytes
Max Memory Allocated: 9.082197666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 8.328254699707031  GigaBytes
Max Memory Allocated: 9.082197666168213  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 0.21175527572631836  GigaBytes
Max Memory Allocated: 9.082197666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 8.455509662628174  GigaBytes
Max Memory Allocated: 9.082197666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 8.457097053527832  GigaBytes
Max Memory Allocated: 9.082197666168213  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 0.21606206893920898  GigaBytes
Max Memory Allocated: 9.082197666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 7.915342807769775  GigaBytes
Max Memory Allocated: 9.082197666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 7.917963981628418  GigaBytes
Max Memory Allocated: 9.082197666168213  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 0.2103738784790039  GigaBytes
Max Memory Allocated: 9.082197666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 8.159243106842041  GigaBytes
Max Memory Allocated: 9.082197666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 8.159992218017578  GigaBytes
Max Memory Allocated: 9.082197666168213  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 0.21020889282226562  GigaBytes
Max Memory Allocated: 9.082197666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 8.074918270111084  GigaBytes
Max Memory Allocated: 9.082197666168213  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 8.075608253479004  GigaBytes
Max Memory Allocated: 9.082197666168213  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 0.2196183204650879  GigaBytes
Max Memory Allocated: 9.082197666168213  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 8.685922145843506  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 8.687814712524414  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 0.220306396484375  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 8.3027663230896  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 8.304237365722656  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 0.22573614120483398  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 7.923512935638428  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 7.925832748413086  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 0.21951055526733398  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 7.47516393661499  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 7.475926876068115  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 0.2062549591064453  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 4.615523815155029  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 4.6158061027526855  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.29638671875 GB
    Memory Allocated: 0.19582796096801758  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.31982421875 GB
    Memory Allocated: 2.805825710296631  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.31982421875 GB
    Memory Allocated: 2.8059544563293457  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 12.31982421875 GB
    Memory Allocated: 0.1642599105834961  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.6052510738372803
the output layer 
self.num_batch (get_in_degree_bucketing) 11
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  11
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  11
G_BUCKET_ID_list [[2, 18, 22], [3, 19, 21], [0, 14, 17], [10, 13, 23], [11, 15, 20], [4, 5], [6, 7], [8, 1], [9, 12], [16]]
Groups_mem_list  [[1901, 1351, 1148], [1929, 1326, 1144], [1514, 1508, 1370], [1685, 1544, 1159], [1683, 1418, 1281], [1966, 1921], [1881, 1853], [1805, 1785], [1779, 1591], [1415], [1415]]
G_BUCKET_ID_list length 10
backpack scheduling spend time (sec) 0.2639436721801758
len(g_bucket_nids_list)  10
len(local_split_batches_nid_list)  11
current group_mem  4.401058628969324
current group_mem  4.401045342543889
current group_mem  4.394056033808697
current group_mem  4.388640456757343
current group_mem  4.383718256965125
current group_mem  3.8889049852154267
current group_mem  3.735089760738637
current group_mem  3.591795788981745
current group_mem  3.3706524621427407
current group_mem  1.4156729754798756
batches output list generation spend  0.00038361549377441406
self.weights_list  [0.12636764495662023, 0.10493616740524075, 0.18171121936200393, 0.05522261686148162, 0.050857149140651634, 0.13140387723908908, 0.09211466775161918, 0.17090201339329894, 0.05624525791447202, 0.02078270527045007, 0.00945668070507252]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.00980687141418457
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.26451683044433594
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.5797591209411621
self.buckets_partition() spend  sec:  0.27434849739074707
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.31982421875 GB
    Memory Allocated: 0.17697763442993164  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.31982421875 GB
    Memory Allocated: 8.310805320739746  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.31982421875 GB
    Memory Allocated: 8.311969757080078  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.31982421875 GB
    Memory Allocated: 0.21187925338745117  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.31982421875 GB
    Memory Allocated: 8.458513736724854  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.31982421875 GB
    Memory Allocated: 8.459994316101074  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.31982421875 GB
    Memory Allocated: 0.2159280776977539  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.31982421875 GB
    Memory Allocated: 7.909830570220947  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.31982421875 GB
    Memory Allocated: 7.912531852722168  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.31982421875 GB
    Memory Allocated: 0.21037960052490234  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.31982421875 GB
    Memory Allocated: 8.15934705734253  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.31982421875 GB
    Memory Allocated: 8.160096168518066  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.31982421875 GB
    Memory Allocated: 0.2102513313293457  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.31982421875 GB
    Memory Allocated: 8.095953941345215  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.31982421875 GB
    Memory Allocated: 8.096643924713135  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.31982421875 GB
    Memory Allocated: 0.21947813034057617  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.31982421875 GB
    Memory Allocated: 8.659123420715332  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.31982421875 GB
    Memory Allocated: 8.66101598739624  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.31982421875 GB
    Memory Allocated: 0.22010517120361328  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.31982421875 GB
    Memory Allocated: 8.262285232543945  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.31982421875 GB
    Memory Allocated: 8.263613224029541  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.31982421875 GB
    Memory Allocated: 0.22562360763549805  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.31982421875 GB
    Memory Allocated: 7.916139125823975  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.31982421875 GB
    Memory Allocated: 7.918458938598633  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.31982421875 GB
    Memory Allocated: 0.21926164627075195  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.31982421875 GB
    Memory Allocated: 7.463396072387695  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.31982421875 GB
    Memory Allocated: 7.46415901184082  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.31982421875 GB
    Memory Allocated: 0.20624065399169922  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.31982421875 GB
    Memory Allocated: 4.61593770980835  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.31982421875 GB
    Memory Allocated: 4.616219997406006  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.31982421875 GB
    Memory Allocated: 0.19539976119995117  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 2.799513339996338  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 2.7996420860290527  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.16382884979248047  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.081780433654785
the output layer 
self.num_batch (get_in_degree_bucketing) 11
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  11
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  11
G_BUCKET_ID_list [[2, 18, 22], [3, 19, 21], [0, 14, 17], [10, 13, 23], [11, 15, 20], [4, 5], [6, 7], [8, 1], [9, 12], [16]]
Groups_mem_list  [[1901, 1351, 1148], [1929, 1326, 1144], [1514, 1508, 1370], [1685, 1544, 1159], [1683, 1418, 1281], [1966, 1921], [1881, 1853], [1805, 1785], [1779, 1591], [1415], [1415]]
G_BUCKET_ID_list length 10
backpack scheduling spend time (sec) 0.4394099712371826
len(g_bucket_nids_list)  10
len(local_split_batches_nid_list)  11
current group_mem  4.401058628969324
current group_mem  4.401045342543889
current group_mem  4.394056033808697
current group_mem  4.388640456757343
current group_mem  4.383718256965125
current group_mem  3.8889049852154267
current group_mem  3.735089760738637
current group_mem  3.591795788981745
current group_mem  3.3706524621427407
current group_mem  1.4156729754798756
batches output list generation spend  0.0003750324249267578
self.weights_list  [0.12636764495662023, 0.10493616740524075, 0.18171121936200393, 0.05522261686148162, 0.050857149140651634, 0.13140387723908908, 0.09211466775161918, 0.17090201339329894, 0.05624525791447202, 0.02078270527045007, 0.00945668070507252]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.008727312088012695
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4400293827056885
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.7521889209747314
self.buckets_partition() spend  sec:  0.448779821395874
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.17702054977416992  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.30950403213501  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.310668468475342  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.2116856575012207  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.452873229980469  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.454586505889893  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.21595430374145508  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 7.908811569213867  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 7.911383152008057  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.21034002304077148  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.165414810180664  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.166163921356201  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.21015167236328125  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.077975749969482  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.078665733337402  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.21991872787475586  GigaBytes
Max Memory Allocated: 9.089717864990234  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.69578504562378  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.697677612304688  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.2203068733215332  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.306208610534668  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.307672023773193  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.22562551498413086  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 7.918251037597656  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 7.9205708503723145  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.21941089630126953  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 7.450710773468018  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 7.451473712921143  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.20644521713256836  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 4.626490592956543  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 4.626772880554199  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.19575262069702148  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 2.804561138153076  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 2.804689884185791  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.16418743133544922  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0685677528381348
the output layer 
self.num_batch (get_in_degree_bucketing) 11
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  11
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  11
G_BUCKET_ID_list [[2, 18, 22], [3, 19, 21], [0, 14, 17], [10, 13, 23], [11, 15, 20], [4, 5], [6, 7], [8, 1], [9, 12], [16]]
Groups_mem_list  [[1901, 1351, 1148], [1929, 1326, 1144], [1514, 1508, 1370], [1685, 1544, 1159], [1683, 1418, 1281], [1966, 1921], [1881, 1853], [1805, 1785], [1779, 1591], [1415], [1415]]
G_BUCKET_ID_list length 10
backpack scheduling spend time (sec) 0.4237632751464844
len(g_bucket_nids_list)  10
len(local_split_batches_nid_list)  11
current group_mem  4.401058628969324
current group_mem  4.401045342543889
current group_mem  4.394056033808697
current group_mem  4.388640456757343
current group_mem  4.383718256965125
current group_mem  3.8889049852154267
current group_mem  3.735089760738637
current group_mem  3.591795788981745
current group_mem  3.3706524621427407
current group_mem  1.4156729754798756
batches output list generation spend  0.0003688335418701172
self.weights_list  [0.12636764495662023, 0.10493616740524075, 0.18171121936200393, 0.05522261686148162, 0.050857149140651634, 0.13140387723908908, 0.09211466775161918, 0.17090201339329894, 0.05624525791447202, 0.02078270527045007, 0.00945668070507252]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.008282661437988281
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.42429184913635254
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.7374465465545654
self.buckets_partition() spend  sec:  0.4325978755950928
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.17702531814575195  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.325400352478027  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.32656478881836  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.21178674697875977  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.450781345367432  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.452330112457275  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.21595430374145508  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 7.8845906257629395  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 7.88729190826416  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.21039056777954102  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.15968370437622  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.160432815551758  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.21007156372070312  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.077946662902832  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.078636646270752  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.21955299377441406  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.66224479675293  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.664137363433838  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.22030401229858398  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.305697917938232  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.307025909423828  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.22562217712402344  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 7.921111106872559  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 7.923430919647217  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.21940040588378906  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 7.43987512588501  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 7.440638065338135  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.20653629302978516  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 4.6326212882995605  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 4.632903575897217  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.19496870040893555  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 2.7768187522888184  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 2.776947498321533  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.1633768081665039  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.066418170928955
the output layer 
self.num_batch (get_in_degree_bucketing) 11
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  11
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  11
G_BUCKET_ID_list [[2, 18, 22], [3, 19, 21], [0, 14, 17], [10, 13, 23], [11, 15, 20], [4, 5], [6, 7], [8, 1], [9, 12], [16]]
Groups_mem_list  [[1901, 1351, 1148], [1929, 1326, 1144], [1514, 1508, 1370], [1685, 1544, 1159], [1683, 1418, 1281], [1966, 1921], [1881, 1853], [1805, 1785], [1779, 1591], [1415], [1415]]
G_BUCKET_ID_list length 10
backpack scheduling spend time (sec) 0.40242886543273926
len(g_bucket_nids_list)  10
len(local_split_batches_nid_list)  11
current group_mem  4.401058628969324
current group_mem  4.401045342543889
current group_mem  4.394056033808697
current group_mem  4.388640456757343
current group_mem  4.383718256965125
current group_mem  3.8889049852154267
current group_mem  3.735089760738637
current group_mem  3.591795788981745
current group_mem  3.3706524621427407
current group_mem  1.4156729754798756
batches output list generation spend  0.00038814544677734375
self.weights_list  [0.12636764495662023, 0.10493616740524075, 0.18171121936200393, 0.05522261686148162, 0.050857149140651634, 0.13140387723908908, 0.09211466775161918, 0.17090201339329894, 0.05624525791447202, 0.02078270527045007, 0.00945668070507252]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.010702848434448242
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.40299010276794434
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.7197082042694092
self.buckets_partition() spend  sec:  0.41371631622314453
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.1769390106201172  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.321769714355469  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.322935581207275  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.21164655685424805  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.455925941467285  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.457406520843506  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.2159423828125  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 7.899819374084473  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 7.902440547943115  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.21052074432373047  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.165389060974121  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.166138172149658  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.2100977897644043  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.093395233154297  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.094085216522217  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.21953248977661133  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.666795253753662  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.66868782043457  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.2201991081237793  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.305590152740479  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.306918144226074  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.22562551498413086  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 7.923402309417725  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 7.925722122192383  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.21928882598876953  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 7.466017246246338  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 7.466780185699463  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.20641469955444336  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 4.634425163269043  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 4.634707450866699  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.19538068771362305  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 2.790703296661377  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 2.790832042694092  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.16379833221435547  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 3.0293896198272705
the output layer 
self.num_batch (get_in_degree_bucketing) 11
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  11
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  11
G_BUCKET_ID_list [[2, 18, 22], [3, 19, 21], [0, 14, 17], [10, 13, 23], [11, 15, 20], [4, 5], [6, 7], [8, 1], [9, 12], [16]]
Groups_mem_list  [[1901, 1351, 1148], [1929, 1326, 1144], [1514, 1508, 1370], [1685, 1544, 1159], [1683, 1418, 1281], [1966, 1921], [1881, 1853], [1805, 1785], [1779, 1591], [1415], [1415]]
G_BUCKET_ID_list length 10
backpack scheduling spend time (sec) 0.44420480728149414
len(g_bucket_nids_list)  10
len(local_split_batches_nid_list)  11
current group_mem  4.401058628969324
current group_mem  4.401045342543889
current group_mem  4.394056033808697
current group_mem  4.388640456757343
current group_mem  4.383718256965125
current group_mem  3.8889049852154267
current group_mem  3.735089760738637
current group_mem  3.591795788981745
current group_mem  3.3706524621427407
current group_mem  1.4156729754798756
batches output list generation spend  0.0004634857177734375
self.weights_list  [0.12636764495662023, 0.10493616740524075, 0.18171121936200393, 0.05522261686148162, 0.050857149140651634, 0.13140387723908908, 0.09211466775161918, 0.17090201339329894, 0.05624525791447202, 0.02078270527045007, 0.00945668070507252]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.00815272331237793
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4448354244232178
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.7590229511260986
self.buckets_partition() spend  sec:  0.4530160427093506
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.17699670791625977  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.316827297210693  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.317992210388184  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.21187591552734375  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.45270824432373  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.454295635223389  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.21606111526489258  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 7.915393352508545  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 7.9180145263671875  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.21027517318725586  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.163214683532715  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.163963794708252  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.21030807495117188  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.098897933959961  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.09958791732788  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.2193899154663086  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.668227672576904  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.670120239257812  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.2203054428100586  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.264261245727539  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.265604496002197  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.22562313079833984  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 7.922996520996094  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 7.925316333770752  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.21942853927612305  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 7.4581146240234375  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 7.4588775634765625  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.20619916915893555  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 4.620523929595947  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 4.6208062171936035  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.1969165802001953  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 2.824880599975586  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 2.825009346008301  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.16536664962768555  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.959092140197754
the output layer 
self.num_batch (get_in_degree_bucketing) 11
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  11
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  11
G_BUCKET_ID_list [[2, 18, 22], [3, 19, 21], [0, 14, 17], [10, 13, 23], [11, 15, 20], [4, 5], [6, 7], [8, 1], [9, 12], [16]]
Groups_mem_list  [[1901, 1351, 1148], [1929, 1326, 1144], [1514, 1508, 1370], [1685, 1544, 1159], [1683, 1418, 1281], [1966, 1921], [1881, 1853], [1805, 1785], [1779, 1591], [1415], [1415]]
G_BUCKET_ID_list length 10
backpack scheduling spend time (sec) 0.2615170478820801
len(g_bucket_nids_list)  10
len(local_split_batches_nid_list)  11
current group_mem  4.401058628969324
current group_mem  4.401045342543889
current group_mem  4.394056033808697
current group_mem  4.388640456757343
current group_mem  4.383718256965125
current group_mem  3.8889049852154267
current group_mem  3.735089760738637
current group_mem  3.591795788981745
current group_mem  3.3706524621427407
current group_mem  1.4156729754798756
batches output list generation spend  0.00036215782165527344
self.weights_list  [0.12636764495662023, 0.10493616740524075, 0.18171121936200393, 0.05522261686148162, 0.050857149140651634, 0.13140387723908908, 0.09211466775161918, 0.17090201339329894, 0.05624525791447202, 0.02078270527045007, 0.00945668070507252]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.008312702178955078
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.26201915740966797
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.5764365196228027
self.buckets_partition() spend  sec:  0.2704136371612549
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.17709970474243164  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.32630443572998  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.327467918395996  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.21183538436889648  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.458306789398193  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.459985733032227  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.2159290313720703  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 7.909236907958984  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 7.911858081817627  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.21035337448120117  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.140481948852539  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.141231060028076  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.21008014678955078  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.072372913360596  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.073062896728516  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.21958589553833008  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.681866645812988  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.683759212493896  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.2203054428100586  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.264386653900146  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.265841484069824  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.22562313079833984  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 7.924990177154541  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 7.927309989929199  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.21941900253295898  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 7.468880653381348  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 7.469643592834473  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.2063312530517578  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 4.6199049949646  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 4.620187282562256  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.1957416534423828  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 2.810878276824951  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 2.811007022857666  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.16417837142944336  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.8679749965667725
the output layer 
self.num_batch (get_in_degree_bucketing) 11
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  11
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  11
G_BUCKET_ID_list [[2, 18, 22], [3, 19, 21], [0, 14, 17], [10, 13, 23], [11, 15, 20], [4, 5], [6, 7], [8, 1], [9, 12], [16]]
Groups_mem_list  [[1901, 1351, 1148], [1929, 1326, 1144], [1514, 1508, 1370], [1685, 1544, 1159], [1683, 1418, 1281], [1966, 1921], [1881, 1853], [1805, 1785], [1779, 1591], [1415], [1415]]
G_BUCKET_ID_list length 10
backpack scheduling spend time (sec) 0.42238759994506836
len(g_bucket_nids_list)  10
len(local_split_batches_nid_list)  11
current group_mem  4.401058628969324
current group_mem  4.401045342543889
current group_mem  4.394056033808697
current group_mem  4.388640456757343
current group_mem  4.383718256965125
current group_mem  3.8889049852154267
current group_mem  3.735089760738637
current group_mem  3.591795788981745
current group_mem  3.3706524621427407
current group_mem  1.4156729754798756
batches output list generation spend  0.0003752708435058594
self.weights_list  [0.12636764495662023, 0.10493616740524075, 0.18171121936200393, 0.05522261686148162, 0.050857149140651634, 0.13140387723908908, 0.09211466775161918, 0.17090201339329894, 0.05624525791447202, 0.02078270527045007, 0.00945668070507252]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.008521318435668945
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4229307174682617
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.7354278564453125
self.buckets_partition() spend  sec:  0.43147802352905273
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.17810297012329102  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.359043598175049  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.360207557678223  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.21179676055908203  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.446070194244385  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.447783470153809  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.21590375900268555  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 7.915044784545898  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 7.917578220367432  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.21026229858398438  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.149142742156982  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.14989185333252  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.21019792556762695  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.098020076751709  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.098710060119629  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.2195720672607422  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.668859958648682  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.67075252532959  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.2201066017150879  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.257912158966064  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 8.259316444396973  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.22562408447265625  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 7.9192423820495605  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 7.921562194824219  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.2193613052368164  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 7.44779634475708  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 7.448559284210205  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.2064380645751953  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 4.628772258758545  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 4.629054546356201  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34326171875 GB
    Memory Allocated: 0.19539546966552734  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 2.797342300415039  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 2.797471046447754  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.16382074356079102  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.7679734230041504
the output layer 
self.num_batch (get_in_degree_bucketing) 11
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  11
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  11
G_BUCKET_ID_list [[2, 18, 22], [3, 19, 21], [0, 14, 17], [10, 13, 23], [11, 15, 20], [4, 5], [6, 7], [8, 1], [9, 12], [16]]
Groups_mem_list  [[1901, 1351, 1148], [1929, 1326, 1144], [1514, 1508, 1370], [1685, 1544, 1159], [1683, 1418, 1281], [1966, 1921], [1881, 1853], [1805, 1785], [1779, 1591], [1415], [1415]]
G_BUCKET_ID_list length 10
backpack scheduling spend time (sec) 0.4031362533569336
len(g_bucket_nids_list)  10
len(local_split_batches_nid_list)  11
current group_mem  4.401058628969324
current group_mem  4.401045342543889
current group_mem  4.394056033808697
current group_mem  4.388640456757343
current group_mem  4.383718256965125
current group_mem  3.8889049852154267
current group_mem  3.735089760738637
current group_mem  3.591795788981745
current group_mem  3.3706524621427407
current group_mem  1.4156729754798756
batches output list generation spend  0.0003731250762939453
self.weights_list  [0.12636764495662023, 0.10493616740524075, 0.18171121936200393, 0.05522261686148162, 0.050857149140651634, 0.13140387723908908, 0.09211466775161918, 0.17090201339329894, 0.05624525791447202, 0.02078270527045007, 0.00945668070507252]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.008061408996582031
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.40367865562438965
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.7167253494262695
self.buckets_partition() spend  sec:  0.4117696285247803
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.1769237518310547  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.311463356018066  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.312628269195557  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.21167707443237305  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.442835807800293  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.444549083709717  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.21595382690429688  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.905740261077881  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.908361434936523  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.21053075790405273  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.165226936340332  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.16597604751587  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.20999813079833984  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.075450420379639  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.076140403747559  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.21954870223999023  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.653701782226562  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.65559434890747  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.22013235092163086  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.308073997497559  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.309401988983154  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.22562313079833984  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.933959484100342  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.936279296875  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.21946477890014648  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.47810697555542  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.478869915008545  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.20647573471069336  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 4.627811431884766  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 4.628093719482422  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.19547033309936523  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 2.7872166633605957  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 2.7873454093933105  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.16388416290283203  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.6716909408569336
the output layer 
self.num_batch (get_in_degree_bucketing) 11
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  11
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  11
G_BUCKET_ID_list [[2, 18, 22], [3, 19, 21], [0, 14, 17], [10, 13, 23], [11, 15, 20], [4, 5], [6, 7], [8, 1], [9, 12], [16]]
Groups_mem_list  [[1901, 1351, 1148], [1929, 1326, 1144], [1514, 1508, 1370], [1685, 1544, 1159], [1683, 1418, 1281], [1966, 1921], [1881, 1853], [1805, 1785], [1779, 1591], [1415], [1415]]
G_BUCKET_ID_list length 10
backpack scheduling spend time (sec) 0.3867771625518799
len(g_bucket_nids_list)  10
len(local_split_batches_nid_list)  11
current group_mem  4.401058628969324
current group_mem  4.401045342543889
current group_mem  4.394056033808697
current group_mem  4.388640456757343
current group_mem  4.383718256965125
current group_mem  3.8889049852154267
current group_mem  3.735089760738637
current group_mem  3.591795788981745
current group_mem  3.3706524621427407
current group_mem  1.4156729754798756
batches output list generation spend  0.0005035400390625
self.weights_list  [0.12636764495662023, 0.10493616740524075, 0.18171121936200393, 0.05522261686148162, 0.050857149140651634, 0.13140387723908908, 0.09211466775161918, 0.17090201339329894, 0.05624525791447202, 0.02078270527045007, 0.00945668070507252]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009189367294311523
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.3874645233154297
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.7154865264892578
self.buckets_partition() spend  sec:  0.3966825008392334
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.17697906494140625  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.315724849700928  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.316890239715576  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.21179676055908203  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.450970649719238  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.452413082122803  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.21591615676879883  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.9413862228393555  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.944007396697998  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.2103285789489746  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.137609004974365  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.138358116149902  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.21024036407470703  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.090266227722168  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.090956211090088  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.21954774856567383  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.666345119476318  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.668237686157227  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.22014188766479492  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.267221450805664  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.26854944229126  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.22562360763549805  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.922996520996094  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.925316333770752  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.21939754486083984  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.461749076843262  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.462512016296387  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.20638751983642578  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 4.6221795082092285  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 4.622461795806885  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.19552373886108398  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 2.785841941833496  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 2.785970687866211  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.16393661499023438  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.605654001235962
the output layer 
self.num_batch (get_in_degree_bucketing) 11
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  11
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  11
G_BUCKET_ID_list [[2, 18, 22], [3, 19, 21], [0, 14, 17], [10, 13, 23], [11, 15, 20], [4, 5], [6, 7], [8, 1], [9, 12], [16]]
Groups_mem_list  [[1901, 1351, 1148], [1929, 1326, 1144], [1514, 1508, 1370], [1685, 1544, 1159], [1683, 1418, 1281], [1966, 1921], [1881, 1853], [1805, 1785], [1779, 1591], [1415], [1415]]
G_BUCKET_ID_list length 10
backpack scheduling spend time (sec) 0.2667243480682373
len(g_bucket_nids_list)  10
len(local_split_batches_nid_list)  11
current group_mem  4.401058628969324
current group_mem  4.401045342543889
current group_mem  4.394056033808697
current group_mem  4.388640456757343
current group_mem  4.383718256965125
current group_mem  3.8889049852154267
current group_mem  3.735089760738637
current group_mem  3.591795788981745
current group_mem  3.3706524621427407
current group_mem  1.4156729754798756
batches output list generation spend  0.00046825408935546875
self.weights_list  [0.12636764495662023, 0.10493616740524075, 0.18171121936200393, 0.05522261686148162, 0.050857149140651634, 0.13140387723908908, 0.09211466775161918, 0.17090201339329894, 0.05624525791447202, 0.02078270527045007, 0.00945668070507252]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.008365869522094727
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.26737189292907715
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.5825884342193604
self.buckets_partition() spend  sec:  0.27576112747192383
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.1781020164489746  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.32995891571045  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.33112382888794  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.21178388595581055  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.453009605407715  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.454528331756592  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.21595478057861328  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.953587532043457  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.9562087059021  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.21040678024291992  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.148993015289307  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.149742126464844  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.21020793914794922  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.088943481445312  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.089633464813232  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.2195754051208496  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.666866302490234  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.668758869171143  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.2201251983642578  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.307275295257568  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.308603286743164  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.22562456130981445  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.916684627532959  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.919004440307617  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.21944236755371094  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.473377227783203  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.474140167236328  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.20659208297729492  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 4.63668966293335  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 4.636971950531006  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.19536972045898438  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 2.778611183166504  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 2.7787399291992188  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.16378068923950195  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.55867075920105
the output layer 
self.num_batch (get_in_degree_bucketing) 11
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  11
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  11
G_BUCKET_ID_list [[2, 18, 22], [3, 19, 21], [0, 14, 17], [10, 13, 23], [11, 15, 20], [4, 5], [6, 7], [8, 1], [9, 12], [16]]
Groups_mem_list  [[1901, 1351, 1148], [1929, 1326, 1144], [1514, 1508, 1370], [1685, 1544, 1159], [1683, 1418, 1281], [1966, 1921], [1881, 1853], [1805, 1785], [1779, 1591], [1415], [1415]]
G_BUCKET_ID_list length 10
backpack scheduling spend time (sec) 0.4444875717163086
len(g_bucket_nids_list)  10
len(local_split_batches_nid_list)  11
current group_mem  4.401058628969324
current group_mem  4.401045342543889
current group_mem  4.394056033808697
current group_mem  4.388640456757343
current group_mem  4.383718256965125
current group_mem  3.8889049852154267
current group_mem  3.735089760738637
current group_mem  3.591795788981745
current group_mem  3.3706524621427407
current group_mem  1.4156729754798756
batches output list generation spend  0.0005249977111816406
self.weights_list  [0.12636764495662023, 0.10493616740524075, 0.18171121936200393, 0.05522261686148162, 0.050857149140651634, 0.13140387723908908, 0.09211466775161918, 0.17090201339329894, 0.05624525791447202, 0.02078270527045007, 0.00945668070507252]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009859800338745117
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.44519972801208496
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.7613341808319092
self.buckets_partition() spend  sec:  0.45508599281311035
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.17693281173706055  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.317530632019043  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.318696022033691  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.21173954010009766  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.45012092590332  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.451708316802979  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.21600914001464844  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.906877040863037  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.909460067749023  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.21036720275878906  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.17629861831665  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.177047729492188  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.21027421951293945  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.100693702697754  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.101383686065674  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.21947765350341797  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.651503086090088  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.653395652770996  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.22013282775878906  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.265776634216309  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.267104625701904  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.22562408447265625  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.913877010345459  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.916196823120117  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.21918725967407227  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.441985130310059  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.442748069763184  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.2064990997314453  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 4.625649929046631  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 4.625932216644287  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.19544124603271484  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 2.7957749366760254  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 2.7959036827087402  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.16386651992797852  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.4716057777404785
the output layer 
self.num_batch (get_in_degree_bucketing) 11
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  11
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  11
G_BUCKET_ID_list [[2, 18, 22], [3, 19, 21], [0, 14, 17], [10, 13, 23], [11, 15, 20], [4, 5], [6, 7], [8, 1], [9, 12], [16]]
Groups_mem_list  [[1901, 1351, 1148], [1929, 1326, 1144], [1514, 1508, 1370], [1685, 1544, 1159], [1683, 1418, 1281], [1966, 1921], [1881, 1853], [1805, 1785], [1779, 1591], [1415], [1415]]
G_BUCKET_ID_list length 10
backpack scheduling spend time (sec) 0.3882911205291748
len(g_bucket_nids_list)  10
len(local_split_batches_nid_list)  11
current group_mem  4.401058628969324
current group_mem  4.401045342543889
current group_mem  4.394056033808697
current group_mem  4.388640456757343
current group_mem  4.383718256965125
current group_mem  3.8889049852154267
current group_mem  3.735089760738637
current group_mem  3.591795788981745
current group_mem  3.3706524621427407
current group_mem  1.4156729754798756
batches output list generation spend  0.00046896934509277344
self.weights_list  [0.12636764495662023, 0.10493616740524075, 0.18171121936200393, 0.05522261686148162, 0.050857149140651634, 0.13140387723908908, 0.09211466775161918, 0.17090201339329894, 0.05624525791447202, 0.02078270527045007, 0.00945668070507252]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.009281635284423828
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.3889286518096924
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.7031548023223877
self.buckets_partition() spend  sec:  0.39823341369628906
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.1781024932861328  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.327918529510498  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.32908296585083  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.21171140670776367  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.442801475524902  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.44438886642456  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.21594905853271484  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.904656410217285  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.907277584075928  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.21039819717407227  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.175218105316162  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.1759672164917  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.2101125717163086  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.088879585266113  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.089569568634033  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.21954011917114258  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.653680324554443  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.655572891235352  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.22019672393798828  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.271456718444824  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.27278470993042  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.22562217712402344  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.927002429962158  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.929322242736816  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.21940231323242188  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.46993350982666  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.470696449279785  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.20659971237182617  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 4.641519069671631  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 4.641801357269287  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.19520139694213867  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 2.7832255363464355  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 2.7833542823791504  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.16361713409423828  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.396641254425049
the output layer 
self.num_batch (get_in_degree_bucketing) 11
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  11
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  11
G_BUCKET_ID_list [[2, 18, 22], [3, 19, 21], [0, 14, 17], [10, 13, 23], [11, 15, 20], [4, 5], [6, 7], [8, 1], [9, 12], [16]]
Groups_mem_list  [[1901, 1351, 1148], [1929, 1326, 1144], [1514, 1508, 1370], [1685, 1544, 1159], [1683, 1418, 1281], [1966, 1921], [1881, 1853], [1805, 1785], [1779, 1591], [1415], [1415]]
G_BUCKET_ID_list length 10
backpack scheduling spend time (sec) 0.3880133628845215
len(g_bucket_nids_list)  10
len(local_split_batches_nid_list)  11
current group_mem  4.401058628969324
current group_mem  4.401045342543889
current group_mem  4.394056033808697
current group_mem  4.388640456757343
current group_mem  4.383718256965125
current group_mem  3.8889049852154267
current group_mem  3.735089760738637
current group_mem  3.591795788981745
current group_mem  3.3706524621427407
current group_mem  1.4156729754798756
batches output list generation spend  0.0004699230194091797
self.weights_list  [0.12636764495662023, 0.10493616740524075, 0.18171121936200393, 0.05522261686148162, 0.050857149140651634, 0.13140387723908908, 0.09211466775161918, 0.17090201339329894, 0.05624525791447202, 0.02078270527045007, 0.00945668070507252]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.008321285247802734
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.3886446952819824
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.7019493579864502
self.buckets_partition() spend  sec:  0.3969912528991699
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.1769118309020996  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.309652328491211  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.310817241668701  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.2118239402770996  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.442368984222412  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.44395637512207  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.21606111526489258  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.8850178718566895  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.887639045715332  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.21056270599365234  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.18291711807251  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.183666229248047  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.21003389358520508  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.088395118713379  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.089085102081299  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.2196040153503418  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.681588172912598  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.683480739593506  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.2203054428100586  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.264995098114014  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.266443252563477  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.22562313079833984  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.928839683532715  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.931159496307373  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.21936321258544922  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.454898834228516  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.455661773681641  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.20653009414672852  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 4.623993873596191  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 4.624276161193848  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.1958303451538086  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 2.8030991554260254  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 2.8032279014587402  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.16425657272338867  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.3203728199005127
the output layer 
self.num_batch (get_in_degree_bucketing) 11
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  11
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  11
G_BUCKET_ID_list [[2, 18, 22], [3, 19, 21], [0, 14, 17], [10, 13, 23], [11, 15, 20], [4, 5], [6, 7], [8, 1], [9, 12], [16]]
Groups_mem_list  [[1901, 1351, 1148], [1929, 1326, 1144], [1514, 1508, 1370], [1685, 1544, 1159], [1683, 1418, 1281], [1966, 1921], [1881, 1853], [1805, 1785], [1779, 1591], [1415], [1415]]
G_BUCKET_ID_list length 10
backpack scheduling spend time (sec) 0.4472618103027344
len(g_bucket_nids_list)  10
len(local_split_batches_nid_list)  11
current group_mem  4.401058628969324
current group_mem  4.401045342543889
current group_mem  4.394056033808697
current group_mem  4.388640456757343
current group_mem  4.383718256965125
current group_mem  3.8889049852154267
current group_mem  3.735089760738637
current group_mem  3.591795788981745
current group_mem  3.3706524621427407
current group_mem  1.4156729754798756
batches output list generation spend  0.0004975795745849609
self.weights_list  [0.12636764495662023, 0.10493616740524075, 0.18171121936200393, 0.05522261686148162, 0.050857149140651634, 0.13140387723908908, 0.09211466775161918, 0.17090201339329894, 0.05624525791447202, 0.02078270527045007, 0.00945668070507252]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.008978128433227539
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4479520320892334
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.7624104022979736
self.buckets_partition() spend  sec:  0.4569573402404785
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.17702960968017578  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.320050239562988  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.32121467590332  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.2117142677307129  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.438961505889893  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.44054889678955  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.21600055694580078  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.9402384757995605  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.942939758300781  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.21065998077392578  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.16552734375  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.166276454925537  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.2100672721862793  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.085140228271484  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.085830211639404  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.21982717514038086  GigaBytes
Max Memory Allocated: 9.099748611450195  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.696122646331787  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.698015213012695  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.2203078269958496  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.265713691711426  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.267041683197021  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.22562551498413086  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.912820339202881  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.915140151977539  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.21931076049804688  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.425974369049072  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.426737308502197  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.20642805099487305  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 4.633190155029297  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 4.633472442626953  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.19575786590576172  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 2.8095145225524902  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 2.809643268585205  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.16418981552124023  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.248764753341675
the output layer 
self.num_batch (get_in_degree_bucketing) 11
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  11
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  11
G_BUCKET_ID_list [[2, 18, 22], [3, 19, 21], [0, 14, 17], [10, 13, 23], [11, 15, 20], [4, 5], [6, 7], [8, 1], [9, 12], [16]]
Groups_mem_list  [[1901, 1351, 1148], [1929, 1326, 1144], [1514, 1508, 1370], [1685, 1544, 1159], [1683, 1418, 1281], [1966, 1921], [1881, 1853], [1805, 1785], [1779, 1591], [1415], [1415]]
G_BUCKET_ID_list length 10
backpack scheduling spend time (sec) 0.27243566513061523
len(g_bucket_nids_list)  10
len(local_split_batches_nid_list)  11
current group_mem  4.401058628969324
current group_mem  4.401045342543889
current group_mem  4.394056033808697
current group_mem  4.388640456757343
current group_mem  4.383718256965125
current group_mem  3.8889049852154267
current group_mem  3.735089760738637
current group_mem  3.591795788981745
current group_mem  3.3706524621427407
current group_mem  1.4156729754798756
batches output list generation spend  0.0004024505615234375
self.weights_list  [0.12636764495662023, 0.10493616740524075, 0.18171121936200393, 0.05522261686148162, 0.050857149140651634, 0.13140387723908908, 0.09211466775161918, 0.17090201339329894, 0.05624525791447202, 0.02078270527045007, 0.00945668070507252]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.0070989131927490234
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.2729756832122803
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.546051025390625
self.buckets_partition() spend  sec:  0.2801051139831543
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.17693233489990234  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.308338642120361  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.309503078460693  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.21178627014160156  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.441550731658936  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.443138122558594  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.21606063842773438  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.883399486541748  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.886020660400391  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.210540771484375  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.175579071044922  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.176328182220459  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.2102651596069336  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.089842319488525  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.090532302856445  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.2196798324584961  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.68455696105957  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.686355113983154  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.22014522552490234  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.306639671325684  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.30796766281128  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.22562360763549805  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.938014984130859  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.940334796905518  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.2193288803100586  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.456092357635498  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.456855297088623  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.20638608932495117  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 4.6252217292785645  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 4.625504016876221  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.1969141960144043  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 2.82098388671875  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 2.821112632751465  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.1653604507446289  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.1947948932647705
the output layer 
self.num_batch (get_in_degree_bucketing) 11
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  11
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  11
G_BUCKET_ID_list [[2, 18, 22], [3, 19, 21], [0, 14, 17], [10, 13, 23], [11, 15, 20], [4, 5], [6, 7], [8, 1], [9, 12], [16]]
Groups_mem_list  [[1901, 1351, 1148], [1929, 1326, 1144], [1514, 1508, 1370], [1685, 1544, 1159], [1683, 1418, 1281], [1966, 1921], [1881, 1853], [1805, 1785], [1779, 1591], [1415], [1415]]
G_BUCKET_ID_list length 10
backpack scheduling spend time (sec) 0.39269280433654785
len(g_bucket_nids_list)  10
len(local_split_batches_nid_list)  11
current group_mem  4.401058628969324
current group_mem  4.401045342543889
current group_mem  4.394056033808697
current group_mem  4.388640456757343
current group_mem  4.383718256965125
current group_mem  3.8889049852154267
current group_mem  3.735089760738637
current group_mem  3.591795788981745
current group_mem  3.3706524621427407
current group_mem  1.4156729754798756
batches output list generation spend  0.0003705024719238281
self.weights_list  [0.12636764495662023, 0.10493616740524075, 0.18171121936200393, 0.05522261686148162, 0.050857149140651634, 0.13140387723908908, 0.09211466775161918, 0.17090201339329894, 0.05624525791447202, 0.02078270527045007, 0.00945668070507252]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.01254129409790039
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.3932979106903076
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.680821418762207
self.buckets_partition() spend  sec:  0.40586328506469727
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.17703866958618164  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.32124376296997  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.322407245635986  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.2119464874267578  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.455069541931152  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.456782817840576  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.2158980369567871  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.908290863037109  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.910912036895752  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.2104320526123047  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.146604537963867  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.147353649139404  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.21028566360473633  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.08647108078003  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.08716106414795  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.2195415496826172  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.656071186065674  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.657963752746582  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.2201380729675293  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.306167602539062  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.307495594024658  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.22562456130981445  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.933012962341309  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.935332775115967  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.2192831039428711  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.440384387969971  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.441147327423096  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.20644187927246094  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 4.626434803009033  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 4.6267170906066895  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.19557571411132812  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 2.818023204803467  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 2.8181519508361816  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.16401338577270508  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.1456198692321777
the output layer 
self.num_batch (get_in_degree_bucketing) 11
get_in_degree_bucketing dst global nid length 90941
len(bkt)  13428
len(bkt)  11706
len(bkt)  9277
len(bkt)  7320
len(bkt)  6222
len(bkt)  4868
len(bkt)  4045
len(bkt)  3472
len(bkt)  2976
len(bkt)  2599
len(bkt)  2203
len(bkt)  1937
len(bkt)  1656
len(bkt)  1434
len(bkt)  1289
len(bkt)  1111
len(bkt)  1030
len(bkt)  948
len(bkt)  836
len(bkt)  807
len(bkt)  717
len(bkt)  556
len(bkt)  519
len(bkt)  525
len(bkt)  9460
total indegree bucketing result ,  90941
the number of total output nodes match :) 
local nids of zero in-degree  []
bucket partitioner: bkt_dst_nodes_list_local length  25
---||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||-----||--
self.num_batch,  11
type of fanout_dst_nids  <class 'torch.Tensor'>
self.K  11
G_BUCKET_ID_list [[2, 18, 22], [3, 19, 21], [0, 14, 17], [10, 13, 23], [11, 15, 20], [4, 5], [6, 7], [8, 1], [9, 12], [16]]
Groups_mem_list  [[1901, 1351, 1148], [1929, 1326, 1144], [1514, 1508, 1370], [1685, 1544, 1159], [1683, 1418, 1281], [1966, 1921], [1881, 1853], [1805, 1785], [1779, 1591], [1415], [1415]]
G_BUCKET_ID_list length 10
backpack scheduling spend time (sec) 0.4255967140197754
len(g_bucket_nids_list)  10
len(local_split_batches_nid_list)  11
current group_mem  4.401058628969324
current group_mem  4.401045342543889
current group_mem  4.394056033808697
current group_mem  4.388640456757343
current group_mem  4.383718256965125
current group_mem  3.8889049852154267
current group_mem  3.735089760738637
current group_mem  3.591795788981745
current group_mem  3.3706524621427407
current group_mem  1.4156729754798756
batches output list generation spend  0.0003821849822998047
self.weights_list  [0.12636764495662023, 0.10493616740524075, 0.18171121936200393, 0.05522261686148162, 0.050857149140651634, 0.13140387723908908, 0.09211466775161918, 0.17090201339329894, 0.05624525791447202, 0.02078270527045007, 0.00945668070507252]
bkt_dst_nodes_list = self.get_in_degree_bucketing() spend:  0.007785797119140625
self.gen_batches_seeds_list(bkt_dst_nodes_list_local) spend  0.4261434078216553
self.has_zero_indegree_seeds  False
num_output  90941
self.output_nids  90941
output nodes length match
global output equals  True
partition total batch output list spend :  0.7365405559539795
self.buckets_partition() spend  sec:  0.4339559078216553
step  0
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.1769862174987793  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.308896541595459  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.310060977935791  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

step  1
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.21190452575683594  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.446714878082275  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.4484281539917  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

step  2
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.21595430374145508  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.907355308532715  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.9100565910339355  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

step  3
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.21044540405273438  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.164041519165039  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.164790630340576  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

step  4
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.21013736724853516  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.085322380065918  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.086012363433838  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

step  5
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.2194962501525879  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.669799327850342  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.67169189453125  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

step  6
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.22014379501342773  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.313506126403809  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 8.314834117889404  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

step  7
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.22562456130981445  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.932246685028076  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.934566497802734  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

step  8
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.2192521095275879  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.439966678619385  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 7.44072961807251  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

step  9
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.20666980743408203  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 4.630838871002197  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 4.6311211585998535  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

step  10
----------------------------------------before batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.1954951286315918  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after batch_pred = model(blocks, batch_inputs)
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 2.803706645965576  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after loss function
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 2.803835391998291  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------after optimizer
 Nvidia-smi: 12.34521484375 GB
    Memory Allocated: 0.1639251708984375  GigaBytes
Max Memory Allocated: 9.099918365478516  GigaBytes

----------------------------------------------------------pseudo_mini_loss sum 2.0860700607299805
epoch_time_list  [7.0530993938446045, 6.103156805038452, 6.095347881317139, 5.9375481605529785, 6.1075828075408936, 6.113126277923584, 5.885607481002808, 6.091866731643677, 5.871359586715698, 5.936387777328491, 5.904115200042725, 6.1367573738098145, 5.983403921127319, 6.200242519378662, 6.068946838378906, 6.175550222396851, 6.1767964363098145, 5.770766735076904, 6.222862720489502, 5.884432077407837]

loading_time list   [0.02229142189025879, 0.05968904495239258, 0.03713178634643555, 0.04498124122619629, 0.03384065628051758, 0.043222904205322266, 0.031542062759399414, 0.031266212463378906, 0.024553775787353516, 0.03966164588928223, 0.030423641204833984, 0.029585838317871094, 0.030364036560058594, 0.04521656036376953, 0.028589248657226562, 0.02123117446899414, 0.04526996612548828, 0.036245107650756836, 0.025364160537719727, 0.031169414520263672]

 data loader gen time  [1.7317721843719482, 1.7520029544830322, 1.756937026977539, 1.6233959197998047, 1.7482810020446777, 1.770594596862793, 1.5698773860931396, 1.7662975788116455, 1.569657325744629, 1.6095964908599854, 1.5731327533721924, 1.7647595405578613, 1.5869319438934326, 1.813629388809204, 1.7056770324707031, 1.730409860610962, 1.831524133682251, 1.4766309261322021, 1.8648242950439453, 1.5061137676239014]
	---backpack schedule time  [0.749439001083374, 0.7222492694854736, 0.7521951198577881, 0.5924317836761475, 0.763075590133667, 0.7508020401000977, 0.7285525798797607, 0.7711596488952637, 0.5863921642303467, 0.7480559349060059, 0.7262461185455322, 0.7285642623901367, 0.5924251079559326, 0.7742507457733154, 0.7128291130065918, 0.7115187644958496, 0.7754278182983398, 0.5552477836608887, 0.6999101638793945, 0.7467892169952393]
	---connection_check_time_list  [0.4574296474456787, 0.48191356658935547, 0.4894280433654785, 0.49613046646118164, 0.47513413429260254, 0.49729418754577637, 0.4773852825164795, 0.48002076148986816, 0.4859282970428467, 0.47738194465637207, 0.48026251792907715, 0.499523401260376, 0.4781661033630371, 0.4963407516479492, 0.4792323112487793, 0.4819600582122803, 0.501971960067749, 0.590294599533081, 0.6177453994750977, 0.4853334426879883]
	---block_gen_time_list  [0.46504688262939453, 0.48488950729370117, 0.4547107219696045, 0.47182726860046387, 0.4502592086791992, 0.46141934394836426, 0.30420541763305664, 0.4559314250946045, 0.43754053115844727, 0.324993371963501, 0.30519843101501465, 0.47639894485473633, 0.45665717124938965, 0.48296475410461426, 0.4540717601776123, 0.4766247272491455, 0.4937458038330078, 0.2757720947265625, 0.4685981273651123, 0.21561169624328613]
training time  [5.299027919769287, 4.288347959518433, 4.297777891159058, 4.264867305755615, 4.321293592453003, 4.29523491859436, 4.280006408691406, 4.290292739868164, 4.272974729537964, 4.282897472381592, 4.296379327774048, 4.3361663818359375, 4.361906290054321, 4.336968183517456, 4.330633640289307, 4.41979455947876, 4.295568466186523, 4.251397132873535, 4.323136568069458, 4.342677354812622]
---feature block loading time  [1.8050262928009033, 1.9372458457946777, 1.9451830387115479, 1.937913179397583, 1.9762380123138428, 1.937255620956421, 1.9494986534118652, 1.9421474933624268, 1.9488773345947266, 1.9491026401519775, 1.9388985633850098, 1.9490649700164795, 1.9883699417114258, 1.9532053470611572, 1.9506325721740723, 2.023420572280884, 1.9248266220092773, 1.8912029266357422, 1.953993320465088, 1.961866855621338]


epoch_time avg   6.033112794160843
loading_time avg   0.03297165036201477
 data loader gen time avg 1.6804961264133453
	---backpack schedule time avg 0.7107029408216476
	---connection_check_time avg  0.500248447060585
	---block_gen_time avg  0.4087495505809784
training time  4.314832985401154
---feature block loading time  1.9524125903844833
pure train time per /epoch  [3.4844820499420166, 2.2502834796905518, 2.249303102493286, 2.221597194671631, 2.2425734996795654, 2.2578628063201904, 2.2340431213378906, 2.2452006340026855, 2.218942165374756, 2.2331111431121826, 2.252946376800537, 2.290037155151367, 2.2687580585479736, 2.287299394607544, 2.2812211513519287, 2.288620710372925, 2.268106460571289, 2.2553906440734863, 2.267216682434082, 2.2788801193237305]
pure train time average  2.2583416069255158
