main start at this time 1733103291.902291
-----------------------------------------before load data 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 0.55029296875 GB
    Memory Allocated: 0.033054351806640625  GigaBytes
Max Memory Allocated: 0.033054351806640625  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 0.55224609375 GB
    Memory Allocated: 0.033054351806640625  GigaBytes
Max Memory Allocated: 0.033054351806640625  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.546 seconds, peak memory: 17.045 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 17.045 GB
Metis partitioning: 5.324 seconds, peak memory: 17.823 GB
Split the graph: 11.781 seconds
Construct subgraphs: 0.015 seconds
REG metis partition end ----................................
REG construction  time spent:  23.952407360076904
pure dgl.metis_partition the time spent:  18.696681022644043
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.632744312286377

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  2.023972988128662

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 0.55224609375 GB
    Memory Allocated: 0.033054351806640625  GigaBytes
Max Memory Allocated: 0.033054351806640625  GigaBytes

connection checking time:  2.011404275894165
block generation total time  3.656717300415039
average batch blocks generation time:  0.7313434600830078
block dataloader generation time/epoch 48.987913608551025
pseudo mini batch 0 input nodes size: 41187
----------------------------------------before load block subtensor 
 Nvidia-smi: 0.55224609375 GB
    Memory Allocated: 0.033054351806640625  GigaBytes
Max Memory Allocated: 0.033054351806640625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 0.55224609375 GB
    Memory Allocated: 0.033054351806640625  GigaBytes
Max Memory Allocated: 0.033054351806640625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 0.57373046875 GB
    Memory Allocated: 0.052693843841552734  GigaBytes
Max Memory Allocated: 0.052693843841552734  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 0.57373046875 GB
    Memory Allocated: 0.05282926559448242  GigaBytes
Max Memory Allocated: 0.05282926559448242  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 0.57373046875 GB
    Memory Allocated: 0.05282926559448242  GigaBytes
Max Memory Allocated: 0.05282926559448242  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2335, 2: 2135, 3: 1849, 4: 1497, 25: 1468, 5: 1272, 6: 1057, 7: 900, 8: 771, 9: 661, 10: 603, 11: 554, 12: 430, 13: 386, 14: 339, 15: 289, 17: 262, 16: 248, 20: 208, 18: 195, 19: 172, 21: 167, 23: 117, 22: 116, 24: 112})

----------------------------------------after blocks to device 
 Nvidia-smi: 0.57763671875 GB
    Memory Allocated: 0.0564122200012207  GigaBytes
Max Memory Allocated: 0.0564122200012207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 0.57763671875 GB
    Memory Allocated: 0.0564122200012207  GigaBytes
Max Memory Allocated: 0.0564122200012207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.89208984375 GB
    Memory Allocated: 10.412003993988037  GigaBytes
Max Memory Allocated: 11.115628719329834  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.89208984375 GB
    Memory Allocated: 10.414736270904541  GigaBytes
Max Memory Allocated: 11.115628719329834  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.46630859375 GB
    Memory Allocated: 0.11090230941772461  GigaBytes
Max Memory Allocated: 11.115628719329834  GigaBytes

pseudo mini batch 1 input nodes size: 46929
----------------------------------------before load block subtensor 
 Nvidia-smi: 12.46630859375 GB
    Memory Allocated: 0.10818243026733398  GigaBytes
Max Memory Allocated: 11.115628719329834  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 12.46630859375 GB
    Memory Allocated: 0.10818243026733398  GigaBytes
Max Memory Allocated: 11.115628719329834  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.46630859375 GB
    Memory Allocated: 0.13055992126464844  GigaBytes
Max Memory Allocated: 11.115628719329834  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.46630859375 GB
    Memory Allocated: 0.13069868087768555  GigaBytes
Max Memory Allocated: 11.115628719329834  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 12.46630859375 GB
    Memory Allocated: 0.11092376708984375  GigaBytes
Max Memory Allocated: 11.115628719329834  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2991, 2: 2699, 3: 2159, 4: 1704, 5: 1385, 6: 1109, 7: 936, 8: 786, 25: 767, 9: 660, 10: 534, 11: 432, 12: 391, 13: 337, 14: 293, 15: 238, 16: 203, 18: 171, 17: 168, 19: 147, 21: 115, 20: 98, 22: 92, 23: 90, 24: 75})

----------------------------------------after blocks to device 
 Nvidia-smi: 12.46630859375 GB
    Memory Allocated: 0.11410331726074219  GigaBytes
Max Memory Allocated: 11.115628719329834  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.46630859375 GB
    Memory Allocated: 0.11410331726074219  GigaBytes
Max Memory Allocated: 11.115628719329834  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.47021484375 GB
    Memory Allocated: 8.996933937072754  GigaBytes
Max Memory Allocated: 11.115628719329834  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 12.47021484375 GB
    Memory Allocated: 8.999724864959717  GigaBytes
Max Memory Allocated: 11.115628719329834  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.93701171875 GB
    Memory Allocated: 0.11659717559814453  GigaBytes
Max Memory Allocated: 11.115628719329834  GigaBytes

pseudo mini batch 2 input nodes size: 69068
----------------------------------------before load block subtensor 
 Nvidia-smi: 12.93701171875 GB
    Memory Allocated: 0.1139059066772461  GigaBytes
Max Memory Allocated: 11.115628719329834  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 12.93701171875 GB
    Memory Allocated: 0.1139059066772461  GigaBytes
Max Memory Allocated: 11.115628719329834  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.93701171875 GB
    Memory Allocated: 0.1471090316772461  GigaBytes
Max Memory Allocated: 11.115628719329834  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 12.93701171875 GB
    Memory Allocated: 0.147247314453125  GigaBytes
Max Memory Allocated: 11.115628719329834  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 12.93701171875 GB
    Memory Allocated: 0.12473106384277344  GigaBytes
Max Memory Allocated: 11.115628719329834  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2969, 2: 2499, 3: 2041, 4: 1635, 5: 1407, 25: 1211, 6: 1017, 7: 858, 8: 771, 9: 634, 10: 557, 11: 431, 12: 395, 13: 339, 14: 298, 15: 275, 16: 219, 17: 198, 18: 172, 20: 141, 19: 134, 21: 100, 22: 99, 24: 81, 23: 76})

----------------------------------------after blocks to device 
 Nvidia-smi: 12.93701171875 GB
    Memory Allocated: 0.1285395622253418  GigaBytes
Max Memory Allocated: 11.115628719329834  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.93701171875 GB
    Memory Allocated: 0.1285395622253418  GigaBytes
Max Memory Allocated: 11.115628719329834  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.19873046875 GB
    Memory Allocated: 10.13580846786499  GigaBytes
Max Memory Allocated: 11.115628719329834  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.19873046875 GB
    Memory Allocated: 10.138599395751953  GigaBytes
Max Memory Allocated: 11.115628719329834  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.70654296875 GB
    Memory Allocated: 0.13206243515014648  GigaBytes
Max Memory Allocated: 11.115628719329834  GigaBytes

pseudo mini batch 3 input nodes size: 88523
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.70654296875 GB
    Memory Allocated: 0.1284012794494629  GigaBytes
Max Memory Allocated: 11.115628719329834  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.70654296875 GB
    Memory Allocated: 0.1284012794494629  GigaBytes
Max Memory Allocated: 11.115628719329834  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.70654296875 GB
    Memory Allocated: 0.17061233520507812  GigaBytes
Max Memory Allocated: 11.115628719329834  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.70654296875 GB
    Memory Allocated: 0.1707439422607422  GigaBytes
Max Memory Allocated: 11.115628719329834  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.70654296875 GB
    Memory Allocated: 0.13740253448486328  GigaBytes
Max Memory Allocated: 11.115628719329834  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2946, 2: 2566, 25: 1952, 3: 1829, 4: 1371, 5: 1190, 6: 918, 7: 709, 8: 599, 9: 517, 10: 433, 11: 384, 12: 319, 13: 254, 15: 221, 14: 218, 16: 180, 18: 175, 17: 162, 19: 161, 20: 149, 21: 125, 24: 103, 22: 99, 23: 77})

----------------------------------------after blocks to device 
 Nvidia-smi: 13.70654296875 GB
    Memory Allocated: 0.14281177520751953  GigaBytes
Max Memory Allocated: 11.115628719329834  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.70654296875 GB
    Memory Allocated: 0.14281177520751953  GigaBytes
Max Memory Allocated: 11.115628719329834  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.23779296875 GB
    Memory Allocated: 11.542648315429688  GigaBytes
Max Memory Allocated: 12.2117919921875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.23779296875 GB
    Memory Allocated: 11.54535722732544  GigaBytes
Max Memory Allocated: 12.2117919921875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.77099609375 GB
    Memory Allocated: 0.14671611785888672  GigaBytes
Max Memory Allocated: 12.2117919921875  GigaBytes

pseudo mini batch 4 input nodes size: 86943
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.77099609375 GB
    Memory Allocated: 0.1402134895324707  GigaBytes
Max Memory Allocated: 12.2117919921875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.77099609375 GB
    Memory Allocated: 0.1402134895324707  GigaBytes
Max Memory Allocated: 12.2117919921875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.77099609375 GB
    Memory Allocated: 0.181671142578125  GigaBytes
Max Memory Allocated: 12.2117919921875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.77099609375 GB
    Memory Allocated: 0.18180561065673828  GigaBytes
Max Memory Allocated: 12.2117919921875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.77099609375 GB
    Memory Allocated: 0.13946294784545898  GigaBytes
Max Memory Allocated: 12.2117919921875  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 4062, 1: 2187, 2: 1807, 3: 1399, 4: 1113, 5: 968, 6: 767, 7: 642, 8: 545, 9: 504, 10: 472, 12: 402, 11: 402, 13: 340, 14: 286, 15: 266, 16: 261, 17: 240, 18: 235, 19: 222, 20: 211, 21: 210, 23: 159, 24: 154, 22: 150})

----------------------------------------after blocks to device 
 Nvidia-smi: 16.77099609375 GB
    Memory Allocated: 0.14588260650634766  GigaBytes
Max Memory Allocated: 12.2117919921875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.77099609375 GB
    Memory Allocated: 0.14588260650634766  GigaBytes
Max Memory Allocated: 12.2117919921875  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.98974609375 GB
    Memory Allocated: 15.796206951141357  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.98974609375 GB
    Memory Allocated: 15.798912048339844  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.15138816833496094  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.2174968719482422  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.18444252014160156  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.09647221565246582 |0.00631256103515625 |0.44045300483703614 |0.0029349327087402344 |0.5271074771881104 |0.19339799880981445 |
----------------------------------------------------------pseudo_mini_loss sum 3.7762272357940674
Total (block generation + training)time/epoch 54.59603524208069
Training time/epoch 5.607824802398682
Training time without block to device /epoch 5.5762619972229
Training time without total dataloading part /epoch 5.045875072479248
load block tensor time/epoch 0.4823610782623291
block to device time/epoch 0.03156280517578125
input features size transfer per epoch 7.450580596923828e-07
blocks size to device per epoch 4.0978193283081055e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  541221
Number of first layer input nodes during this epoch:  332650
Number of first layer output nodes during this epoch:  208571
----------------------------------------before generate dataloader block 
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.1714644432067871  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.526 seconds, peak memory: 43.935 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 43.935 GB
Metis partitioning: 5.328 seconds, peak memory: 44.739 GB
Split the graph: 11.654 seconds
Construct subgraphs: 0.006 seconds
REG metis partition end ----................................
REG construction  time spent:  26.916510343551636
pure dgl.metis_partition the time spent:  18.541725635528564
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.9446682929992676

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.364872932434082

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.1714644432067871  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

connection checking time:  1.5571835041046143
block generation total time  2.3095412254333496
average batch blocks generation time:  0.46190824508666994
block dataloader generation time/epoch 49.51507520675659
pseudo mini batch 0 input nodes size: 39790
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.16454029083251953  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.16454029083251953  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.18407154083251953  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.18420982360839844  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.14261770248413086  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2239, 2: 2086, 3: 1817, 25: 1605, 4: 1486, 5: 1267, 6: 1080, 7: 927, 8: 798, 9: 704, 10: 617, 11: 575, 12: 468, 13: 411, 14: 373, 15: 305, 17: 284, 16: 272, 18: 230, 20: 217, 21: 192, 19: 183, 22: 132, 23: 132, 24: 121})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.14635181427001953  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.14635181427001953  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 11.08137035369873  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 11.084297180175781  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.17745065689086914  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

pseudo mini batch 1 input nodes size: 45121
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.17470264434814453  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.17470264434814453  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.19621801376342773  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.19635677337646484  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.17668724060058594  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3190, 2: 2890, 3: 2231, 4: 1790, 5: 1417, 6: 1102, 7: 905, 8: 757, 9: 637, 25: 591, 10: 519, 11: 411, 12: 379, 13: 300, 14: 251, 15: 233, 16: 176, 17: 153, 18: 134, 19: 128, 20: 89, 21: 84, 22: 74, 23: 72, 24: 69})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.1796436309814453  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.1796436309814453  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 8.421860218048096  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 8.424748420715332  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.18164825439453125  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

pseudo mini batch 2 input nodes size: 68358
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.1791396141052246  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.1791396141052246  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.2123427391052246  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.2124795913696289  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.1908254623413086  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2828, 2: 2439, 3: 2032, 4: 1601, 5: 1373, 25: 1225, 6: 1035, 7: 863, 8: 787, 9: 626, 10: 560, 11: 421, 12: 381, 13: 351, 14: 300, 15: 272, 16: 219, 17: 185, 18: 167, 19: 145, 20: 140, 22: 107, 21: 106, 23: 80, 24: 76})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.19462203979492188  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.19462203979492188  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 10.25202751159668  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 10.254805088043213  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.19816112518310547  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

pseudo mini batch 3 input nodes size: 94160
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.19452524185180664  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.19452524185180664  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.2394242286682129  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.23955678939819336  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.20621681213378906  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2960, 2: 2490, 25: 2080, 3: 1800, 4: 1335, 5: 1207, 6: 905, 7: 704, 8: 588, 9: 513, 10: 452, 11: 399, 12: 317, 13: 267, 14: 233, 15: 219, 17: 186, 16: 186, 18: 173, 19: 160, 20: 147, 21: 132, 24: 108, 22: 104, 23: 81})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.21229124069213867  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.21229124069213867  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 12.102322578430176  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 12.105775356292725  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.21621370315551758  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

pseudo mini batch 4 input nodes size: 89208
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.20909690856933594  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.20909690856933594  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.2516345977783203  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.2517671585083008  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.20673561096191406  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 3959, 1: 2211, 2: 1801, 3: 1397, 4: 1108, 5: 958, 6: 746, 7: 646, 8: 542, 9: 496, 10: 451, 11: 397, 12: 392, 13: 327, 14: 277, 15: 260, 16: 258, 18: 244, 17: 222, 19: 220, 20: 214, 21: 203, 23: 154, 24: 151, 22: 139})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.2134256362915039  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.2134256362915039  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 15.651643753051758  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 15.654329776763916  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.21886634826660156  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.21886634826660156  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.18581199645996094  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.11841874122619629 |0.007221364974975586 |0.22244935035705565 |0.00013918876647949218 |0.5097497463226318 |0.004775524139404297 |
----------------------------------------------------------pseudo_mini_loss sum 18.43211555480957
Total (block generation + training)time/epoch 54.55702793598175
Training time/epoch 4.475482702255249
Training time without block to device /epoch 4.439375877380371
Training time without total dataloading part /epoch 3.6664669513702393
load block tensor time/epoch 0.5920937061309814
block to device time/epoch 0.03610682487487793
input features size transfer per epoch 7.450580596923828e-07
blocks size to device per epoch 4.0978193283081055e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  547687
Number of first layer input nodes during this epoch:  336637
Number of first layer output nodes during this epoch:  211050
----------------------------------------before generate dataloader block 
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.1727290153503418  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.509 seconds, peak memory: 45.019 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.019 GB
Metis partitioning: 5.244 seconds, peak memory: 45.019 GB
Split the graph: 13.395 seconds
Construct subgraphs: 0.013 seconds
REG metis partition end ----................................
REG construction  time spent:  24.233837842941284
pure dgl.metis_partition the time spent:  20.189671516418457
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7801713943481445

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.357311725616455

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.1727290153503418  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

connection checking time:  1.3527858257293701
block generation total time  2.1374831199645996
average batch blocks generation time:  0.42749662399291993
block dataloader generation time/epoch 49.22169431050619
pseudo mini batch 0 input nodes size: 42119
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.1654348373413086  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.1654348373413086  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.18551874160766602  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.18565654754638672  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.14298629760742188  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2530, 2: 2199, 3: 1889, 4: 1540, 25: 1403, 5: 1311, 6: 1080, 7: 908, 8: 775, 9: 652, 10: 618, 11: 535, 12: 428, 13: 378, 14: 338, 15: 285, 16: 261, 17: 259, 18: 198, 20: 197, 19: 173, 21: 161, 24: 113, 23: 112, 22: 105})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.1465439796447754  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.1465439796447754  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 10.406819343566895  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 10.409658432006836  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.1776442527770996  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

pseudo mini batch 1 input nodes size: 47832
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.17493438720703125  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.17493438720703125  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.19837188720703125  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.19851016998291016  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.17828845977783203  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2889, 2: 2728, 3: 2137, 4: 1728, 5: 1406, 6: 1109, 7: 958, 8: 776, 25: 759, 9: 669, 10: 530, 11: 455, 12: 395, 13: 337, 14: 281, 15: 240, 16: 186, 17: 174, 18: 157, 19: 137, 21: 111, 20: 104, 22: 101, 23: 82, 24: 74})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.1814436912536621  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.1814436912536621  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 9.024040699005127  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 9.02683162689209  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.1836867332458496  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

pseudo mini batch 2 input nodes size: 66481
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.18103408813476562  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.18103408813476562  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.21273469924926758  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.21287059783935547  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.18929481506347656  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2989, 2: 2538, 3: 2059, 4: 1598, 5: 1347, 25: 1118, 6: 1048, 7: 844, 8: 745, 9: 586, 10: 506, 11: 406, 12: 370, 13: 325, 14: 281, 15: 251, 16: 210, 17: 184, 18: 148, 20: 144, 19: 140, 21: 105, 22: 93, 24: 76, 23: 70})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.19287443161010742  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.19287443161010742  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 9.708171367645264  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 9.710962295532227  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.19567441940307617  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

pseudo mini batch 3 input nodes size: 84246
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.19230365753173828  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.19230365753173828  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.23247528076171875  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.23261070251464844  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.2007741928100586  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 4274, 1: 2143, 2: 1757, 3: 1375, 4: 1127, 5: 966, 6: 721, 7: 621, 8: 524, 9: 511, 10: 473, 11: 416, 12: 391, 13: 345, 15: 293, 14: 292, 16: 268, 18: 249, 17: 243, 19: 234, 20: 221, 21: 214, 23: 164, 24: 159, 22: 151})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.2073202133178711  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.75732421875 GB
    Memory Allocated: 0.2073202133178711  GigaBytes
Max Memory Allocated: 16.91460609436035  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.49560546875 GB
    Memory Allocated: 16.278417110443115  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.49560546875 GB
    Memory Allocated: 16.28116798400879  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.2131643295288086  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

pseudo mini batch 4 input nodes size: 87520
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.2056570053100586  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.2056570053100586  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.2473897933959961  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.24752140045166016  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.20721435546875  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2877, 2: 2484, 25: 1906, 3: 1817, 4: 1327, 5: 1192, 6: 910, 7: 714, 8: 652, 9: 558, 10: 472, 11: 391, 12: 353, 13: 271, 14: 242, 15: 220, 18: 196, 16: 186, 17: 170, 19: 152, 20: 141, 21: 126, 22: 106, 24: 103, 23: 91})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.21243000030517578  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.21243000030517578  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 11.638023376464844  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 11.640736103057861  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.21711444854736328  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.21711444854736328  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.18406009674072266  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.12005648612976075 |0.007063102722167969 |0.27440671920776366 |0.00013022422790527345 |0.4900864601135254 |0.002614259719848633 |
----------------------------------------------------------pseudo_mini_loss sum 8.511661529541016
Total (block generation + training)time/epoch 54.13123893737793
Training time/epoch 4.644361257553101
Training time without block to device /epoch 4.609045743942261
Training time without total dataloading part /epoch 3.8257312774658203
load block tensor time/epoch 0.6002824306488037
block to device time/epoch 0.035315513610839844
input features size transfer per epoch 7.450580596923828e-07
blocks size to device per epoch 4.0978193283081055e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  533538
Number of first layer input nodes during this epoch:  328198
Number of first layer output nodes during this epoch:  205340
----------------------------------------before generate dataloader block 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.16971921920776367  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.444 seconds, peak memory: 45.024 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.024 GB
Metis partitioning: 5.048 seconds, peak memory: 45.024 GB
Split the graph: 11.194 seconds
Construct subgraphs: 0.007 seconds
REG metis partition end ----................................
REG construction  time spent:  23.32151174545288
pure dgl.metis_partition the time spent:  17.721426963806152
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7761030197143555

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.3015141487121582

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.16971921920776367  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

connection checking time:  1.3117039203643799
block generation total time  2.0776171684265137
average batch blocks generation time:  0.41552343368530276
block dataloader generation time/epoch 48.19346326589584
pseudo mini batch 0 input nodes size: 47079
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.163238525390625  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.163238525390625  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.18568754196166992  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.18582582473754883  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.14396142959594727  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3176, 2: 2848, 3: 2231, 4: 1729, 5: 1401, 6: 1113, 7: 910, 8: 746, 25: 645, 9: 611, 10: 529, 11: 419, 12: 387, 13: 297, 14: 250, 15: 238, 16: 177, 17: 161, 18: 148, 19: 124, 20: 94, 21: 91, 22: 75, 23: 69, 24: 68})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.14696693420410156  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.14696693420410156  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 8.513979434967041  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 8.517451763153076  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.179046630859375  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

pseudo mini batch 1 input nodes size: 41412
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.1764841079711914  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.1764841079711914  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.19623088836669922  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.1963663101196289  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.17377901077270508  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2299, 2: 2083, 3: 1826, 25: 1496, 4: 1459, 5: 1257, 6: 1054, 7: 913, 8: 793, 9: 672, 10: 613, 11: 566, 12: 432, 13: 396, 14: 357, 15: 292, 17: 267, 16: 256, 20: 212, 18: 208, 21: 179, 19: 177, 23: 118, 22: 117, 24: 116})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.1774125099182129  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.1774125099182129  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 10.707814693450928  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 10.710660934448242  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.17997980117797852  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

pseudo mini batch 2 input nodes size: 67138
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.17722702026367188  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.17722702026367188  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.20924091339111328  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.2093796730041504  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.1894974708557129  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2817, 2: 2421, 3: 1980, 4: 1651, 5: 1376, 25: 1307, 6: 1055, 7: 874, 8: 797, 9: 663, 10: 543, 11: 424, 12: 413, 13: 358, 14: 313, 15: 274, 16: 229, 17: 192, 18: 182, 19: 155, 20: 145, 22: 119, 21: 113, 23: 93, 24: 86})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.19337701797485352  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.19337701797485352  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 10.484336853027344  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 10.487671375274658  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.1967301368713379  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

pseudo mini batch 3 input nodes size: 84797
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.1930832862854004  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.1930832862854004  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.23351764678955078  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.23365068435668945  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.20149803161621094  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 3974, 1: 2214, 2: 1815, 3: 1440, 4: 1100, 5: 956, 6: 755, 7: 623, 8: 520, 9: 494, 10: 453, 11: 397, 12: 391, 13: 337, 14: 276, 15: 270, 16: 260, 17: 239, 18: 234, 19: 218, 20: 207, 21: 206, 23: 153, 24: 147, 22: 144})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.20777320861816406  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.28857421875 GB
    Memory Allocated: 0.20777320861816406  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 15.527437210083008  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 15.530184268951416  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.21256256103515625  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

pseudo mini batch 4 input nodes size: 89502
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.20581722259521484  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.20581722259521484  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.24849510192871094  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.2486281394958496  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.20806074142456055  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2922, 2: 2539, 25: 2038, 3: 1800, 4: 1381, 5: 1232, 6: 891, 7: 725, 8: 616, 9: 536, 10: 461, 11: 397, 12: 314, 13: 268, 14: 238, 15: 215, 16: 189, 18: 176, 17: 171, 19: 162, 20: 149, 21: 128, 24: 108, 22: 101, 23: 86})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.2133173942565918  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.2133173942565918  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 11.923232555389404  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 11.9259033203125  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.21806573867797852  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.21806573867797852  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.1850113868713379  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.11997885704040527 |0.005724859237670898 |0.22516555786132814 |0.00015053749084472656 |0.5102390289306641 |0.004996061325073242 |
----------------------------------------------------------pseudo_mini_loss sum 4.493980884552002
Total (block generation + training)time/epoch 52.99667817354202
Training time/epoch 4.483944654464722
Training time without block to device /epoch 4.455320358276367
Training time without total dataloading part /epoch 3.682771682739258
load block tensor time/epoch 0.5998942852020264
block to device time/epoch 0.028624296188354492
input features size transfer per epoch 7.450580596923828e-07
blocks size to device per epoch 4.0978193283081055e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  537075
Number of first layer input nodes during this epoch:  329928
Number of first layer output nodes during this epoch:  207147
----------------------------------------before generate dataloader block 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.1707286834716797  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.450 seconds, peak memory: 45.024 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.024 GB
Metis partitioning: 4.980 seconds, peak memory: 45.024 GB
Split the graph: 11.191 seconds
Construct subgraphs: 0.016 seconds
REG metis partition end ----................................
REG construction  time spent:  24.879767179489136
pure dgl.metis_partition the time spent:  17.66458773612976
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7193703651428223

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.3530750274658203

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.1707286834716797  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

connection checking time:  1.3257169723510742
block generation total time  2.0724453926086426
average batch blocks generation time:  0.4144890785217285
block dataloader generation time/epoch 47.881985330581664
pseudo mini batch 0 input nodes size: 43929
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.16424131393432617  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.16424131393432617  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.18572568893432617  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.18586397171020508  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.1430530548095703  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2511, 2: 2248, 3: 1962, 4: 1533, 25: 1433, 5: 1298, 6: 1077, 7: 896, 8: 771, 9: 641, 10: 607, 11: 527, 12: 420, 13: 375, 14: 344, 15: 284, 17: 268, 16: 252, 18: 204, 20: 199, 19: 178, 21: 166, 23: 115, 24: 111, 22: 108})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.14667272567749023  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.14667272567749023  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 10.557063102722168  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 10.560195922851562  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.17915582656860352  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

pseudo mini batch 1 input nodes size: 49491
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.1763443946838379  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.1763443946838379  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.19994354248046875  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.20008182525634766  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.17845916748046875  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2791, 2: 2541, 3: 2036, 4: 1673, 5: 1348, 6: 1067, 25: 943, 7: 928, 8: 823, 9: 701, 10: 548, 11: 502, 12: 434, 13: 352, 14: 288, 15: 266, 16: 214, 17: 184, 18: 171, 19: 151, 20: 132, 21: 126, 22: 110, 23: 100, 24: 79})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.18184137344360352  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.18184137344360352  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 9.597700119018555  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 9.60064172744751  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.18462419509887695  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

pseudo mini batch 2 input nodes size: 67541
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.18175363540649414  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.18175363540649414  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.2139596939086914  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.2140960693359375  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.19035863876342773  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2951, 2: 2614, 3: 2079, 4: 1642, 5: 1406, 25: 1057, 6: 1029, 7: 871, 8: 739, 9: 607, 10: 543, 11: 378, 12: 366, 13: 322, 14: 297, 15: 257, 16: 206, 17: 183, 18: 165, 19: 129, 20: 125, 21: 94, 22: 91, 24: 75, 23: 68})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.19395828247070312  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.19395828247070312  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 9.701997756958008  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 9.705137729644775  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.19650840759277344  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

pseudo mini batch 3 input nodes size: 88454
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.19306039810180664  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.19306039810180664  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.23523855209350586  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.23537254333496094  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.20303010940551758  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 4175, 1: 2119, 2: 1745, 3: 1389, 4: 1068, 5: 975, 6: 760, 7: 623, 8: 533, 9: 521, 10: 460, 11: 417, 12: 393, 13: 343, 14: 293, 15: 279, 16: 270, 18: 248, 19: 223, 17: 222, 21: 219, 20: 218, 24: 163, 23: 152, 22: 146})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.2096118927001953  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.2096118927001953  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 16.18216848373413  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 16.18486976623535  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.21493053436279297  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

pseudo mini batch 4 input nodes size: 92335
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.20776748657226562  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.20776748657226562  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.25179624557495117  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.25192785263061523  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.20961570739746094  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3056, 2: 2558, 25: 1852, 3: 1811, 4: 1404, 5: 1195, 6: 935, 7: 727, 8: 606, 9: 506, 10: 441, 11: 379, 12: 324, 13: 264, 14: 212, 15: 203, 17: 173, 16: 169, 18: 160, 19: 155, 20: 133, 21: 112, 22: 101, 24: 97, 23: 84})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.21476459503173828  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.21476459503173828  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 11.53056001663208  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 11.5332612991333  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.21949291229248047  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.21949291229248047  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.18643856048583984  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.12001862525939941 |0.005975770950317383 |0.21918754577636718 |0.00013213157653808595 |0.5072649478912353 |0.004828214645385742 |
----------------------------------------------------------pseudo_mini_loss sum 4.793200492858887
Total (block generation + training)time/epoch 52.61376924514771
Training time/epoch 4.445676803588867
Training time without block to device /epoch 4.41579794883728
Training time without total dataloading part /epoch 3.637751340866089
load block tensor time/epoch 0.6000931262969971
block to device time/epoch 0.029878854751586914
input features size transfer per epoch 7.450580596923828e-07
blocks size to device per epoch 4.0978193283081055e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  553835
Number of first layer input nodes during this epoch:  341750
Number of first layer output nodes during this epoch:  212085
----------------------------------------before generate dataloader block 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.1719808578491211  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.488 seconds, peak memory: 45.024 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.024 GB
Metis partitioning: 5.231 seconds, peak memory: 45.024 GB
Split the graph: 10.786 seconds
Construct subgraphs: 0.014 seconds
REG metis partition end ----................................
REG construction  time spent:  22.81801438331604
pure dgl.metis_partition the time spent:  17.547844409942627
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7779672145843506

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.3697590827941895

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.1719808578491211  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

connection checking time:  1.4103124141693115
block generation total time  2.14772629737854
average batch blocks generation time:  0.429545259475708
block dataloader generation time/epoch 47.3349863688151
pseudo mini batch 0 input nodes size: 50735
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.16549205780029297  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.16549205780029297  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.18968439102172852  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.18982267379760742  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.1456623077392578  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3036, 2: 2722, 3: 2117, 4: 1688, 5: 1385, 6: 1098, 7: 911, 25: 830, 8: 781, 9: 627, 10: 531, 11: 431, 12: 373, 13: 321, 14: 288, 15: 253, 16: 188, 17: 167, 18: 166, 19: 135, 21: 111, 23: 101, 20: 99, 22: 93, 24: 80})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.1489100456237793  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.1489100456237793  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 9.110544204711914  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 9.11331844329834  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.18116188049316406  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

pseudo mini batch 1 input nodes size: 40003
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.17834043502807617  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.17834043502807617  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.19787168502807617  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.19800949096679688  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.17367887496948242  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2337, 2: 2122, 3: 1855, 25: 1498, 4: 1495, 5: 1278, 6: 1085, 7: 944, 8: 790, 9: 697, 10: 617, 11: 569, 12: 445, 13: 407, 14: 356, 15: 294, 17: 269, 16: 267, 20: 212, 18: 212, 21: 179, 19: 175, 22: 120, 23: 116, 24: 115})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.17732620239257812  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.17732620239257812  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 10.7690749168396  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 10.771852493286133  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.1799764633178711  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

pseudo mini batch 2 input nodes size: 66981
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.17724895477294922  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.17724895477294922  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.20918798446655273  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.20932531356811523  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.18965625762939453  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2979, 2: 2567, 3: 2113, 4: 1674, 5: 1414, 25: 1043, 6: 1024, 7: 860, 8: 764, 9: 626, 10: 540, 11: 401, 12: 396, 13: 321, 14: 279, 15: 249, 16: 220, 17: 189, 18: 145, 19: 131, 20: 130, 21: 90, 22: 87, 24: 70, 23: 63})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.19327259063720703  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.19327259063720703  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 9.71302318572998  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 9.715793132781982  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.19644832611083984  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

pseudo mini batch 3 input nodes size: 91978
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.19296646118164062  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.19296646118164062  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.23682498931884766  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.23695802688598633  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.2048816680908203  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 3940, 1: 2172, 2: 1790, 3: 1419, 4: 1070, 5: 982, 6: 782, 7: 632, 9: 528, 8: 524, 10: 474, 11: 409, 12: 393, 13: 337, 14: 283, 15: 267, 16: 257, 18: 239, 17: 234, 20: 220, 19: 216, 21: 210, 23: 155, 24: 147, 22: 142})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.21135234832763672  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.21135234832763672  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 15.778053283691406  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 15.780934810638428  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.21645069122314453  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

pseudo mini batch 4 input nodes size: 95390
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.20931005477905273  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.20931005477905273  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.25479555130004883  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.2549281120300293  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.2109365463256836  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2904, 2: 2505, 25: 2149, 3: 1773, 4: 1393, 5: 1163, 6: 879, 7: 698, 8: 613, 9: 498, 10: 437, 11: 393, 12: 330, 13: 270, 14: 228, 15: 226, 18: 186, 19: 179, 16: 179, 17: 171, 20: 146, 21: 127, 22: 114, 24: 113, 23: 84})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.21622514724731445  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.21622514724731445  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 12.333493709564209  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 12.336271286010742  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.22085809707641602  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.22085809707641602  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.1878037452697754  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.1211735725402832 |0.005411195755004883 |0.22204666137695311 |0.00012536048889160155 |0.5057236671447753 |0.0016369819641113281 |
----------------------------------------------------------pseudo_mini_loss sum 5.6071953773498535
Total (block generation + training)time/epoch 52.01990123589834
Training time/epoch 4.4503173828125
Training time without block to device /epoch 4.423261404037476
Training time without total dataloading part /epoch 3.641115427017212
load block tensor time/epoch 0.605867862701416
block to device time/epoch 0.027055978775024414
input features size transfer per epoch 7.450580596923828e-07
blocks size to device per epoch 4.0978193283081055e-07
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  559740
Number of first layer input nodes during this epoch:  345087
Number of first layer output nodes during this epoch:  214653
----------------------------------------before generate dataloader block 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.17355918884277344  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.435 seconds, peak memory: 45.024 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.024 GB
Metis partitioning: 4.916 seconds, peak memory: 45.024 GB
Split the graph: 10.754 seconds
Construct subgraphs: 0.013 seconds
REG metis partition end ----................................
REG construction  time spent:  22.77174210548401
pure dgl.metis_partition the time spent:  17.146453142166138
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7583191394805908

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.3301258087158203

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.17355918884277344  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

connection checking time:  1.3412349224090576
block generation total time  2.088444948196411
average batch blocks generation time:  0.41768898963928225
block dataloader generation time/epoch 46.85897316251482
pseudo mini batch 0 input nodes size: 44392
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.16705942153930664  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.16705942153930664  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.18854379653930664  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.18868255615234375  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.1430644989013672  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2538, 2: 2236, 3: 1912, 4: 1552, 25: 1445, 5: 1310, 6: 1077, 7: 907, 8: 771, 9: 673, 10: 628, 11: 528, 12: 412, 13: 382, 14: 352, 15: 286, 17: 267, 16: 260, 20: 201, 18: 201, 19: 176, 21: 162, 23: 118, 24: 112, 22: 112})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.1467142105102539  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.1467142105102539  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 10.630747318267822  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 10.633689403533936  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.17908620834350586  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

pseudo mini batch 1 input nodes size: 49744
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.17624950408935547  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.17624950408935547  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.19996929168701172  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.20010805130004883  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.17848491668701172  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2834, 2: 2667, 3: 2104, 4: 1710, 5: 1381, 6: 1119, 7: 955, 25: 852, 8: 784, 9: 668, 10: 551, 11: 464, 12: 402, 13: 348, 14: 283, 15: 263, 16: 197, 18: 178, 17: 177, 19: 140, 21: 121, 20: 118, 22: 109, 23: 94, 24: 77})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.18180465698242188  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.18180465698242188  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 9.423480033874512  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 9.426299571990967  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.1845245361328125  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

pseudo mini batch 2 input nodes size: 68880
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.1816730499267578  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.1816730499267578  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.2148761749267578  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.2150120735168457  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.19115352630615234  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3031, 2: 2595, 3: 2050, 4: 1640, 5: 1390, 25: 1098, 6: 1012, 7: 827, 8: 755, 9: 589, 10: 496, 11: 395, 12: 394, 13: 313, 14: 284, 15: 241, 16: 205, 17: 178, 18: 138, 19: 137, 20: 121, 21: 94, 22: 89, 24: 80, 23: 72})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.19478654861450195  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.19478654861450195  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 9.71787405014038  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 9.720651626586914  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.19745588302612305  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

pseudo mini batch 3 input nodes size: 92715
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.19392633438110352  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.19392633438110352  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.23813629150390625  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.2382678985595703  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.20492887496948242  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2880, 2: 2424, 25: 2033, 3: 1805, 4: 1348, 5: 1193, 6: 932, 7: 716, 8: 641, 9: 519, 10: 448, 11: 413, 12: 327, 13: 255, 14: 229, 15: 215, 18: 184, 17: 183, 16: 181, 19: 164, 20: 156, 21: 131, 24: 104, 22: 95, 23: 81})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.20998048782348633  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.20998048782348633  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 12.01668643951416  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 12.020048141479492  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.21510648727416992  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

pseudo mini batch 4 input nodes size: 90118
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.20900678634643555  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.20900678634643555  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.25197839736938477  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.25211143493652344  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.20776987075805664  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 4032, 1: 2145, 2: 1784, 3: 1406, 4: 1070, 5: 948, 6: 728, 7: 640, 9: 527, 8: 521, 10: 476, 11: 403, 12: 402, 13: 358, 14: 286, 15: 284, 16: 268, 18: 247, 17: 225, 19: 219, 20: 211, 21: 209, 23: 154, 24: 152, 22: 151})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.21427488327026367  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.21427488327026367  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 15.919783592224121  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 15.922988414764404  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.21990251541137695  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.21990251541137695  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.18684816360473633  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.11847233772277832 |0.005244779586791992 |0.22057647705078126 |0.00013489723205566405 |0.508611536026001 |0.004766941070556641 |
----------------------------------------------------------pseudo_mini_loss sum 4.785427093505859
Total (block generation + training)time/epoch 51.50983837672642
Training time/epoch 4.446312665939331
Training time without block to device /epoch 4.420088768005371
Training time without total dataloading part /epoch 3.651381492614746
load block tensor time/epoch 0.5923616886138916
block to device time/epoch 0.02622389793395996
input features size transfer per epoch 7.450580596923828e-07
blocks size to device per epoch 4.0978193283081055e-07
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  559527
Number of first layer input nodes during this epoch:  345849
Number of first layer output nodes during this epoch:  213678
----------------------------------------before generate dataloader block 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.17383670806884766  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.541 seconds, peak memory: 45.024 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.024 GB
Metis partitioning: 5.519 seconds, peak memory: 45.024 GB
Split the graph: 13.421 seconds
Construct subgraphs: 0.036 seconds
REG metis partition end ----................................
REG construction  time spent:  25.062035083770752
pure dgl.metis_partition the time spent:  20.547023057937622
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.9937169551849365

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  2.03340482711792

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.17383670806884766  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

connection checking time:  1.7218017578125
block generation total time  3.0271217823028564
average batch blocks generation time:  0.6054243564605712
block dataloader generation time/epoch 47.411287277936935
pseudo mini batch 0 input nodes size: 41520
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.16625547409057617  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.16625547409057617  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.18605375289916992  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.18619203567504883  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.14308738708496094  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2414, 2: 2173, 3: 1871, 25: 1532, 4: 1511, 5: 1274, 6: 1078, 7: 918, 8: 773, 9: 658, 10: 607, 11: 543, 12: 439, 13: 383, 14: 356, 15: 290, 17: 272, 16: 269, 18: 216, 20: 203, 21: 183, 19: 173, 23: 125, 22: 121, 24: 117})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.1467423439025879  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.1467423439025879  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 10.754135608673096  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 10.75708532333374  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.1773819923400879  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

pseudo mini batch 1 input nodes size: 52267
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.17463350296020508  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.17463350296020508  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.1995563507080078  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.19969463348388672  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.17975807189941406  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2898, 2: 2577, 3: 2061, 4: 1679, 5: 1378, 6: 1078, 7: 929, 25: 911, 8: 799, 9: 658, 10: 595, 11: 479, 12: 421, 13: 342, 14: 279, 15: 261, 16: 196, 17: 179, 18: 150, 19: 144, 20: 133, 21: 110, 22: 95, 23: 81, 24: 74})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.18309545516967773  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.18309545516967773  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 9.406956195831299  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 9.40977954864502  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.1856827735900879  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

pseudo mini batch 2 input nodes size: 65109
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.18280601501464844  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.18280601501464844  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.2138524055480957  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.21398639678955078  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.18892526626586914  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3121, 2: 2754, 3: 2177, 4: 1699, 5: 1418, 6: 1035, 7: 814, 25: 753, 8: 707, 9: 606, 10: 464, 11: 368, 12: 323, 13: 301, 14: 246, 15: 217, 16: 174, 17: 151, 18: 143, 19: 122, 20: 100, 21: 72, 24: 71, 22: 69, 23: 68})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.19223785400390625  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.19223785400390625  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 8.816956043243408  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 8.819802284240723  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.19476985931396484  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

pseudo mini batch 3 input nodes size: 88472
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.1914987564086914  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.1914987564086914  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.23368549346923828  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.23381853103637695  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.2026381492614746  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2953, 2: 2510, 25: 1883, 3: 1798, 4: 1362, 5: 1177, 6: 935, 7: 765, 8: 665, 9: 535, 10: 448, 11: 396, 12: 351, 13: 269, 14: 259, 15: 230, 16: 200, 18: 180, 17: 167, 19: 162, 20: 150, 21: 129, 22: 112, 24: 105, 23: 76})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.20785856246948242  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.20785856246948242  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 11.663774967193604  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 11.666472434997559  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.21202945709228516  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

pseudo mini batch 4 input nodes size: 84681
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.20609140396118164  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.20609140396118164  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.24647045135498047  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.24660587310791016  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.2042860984802246  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 4381, 1: 2042, 2: 1692, 3: 1370, 4: 1069, 5: 975, 6: 742, 7: 619, 8: 528, 9: 519, 10: 485, 11: 417, 12: 403, 13: 361, 14: 294, 15: 291, 16: 272, 17: 261, 18: 259, 19: 235, 21: 223, 20: 221, 23: 169, 22: 159, 24: 158})

----------------------------------------after blocks to device 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.21094942092895508  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.30224609375 GB
    Memory Allocated: 0.21094942092895508  GigaBytes
Max Memory Allocated: 17.444820404052734  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.28076171875 GB
    Memory Allocated: 16.553268909454346  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.28076171875 GB
    Memory Allocated: 16.556004524230957  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.21707487106323242  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.21707487106323242  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.1840205192565918  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.11307058334350586 |0.008704137802124024 |0.2341646671295166 |0.00019435882568359376 |0.5074676513671875 |0.008888959884643555 |
----------------------------------------------------------pseudo_mini_loss sum 4.338465213775635
Total (block generation + training)time/epoch 52.04581889510155
Training time/epoch 4.519704580307007
Training time without block to device /epoch 4.476183891296387
Training time without total dataloading part /epoch 3.718022346496582
load block tensor time/epoch 0.5653529167175293
block to device time/epoch 0.04352068901062012
input features size transfer per epoch 7.450580596923828e-07
blocks size to device per epoch 4.0978193283081055e-07
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  539715
Number of first layer input nodes during this epoch:  332049
Number of first layer output nodes during this epoch:  207666
----------------------------------------before generate dataloader block 
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.1712808609008789  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.513 seconds, peak memory: 45.024 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.024 GB
Metis partitioning: 5.208 seconds, peak memory: 45.024 GB
Split the graph: 11.591 seconds
Construct subgraphs: 0.019 seconds
REG metis partition end ----................................
REG construction  time spent:  25.363133668899536
pure dgl.metis_partition the time spent:  18.3602397441864
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.9974007606506348

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.4582436084747314

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.1712808609008789  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

connection checking time:  1.4634912014007568
block generation total time  2.455644369125366
average batch blocks generation time:  0.49112887382507325
block dataloader generation time/epoch 47.520661698447334
pseudo mini batch 0 input nodes size: 49165
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.1635909080505371  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.1635909080505371  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.18703460693359375  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.18717288970947266  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.14665842056274414  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3074, 2: 2759, 3: 2143, 4: 1677, 5: 1357, 6: 1098, 7: 917, 8: 778, 25: 750, 9: 627, 10: 530, 11: 446, 12: 389, 13: 327, 15: 267, 14: 266, 16: 192, 17: 175, 19: 146, 18: 146, 20: 120, 21: 102, 22: 96, 23: 83, 24: 73})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.14983177185058594  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.14983177185058594  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 8.972475528717041  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 8.975295543670654  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.18050289154052734  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 1 input nodes size: 40228
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.17777729034423828  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.17777729034423828  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.19730854034423828  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.19744586944580078  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.17386388778686523  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2318, 2: 2110, 3: 1851, 25: 1544, 4: 1496, 5: 1275, 6: 1073, 7: 923, 8: 773, 9: 682, 10: 612, 11: 556, 12: 440, 13: 389, 14: 355, 15: 286, 17: 273, 16: 269, 18: 220, 20: 205, 21: 190, 19: 176, 23: 128, 22: 122, 24: 121})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.1775221824645996  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.1775221824645996  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 10.82176923751831  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 10.824779510498047  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.18012285232543945  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 2 input nodes size: 67574
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.1773996353149414  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.1773996353149414  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.20962142944335938  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.20975923538208008  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.19009065628051758  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2912, 2: 2548, 3: 2025, 4: 1659, 5: 1413, 25: 1138, 6: 1050, 7: 857, 8: 781, 9: 642, 10: 554, 11: 400, 12: 380, 13: 325, 14: 308, 15: 268, 16: 221, 17: 183, 18: 168, 19: 136, 20: 128, 21: 94, 22: 89, 24: 79, 23: 76})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.1938009262084961  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.1938009262084961  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 9.956175804138184  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 9.95912504196167  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.19669818878173828  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 3 input nodes size: 91522
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.19315052032470703  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.19315052032470703  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.23679161071777344  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.2369241714477539  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.20456457138061523  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2916, 2: 2507, 25: 2007, 3: 1830, 4: 1379, 5: 1206, 6: 890, 7: 726, 8: 629, 9: 536, 10: 442, 11: 406, 12: 335, 13: 281, 14: 226, 15: 201, 18: 180, 17: 168, 16: 168, 19: 157, 20: 139, 21: 129, 22: 107, 24: 105, 23: 77})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.20979595184326172  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.20979595184326172  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 11.919710636138916  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 11.922526359558105  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.21436691284179688  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 4 input nodes size: 87736
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.2078847885131836  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.2078847885131836  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.24972057342529297  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.24985361099243164  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.20607995986938477  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 4021, 1: 2208, 2: 1782, 3: 1428, 4: 1109, 5: 971, 6: 757, 7: 622, 8: 511, 9: 489, 10: 461, 11: 395, 12: 393, 13: 334, 14: 279, 15: 267, 16: 261, 18: 234, 17: 231, 19: 221, 20: 215, 21: 202, 23: 155, 24: 147, 22: 142})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.21247434616088867  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.21247434616088867  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 15.71894645690918  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 15.721834659576416  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.21773004531860352  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.21773004531860352  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.1846756935119629  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.11447658538818359 |0.005754327774047852 |0.2233656883239746 |0.00014371871948242186 |0.5077342510223388 |0.0051555633544921875 |
----------------------------------------------------------pseudo_mini_loss sum 3.808333158493042
Total (block generation + training)time/epoch 52.13466747601827
Training time/epoch 4.449464559555054
Training time without block to device /epoch 4.4206929206848145
Training time without total dataloading part /epoch 3.6613738536834717
load block tensor time/epoch 0.572382926940918
block to device time/epoch 0.028771638870239258
input features size transfer per epoch 7.450580596923828e-07
blocks size to device per epoch 4.0978193283081055e-07
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  546078
Number of first layer input nodes during this epoch:  336225
Number of first layer output nodes during this epoch:  209853
----------------------------------------before generate dataloader block 
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.171630859375  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.539 seconds, peak memory: 45.416 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.416 GB
Metis partitioning: 5.530 seconds, peak memory: 45.416 GB
Split the graph: 12.746 seconds
Construct subgraphs: 0.042 seconds
REG metis partition end ----................................
REG construction  time spent:  24.95797038078308
pure dgl.metis_partition the time spent:  19.895082712173462
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.8082079887390137

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.5140659809112549

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.171630859375  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

connection checking time:  1.3941981792449951
block generation total time  2.3222739696502686
average batch blocks generation time:  0.46445479393005373
block dataloader generation time/epoch 47.7040901184082
pseudo mini batch 0 input nodes size: 55684
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.1646747589111328  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.1646747589111328  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.19122695922851562  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.19136571884155273  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.1493968963623047  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2690, 2: 2563, 3: 2055, 4: 1685, 5: 1380, 6: 1057, 25: 1038, 7: 923, 8: 818, 9: 666, 10: 554, 11: 485, 12: 437, 13: 360, 14: 306, 15: 285, 16: 196, 18: 191, 17: 179, 19: 149, 20: 130, 21: 125, 22: 117, 23: 88, 24: 86})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.15293407440185547  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.15293407440185547  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 9.842495441436768  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 9.84540319442749  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.18452978134155273  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 1 input nodes size: 41366
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.18142080307006836  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.18142080307006836  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.20114564895629883  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.2012791633605957  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.17458820343017578  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2350, 2: 2154, 3: 1850, 4: 1471, 25: 1385, 5: 1251, 6: 1050, 7: 920, 8: 728, 9: 636, 10: 600, 11: 511, 12: 403, 13: 371, 14: 349, 15: 271, 17: 263, 16: 257, 20: 203, 18: 199, 19: 167, 21: 158, 23: 115, 24: 110, 22: 109})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.17807865142822266  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.17807865142822266  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 10.245903015136719  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 10.248749256134033  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.1805715560913086  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 2 input nodes size: 65619
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.17791032791137695  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.17791032791137695  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.2091999053955078  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.20933818817138672  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.18947982788085938  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3297, 2: 2672, 3: 2133, 4: 1634, 5: 1411, 6: 1083, 25: 979, 7: 830, 8: 773, 9: 615, 10: 485, 11: 376, 12: 356, 13: 306, 14: 267, 15: 233, 16: 197, 17: 172, 18: 130, 19: 127, 20: 117, 21: 90, 23: 81, 22: 77, 24: 66})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.19299554824829102  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.19299554824829102  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 9.507948875427246  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 9.51072645187378  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.19620656967163086  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 3 input nodes size: 86176
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.19280338287353516  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.19280338287353516  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.23389530181884766  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.23402690887451172  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.20259904861450195  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3021, 2: 2545, 3: 1834, 25: 1820, 4: 1384, 5: 1197, 6: 894, 7: 728, 8: 619, 9: 529, 10: 469, 11: 402, 12: 318, 13: 263, 14: 222, 15: 206, 16: 193, 18: 174, 17: 170, 19: 155, 20: 137, 21: 121, 22: 94, 24: 90, 23: 72})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.2077479362487793  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.2077479362487793  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 11.303284168243408  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 11.306122779846191  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.21202516555786133  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 4 input nodes size: 84445
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.20557451248168945  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.20557451248168945  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.24584102630615234  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.24597787857055664  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.20475435256958008  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 4238, 1: 2070, 2: 1772, 3: 1405, 4: 1146, 5: 983, 6: 784, 7: 644, 8: 534, 9: 530, 10: 491, 11: 429, 12: 423, 13: 356, 15: 294, 14: 290, 16: 268, 18: 254, 17: 246, 19: 238, 21: 223, 20: 220, 24: 173, 23: 163, 22: 159})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.21132802963256836  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.08935546875 GB
    Memory Allocated: 0.21132802963256836  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 16.375736713409424  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 16.378575325012207  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.21712827682495117  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.21712827682495117  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.18364667892456055  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.11997742652893066 |0.007415866851806641 |0.22543859481811523 |0.00017161369323730468 |0.5076048851013184 |0.005476236343383789 |
----------------------------------------------------------pseudo_mini_loss sum 4.037278175354004
Total (block generation + training)time/epoch 52.30592594146729
Training time/epoch 4.491985082626343
Training time without block to device /epoch 4.45490574836731
Training time without total dataloading part /epoch 3.6715517044067383
load block tensor time/epoch 0.5998871326446533
block to device time/epoch 0.0370793342590332
input features size transfer per epoch 7.450580596923828e-07
blocks size to device per epoch 4.0978193283081055e-07
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  540676
Number of first layer input nodes during this epoch:  333290
Number of first layer output nodes during this epoch:  207386
----------------------------------------before generate dataloader block 
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.17085790634155273  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.497 seconds, peak memory: 45.566 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.566 GB
Metis partitioning: 5.381 seconds, peak memory: 45.566 GB
Split the graph: 12.655 seconds
Construct subgraphs: 0.010 seconds
REG metis partition end ----................................
REG construction  time spent:  27.172512531280518
pure dgl.metis_partition the time spent:  19.57753086090088
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.278505563735962

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.425905466079712

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.17085790634155273  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

connection checking time:  1.3943061828613281
block generation total time  2.704411029815674
average batch blocks generation time:  0.5408822059631347
block dataloader generation time/epoch 48.065965457396075
pseudo mini batch 0 input nodes size: 40980
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.16378450393676758  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.16378450393676758  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.18332529067993164  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.18346166610717773  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.14305830001831055  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2339, 2: 2123, 3: 1845, 25: 1528, 4: 1476, 5: 1280, 6: 1069, 7: 921, 8: 763, 9: 665, 10: 603, 11: 533, 12: 432, 13: 387, 14: 361, 15: 290, 17: 272, 16: 269, 18: 220, 20: 204, 21: 182, 19: 178, 23: 126, 22: 119, 24: 119})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.14669561386108398  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.14669561386108398  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 10.693012237548828  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 10.696187019348145  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.17717552185058594  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 1 input nodes size: 49853
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.17445135116577148  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.17445135116577148  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.19822311401367188  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.19836091995239258  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.17868375778198242  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3085, 2: 2748, 3: 2138, 4: 1740, 5: 1386, 6: 1109, 7: 936, 8: 788, 25: 680, 9: 644, 10: 523, 11: 434, 12: 375, 13: 322, 15: 261, 14: 259, 16: 170, 17: 168, 18: 147, 19: 120, 20: 110, 21: 93, 22: 88, 23: 79, 24: 71})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.18178176879882812  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.18178176879882812  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 8.78442907333374  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 8.78734016418457  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.1842632293701172  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 2 input nodes size: 68591
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.1815943717956543  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.1815943717956543  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.2147974967956543  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.214935302734375  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.1910257339477539  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2865, 2: 2484, 3: 2025, 4: 1628, 5: 1370, 25: 1254, 6: 1035, 7: 856, 8: 763, 9: 632, 10: 564, 11: 429, 12: 410, 13: 346, 14: 312, 15: 258, 16: 221, 17: 185, 18: 158, 19: 157, 20: 139, 21: 113, 22: 103, 24: 86, 23: 76})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.19482088088989258  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.19482088088989258  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 10.280487060546875  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 10.283493518829346  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.19773626327514648  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 3 input nodes size: 85536
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.19414663314819336  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.19414663314819336  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.23493337631225586  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.23506498336791992  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.20172405242919922  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3066, 2: 2623, 3: 1885, 25: 1700, 4: 1409, 5: 1225, 6: 905, 7: 722, 8: 627, 9: 522, 10: 433, 11: 382, 12: 321, 13: 261, 14: 211, 15: 190, 16: 177, 17: 172, 18: 170, 19: 152, 20: 133, 21: 112, 22: 97, 24: 91, 23: 71})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.2068157196044922  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.2068157196044922  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 11.053422451019287  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 11.056291580200195  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.2112579345703125  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 4 input nodes size: 83979
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.20478391647338867  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.20478391647338867  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.2448282241821289  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.2449626922607422  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.20404434204101562  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 4298, 1: 2073, 2: 1728, 3: 1384, 4: 1067, 5: 961, 6: 750, 7: 610, 8: 531, 9: 513, 10: 476, 11: 425, 12: 399, 13: 340, 14: 291, 15: 290, 16: 274, 18: 253, 17: 233, 19: 229, 20: 221, 21: 217, 23: 167, 24: 158, 22: 149})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.2106156349182129  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.2106156349182129  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 16.345801830291748  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 16.348556518554688  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.2171320915222168  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.2171320915222168  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.18407773971557617  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.12025861740112305 |0.008195066452026367 |0.21943154335021972 |0.00016069412231445312 |0.5056854724884033 |0.00631260871887207 |
----------------------------------------------------------pseudo_mini_loss sum 3.529238700866699
Total (block generation + training)time/epoch 52.65513684532859
Training time/epoch 4.462085247039795
Training time without block to device /epoch 4.421109914779663
Training time without total dataloading part /epoch 3.6327011585235596
load block tensor time/epoch 0.6012930870056152
block to device time/epoch 0.040975332260131836
input features size transfer per epoch 7.450580596923828e-07
blocks size to device per epoch 4.0978193283081055e-07
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  534558
Number of first layer input nodes during this epoch:  328939
Number of first layer output nodes during this epoch:  205619
----------------------------------------before generate dataloader block 
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.1712632179260254  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.446 seconds, peak memory: 45.691 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.691 GB
Metis partitioning: 4.953 seconds, peak memory: 45.691 GB
Split the graph: 11.239 seconds
Construct subgraphs: 0.018 seconds
REG metis partition end ----................................
REG construction  time spent:  26.684849500656128
pure dgl.metis_partition the time spent:  17.685627460479736
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7475202083587646

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.3908634185791016

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.1712632179260254  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

connection checking time:  1.3677308559417725
block generation total time  2.138383626937866
average batch blocks generation time:  0.42767672538757323
block dataloader generation time/epoch 48.109378695487976
pseudo mini batch 0 input nodes size: 50837
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.16349267959594727  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.16349267959594727  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.18773365020751953  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.18787240982055664  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.14769363403320312  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3009, 2: 2697, 3: 2060, 4: 1705, 5: 1372, 6: 1099, 7: 901, 25: 870, 8: 797, 9: 654, 10: 534, 11: 427, 12: 396, 13: 330, 14: 283, 15: 270, 16: 186, 17: 175, 18: 158, 19: 142, 20: 122, 21: 108, 22: 97, 23: 94, 24: 79})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.1509857177734375  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.1509857177734375  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 9.250470638275146  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 9.253408908843994  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.1814441680908203  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 1 input nodes size: 40709
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.17859268188476562  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.17859268188476562  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.19812393188476562  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.19826221466064453  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.17388248443603516  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2263, 2: 2132, 3: 1903, 4: 1523, 25: 1484, 5: 1293, 6: 1095, 7: 944, 8: 801, 9: 696, 10: 629, 11: 575, 12: 455, 13: 410, 14: 365, 15: 301, 17: 274, 16: 270, 18: 222, 20: 214, 19: 180, 21: 178, 22: 121, 23: 116, 24: 114})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.17756414413452148  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.17756414413452148  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 10.88800859451294  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 10.890946388244629  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.18036794662475586  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 2 input nodes size: 69295
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.17760515213012695  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.17760515213012695  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.21080827713012695  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.21094369888305664  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.19127416610717773  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3045, 2: 2595, 3: 2112, 4: 1612, 5: 1384, 25: 1074, 6: 1024, 7: 851, 8: 727, 9: 581, 10: 507, 11: 385, 12: 370, 13: 289, 14: 285, 15: 225, 16: 200, 17: 177, 18: 140, 19: 128, 20: 113, 21: 93, 22: 93, 24: 76, 23: 73})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.1948866844177246  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.1948866844177246  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 9.621647834777832  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 9.624642848968506  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.19759321212768555  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 3 input nodes size: 92514
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.19404935836791992  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.19404935836791992  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.23816347122192383  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.2382969856262207  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.20495843887329102  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2880, 2: 2490, 25: 2058, 3: 1811, 4: 1383, 5: 1202, 6: 889, 7: 735, 8: 615, 9: 543, 10: 456, 11: 422, 12: 328, 13: 283, 14: 238, 15: 221, 16: 201, 18: 188, 17: 177, 19: 169, 20: 152, 21: 126, 24: 110, 22: 105, 23: 78})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.2100825309753418  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.2100825309753418  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 12.15482473373413  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 12.157486915588379  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.21442747116088867  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 4 input nodes size: 88842
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.20828628540039062  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.20828628540039062  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.25064945220947266  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.25078248977661133  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.20653486251831055  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 3974, 1: 2231, 2: 1792, 3: 1391, 4: 1097, 5: 971, 6: 761, 7: 614, 8: 532, 9: 502, 10: 473, 11: 394, 12: 388, 13: 344, 15: 272, 14: 263, 16: 254, 18: 240, 17: 227, 19: 217, 21: 212, 20: 206, 23: 158, 24: 146, 22: 140})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.21289587020874023  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.09521484375 GB
    Memory Allocated: 0.21289587020874023  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.11279296875 GB
    Memory Allocated: 15.620622158050537  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.11279296875 GB
    Memory Allocated: 15.623284339904785  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.11279296875 GB
    Memory Allocated: 0.21933984756469727  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.11279296875 GB
    Memory Allocated: 0.21933984756469727  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.11279296875 GB
    Memory Allocated: 0.18628549575805664  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.11967759132385254 |0.0066890716552734375 |0.21809611320495606 |0.00012722015380859376 |0.5098982334136963 |0.0021066665649414062 |
----------------------------------------------------------pseudo_mini_loss sum 3.5634241104125977
Total (block generation + training)time/epoch 52.68691384792328
Training time/epoch 4.449281215667725
Training time without block to device /epoch 4.415835857391357
Training time without total dataloading part /epoch 3.642714500427246
load block tensor time/epoch 0.5983879566192627
block to device time/epoch 0.03344535827636719
input features size transfer per epoch 7.450580596923828e-07
blocks size to device per epoch 4.0978193283081055e-07
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  554515
Number of first layer input nodes during this epoch:  342197
Number of first layer output nodes during this epoch:  212318
----------------------------------------before generate dataloader block 
 Nvidia-smi: 22.11279296875 GB
    Memory Allocated: 0.17320537567138672  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.467 seconds, peak memory: 45.691 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.691 GB
Metis partitioning: 4.989 seconds, peak memory: 45.691 GB
Split the graph: 12.304 seconds
Construct subgraphs: 0.020 seconds
REG metis partition end ----................................
REG construction  time spent:  23.88642930984497
pure dgl.metis_partition the time spent:  18.806983470916748
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7533202171325684

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.3041982650756836

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.11279296875 GB
    Memory Allocated: 0.17320537567138672  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

connection checking time:  1.3241143226623535
block generation total time  2.057518482208252
average batch blocks generation time:  0.4115036964416504
block dataloader generation time/epoch 48.0107524394989
pseudo mini batch 0 input nodes size: 40961
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.11279296875 GB
    Memory Allocated: 0.16572904586791992  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.11279296875 GB
    Memory Allocated: 0.16572904586791992  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.11279296875 GB
    Memory Allocated: 0.1858658790588379  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.11279296875 GB
    Memory Allocated: 0.186004638671875  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.11279296875 GB
    Memory Allocated: 0.1435084342956543  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2292, 2: 2096, 3: 1805, 25: 1619, 4: 1481, 5: 1270, 6: 1082, 7: 927, 8: 801, 9: 698, 10: 624, 11: 592, 12: 466, 13: 410, 14: 364, 15: 314, 17: 280, 16: 266, 18: 221, 20: 215, 19: 187, 21: 187, 23: 131, 22: 127, 24: 125})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.11279296875 GB
    Memory Allocated: 0.1472640037536621  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.11279296875 GB
    Memory Allocated: 0.1472640037536621  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.11279296875 GB
    Memory Allocated: 11.081566333770752  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.11279296875 GB
    Memory Allocated: 11.084622859954834  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.11279296875 GB
    Memory Allocated: 0.17785024642944336  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 1 input nodes size: 44605
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.11279296875 GB
    Memory Allocated: 0.1750621795654297  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.11279296875 GB
    Memory Allocated: 0.1750621795654297  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.11279296875 GB
    Memory Allocated: 0.1965465545654297  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.11279296875 GB
    Memory Allocated: 0.19668197631835938  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.11279296875 GB
    Memory Allocated: 0.1764063835144043  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3266, 2: 2904, 3: 2258, 4: 1757, 5: 1394, 6: 1062, 7: 867, 8: 731, 9: 590, 10: 494, 25: 492, 11: 360, 12: 339, 13: 280, 14: 244, 15: 215, 16: 170, 17: 132, 18: 129, 19: 100, 20: 84, 21: 73, 22: 68, 23: 57, 24: 55})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.11279296875 GB
    Memory Allocated: 0.17917776107788086  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.11279296875 GB
    Memory Allocated: 0.17917776107788086  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 7.931686878204346  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 7.934479713439941  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.18131208419799805  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 2 input nodes size: 64990
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.1789412498474121  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.1789412498474121  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.2099308967590332  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.2100696563720703  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.18844985961914062  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2863, 2: 2484, 3: 2031, 4: 1610, 5: 1417, 25: 1252, 6: 1059, 7: 884, 8: 789, 9: 632, 10: 553, 11: 427, 12: 410, 13: 343, 14: 299, 15: 266, 16: 223, 17: 206, 18: 161, 19: 161, 20: 138, 21: 111, 22: 101, 24: 86, 23: 84})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.19220256805419922  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.19220256805419922  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 10.30250358581543  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 10.30529260635376  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.19539737701416016  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 3 input nodes size: 89308
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.19192886352539062  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.19192886352539062  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.2345142364501953  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.23464584350585938  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.20351743698120117  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2860, 2: 2473, 25: 1970, 3: 1792, 4: 1389, 5: 1175, 6: 905, 7: 733, 8: 615, 9: 530, 10: 454, 11: 410, 12: 317, 13: 272, 14: 244, 15: 214, 18: 193, 16: 191, 19: 167, 17: 166, 20: 150, 21: 124, 22: 116, 24: 102, 23: 95})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.20845270156860352  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.20845270156860352  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 11.848518371582031  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 11.851315021514893  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.21259737014770508  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 4 input nodes size: 88932
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.20660781860351562  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.20660781860351562  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.24901390075683594  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.24914836883544922  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.20643138885498047  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 4127, 1: 2147, 2: 1749, 3: 1391, 4: 1083, 5: 966, 6: 760, 7: 634, 8: 536, 9: 526, 10: 474, 11: 414, 12: 405, 13: 351, 14: 283, 15: 280, 16: 261, 17: 246, 18: 244, 21: 222, 19: 221, 20: 220, 24: 157, 23: 152, 22: 144})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.2129673957824707  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.2129673957824707  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 16.089946746826172  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 16.092731952667236  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.21844244003295898  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.21844244003295898  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.18538808822631836  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.11829776763916015 |0.005142974853515625 |0.2234344959259033 |0.0001232147216796875 |0.5073798179626465 |0.004764080047607422 |
----------------------------------------------------------pseudo_mini_loss sum 3.210925579071045
Total (block generation + training)time/epoch 52.57835786159222
Training time/epoch 4.4481260776519775
Training time without block to device /epoch 4.422411203384399
Training time without total dataloading part /epoch 3.659451723098755
load block tensor time/epoch 0.5914888381958008
block to device time/epoch 0.025714874267578125
input features size transfer per epoch 7.450580596923828e-07
blocks size to device per epoch 4.0978193283081055e-07
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  535564
Number of first layer input nodes during this epoch:  328796
Number of first layer output nodes during this epoch:  206768
----------------------------------------before generate dataloader block 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.1724720001220703  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.458 seconds, peak memory: 45.691 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.691 GB
Metis partitioning: 4.937 seconds, peak memory: 45.691 GB
Split the graph: 12.225 seconds
Construct subgraphs: 0.023 seconds
REG metis partition end ----................................
REG construction  time spent:  24.96959638595581
pure dgl.metis_partition the time spent:  18.66995120048523
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7475759983062744

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.3204624652862549

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.1724720001220703  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

connection checking time:  1.3172788619995117
block generation total time  2.0680384635925293
average batch blocks generation time:  0.41360769271850584
block dataloader generation time/epoch 47.992207748549326
pseudo mini batch 0 input nodes size: 46415
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.16538000106811523  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.16538000106811523  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.18751239776611328  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.1876506805419922  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.1451101303100586  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3222, 2: 2878, 3: 2218, 4: 1738, 5: 1414, 6: 1083, 7: 910, 8: 742, 9: 611, 25: 606, 10: 522, 11: 401, 12: 369, 13: 317, 14: 266, 15: 226, 16: 188, 17: 152, 18: 142, 19: 129, 20: 95, 21: 94, 22: 80, 23: 66, 24: 63})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.14809179306030273  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.14809179306030273  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 8.456889629364014  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 8.459652423858643  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.1786785125732422  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 1 input nodes size: 41497
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.17612457275390625  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.17612457275390625  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.19591188430786133  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.19605064392089844  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.17377996444702148  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2296, 2: 2139, 3: 1843, 25: 1600, 4: 1504, 5: 1285, 6: 1084, 7: 923, 8: 796, 9: 686, 10: 624, 11: 569, 12: 467, 13: 394, 14: 358, 15: 303, 17: 279, 16: 260, 18: 213, 20: 209, 21: 188, 19: 177, 23: 129, 22: 127, 24: 123})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.17750883102416992  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.17750883102416992  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 11.031790256500244  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 11.034621238708496  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.18043184280395508  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 2 input nodes size: 67191
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.17764663696289062  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.17764663696289062  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.2096858024597168  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.20982122421264648  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.1898951530456543  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2870, 2: 2433, 3: 2000, 4: 1580, 5: 1353, 25: 1186, 6: 1082, 7: 849, 8: 757, 9: 632, 10: 549, 11: 420, 12: 382, 13: 330, 14: 294, 15: 267, 16: 208, 17: 185, 18: 163, 19: 138, 20: 135, 22: 98, 21: 96, 24: 80, 23: 79})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.19359540939331055  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.19359540939331055  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 9.977813720703125  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 9.98085069656372  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.19646596908569336  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 3 input nodes size: 89129
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.1929488182067871  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.1929488182067871  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.23544883728027344  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.2355804443359375  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.20340585708618164  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2899, 2: 2433, 25: 1984, 3: 1811, 4: 1386, 5: 1198, 6: 873, 7: 717, 8: 648, 9: 528, 10: 451, 11: 404, 12: 314, 13: 275, 14: 232, 15: 223, 18: 192, 16: 185, 17: 178, 19: 165, 20: 150, 21: 120, 24: 103, 22: 103, 23: 85})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.20949697494506836  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.20949697494506836  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 11.789913654327393  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 11.7926607131958  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.21367359161376953  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 4 input nodes size: 87248
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.20656204223632812  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.20656204223632812  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.24816513061523438  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.24829959869384766  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.20566797256469727  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 4084, 1: 2141, 2: 1823, 3: 1405, 4: 1112, 5: 972, 6: 746, 7: 646, 8: 529, 9: 519, 10: 453, 11: 409, 12: 405, 13: 340, 14: 284, 16: 270, 15: 270, 18: 238, 17: 236, 19: 227, 21: 219, 20: 218, 23: 160, 24: 156, 22: 148})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.2127523422241211  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.2127523422241211  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 15.921432495117188  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 15.924118518829346  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.21823692321777344  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.21823692321777344  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.1851825714111328  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.1177478313446045 |0.005736780166625976 |0.23084564208984376 |0.0001407146453857422 |0.5073366641998291 |0.004920482635498047 |
----------------------------------------------------------pseudo_mini_loss sum 3.008535385131836
Total (block generation + training)time/epoch 52.55438848904201
Training time/epoch 4.491410493850708
Training time without block to device /epoch 4.462726593017578
Training time without total dataloading part /epoch 3.696535587310791
load block tensor time/epoch 0.5887391567230225
block to device time/epoch 0.028683900833129883
input features size transfer per epoch 7.450580596923828e-07
blocks size to device per epoch 4.0978193283081055e-07
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  539411
Number of first layer input nodes during this epoch:  331480
Number of first layer output nodes during this epoch:  207931
----------------------------------------before generate dataloader block 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.17223453521728516  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.466 seconds, peak memory: 45.691 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.691 GB
Metis partitioning: 5.055 seconds, peak memory: 45.691 GB
Split the graph: 12.051 seconds
Construct subgraphs: 0.028 seconds
REG metis partition end ----................................
REG construction  time spent:  24.204965829849243
pure dgl.metis_partition the time spent:  18.627816677093506
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7368264198303223

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.2955210208892822

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.17223453521728516  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

connection checking time:  1.301234483718872
block generation total time  2.0323474407196045
average batch blocks generation time:  0.4064694881439209
block dataloader generation time/epoch 47.91391735076904
pseudo mini batch 0 input nodes size: 57277
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.16462993621826172  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.16462993621826172  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.1919417381286621  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.1920785903930664  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.15034103393554688  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2918, 2: 2581, 3: 2075, 4: 1672, 5: 1360, 6: 1086, 25: 972, 7: 888, 8: 779, 9: 640, 10: 527, 11: 427, 12: 404, 13: 330, 14: 281, 15: 262, 16: 193, 17: 172, 18: 152, 19: 141, 20: 115, 22: 105, 21: 98, 24: 86, 23: 73})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.15371417999267578  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.15371417999267578  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 9.380606174468994  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 9.383452892303467  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.1846637725830078  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 1 input nodes size: 41710
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.18167734146118164  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.18167734146118164  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.20156621932983398  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.2017045021057129  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.1742558479309082  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2282, 2: 2117, 3: 1856, 25: 1533, 4: 1513, 5: 1269, 6: 1096, 7: 934, 8: 782, 9: 696, 10: 630, 11: 559, 12: 453, 13: 391, 14: 365, 15: 303, 17: 283, 16: 279, 18: 229, 20: 205, 19: 185, 21: 183, 23: 129, 22: 122, 24: 119})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.17796039581298828  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.17796039581298828  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 10.962759017944336  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 10.965689182281494  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.18071460723876953  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 2 input nodes size: 60591
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.17793989181518555  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.17793989181518555  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.20723676681518555  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.20737266540527344  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.1873455047607422  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3129, 2: 2656, 3: 2086, 4: 1624, 5: 1390, 6: 1025, 25: 944, 7: 824, 8: 761, 9: 585, 10: 515, 11: 398, 12: 354, 13: 317, 14: 269, 15: 226, 16: 182, 17: 170, 18: 145, 20: 126, 19: 126, 21: 99, 23: 83, 22: 82, 24: 68})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.19074487686157227  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.19074487686157227  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 9.245970249176025  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 9.248873710632324  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.1933598518371582  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 3 input nodes size: 84224
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.19016456604003906  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.19016456604003906  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.23032569885253906  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.23046207427978516  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.20102930068969727  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 4263, 1: 2073, 2: 1761, 3: 1389, 4: 1107, 5: 981, 6: 764, 7: 638, 8: 526, 9: 525, 10: 483, 11: 425, 12: 413, 13: 356, 15: 299, 14: 289, 16: 271, 18: 264, 17: 246, 19: 233, 20: 232, 21: 229, 24: 164, 23: 162, 22: 157})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.20760154724121094  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.20760154724121094  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 16.377558708190918  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 16.38045835494995  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.21299171447753906  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 4 input nodes size: 84621
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.20601224899291992  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.20601224899291992  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.24636268615722656  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.24649429321289062  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.20619678497314453  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3026, 2: 2591, 3: 1871, 25: 1748, 4: 1404, 5: 1222, 6: 897, 7: 761, 8: 624, 9: 530, 10: 444, 11: 394, 12: 313, 13: 262, 14: 230, 15: 199, 16: 186, 17: 159, 18: 158, 19: 151, 20: 129, 21: 108, 22: 90, 24: 88, 23: 72})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.2113056182861328  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.2113056182861328  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 11.087090969085693  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 11.089776992797852  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.21568012237548828  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.21568012237548828  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.18262577056884766  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.12015843391418457 |0.0054590702056884766 |0.2284099578857422 |0.0001373291015625 |0.5073649406433105 |0.004856109619140625 |
----------------------------------------------------------pseudo_mini_loss sum 3.015111207962036
Total (block generation + training)time/epoch 52.47097377777099
Training time/epoch 4.485049486160278
Training time without block to device /epoch 4.457754135131836
Training time without total dataloading part /epoch 3.684417247772217
load block tensor time/epoch 0.6007921695709229
block to device time/epoch 0.027295351028442383
input features size transfer per epoch 7.450580596923828e-07
blocks size to device per epoch 4.0978193283081055e-07
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  533108
Number of first layer input nodes during this epoch:  328423
Number of first layer output nodes during this epoch:  204685
----------------------------------------before generate dataloader block 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.1681222915649414  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.494 seconds, peak memory: 45.691 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.691 GB
Metis partitioning: 5.163 seconds, peak memory: 45.691 GB
Split the graph: 11.431 seconds
Construct subgraphs: 0.021 seconds
REG metis partition end ----................................
REG construction  time spent:  25.86892342567444
pure dgl.metis_partition the time spent:  18.137983083724976
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.3372910022735596

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.4266924858093262

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.1681222915649414  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

connection checking time:  1.5097289085388184
block generation total time  2.7639834880828857
average batch blocks generation time:  0.5527966976165771
block dataloader generation time/epoch 47.98119457066059
pseudo mini batch 0 input nodes size: 59102
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.1616497039794922  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.1616497039794922  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.18983173370361328  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.1899709701538086  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.1494889259338379  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2628, 2: 2398, 3: 1927, 4: 1610, 25: 1353, 5: 1303, 6: 1069, 7: 898, 8: 835, 9: 672, 10: 590, 11: 498, 12: 434, 13: 367, 14: 320, 15: 306, 16: 249, 17: 217, 18: 177, 19: 172, 20: 154, 21: 138, 22: 136, 23: 110, 24: 98})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.15332937240600586  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.15332937240600586  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 10.635984897613525  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 10.639411449432373  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.18660831451416016  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 1 input nodes size: 42223
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.18322181701660156  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.18322181701660156  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.2033553123474121  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.20349454879760742  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.17517328262329102  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2301, 2: 2107, 3: 1893, 4: 1541, 25: 1527, 5: 1303, 6: 1102, 7: 940, 8: 789, 9: 704, 10: 627, 11: 559, 12: 452, 13: 416, 14: 371, 15: 302, 17: 272, 16: 271, 18: 225, 20: 221, 21: 178, 19: 177, 23: 121, 22: 120, 24: 117})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.17891836166381836  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.17891836166381836  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 10.997595310211182  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 11.000605583190918  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.18145513534545898  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 2 input nodes size: 54958
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.1786060333251953  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.1786060333251953  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.20481204986572266  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.20494699478149414  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.18467426300048828  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3492, 2: 3032, 3: 2295, 4: 1763, 5: 1470, 6: 1047, 7: 831, 8: 705, 9: 557, 10: 451, 25: 448, 11: 323, 12: 291, 13: 253, 14: 226, 15: 176, 16: 142, 17: 122, 18: 117, 19: 85, 20: 72, 21: 61, 23: 52, 24: 46, 22: 46})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.18749237060546875  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.12255859375 GB
    Memory Allocated: 0.18749237060546875  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 7.767919540405273  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 7.770617961883545  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.18967533111572266  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 3 input nodes size: 92845
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.18702030181884766  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.18702030181884766  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.2312922477722168  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.23142385482788086  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.20508289337158203  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2808, 2: 2363, 25: 2159, 3: 1741, 4: 1305, 5: 1157, 6: 894, 7: 741, 8: 624, 9: 525, 10: 468, 11: 421, 12: 352, 13: 281, 14: 236, 15: 230, 16: 193, 19: 192, 17: 186, 18: 185, 20: 148, 21: 143, 24: 116, 22: 107, 23: 82})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.2102794647216797  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.2102794647216797  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 12.359694004058838  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 12.362604141235352  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.21475696563720703  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 4 input nodes size: 86013
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.20858287811279297  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.20858287811279297  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.24959707260131836  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.24973058700561523  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.20532703399658203  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 3973, 1: 2199, 2: 1806, 3: 1421, 4: 1101, 5: 989, 6: 756, 7: 635, 8: 519, 9: 518, 10: 463, 12: 408, 11: 402, 13: 339, 14: 281, 15: 275, 16: 256, 18: 244, 17: 233, 20: 212, 19: 210, 21: 197, 23: 154, 24: 148, 22: 147})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.21166133880615234  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.21166133880615234  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 15.629013538360596  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 15.631840705871582  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.21738910675048828  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.21738910675048828  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.18433475494384766  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.11795597076416016 |0.005306100845336914 |0.22890586853027345 |0.00013151168823242188 |0.5065259456634521 |0.004849910736083984 |
----------------------------------------------------------pseudo_mini_loss sum 2.9759459495544434
Total (block generation + training)time/epoch 52.532994493842125
Training time/epoch 4.4726526737213135
Training time without block to device /epoch 4.446122169494629
Training time without total dataloading part /epoch 3.682666540145874
load block tensor time/epoch 0.5897798538208008
block to device time/epoch 0.02653050422668457
input features size transfer per epoch 7.450580596923828e-07
blocks size to device per epoch 4.0978193283081055e-07
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  544594
Number of first layer input nodes during this epoch:  335141
Number of first layer output nodes during this epoch:  209453
----------------------------------------before generate dataloader block 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.1712789535522461  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.465 seconds, peak memory: 45.691 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.691 GB
Metis partitioning: 4.996 seconds, peak memory: 45.691 GB
Split the graph: 11.893 seconds
Construct subgraphs: 0.013 seconds
REG metis partition end ----................................
REG construction  time spent:  23.168460369110107
pure dgl.metis_partition the time spent:  18.395824909210205
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7293810844421387

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.3332369327545166

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.1712789535522461  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

connection checking time:  1.3371813297271729
block generation total time  2.0626180171966553
average batch blocks generation time:  0.41252360343933103
block dataloader generation time/epoch 47.84596112195183
pseudo mini batch 0 input nodes size: 50416
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.16384458541870117  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.16384458541870117  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.18788480758666992  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.18802356719970703  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.14687585830688477  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3026, 2: 2718, 3: 2156, 4: 1697, 5: 1407, 6: 1085, 7: 907, 25: 846, 8: 747, 9: 640, 10: 535, 11: 423, 12: 385, 13: 317, 14: 281, 15: 247, 16: 196, 17: 173, 18: 163, 19: 138, 21: 111, 20: 103, 22: 97, 23: 95, 24: 79})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.15013456344604492  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.15013456344604492  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 9.156317710876465  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 9.1595458984375  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.18147802352905273  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 1 input nodes size: 41246
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.17864751815795898  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.17864751815795898  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.19831514358520508  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.1984539031982422  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.17427492141723633  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2486, 2: 2189, 3: 1889, 4: 1530, 25: 1452, 5: 1292, 6: 1091, 7: 939, 8: 796, 9: 682, 10: 615, 11: 566, 12: 431, 13: 385, 14: 339, 15: 290, 17: 259, 16: 251, 20: 208, 18: 199, 21: 168, 19: 167, 22: 114, 23: 114, 24: 113})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.17787981033325195  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.17787981033325195  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 10.634041786193848  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 10.636956691741943  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.18020391464233398  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 2 input nodes size: 67246
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.17748117446899414  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.17748117446899414  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.20954656600952148  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.20968246459960938  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.18987607955932617  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2938, 2: 2514, 3: 2025, 4: 1596, 5: 1372, 25: 1104, 6: 1014, 7: 830, 8: 768, 9: 631, 10: 521, 12: 400, 11: 398, 13: 338, 14: 295, 15: 256, 16: 209, 17: 196, 18: 157, 19: 146, 20: 136, 21: 101, 22: 98, 24: 74, 23: 66})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.1935262680053711  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.1935262680053711  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 9.820475578308105  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 9.823390483856201  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.19642257690429688  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 3 input nodes size: 90099
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.1929335594177246  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.1929335594177246  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.23589611053466797  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.23603010177612305  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.2038288116455078  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 4029, 1: 2112, 2: 1819, 3: 1417, 4: 1110, 5: 973, 6: 780, 7: 646, 8: 529, 9: 513, 10: 484, 11: 410, 12: 409, 13: 343, 15: 275, 14: 272, 16: 255, 18: 250, 17: 237, 19: 221, 20: 217, 21: 215, 24: 154, 23: 151, 22: 143})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.21031808853149414  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.21031808853149414  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 15.95187759399414  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 15.95478105545044  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.21619415283203125  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 4 input nodes size: 93633
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.2086319923400879  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.2086319923400879  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.2532796859741211  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.25341129302978516  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.21031475067138672  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2866, 2: 2466, 25: 2029, 3: 1790, 4: 1387, 5: 1178, 6: 898, 7: 723, 8: 632, 9: 510, 10: 444, 11: 406, 12: 312, 13: 273, 14: 247, 15: 221, 16: 200, 18: 179, 17: 165, 19: 164, 20: 143, 21: 122, 24: 105, 22: 104, 23: 93})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.2155628204345703  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.2155628204345703  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 12.023076057434082  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 12.02600622177124  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.22058486938476562  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.22058486938476562  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.187530517578125  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.11992301940917968 |0.005804014205932617 |0.2261343479156494 |0.0001327037811279297 |0.508480453491211 |0.003465890884399414 |
----------------------------------------------------------pseudo_mini_loss sum 2.8667032718658447
Total (block generation + training)time/epoch 52.39350597998675
Training time/epoch 4.4792749881744385
Training time without block to device /epoch 4.450254917144775
Training time without total dataloading part /epoch 3.677203416824341
load block tensor time/epoch 0.5996150970458984
block to device time/epoch 0.029020071029663086
input features size transfer per epoch 7.450580596923828e-07
blocks size to device per epoch 4.0978193283081055e-07
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  554804
Number of first layer input nodes during this epoch:  342640
Number of first layer output nodes during this epoch:  212164
----------------------------------------before generate dataloader block 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.17322158813476562  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.467 seconds, peak memory: 45.691 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.691 GB
Metis partitioning: 4.981 seconds, peak memory: 45.691 GB
Split the graph: 10.835 seconds
Construct subgraphs: 0.023 seconds
REG metis partition end ----................................
REG construction  time spent:  25.311739683151245
pure dgl.metis_partition the time spent:  17.33469033241272
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.7507278919219971

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.3673839569091797

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.17322158813476562  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

connection checking time:  1.366429090499878
block generation total time  2.1181118488311768
average batch blocks generation time:  0.42362236976623535
block dataloader generation time/epoch 47.78890167342292
pseudo mini batch 0 input nodes size: 49660
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.16672945022583008  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.16672945022583008  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.19040918350219727  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.19054794311523438  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.1457686424255371  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3054, 2: 2679, 3: 2111, 4: 1698, 5: 1402, 6: 1103, 7: 914, 25: 791, 8: 780, 9: 642, 10: 535, 11: 465, 12: 395, 13: 337, 15: 270, 14: 268, 16: 190, 17: 172, 18: 160, 19: 148, 20: 124, 22: 99, 21: 97, 23: 86, 24: 76})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.14900445938110352  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.14900445938110352  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 9.09743595123291  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 9.100319385528564  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.1806645393371582  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 1 input nodes size: 42167
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.17787790298461914  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.17787790298461914  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.1979846954345703  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.19812297821044922  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.17430448532104492  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2336, 2: 2135, 3: 1895, 25: 1535, 4: 1508, 5: 1290, 6: 1090, 7: 933, 8: 776, 9: 676, 10: 628, 11: 545, 12: 442, 13: 392, 14: 365, 15: 291, 17: 281, 16: 278, 18: 217, 20: 202, 21: 188, 19: 181, 23: 130, 22: 123, 24: 115})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.17800426483154297  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.17800426483154297  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 10.933062553405762  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 10.935885906219482  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.1808452606201172  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 2 input nodes size: 69881
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.1780562400817871  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.1780562400817871  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.2113780975341797  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.21151351928710938  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.1912684440612793  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2893, 2: 2573, 3: 2083, 4: 1601, 5: 1394, 25: 1094, 6: 1037, 7: 845, 8: 771, 9: 625, 10: 530, 12: 390, 11: 384, 13: 323, 14: 302, 15: 233, 16: 194, 17: 178, 18: 139, 19: 132, 20: 116, 21: 96, 22: 88, 24: 76, 23: 68})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.19493818283081055  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.19493818283081055  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 9.77478313446045  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 9.777621746063232  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.1977696418762207  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 3 input nodes size: 93127
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.19417428970336914  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.19417428970336914  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.23858070373535156  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.23871374130249023  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.20525646209716797  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2942, 2: 2513, 25: 2084, 3: 1824, 4: 1377, 5: 1208, 6: 878, 7: 707, 8: 602, 9: 527, 10: 445, 11: 416, 12: 318, 13: 256, 15: 224, 14: 216, 18: 197, 16: 195, 19: 160, 17: 158, 20: 150, 21: 128, 24: 108, 22: 102, 23: 79})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.21036815643310547  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.21036815643310547  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 12.08421516418457  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 12.087053775787354  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.21555376052856445  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 4 input nodes size: 91101
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.20860958099365234  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.20860958099365234  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.25204992294311523  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.2521829605102539  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.2076435089111328  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 3956, 1: 2203, 2: 1806, 3: 1364, 4: 1136, 5: 928, 6: 760, 7: 646, 8: 543, 9: 506, 10: 461, 11: 393, 12: 392, 13: 348, 14: 283, 15: 271, 16: 254, 17: 241, 18: 235, 19: 215, 20: 215, 21: 208, 23: 156, 24: 150, 22: 144})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.21408462524414062  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.21408462524414062  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 15.7454195022583  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 15.748116970062256  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.21962928771972656  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.21962928771972656  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.18657493591308594  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.11957387924194336 |0.0054934024810791016 |0.22690906524658203 |0.0001270771026611328 |0.5069098472595215 |0.004822492599487305 |
----------------------------------------------------------pseudo_mini_loss sum 2.8231639862060547
Total (block generation + training)time/epoch 52.33254906866286
Training time/epoch 4.4770612716674805
Training time without block to device /epoch 4.449594259262085
Training time without total dataloading part /epoch 3.6745524406433105
load block tensor time/epoch 0.5978693962097168
block to device time/epoch 0.027467012405395508
input features size transfer per epoch 7.450580596923828e-07
blocks size to device per epoch 4.0978193283081055e-07
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  559872
Number of first layer input nodes during this epoch:  345936
Number of first layer output nodes during this epoch:  213936
----------------------------------------before generate dataloader block 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.17349863052368164  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.482 seconds, peak memory: 45.691 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.691 GB
Metis partitioning: 4.995 seconds, peak memory: 45.691 GB
Split the graph: 11.757 seconds
Construct subgraphs: 0.007 seconds
REG metis partition end ----................................
REG construction  time spent:  22.578501224517822
pure dgl.metis_partition the time spent:  18.269458293914795
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.738501787185669

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.3503847122192383

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.17349863052368164  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

connection checking time:  1.3344988822937012
block generation total time  2.0888864994049072
average batch blocks generation time:  0.41777729988098145
block dataloader generation time/epoch 47.63961154536197
pseudo mini batch 0 input nodes size: 44827
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.16642236709594727  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.16642236709594727  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.18790674209594727  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.18804454803466797  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.1444711685180664  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3079, 2: 2770, 3: 2230, 4: 1741, 5: 1403, 6: 1108, 7: 929, 8: 726, 25: 654, 9: 633, 10: 521, 11: 429, 12: 375, 13: 320, 14: 262, 15: 234, 16: 192, 17: 169, 18: 151, 19: 130, 20: 103, 21: 95, 22: 83, 23: 74, 24: 70})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.14746427536010742  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.14746427536010742  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 8.568152904510498  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 8.57105302810669  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.1779623031616211  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 1 input nodes size: 41506
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.17547369003295898  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.17547369003295898  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.1952652931213379  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.1954026222229004  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.1737804412841797  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2359, 2: 2150, 3: 1882, 4: 1495, 25: 1491, 5: 1280, 6: 1087, 7: 915, 8: 783, 9: 678, 10: 625, 11: 559, 12: 442, 13: 396, 14: 356, 15: 298, 17: 262, 16: 248, 20: 212, 18: 207, 19: 177, 21: 170, 24: 116, 23: 116, 22: 115})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.17741870880126953  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.17741870880126953  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 10.715497970581055  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 10.718267917633057  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.1802978515625  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 2 input nodes size: 68493
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.17754793167114258  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.17754793167114258  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.21075105667114258  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.21088886260986328  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.19095993041992188  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2834, 2: 2455, 3: 1963, 4: 1530, 5: 1376, 25: 1351, 6: 1028, 7: 854, 8: 809, 9: 646, 10: 545, 11: 413, 12: 410, 13: 351, 14: 311, 15: 282, 16: 226, 17: 200, 18: 168, 19: 152, 20: 137, 22: 121, 21: 118, 23: 90, 24: 89})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.19486284255981445  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.19486284255981445  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 10.51710319519043  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 10.520090579986572  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.19823026657104492  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 3 input nodes size: 87564
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.19452953338623047  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.19452953338623047  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.2362833023071289  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.23641729354858398  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.20307636260986328  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 4068, 1: 2141, 2: 1808, 3: 1414, 4: 1129, 5: 962, 6: 727, 7: 613, 8: 531, 9: 497, 10: 452, 12: 400, 11: 392, 13: 327, 14: 287, 15: 278, 16: 276, 18: 250, 17: 244, 20: 226, 19: 223, 21: 220, 23: 160, 22: 152, 24: 148})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.2095627784729004  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.2095627784729004  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 15.95705270767212  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 15.960310935974121  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.2144331932067871  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 4 input nodes size: 90550
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.2073841094970703  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.2073841094970703  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.2505617141723633  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.25069332122802734  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.20880556106567383  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3015, 2: 2523, 25: 1896, 3: 1788, 4: 1425, 5: 1201, 6: 918, 7: 734, 8: 623, 9: 522, 10: 456, 11: 410, 12: 310, 13: 262, 14: 218, 15: 197, 18: 172, 16: 169, 17: 155, 19: 154, 20: 129, 21: 114, 24: 102, 22: 85, 23: 79})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.21396970748901367  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.21396970748901367  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 11.55857229232788  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 11.561346054077148  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.21865510940551758  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.21865510940551758  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.18560075759887695  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.11972393989562988 |0.005614757537841797 |0.2323927879333496 |0.00014200210571289063 |0.5077815532684327 |0.004937410354614258 |
----------------------------------------------------------pseudo_mini_loss sum 2.7671620845794678
Total (block generation + training)time/epoch 52.18181350356654
Training time/epoch 4.515934467315674
Training time without block to device /epoch 4.487860679626465
Training time without total dataloading part /epoch 3.70651912689209
load block tensor time/epoch 0.5986196994781494
block to device time/epoch 0.028073787689208984
input features size transfer per epoch 7.450580596923828e-07
blocks size to device per epoch 4.0978193283081055e-07
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  541995
Number of first layer input nodes during this epoch:  332940
Number of first layer output nodes during this epoch:  209055
----------------------------------------before generate dataloader block 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.1711745262145996  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 1.443 seconds, peak memory: 45.691 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 45.691 GB
Metis partitioning: 4.962 seconds, peak memory: 45.691 GB
Split the graph: 12.267 seconds
Construct subgraphs: 0.014 seconds
REG metis partition end ----................................
REG construction  time spent:  25.20283031463623
pure dgl.metis_partition the time spent:  18.713660717010498
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.724776029586792

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  1.2986900806427002

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.1711745262145996  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

connection checking time:  1.3230500221252441
block generation total time  2.023466110229492
average batch blocks generation time:  0.4046932220458984
block dataloader generation time/epoch 47.65619859695435
pseudo mini batch 0 input nodes size: 47470
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.1646881103515625  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.1646881103515625  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.1881256103515625  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.1882634162902832  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.14495420455932617  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3174, 2: 2820, 3: 2200, 4: 1781, 5: 1404, 6: 1108, 7: 896, 8: 779, 9: 639, 25: 589, 10: 511, 11: 421, 12: 364, 13: 323, 14: 260, 15: 236, 16: 171, 17: 152, 18: 136, 19: 114, 20: 92, 21: 83, 22: 79, 23: 70, 24: 66})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.14792156219482422  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.14792156219482422  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 8.405466079711914  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 8.408219337463379  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.18023109436035156  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 1 input nodes size: 41737
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.17769241333007812  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.17769241333007812  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.19759416580200195  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.19773054122924805  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.17415523529052734  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2294, 2: 2128, 3: 1854, 25: 1563, 4: 1478, 5: 1283, 6: 1061, 7: 908, 8: 760, 9: 663, 10: 606, 11: 533, 12: 430, 13: 380, 14: 355, 15: 291, 17: 275, 16: 265, 18: 217, 20: 203, 21: 188, 19: 178, 23: 128, 22: 122, 24: 118})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.17783784866333008  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.17783784866333008  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 10.846271514892578  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 10.849379062652588  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.18057584762573242  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 2 input nodes size: 66552
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.17777729034423828  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.17777729034423828  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.20951175689697266  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.20965003967285156  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.18961191177368164  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2881, 2: 2466, 3: 2000, 4: 1583, 5: 1370, 25: 1290, 6: 1026, 7: 869, 8: 784, 9: 638, 10: 546, 11: 449, 12: 409, 13: 350, 14: 295, 15: 279, 16: 224, 17: 210, 18: 179, 19: 164, 20: 145, 21: 117, 22: 105, 23: 88, 24: 87})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.1934518814086914  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.1934518814086914  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 10.412343978881836  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 10.41518259048462  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.1961660385131836  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 3 input nodes size: 89841
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.1925640106201172  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.1925640106201172  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.23540353775024414  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.2355351448059082  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.20366239547729492  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2975, 2: 2512, 25: 1853, 3: 1811, 4: 1413, 5: 1191, 6: 911, 7: 726, 8: 622, 9: 522, 10: 452, 11: 403, 12: 313, 13: 269, 14: 237, 15: 216, 16: 190, 18: 176, 17: 163, 20: 150, 19: 148, 21: 116, 24: 109, 22: 102, 23: 77})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.20883607864379883  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.20883607864379883  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 11.537288665771484  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 11.54011583328247  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.21349573135375977  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

pseudo mini batch 4 input nodes size: 88163
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.20701217651367188  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.20701217651367188  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.24905157089233398  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.24918556213378906  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.20621442794799805  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({25: 4165, 1: 2104, 2: 1780, 3: 1412, 4: 1065, 5: 974, 6: 762, 7: 646, 8: 527, 9: 514, 10: 484, 12: 421, 11: 397, 13: 334, 14: 287, 15: 267, 16: 261, 18: 240, 19: 232, 17: 230, 20: 217, 21: 213, 23: 156, 22: 148, 24: 145})

----------------------------------------after blocks to device 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.21275806427001953  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.21275806427001953  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 16.080379009246826  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 16.083232879638672  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.21864986419677734  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.21864986419677734  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.24365234375 GB
    Memory Allocated: 0.18559551239013672  GigaBytes
Max Memory Allocated: 17.74680471420288  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.11863784790039063 |0.006572198867797851 |0.23025274276733398 |0.00015316009521484374 |0.5070463180541992 |0.005076408386230469 |
----------------------------------------------------------pseudo_mini_loss sum 2.701154947280884
Total (block generation + training)time/epoch 52.196472787857054
Training time/epoch 4.503441572189331
Training time without block to device /epoch 4.470580577850342
Training time without total dataloading part /epoch 3.6923375129699707
load block tensor time/epoch 0.5931892395019531
block to device time/epoch 0.03286099433898926
input features size transfer per epoch 7.450580596923828e-07
blocks size to device per epoch 4.0978193283081055e-07
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  542835
Number of first layer input nodes during this epoch:  333763
Number of first layer output nodes during this epoch:  209072
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(128, 128, batch_first=True)
      (fc_self): Linear(in_features=128, out_features=1024, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=1024, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(1024, 1024, batch_first=True)
      (fc_self): Linear(in_features=1024, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=1024, out_features=40, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  8872960
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([512, 128])
layers.0.lstm.weight_hh_l0, torch.Size([512, 128])
layers.0.lstm.bias_ih_l0, torch.Size([512])
layers.0.lstm.bias_hh_l0, torch.Size([512])
layers.0.fc_self.weight, torch.Size([1024, 128])
layers.0.fc_neigh.weight, torch.Size([1024, 128])
layers.1.lstm.weight_ih_l0, torch.Size([4096, 1024])
layers.1.lstm.weight_hh_l0, torch.Size([4096, 1024])
layers.1.lstm.bias_ih_l0, torch.Size([4096])
layers.1.lstm.bias_hh_l0, torch.Size([4096])
layers.1.fc_self.weight, torch.Size([40, 1024])
layers.1.fc_neigh.weight, torch.Size([40, 1024])
----------------------------------------
un-trainable parameters
