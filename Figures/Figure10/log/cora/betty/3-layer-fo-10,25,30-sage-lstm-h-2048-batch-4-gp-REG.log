main start at this time 1733010963.0993032
-----------------------------------------before load data 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

----------------------------------------start of run function 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  1433
----------------------------------------before model to device 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 0.88623046875 GB
    Memory Allocated: 0.3674592971801758  GigaBytes
Max Memory Allocated: 0.3674592971801758  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 0.88818359375 GB
    Memory Allocated: 0.3674592971801758  GigaBytes
Max Memory Allocated: 0.3674592971801758  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 13.818 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 13.818 GB
Metis partitioning: 0.000 seconds, peak memory: 13.818 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.02030205726623535
pure dgl.metis_partition the time spent:  0.0042781829833984375

block_gen_time in "generate_blocks_for_one_layer_block"  0.007806539535522461


block_gen_time in "generate_blocks_for_one_layer_block"  0.010167837142944336


block_gen_time in "generate_blocks_for_one_layer_block"  0.016229629516601562

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 0.88818359375 GB
    Memory Allocated: 0.3674592971801758  GigaBytes
Max Memory Allocated: 0.3674592971801758  GigaBytes

connection checking time:  0.014718770980834961
block generation total time  0.03420400619506836
average batch blocks generation time:  0.00855100154876709
pseudo mini batch 0 input nodes size: 1321
----------------------------------------before load block subtensor 
 Nvidia-smi: 0.88818359375 GB
    Memory Allocated: 0.3674592971801758  GigaBytes
Max Memory Allocated: 0.3674592971801758  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 0.88818359375 GB
    Memory Allocated: 0.3674592971801758  GigaBytes
Max Memory Allocated: 0.3674592971801758  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 0.90771484375 GB
    Memory Allocated: 0.37451171875  GigaBytes
Max Memory Allocated: 0.37451171875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 0.90771484375 GB
    Memory Allocated: 0.3745121955871582  GigaBytes
Max Memory Allocated: 0.3745121955871582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 0.90771484375 GB
    Memory Allocated: 0.3745121955871582  GigaBytes
Max Memory Allocated: 0.3745121955871582  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 6, 3: 6, 4: 6, 5: 4, 6: 3, 9: 2, 10: 2, 7: 2, 12: 2, 1: 1, 11: 1, 21: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 0.90771484375 GB
    Memory Allocated: 0.37454891204833984  GigaBytes
Max Memory Allocated: 0.37454891204833984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 0.90771484375 GB
    Memory Allocated: 0.37454891204833984  GigaBytes
Max Memory Allocated: 0.37454891204833984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.40576171875 GB
    Memory Allocated: 0.8263378143310547  GigaBytes
Max Memory Allocated: 0.8284335136413574  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.40576171875 GB
    Memory Allocated: 0.8263397216796875  GigaBytes
Max Memory Allocated: 0.8284335136413574  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.85107421875 GB
    Memory Allocated: 0.7557220458984375  GigaBytes
Max Memory Allocated: 1.207221508026123  GigaBytes

pseudo mini batch 1 input nodes size: 726
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.85107421875 GB
    Memory Allocated: 0.7556734085083008  GigaBytes
Max Memory Allocated: 1.207221508026123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.85107421875 GB
    Memory Allocated: 0.7556734085083008  GigaBytes
Max Memory Allocated: 1.207221508026123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.85107421875 GB
    Memory Allocated: 0.7602176666259766  GigaBytes
Max Memory Allocated: 1.207221508026123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.85107421875 GB
    Memory Allocated: 0.7602181434631348  GigaBytes
Max Memory Allocated: 1.207221508026123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.85107421875 GB
    Memory Allocated: 0.7531652450561523  GigaBytes
Max Memory Allocated: 1.207221508026123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 9, 3: 9, 1: 7, 4: 4, 5: 2, 19: 1, 9: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 1.85107421875 GB
    Memory Allocated: 0.7531828880310059  GigaBytes
Max Memory Allocated: 1.207221508026123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.85107421875 GB
    Memory Allocated: 0.7531828880310059  GigaBytes
Max Memory Allocated: 1.207221508026123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.85107421875 GB
    Memory Allocated: 0.9508056640625  GigaBytes
Max Memory Allocated: 1.207221508026123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.85107421875 GB
    Memory Allocated: 0.9508070945739746  GigaBytes
Max Memory Allocated: 1.207221508026123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.03857421875 GB
    Memory Allocated: 0.7532086372375488  GigaBytes
Max Memory Allocated: 1.207221508026123  GigaBytes

pseudo mini batch 2 input nodes size: 847
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.03857421875 GB
    Memory Allocated: 0.7531862258911133  GigaBytes
Max Memory Allocated: 1.207221508026123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.03857421875 GB
    Memory Allocated: 0.7531862258911133  GigaBytes
Max Memory Allocated: 1.207221508026123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.03857421875 GB
    Memory Allocated: 0.7577080726623535  GigaBytes
Max Memory Allocated: 1.207221508026123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.03857421875 GB
    Memory Allocated: 0.7577085494995117  GigaBytes
Max Memory Allocated: 1.207221508026123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.03857421875 GB
    Memory Allocated: 0.7531638145446777  GigaBytes
Max Memory Allocated: 1.207221508026123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 6, 1: 6, 3: 5, 5: 5, 6: 4, 8: 3, 2: 3, 7: 1, 30: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.03857421875 GB
    Memory Allocated: 0.7531890869140625  GigaBytes
Max Memory Allocated: 1.207221508026123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.03857421875 GB
    Memory Allocated: 0.7531890869140625  GigaBytes
Max Memory Allocated: 1.207221508026123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.03857421875 GB
    Memory Allocated: 1.0408039093017578  GigaBytes
Max Memory Allocated: 1.207221508026123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.03857421875 GB
    Memory Allocated: 1.0408053398132324  GigaBytes
Max Memory Allocated: 1.207221508026123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.03857421875 GB
    Memory Allocated: 0.7532243728637695  GigaBytes
Max Memory Allocated: 1.2894916534423828  GigaBytes

pseudo mini batch 3 input nodes size: 1027
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.03857421875 GB
    Memory Allocated: 0.7531938552856445  GigaBytes
Max Memory Allocated: 1.2894916534423828  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.03857421875 GB
    Memory Allocated: 0.7531938552856445  GigaBytes
Max Memory Allocated: 1.2894916534423828  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.03857421875 GB
    Memory Allocated: 0.7586765289306641  GigaBytes
Max Memory Allocated: 1.2894916534423828  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.03857421875 GB
    Memory Allocated: 0.7586770057678223  GigaBytes
Max Memory Allocated: 1.2894916534423828  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.03857421875 GB
    Memory Allocated: 0.7541546821594238  GigaBytes
Max Memory Allocated: 1.2894916534423828  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 7, 4: 6, 1: 6, 3: 6, 5: 4, 6: 3, 10: 1, 7: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.03857421875 GB
    Memory Allocated: 0.7541847229003906  GigaBytes
Max Memory Allocated: 1.2894916534423828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.03857421875 GB
    Memory Allocated: 0.7541847229003906  GigaBytes
Max Memory Allocated: 1.2894916534423828  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.03857421875 GB
    Memory Allocated: 1.088707447052002  GigaBytes
Max Memory Allocated: 1.2894916534423828  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.03857421875 GB
    Memory Allocated: 1.0887088775634766  GigaBytes
Max Memory Allocated: 1.2894916534423828  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.03857421875 GB
    Memory Allocated: 0.7542257308959961  GigaBytes
Max Memory Allocated: 1.3371696472167969  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.4833993911743164  GigaBytes
Max Memory Allocated: 1.8492870330810547  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.1181488037109375  GigaBytes
Max Memory Allocated: 1.8492870330810547  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06072419881820679 |0.001988232135772705 |0.6689582467079163 |0.0035129189491271973 |0.310300350189209 |0.13535332679748535 |
----------------------------------------------------------pseudo_mini_loss sum 1.9504835605621338
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6469
Number of first layer input nodes during this epoch:  3921
Number of first layer output nodes during this epoch:  1895
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.1180577278137207  GigaBytes
Max Memory Allocated: 1.8492870330810547  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.365 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.365 GB
Metis partitioning: 0.000 seconds, peak memory: 16.365 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.011098861694335938
pure dgl.metis_partition the time spent:  0.004029989242553711

block_gen_time in "generate_blocks_for_one_layer_block"  0.0077097415924072266


block_gen_time in "generate_blocks_for_one_layer_block"  0.011003255844116211


block_gen_time in "generate_blocks_for_one_layer_block"  0.016969919204711914

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.1180577278137207  GigaBytes
Max Memory Allocated: 1.8492870330810547  GigaBytes

connection checking time:  0.015043020248413086
block generation total time  0.03568291664123535
average batch blocks generation time:  0.008920729160308838
pseudo mini batch 0 input nodes size: 1212
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.1180191040039062  GigaBytes
Max Memory Allocated: 1.8492870330810547  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.1180191040039062  GigaBytes
Max Memory Allocated: 1.8492870330810547  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.1250715255737305  GigaBytes
Max Memory Allocated: 1.8492870330810547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.1250720024108887  GigaBytes
Max Memory Allocated: 1.8492870330810547  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.119588851928711  GigaBytes
Max Memory Allocated: 1.8492870330810547  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 7, 2: 5, 1: 4, 5: 4, 4: 4, 6: 3, 9: 2, 12: 2, 10: 2, 11: 1, 7: 1, 21: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.1196227073669434  GigaBytes
Max Memory Allocated: 1.8492870330810547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.1196227073669434  GigaBytes
Max Memory Allocated: 1.8492870330810547  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.5305185317993164  GigaBytes
Max Memory Allocated: 1.8492870330810547  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.5305204391479492  GigaBytes
Max Memory Allocated: 1.8492870330810547  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.4842243194580078  GigaBytes
Max Memory Allocated: 1.9037699699401855  GigaBytes

pseudo mini batch 1 input nodes size: 935
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.484179973602295  GigaBytes
Max Memory Allocated: 1.9037699699401855  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.484179973602295  GigaBytes
Max Memory Allocated: 1.9037699699401855  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.4896626472473145  GigaBytes
Max Memory Allocated: 1.9037699699401855  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.4896631240844727  GigaBytes
Max Memory Allocated: 1.9037699699401855  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.4826102256774902  GigaBytes
Max Memory Allocated: 1.9037699699401855  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 8, 3: 6, 2: 5, 5: 4, 1: 3, 6: 3, 9: 2, 8: 2, 30: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.4826383590698242  GigaBytes
Max Memory Allocated: 1.9037699699401855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.4826383590698242  GigaBytes
Max Memory Allocated: 1.9037699699401855  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.8059186935424805  GigaBytes
Max Memory Allocated: 1.9037699699401855  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.805920124053955  GigaBytes
Max Memory Allocated: 1.9037699699401855  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826774597167969  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

pseudo mini batch 2 input nodes size: 929
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826431274414062  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826431274414062  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.487602710723877  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4876031875610352  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4821200370788574  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 8, 3: 8, 1: 6, 4: 5, 5: 3, 7: 2, 6: 2, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.482142448425293  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.482142448425293  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.7503113746643066  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.7503128051757812  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4821748733520508  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

pseudo mini batch 3 input nodes size: 968
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4821443557739258  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4821443557739258  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4876270294189453  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4876275062561035  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826674461364746  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 7, 2: 7, 4: 5, 3: 5, 5: 4, 6: 3, 30: 1, 19: 1, 8: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826946258544922  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826946258544922  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.7985520362854004  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.798553466796875  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.482731819152832  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.482731819152832  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1181449890136719  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06005960702896118 |0.000724494457244873 |0.10187071561813354 |9.733438491821289e-05 |0.27405643463134766 |0.0029294490814208984 |
----------------------------------------------------------pseudo_mini_loss sum 53.46855163574219
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6683
Number of first layer input nodes during this epoch:  4044
Number of first layer output nodes during this epoch:  1978
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1180510520935059  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.464 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.464 GB
Metis partitioning: 0.000 seconds, peak memory: 16.464 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009470462799072266
pure dgl.metis_partition the time spent:  0.004670381546020508

block_gen_time in "generate_blocks_for_one_layer_block"  0.0077054500579833984


block_gen_time in "generate_blocks_for_one_layer_block"  0.010183334350585938


block_gen_time in "generate_blocks_for_one_layer_block"  0.016850948333740234

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1180510520935059  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

connection checking time:  0.015025854110717773
block generation total time  0.03473973274230957
average batch blocks generation time:  0.008684933185577393
block dataloader generation time/epoch 0.07782745361328125
pseudo mini batch 0 input nodes size: 1276
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.118016242980957  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.118016242980957  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1250686645507812  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1250691413879395  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1195859909057617  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 7, 4: 6, 2: 5, 6: 3, 5: 3, 7: 2, 12: 2, 1: 2, 9: 2, 10: 2, 21: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1196227073669434  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1196227073669434  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.5547256469726562  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.554727554321289  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.484231948852539  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

pseudo mini batch 1 input nodes size: 979
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4841833114624023  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4841833114624023  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4896659851074219  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.48966646194458  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826135635375977  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 9, 4: 6, 1: 3, 8: 3, 6: 3, 5: 3, 2: 3, 30: 2, 9: 2, 19: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826436042785645  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826436042785645  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.8423452377319336  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.8423466682434082  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826855659484863  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

pseudo mini batch 2 input nodes size: 909
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.482649326324463  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.482649326324463  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.487502098083496  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4875025749206543  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4820194244384766  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 9, 2: 8, 3: 7, 4: 4, 6: 3, 5: 3, 10: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.482041835784912  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.482041835784912  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.7461810111999512  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.7461824417114258  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.48207426071167  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

pseudo mini batch 3 input nodes size: 773
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.482043743133545  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.482043743133545  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4865880012512207  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.486588478088379  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4817352294921875  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 9, 4: 6, 5: 6, 1: 6, 3: 3, 6: 2, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4817538261413574  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4817538261413574  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.7003183364868164  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.700319766998291  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4817805290222168  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4817805290222168  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1171936988830566  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06108742952346802 |0.0007264614105224609 |0.09983575344085693 |0.00010097026824951172 |0.255107581615448 |0.003372669219970703 |
----------------------------------------------------------pseudo_mini_loss sum 110.16050720214844
Total (block generation + training)time/epoch 1.849560022354126
Training time/epoch 1.7715497016906738
Training time without block to device /epoch 1.768643856048584
Training time without total dataloading part /epoch 1.4235498905181885
load block tensor time/epoch 0.24434971809387207
block to device time/epoch 0.0029058456420898438
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  6488
Number of first layer input nodes during this epoch:  3937
Number of first layer output nodes during this epoch:  1898
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.117093563079834  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.464 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.464 GB
Metis partitioning: 0.000 seconds, peak memory: 16.464 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.00921773910522461
pure dgl.metis_partition the time spent:  0.0045528411865234375

block_gen_time in "generate_blocks_for_one_layer_block"  0.00780487060546875


block_gen_time in "generate_blocks_for_one_layer_block"  0.010254383087158203


block_gen_time in "generate_blocks_for_one_layer_block"  0.016312599182128906

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.117093563079834  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

connection checking time:  0.015018224716186523
block generation total time  0.03437185287475586
average batch blocks generation time:  0.008592963218688965
block dataloader generation time/epoch 0.07768237590789795
pseudo mini batch 0 input nodes size: 1188
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1170687675476074  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1170687675476074  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1241211891174316  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1241216659545898  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1195769309997559  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 9, 4: 5, 5: 4, 2: 3, 6: 3, 9: 3, 10: 2, 1: 2, 12: 1, 7: 1, 21: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1196117401123047  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1196117401123047  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.532111644744873  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.5321135520935059  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.484227180480957  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

pseudo mini batch 1 input nodes size: 1066
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4841828346252441  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4841828346252441  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4898738861083984  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4898743629455566  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4828214645385742  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 11, 3: 7, 4: 6, 7: 3, 1: 3, 5: 2, 12: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4828495979309082  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4828495979309082  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.8047194480895996  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.8047208786010742  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4828877449035645  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

pseudo mini batch 2 input nodes size: 956
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.482851505279541  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.482851505279541  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4883341789245605  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4883346557617188  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4826431274414062  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 8, 4: 6, 3: 5, 5: 4, 6: 3, 2: 3, 8: 3, 9: 1, 19: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4826712608337402  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4826712608337402  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.8124127388000488  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.8124141693115234  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.482710361480713  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

pseudo mini batch 3 input nodes size: 559
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4826760292053223  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4826760292053223  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4865822792053223  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4865827560424805  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4810996055603027  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 8, 1: 7, 4: 5, 5: 5, 6: 5, 3: 5, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4811162948608398  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4811162948608398  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.6703495979309082  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.6703510284423828  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4811410903930664  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4811410903930664  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.1165542602539062  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06113314628601074 |0.0007085800170898438 |0.09592676162719727 |9.614229202270508e-05 |0.24820077419281006 |0.0033206939697265625 |
----------------------------------------------------------pseudo_mini_loss sum 144.1767578125
Total (block generation + training)time/epoch 1.8259447813034058
Training time/epoch 1.724674940109253
Training time without block to device /epoch 1.7218406200408936
Training time without total dataloading part /epoch 1.3802154064178467
load block tensor time/epoch 0.24453258514404297
block to device time/epoch 0.002834320068359375
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  6296
Number of first layer input nodes during this epoch:  3769
Number of first layer output nodes during this epoch:  1870
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.1164517402648926  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.464 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.464 GB
Metis partitioning: 0.000 seconds, peak memory: 16.464 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009044170379638672
pure dgl.metis_partition the time spent:  0.004525184631347656

block_gen_time in "generate_blocks_for_one_layer_block"  0.007687807083129883


block_gen_time in "generate_blocks_for_one_layer_block"  0.010225296020507812


block_gen_time in "generate_blocks_for_one_layer_block"  0.016768217086791992

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.1164517402648926  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

connection checking time:  0.015441417694091797
block generation total time  0.03468132019042969
average batch blocks generation time:  0.008670330047607422
block dataloader generation time/epoch 0.07770705223083496
pseudo mini batch 0 input nodes size: 1209
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.1164307594299316  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.1164307594299316  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.1234831809997559  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.123483657836914  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.1195769309997559  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 11, 4: 5, 1: 4, 2: 4, 10: 2, 6: 2, 5: 2, 12: 2, 21: 1, 9: 1, 19: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.119612693786621  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.119612693786621  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.5522217750549316  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.5522236824035645  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4842300415039062  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

pseudo mini batch 1 input nodes size: 1204
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4841833114624023  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4841833114624023  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4906110763549805  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4906115531921387  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4835586547851562  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 8, 2: 8, 1: 5, 5: 4, 7: 3, 3: 3, 9: 2, 11: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.483588695526123  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.483588695526123  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.8304057121276855  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.8304071426391602  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4836297035217285  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

pseudo mini batch 2 input nodes size: 896
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4835891723632812  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4835891723632812  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4890718460083008  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.489072322845459  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4826440811157227  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 7, 1: 6, 2: 5, 6: 4, 4: 4, 8: 3, 5: 2, 30: 1, 9: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4826703071594238  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4826703071594238  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.7849459648132324  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.784947395324707  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4827065467834473  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

pseudo mini batch 3 input nodes size: 740
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4826741218566895  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4826741218566895  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4872183799743652  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4872188568115234  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4817357063293457  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 8, 5: 7, 4: 5, 1: 5, 3: 5, 6: 4, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4817543029785156  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4817543029785156  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.7014694213867188  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.7014708518981934  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.481781005859375  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.481781005859375  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.1171941757202148  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.060903191566467285 |0.000720977783203125 |0.09704691171646118 |9.79304313659668e-05 |0.24541723728179932 |0.0027670860290527344 |
----------------------------------------------------------pseudo_mini_loss sum 68.70056915283203
Total (block generation + training)time/epoch 1.8173116048177083
Training time/epoch 1.7221553325653076
Training time without block to device /epoch 1.7192714214324951
Training time without total dataloading part /epoch 1.3730154037475586
load block tensor time/epoch 0.24361276626586914
block to device time/epoch 0.0028839111328125
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  6653
Number of first layer input nodes during this epoch:  4049
Number of first layer output nodes during this epoch:  1950
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.117093563079834  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.464 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.464 GB
Metis partitioning: 0.000 seconds, peak memory: 16.464 GB
Split the graph: 0.002 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.010005712509155273
pure dgl.metis_partition the time spent:  0.004964590072631836

block_gen_time in "generate_blocks_for_one_layer_block"  0.007709980010986328


block_gen_time in "generate_blocks_for_one_layer_block"  0.01003122329711914


block_gen_time in "generate_blocks_for_one_layer_block"  0.017208337783813477

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.117093563079834  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

connection checking time:  0.015331506729125977
block generation total time  0.034949541091918945
average batch blocks generation time:  0.008737385272979736
block dataloader generation time/epoch 0.07809215784072876
pseudo mini batch 0 input nodes size: 1131
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.1170687675476074  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.1170687675476074  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.1231064796447754  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.1231069564819336  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.1185622215270996  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 8, 3: 7, 5: 5, 4: 5, 1: 3, 6: 3, 7: 2, 9: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.1185932159423828  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.1185932159423828  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4730267524719238  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4730286598205566  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4832029342651367  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

pseudo mini batch 1 input nodes size: 900
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4831624031066895  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4831624031066895  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.488645076751709  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4886455535888672  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.482607364654541  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 8, 2: 6, 3: 6, 5: 4, 1: 4, 8: 3, 6: 2, 9: 1, 30: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4826335906982422  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4826335906982422  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.7858452796936035  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.7858467102050781  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4826698303222656  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

pseudo mini batch 2 input nodes size: 1124
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4826374053955078  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4826374053955078  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.488637924194336  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4886384010314941  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4831552505493164  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 6, 4: 6, 3: 5, 5: 4, 2: 3, 6: 3, 12: 2, 10: 2, 7: 1, 21: 1, 9: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4831862449645996  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4831862449645996  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.8561286926269531  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.8561301231384277  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.483229160308838  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

pseudo mini batch 3 input nodes size: 886
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4831886291503906  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4831886291503906  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4886713027954102  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4886717796325684  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.482670783996582  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 8, 2: 8, 1: 7, 6: 3, 4: 3, 5: 2, 19: 1, 9: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4826951026916504  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4826951026916504  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.7542576789855957  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.7542591094970703  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4827284812927246  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.4827284812927246  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.1181416511535645  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06062018871307373 |0.000710904598236084 |0.10392826795578003 |9.834766387939453e-05 |0.27708250284194946 |0.0031671524047851562 |
----------------------------------------------------------pseudo_mini_loss sum 225.05419921875
Total (block generation + training)time/epoch 1.850524663925171
Training time/epoch 1.8708012104034424
Training time without block to device /epoch 1.867957592010498
Training time without total dataloading part /epoch 1.5276036262512207
load block tensor time/epoch 0.24248075485229492
block to device time/epoch 0.002843618392944336
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  6635
Number of first layer input nodes during this epoch:  4041
Number of first layer output nodes during this epoch:  1941
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.118044376373291  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.464 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.464 GB
Metis partitioning: 0.000 seconds, peak memory: 16.464 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009192943572998047
pure dgl.metis_partition the time spent:  0.004281044006347656

block_gen_time in "generate_blocks_for_one_layer_block"  0.007664918899536133


block_gen_time in "generate_blocks_for_one_layer_block"  0.010183095932006836


block_gen_time in "generate_blocks_for_one_layer_block"  0.0181581974029541

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.118044376373291  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

connection checking time:  0.015313148498535156
block generation total time  0.03600621223449707
average batch blocks generation time:  0.009001553058624268
block dataloader generation time/epoch 0.07827577590942383
pseudo mini batch 0 input nodes size: 1367
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.1180133819580078  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.1180133819580078  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.1253108978271484  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.1253113746643066  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.119828224182129  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 8, 4: 6, 7: 3, 2: 3, 5: 3, 6: 3, 1: 2, 9: 2, 12: 2, 10: 2, 21: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.1198678016662598  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.79052734375 GB
    Memory Allocated: 1.1198678016662598  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.80224609375 GB
    Memory Allocated: 1.595789909362793  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.80224609375 GB
    Memory Allocated: 1.5957918167114258  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.80224609375 GB
    Memory Allocated: 1.4844837188720703  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

pseudo mini batch 1 input nodes size: 666
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.80224609375 GB
    Memory Allocated: 1.484431266784668  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.80224609375 GB
    Memory Allocated: 1.484431266784668  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.80224609375 GB
    Memory Allocated: 1.488337516784668  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.80224609375 GB
    Memory Allocated: 1.4883379936218262  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.80224609375 GB
    Memory Allocated: 1.4810400009155273  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 7, 1: 6, 4: 6, 3: 5, 5: 4, 6: 4, 9: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.80224609375 GB
    Memory Allocated: 1.4810576438903809  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.80224609375 GB
    Memory Allocated: 1.4810576438903809  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.80224609375 GB
    Memory Allocated: 1.6807408332824707  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.80224609375 GB
    Memory Allocated: 1.6807422637939453  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4810833930969238  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

pseudo mini batch 2 input nodes size: 1010
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4810609817504883  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4810609817504883  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4865436553955078  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.486544132232666  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826374053955078  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 8, 5: 6, 4: 6, 8: 3, 3: 3, 6: 3, 1: 2, 30: 1, 9: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826664924621582  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826664924621582  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.822486400604248  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.8224878311157227  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4827065467834473  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

pseudo mini batch 3 input nodes size: 1005
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826703071594238  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826703071594238  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4883313179016113  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4883317947387695  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4828486442565918  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 10, 3: 10, 2: 7, 4: 4, 5: 2, 6: 1, 19: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.482874870300293  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.482874870300293  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.7745122909545898  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.7745137214660645  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.48291015625  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.48291015625  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1183233261108398  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.060730159282684326 |0.0007270574569702148 |0.1020933985710144 |9.554624557495117e-05 |0.27106332778930664 |0.0028755664825439453 |
----------------------------------------------------------pseudo_mini_loss sum 139.16201782226562
Total (block generation + training)time/epoch 1.8648347854614258
Training time/epoch 1.8429412841796875
Training time without block to device /epoch 1.8400330543518066
Training time without total dataloading part /epoch 1.495884656906128
load block tensor time/epoch 0.2429206371307373
block to device time/epoch 0.0029082298278808594
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  6660
Number of first layer input nodes during this epoch:  4048
Number of first layer output nodes during this epoch:  1959
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1182265281677246  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.537 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.537 GB
Metis partitioning: 0.000 seconds, peak memory: 16.537 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.00964498519897461
pure dgl.metis_partition the time spent:  0.004576206207275391

block_gen_time in "generate_blocks_for_one_layer_block"  0.00770258903503418


block_gen_time in "generate_blocks_for_one_layer_block"  0.010252952575683594


block_gen_time in "generate_blocks_for_one_layer_block"  0.01696014404296875

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1182265281677246  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

connection checking time:  0.015473127365112305
block generation total time  0.03491568565368652
average batch blocks generation time:  0.00872892141342163
block dataloader generation time/epoch 0.07837486267089844
pseudo mini batch 0 input nodes size: 1081
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1181917190551758  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1181917190551758  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1239628791809082  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1239633560180664  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1183018684387207  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 8, 3: 6, 4: 6, 6: 3, 1: 3, 8: 2, 5: 2, 30: 2, 9: 1, 12: 1, 10: 1, 19: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1183357238769531  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1183357238769531  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.5176596641540527  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.5176615715026855  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4829440116882324  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

pseudo mini batch 1 input nodes size: 877
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4829015731811523  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4829015731811523  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4883842468261719  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.48838472366333  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826130867004395  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 9, 5: 6, 3: 6, 2: 5, 4: 4, 6: 2, 7: 2, 8: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.482635498046875  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.482635498046875  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.7441182136535645  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.744119644165039  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826679229736328  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

pseudo mini batch 2 input nodes size: 1201
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826374053955078  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826374053955078  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.489689826965332  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4896903038024902  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4842071533203125  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 8, 4: 7, 6: 4, 2: 4, 5: 3, 7: 2, 1: 2, 10: 2, 9: 2, 12: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.484241008758545  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.484241008758545  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.8789920806884766  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.8789935111999512  GigaBytes
Max Memory Allocated: 2.104747772216797  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4842877388000488  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

pseudo mini batch 3 input nodes size: 795
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.484243392944336  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.484243392944336  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4887876510620117  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.48878812789917  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4817352294921875  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 8, 1: 6, 3: 6, 4: 5, 5: 4, 6: 2, 21: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4817566871643066  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4817566871643066  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.7319402694702148  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.7319416999816895  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4817872047424316  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4817872047424316  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1172003746032715  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0611533522605896 |0.0007268190383911133 |0.09710615873336792 |9.66191291809082e-05 |0.24486112594604492 |0.0036056041717529297 |
----------------------------------------------------------pseudo_mini_loss sum 35.101837158203125
Total (block generation + training)time/epoch 1.8538336356480916
Training time/epoch 1.7198572158813477
Training time without block to device /epoch 1.7169499397277832
Training time without total dataloading part /epoch 1.371861219406128
load block tensor time/epoch 0.2446134090423584
block to device time/epoch 0.002907276153564453
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  6556
Number of first layer input nodes during this epoch:  3954
Number of first layer output nodes during this epoch:  1945
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1171002388000488  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.537 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.537 GB
Metis partitioning: 0.000 seconds, peak memory: 16.537 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009321928024291992
pure dgl.metis_partition the time spent:  0.0044672489166259766

block_gen_time in "generate_blocks_for_one_layer_block"  0.007697582244873047


block_gen_time in "generate_blocks_for_one_layer_block"  0.010217666625976562


block_gen_time in "generate_blocks_for_one_layer_block"  0.016869068145751953

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1171002388000488  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

connection checking time:  0.01528167724609375
block generation total time  0.03478431701660156
average batch blocks generation time:  0.00869607925415039
block dataloader generation time/epoch 0.07832796233040946
pseudo mini batch 0 input nodes size: 1162
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1170716285705566  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1170716285705566  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1241240501403809  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.124124526977539  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.119579792022705  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 7, 4: 6, 2: 5, 5: 4, 1: 3, 6: 3, 7: 2, 9: 2, 11: 1, 12: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1196117401123047  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1196117401123047  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4957294464111328  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4957313537597656  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4842195510864258  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

pseudo mini batch 1 input nodes size: 917
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4841771125793457  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4841771125793457  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4896597862243652  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4896602630615234  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.482607364654541  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 1: 6, 4: 6, 5: 4, 6: 3, 8: 3, 7: 1, 21: 1, 2: 1, 10: 1, 12: 1, 30: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826374053955078  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826374053955078  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.8253259658813477  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.8253273963928223  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826793670654297  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

pseudo mini batch 2 input nodes size: 1140
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826431274414062  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826431274414062  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4896955490112305  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4896960258483887  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.484212875366211  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 9, 2: 9, 4: 7, 5: 3, 1: 3, 19: 1, 6: 1, 30: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4842429161071777  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4842429161071777  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.8342399597167969  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.8342413902282715  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4842848777770996  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

pseudo mini batch 3 input nodes size: 751
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4842462539672852  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4842462539672852  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.488790512084961  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4887909889221191  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4817380905151367  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 10, 1: 8, 6: 4, 5: 4, 3: 4, 4: 3, 9: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4817566871643066  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4817566871643066  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.7047252655029297  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.7047266960144043  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.481783390045166  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.481783390045166  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1171965599060059  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06083136796951294 |0.0007194876670837402 |0.10157507658004761 |0.00010436773300170898 |0.2660806179046631 |0.0032052993774414062 |
----------------------------------------------------------pseudo_mini_loss sum 16.84230613708496
Total (block generation + training)time/epoch 1.860234567097255
Training time/epoch 1.8204903602600098
Training time without block to device /epoch 1.8176124095916748
Training time without total dataloading part /epoch 1.474245548248291
load block tensor time/epoch 0.24332547187805176
block to device time/epoch 0.002877950668334961
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  6562
Number of first layer input nodes during this epoch:  3970
Number of first layer output nodes during this epoch:  1932
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.117093563079834  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.537 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.537 GB
Metis partitioning: 0.000 seconds, peak memory: 16.537 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.003 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009358882904052734
pure dgl.metis_partition the time spent:  0.0054759979248046875

block_gen_time in "generate_blocks_for_one_layer_block"  0.0076885223388671875


block_gen_time in "generate_blocks_for_one_layer_block"  0.011334419250488281


block_gen_time in "generate_blocks_for_one_layer_block"  0.016920804977416992

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.117093563079834  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

connection checking time:  0.01537942886352539
block generation total time  0.03594374656677246
average batch blocks generation time:  0.008985936641693115
block dataloader generation time/epoch 0.07858991622924805
pseudo mini batch 0 input nodes size: 1147
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1170687675476074  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1170687675476074  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1241211891174316  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1241216659545898  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1195769309997559  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 8, 4: 6, 5: 6, 1: 3, 2: 3, 6: 3, 9: 1, 19: 1, 21: 1, 30: 1, 10: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1196117401123047  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1196117401123047  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.5346441268920898  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.5346460342407227  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.484877586364746  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

pseudo mini batch 1 input nodes size: 1008
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4848332405090332  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4848332405090332  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4903159141540527  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.490316390991211  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4832634925842285  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 9, 2: 7, 1: 6, 4: 3, 6: 3, 9: 2, 5: 2, 7: 1, 10: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.483290672302246  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.483290672302246  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.7850923538208008  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.7850937843322754  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.483327865600586  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

pseudo mini batch 2 input nodes size: 921
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4832935333251953  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4832935333251953  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4882102012634277  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.488210678100586  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4827275276184082  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 8, 4: 6, 3: 5, 5: 4, 1: 4, 8: 3, 6: 3, 7: 1, 30: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4827556610107422  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4827556610107422  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.8033132553100586  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.8033146858215332  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4827947616577148  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

pseudo mini batch 3 input nodes size: 928
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4827604293823242  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4827604293823242  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4882431030273438  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.488243579864502  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4833264350891113  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 7, 4: 7, 1: 7, 3: 4, 5: 3, 7: 2, 6: 2, 10: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4833488464355469  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4833488464355469  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.7489814758300781  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.7489829063415527  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4833812713623047  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4833812713623047  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1181440353393555  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06073242425918579 |0.0007240772247314453 |0.10280609130859375 |9.942054748535156e-05 |0.2745774984359741 |0.003863096237182617 |
----------------------------------------------------------pseudo_mini_loss sum 10.739312171936035
Total (block generation + training)time/epoch 1.8703241646289825
Training time/epoch 1.8604085445404053
Training time without block to device /epoch 1.8575122356414795
Training time without total dataloading part /epoch 1.5137951374053955
load block tensor time/epoch 0.24292969703674316
block to device time/epoch 0.0028963088989257812
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  6609
Number of first layer input nodes during this epoch:  4004
Number of first layer output nodes during this epoch:  1953
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1180415153503418  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.537 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.537 GB
Metis partitioning: 0.000 seconds, peak memory: 16.537 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009289979934692383
pure dgl.metis_partition the time spent:  0.004423379898071289

block_gen_time in "generate_blocks_for_one_layer_block"  0.007626056671142578


block_gen_time in "generate_blocks_for_one_layer_block"  0.010092735290527344


block_gen_time in "generate_blocks_for_one_layer_block"  0.017009973526000977

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1180415153503418  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

connection checking time:  0.015324592590332031
block generation total time  0.0347287654876709
average batch blocks generation time:  0.008682191371917725
block dataloader generation time/epoch 0.07853529188368055
pseudo mini batch 0 input nodes size: 895
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1180105209350586  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1180105209350586  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.122788429260254  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.122788906097412  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1173057556152344  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 7, 2: 6, 5: 5, 4: 5, 6: 4, 8: 3, 9: 2, 1: 2, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.117332935333252  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.117332935333252  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4315190315246582  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.431520938873291  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4825983047485352  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

pseudo mini batch 1 input nodes size: 1011
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4825658798217773  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4825658798217773  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4880485534667969  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.488049030303955  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4832706451416016  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 10, 4: 8, 2: 7, 3: 2, 6: 2, 5: 2, 7: 2, 19: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.48329496383667  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.48329496383667  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.7816228866577148  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.7816243171691895  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.483330249786377  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

pseudo mini batch 2 input nodes size: 1236
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4832978248596191  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4832978248596191  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4903502464294434  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4903507232666016  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4848675727844238  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 10, 2: 5, 5: 4, 6: 4, 12: 2, 4: 2, 10: 2, 1: 2, 7: 1, 9: 1, 30: 1, 11: 1, 21: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.484903335571289  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.484903335571289  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.9254307746887207  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.9254322052001953  GigaBytes
Max Memory Allocated: 2.127565383911133  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4849538803100586  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

pseudo mini batch 3 input nodes size: 857
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4849071502685547  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4849071502685547  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4903898239135742  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4903903007507324  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.48333740234375  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 7, 3: 7, 2: 7, 1: 6, 5: 4, 7: 1, 9: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4833569526672363  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4833569526672363  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.711787223815918  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.7117886543273926  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4833836555480957  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4833836555480957  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1181330680847168  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06071352958679199 |0.0007912516593933105 |0.09861254692077637 |0.00010019540786743164 |0.2518009543418884 |0.003084421157836914 |
----------------------------------------------------------pseudo_mini_loss sum 6.920011520385742
Total (block generation + training)time/epoch 1.8659160137176514
Training time/epoch 1.752406358718872
Training time without block to device /epoch 1.7492413520812988
Training time without total dataloading part /epoch 1.4051392078399658
load block tensor time/epoch 0.24285411834716797
block to device time/epoch 0.003165006637573242
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  6561
Number of first layer input nodes during this epoch:  3999
Number of first layer output nodes during this epoch:  1909
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1180329322814941  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.537 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.537 GB
Metis partitioning: 0.000 seconds, peak memory: 16.537 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.008696317672729492
pure dgl.metis_partition the time spent:  0.004867076873779297

block_gen_time in "generate_blocks_for_one_layer_block"  0.007796764373779297


block_gen_time in "generate_blocks_for_one_layer_block"  0.01021885871887207


block_gen_time in "generate_blocks_for_one_layer_block"  0.01748347282409668

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1180329322814941  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

connection checking time:  0.015531778335571289
block generation total time  0.03549909591674805
average batch blocks generation time:  0.008874773979187012
block dataloader generation time/epoch 0.07856037616729736
pseudo mini batch 0 input nodes size: 1160
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1180062294006348  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1180062294006348  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.125058650970459  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1250591278076172  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1195759773254395  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 7, 3: 6, 4: 5, 5: 5, 1: 4, 6: 3, 10: 2, 9: 2, 12: 1, 21: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1196088790893555  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1196088790893555  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.5011954307556152  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.501197338104248  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.484222412109375  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

pseudo mini batch 1 input nodes size: 1036
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.484179973602295  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.484179973602295  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.489710807800293  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4897112846374512  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826583862304688  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 9, 2: 6, 1: 6, 4: 5, 5: 2, 6: 2, 9: 1, 30: 1, 19: 1, 12: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826865196228027  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826865196228027  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.8063507080078125  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.806352138519287  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.482724666595459  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

pseudo mini batch 2 input nodes size: 981
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826884269714355  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826884269714355  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.488171100616455  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4881715774536133  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.482640266418457  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 6, 1: 6, 3: 5, 4: 5, 6: 3, 8: 3, 5: 3, 11: 1, 7: 1, 30: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.482668399810791  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.482668399810791  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.8054184913635254  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.805419921875  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4827075004577637  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

pseudo mini batch 3 input nodes size: 872
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.482673168182373  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.482673168182373  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4873285293579102  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4873290061950684  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4818458557128906  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 7, 2: 6, 3: 6, 5: 5, 1: 4, 6: 3, 7: 2, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.481870174407959  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.481870174407959  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.7458076477050781  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.7458090782165527  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4819035530090332  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4819035530090332  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.117316722869873  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.060400545597076416 |0.0007418394088745117 |0.14584189653396606 |0.0001087188720703125 |0.2763417959213257 |0.0028276443481445312 |
----------------------------------------------------------pseudo_mini_loss sum 4.718869686126709
Total (block generation + training)time/epoch 1.890917754173279
Training time/epoch 2.0370266437530518
Training time without block to device /epoch 2.0340592861175537
Training time without total dataloading part /epoch 1.6919972896575928
load block tensor time/epoch 0.24160218238830566
block to device time/epoch 0.002967357635498047
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  6631
Number of first layer input nodes during this epoch:  4049
Number of first layer output nodes during this epoch:  1931
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1172170639038086  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.537 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.537 GB
Metis partitioning: 0.001 seconds, peak memory: 16.537 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009609460830688477
pure dgl.metis_partition the time spent:  0.004042387008666992

block_gen_time in "generate_blocks_for_one_layer_block"  0.007784843444824219


block_gen_time in "generate_blocks_for_one_layer_block"  0.010551929473876953


block_gen_time in "generate_blocks_for_one_layer_block"  0.017033815383911133

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1172170639038086  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

connection checking time:  0.01540684700012207
block generation total time  0.035370588302612305
average batch blocks generation time:  0.008842647075653076
block dataloader generation time/epoch 0.07863424041054466
pseudo mini batch 0 input nodes size: 1255
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1171860694885254  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1171860694885254  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1238861083984375  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1238865852355957  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1192307472229004  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 9, 4: 6, 2: 5, 5: 5, 6: 4, 9: 2, 1: 1, 11: 1, 7: 1, 12: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1192636489868164  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1192636489868164  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.509809970855713  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.5098118782043457  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4838690757751465  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

pseudo mini batch 1 input nodes size: 993
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4838247299194336  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4838247299194336  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4893074035644531  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4893078804016113  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.482607364654541  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 8, 3: 6, 4: 6, 2: 5, 5: 3, 6: 2, 10: 2, 12: 1, 19: 1, 21: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826383590698242  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826383590698242  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.843238353729248  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.8432397842407227  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.482682228088379  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

pseudo mini batch 2 input nodes size: 797
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826436042785645  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826436042785645  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4871878623962402  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4871883392333984  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4817051887512207  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 7, 3: 6, 5: 5, 2: 5, 6: 3, 8: 3, 1: 2, 30: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.481729507446289  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.481729507446289  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.7571120262145996  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.7571134567260742  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4817628860473633  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

pseudo mini batch 3 input nodes size: 1079
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4817347526550293  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4817347526550293  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.487494945526123  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4874954223632812  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4829506874084473  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 10, 1: 9, 3: 5, 7: 3, 4: 3, 5: 2, 6: 2, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4829750061035156  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4829750061035156  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.773918628692627  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.7739200592041016  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4830093383789062  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4830093383789062  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.118422508239746  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06092327833175659 |0.0007317066192626953 |0.10096931457519531 |9.834766387939453e-05 |0.25955039262771606 |0.003698587417602539 |
----------------------------------------------------------pseudo_mini_loss sum 4.335390090942383
Total (block generation + training)time/epoch 1.8893273310227827
Training time/epoch 1.793947696685791
Training time without block to device /epoch 1.7910208702087402
Training time without total dataloading part /epoch 1.4461708068847656
load block tensor time/epoch 0.24369311332702637
block to device time/epoch 0.0029268264770507812
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  6743
Number of first layer input nodes during this epoch:  4124
Number of first layer output nodes during this epoch:  1964
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1183228492736816  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.537 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.537 GB
Metis partitioning: 0.000 seconds, peak memory: 16.537 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.00960993766784668
pure dgl.metis_partition the time spent:  0.004360198974609375

block_gen_time in "generate_blocks_for_one_layer_block"  0.0077517032623291016


block_gen_time in "generate_blocks_for_one_layer_block"  0.01028585433959961


block_gen_time in "generate_blocks_for_one_layer_block"  0.016947269439697266

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1183228492736816  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

connection checking time:  0.01556706428527832
block generation total time  0.03498482704162598
average batch blocks generation time:  0.008746206760406494
block dataloader generation time/epoch 0.07865448792775472
pseudo mini batch 0 input nodes size: 1179
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1182880401611328  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1182880401611328  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.124582290649414  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1245827674865723  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1188220977783203  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 6, 3: 6, 4: 6, 5: 4, 6: 3, 1: 3, 9: 2, 10: 2, 21: 1, 11: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1188559532165527  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1188559532165527  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.512831687927246  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.512833595275879  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4843549728393555  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

pseudo mini batch 1 input nodes size: 1096
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4843106269836426  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4843106269836426  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4901618957519531  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4901623725891113  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4838676452636719  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 7, 4: 5, 2: 5, 6: 4, 5: 4, 1: 4, 8: 3, 7: 2, 30: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.483898639678955  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.483898639678955  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.8527202606201172  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.8527216911315918  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4839425086975098  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

pseudo mini batch 2 input nodes size: 1007
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4839038848876953  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4839038848876953  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4893865585327148  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.489387035369873  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4835352897644043  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 8, 3: 7, 1: 5, 2: 4, 5: 4, 6: 3, 12: 1, 19: 1, 9: 1, 10: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4835643768310547  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4835643768310547  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.8158674240112305  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.815868854522705  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4836044311523438  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

pseudo mini batch 3 input nodes size: 744
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4835681915283203  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4835681915283203  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.488112449645996  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4881129264831543  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826297760009766  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 10, 1: 8, 3: 6, 5: 3, 4: 3, 7: 2, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826464653015137  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826464653015137  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.6714577674865723  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.6714591979980469  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826693534851074  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826693534851074  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1171936988830566  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.061844825744628906 |0.0007309913635253906 |0.09730947017669678 |9.948015213012695e-05 |0.24662786722183228 |0.003055095672607422 |
----------------------------------------------------------pseudo_mini_loss sum 7.008884429931641
Total (block generation + training)time/epoch 1.8825106620788574
Training time/epoch 1.7285470962524414
Training time without block to device /epoch 1.7256231307983398
Training time without total dataloading part /epoch 1.3792023658752441
load block tensor time/epoch 0.24737930297851562
block to device time/epoch 0.0029239654541015625
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  6594
Number of first layer input nodes during this epoch:  4026
Number of first layer output nodes during this epoch:  1914
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1170878410339355  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.537 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.537 GB
Metis partitioning: 0.000 seconds, peak memory: 16.537 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.00881338119506836
pure dgl.metis_partition the time spent:  0.00464320182800293

block_gen_time in "generate_blocks_for_one_layer_block"  0.007771968841552734


block_gen_time in "generate_blocks_for_one_layer_block"  0.010504007339477539


block_gen_time in "generate_blocks_for_one_layer_block"  0.017058372497558594

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1170878410339355  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

connection checking time:  0.01554107666015625
block generation total time  0.03533434867858887
average batch blocks generation time:  0.008833587169647217
block dataloader generation time/epoch 0.07864763186528133
pseudo mini batch 0 input nodes size: 1223
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1170649528503418  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1170649528503418  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.124117374420166  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1241178512573242  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1195731163024902  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 4: 5, 2: 5, 5: 4, 6: 3, 9: 3, 1: 3, 10: 2, 7: 2, 11: 1, 21: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1196088790893555  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1196088790893555  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.541595458984375  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.5415973663330078  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4842300415039062  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

pseudo mini batch 1 input nodes size: 857
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4841833114624023  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4841833114624023  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4896659851074219  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.48966646194458  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826135635375977  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 10, 1: 7, 4: 5, 3: 5, 5: 4, 6: 1, 30: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.482633113861084  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.482633113861084  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.724609375  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.7246108055114746  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826607704162598  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

pseudo mini batch 2 input nodes size: 1069
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826345443725586  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826345443725586  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4883413314819336  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4883418083190918  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.482858657836914  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 8, 3: 7, 2: 5, 5: 4, 8: 3, 6: 2, 1: 2, 9: 1, 19: 1, 30: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4828896522521973  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4828896522521973  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.8493719100952148  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.8493733406066895  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.482933521270752  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

pseudo mini batch 3 input nodes size: 917
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4828948974609375  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4828948974609375  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.488377571105957  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4883780479431152  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.482670783996582  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 8, 3: 8, 2: 5, 6: 5, 4: 4, 5: 3, 10: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826931953430176  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826931953430176  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.7468600273132324  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.746861457824707  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4827256202697754  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4827256202697754  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1181387901306152  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06075704097747803 |0.0007340312004089355 |0.1002536416053772 |0.00010287761688232422 |0.2615269422531128 |0.0028460025787353516 |
----------------------------------------------------------pseudo_mini_loss sum 4.136473655700684
Total (block generation + training)time/epoch 1.882041674393874
Training time/epoch 1.7977311611175537
Training time without block to device /epoch 1.794795036315918
Training time without total dataloading part /epoch 1.4503798484802246
load block tensor time/epoch 0.2430281639099121
block to device time/epoch 0.002936124801635742
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  6656
Number of first layer input nodes during this epoch:  4066
Number of first layer output nodes during this epoch:  1934
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1180415153503418  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.537 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.537 GB
Metis partitioning: 0.000 seconds, peak memory: 16.537 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009303808212280273
pure dgl.metis_partition the time spent:  0.004911899566650391

block_gen_time in "generate_blocks_for_one_layer_block"  0.007801055908203125


block_gen_time in "generate_blocks_for_one_layer_block"  0.01048898696899414


block_gen_time in "generate_blocks_for_one_layer_block"  0.016997575759887695

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1180415153503418  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

connection checking time:  0.015366792678833008
block generation total time  0.03528761863708496
average batch blocks generation time:  0.00882190465927124
block dataloader generation time/epoch 0.07869940144675118
pseudo mini batch 0 input nodes size: 1162
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1180105209350586  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1180105209350586  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1250629425048828  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.125063419342041  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1195802688598633  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 7, 4: 6, 5: 5, 1: 4, 2: 4, 6: 3, 9: 2, 10: 2, 12: 1, 21: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1196141242980957  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1196141242980957  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.5180859565734863  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.5180878639221191  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4842243194580078  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

pseudo mini batch 1 input nodes size: 954
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.484179973602295  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.484179973602295  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4896626472473145  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4896631240844727  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826102256774902  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 9, 4: 6, 1: 5, 6: 3, 8: 3, 5: 3, 30: 2, 2: 2, 19: 1, 9: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.482640266418457  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.482640266418457  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.8402867317199707  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.8402881622314453  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.482682228088379  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

pseudo mini batch 2 input nodes size: 864
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826459884643555  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826459884643555  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4872584342956543  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4872589111328125  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4817757606506348  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 8, 2: 7, 3: 5, 5: 4, 4: 4, 6: 4, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4817962646484375  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4817962646484375  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.7201266288757324  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.720128059387207  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.481825828552246  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

pseudo mini batch 3 input nodes size: 956
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.481797218322754  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.481797218322754  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4872798919677734  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4872803688049316  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826674461364746  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 12, 4: 6, 3: 5, 5: 3, 7: 3, 1: 3, 9: 1, 10: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826898574829102  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826898574829102  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.760650634765625  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.7606520652770996  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.482722282409668  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.482722282409668  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1181354522705078  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06066286563873291 |0.0007423162460327148 |0.0995950698852539 |0.00010019540786743164 |0.2529867887496948 |0.0035300254821777344 |
----------------------------------------------------------pseudo_mini_loss sum 3.165541172027588
Total (block generation + training)time/epoch 1.8791649000985282
Training time/epoch 1.7622871398925781
Training time without block to device /epoch 1.7593178749084473
Training time without total dataloading part /epoch 1.4142582416534424
load block tensor time/epoch 0.24265146255493164
block to device time/epoch 0.0029692649841308594
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  6486
Number of first layer input nodes during this epoch:  3936
Number of first layer output nodes during this epoch:  1897
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1180415153503418  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.537 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.537 GB
Metis partitioning: 0.000 seconds, peak memory: 16.537 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009856462478637695
pure dgl.metis_partition the time spent:  0.004296541213989258

block_gen_time in "generate_blocks_for_one_layer_block"  0.0077953338623046875


block_gen_time in "generate_blocks_for_one_layer_block"  0.010274887084960938


block_gen_time in "generate_blocks_for_one_layer_block"  0.0169522762298584

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1180415153503418  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

connection checking time:  0.015453815460205078
block generation total time  0.03502249717712402
average batch blocks generation time:  0.008755624294281006
block dataloader generation time/epoch 0.07873441378275553
pseudo mini batch 0 input nodes size: 1268
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1180105209350586  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1180105209350586  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1250629425048828  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.125063419342041  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1195802688598633  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 7, 2: 6, 3: 6, 5: 4, 6: 3, 7: 2, 1: 2, 9: 2, 21: 1, 12: 1, 10: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.119615077972412  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.119615077972412  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.539736270904541  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.5397381782531738  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.484227180480957  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

pseudo mini batch 1 input nodes size: 882
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4841804504394531  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4841804504394531  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4896631240844727  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4896636009216309  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826107025146484  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 8, 2: 6, 5: 6, 3: 5, 4: 5, 7: 1, 6: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826312065124512  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826312065124512  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.7206859588623047  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.7206873893737793  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826598167419434  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

pseudo mini batch 2 input nodes size: 785
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826316833496094  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826316833496094  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4871759414672852  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4871764183044434  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4816932678222656  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 8, 2: 6, 4: 6, 6: 5, 5: 3, 8: 3, 1: 2, 30: 1, 10: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4817185401916504  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4817185401916504  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.775850772857666  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.7758522033691406  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4817538261413574  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

pseudo mini batch 3 input nodes size: 969
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4817233085632324  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4817233085632324  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.487205982208252  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4872064590454102  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826617240905762  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 8, 3: 7, 2: 7, 4: 4, 6: 2, 5: 2, 9: 1, 12: 1, 30: 1, 7: 1, 19: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826889038085938  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826889038085938  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.798330307006836  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.7983317375183105  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4827260971069336  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4827260971069336  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1181392669677734  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06027829647064209 |0.0007191300392150879 |0.10187578201293945 |9.781122207641602e-05 |0.27366602420806885 |0.004404306411743164 |
----------------------------------------------------------pseudo_mini_loss sum 2.462585926055908
Total (block generation + training)time/epoch 1.882645559310913
Training time/epoch 1.8520495891571045
Training time without block to device /epoch 1.8491730690002441
Training time without total dataloading part /epoch 1.506962776184082
load block tensor time/epoch 0.24111318588256836
block to device time/epoch 0.0028765201568603516
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  6430
Number of first layer input nodes during this epoch:  3904
Number of first layer output nodes during this epoch:  1878
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1180510520935059  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.537 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.537 GB
Metis partitioning: 0.000 seconds, peak memory: 16.537 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009654998779296875
pure dgl.metis_partition the time spent:  0.004943370819091797

block_gen_time in "generate_blocks_for_one_layer_block"  0.0077762603759765625


block_gen_time in "generate_blocks_for_one_layer_block"  0.010136842727661133


block_gen_time in "generate_blocks_for_one_layer_block"  0.0168609619140625

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1180510520935059  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

connection checking time:  0.015271663665771484
block generation total time  0.034774065017700195
average batch blocks generation time:  0.008693516254425049
block dataloader generation time/epoch 0.0787704735994339
pseudo mini batch 0 input nodes size: 1067
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.118016242980957  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.118016242980957  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1237125396728516  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1237130165100098  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.118229866027832  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 9, 4: 5, 5: 5, 1: 5, 8: 3, 30: 2, 6: 2, 12: 1, 10: 1, 2: 1, 9: 1, 21: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.118262767791748  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.118262767791748  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.51983642578125  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.5198383331298828  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4828672409057617  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

pseudo mini batch 1 input nodes size: 719
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4828267097473145  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4828267097473145  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4867329597473145  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4867334365844727  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.48103666305542  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 7, 1: 7, 3: 5, 4: 5, 5: 4, 6: 3, 7: 1, 19: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4810552597045898  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4810552597045898  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.6906447410583496  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.6906461715698242  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4810819625854492  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

pseudo mini batch 2 input nodes size: 1172
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4810576438903809  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4810576438903809  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.488110065460205  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4881105422973633  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.484203815460205  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 7, 4: 7, 3: 7, 5: 4, 6: 3, 1: 2, 9: 2, 10: 1, 7: 1, 11: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4842348098754883  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4842348098754883  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.8473243713378906  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.8473258018493652  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4842777252197266  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

pseudo mini batch 3 input nodes size: 973
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4842371940612793  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4842371940612793  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4897198677062988  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.489720344543457  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826674461364746  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 10, 1: 6, 3: 5, 4: 5, 6: 3, 7: 2, 5: 2, 10: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.482691764831543  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.482691764831543  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.7794241905212402  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.7794256210327148  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.48272705078125  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.48272705078125  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1181402206420898  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06115180253982544 |0.0007227063179016113 |0.09960675239562988 |0.00010591745376586914 |0.25091809034347534 |0.003143787384033203 |
----------------------------------------------------------pseudo_mini_loss sum 2.3827409744262695
Total (block generation + training)time/epoch 1.8796408772468567
Training time/epoch 1.7551608085632324
Training time without block to device /epoch 1.752269983291626
Training time without total dataloading part /epoch 1.4056668281555176
load block tensor time/epoch 0.24460721015930176
block to device time/epoch 0.0028908252716064453
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  6479
Number of first layer input nodes during this epoch:  3931
Number of first layer output nodes during this epoch:  1898
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1180462837219238  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.537 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.537 GB
Metis partitioning: 0.000 seconds, peak memory: 16.537 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009009599685668945
pure dgl.metis_partition the time spent:  0.004820108413696289

block_gen_time in "generate_blocks_for_one_layer_block"  0.007712602615356445


block_gen_time in "generate_blocks_for_one_layer_block"  0.01010441780090332


block_gen_time in "generate_blocks_for_one_layer_block"  0.017203330993652344

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1180462837219238  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

connection checking time:  0.015496492385864258
block generation total time  0.03502035140991211
average batch blocks generation time:  0.008755087852478027
block dataloader generation time/epoch 0.07874826823963839
pseudo mini batch 0 input nodes size: 1173
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1180133819580078  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1180133819580078  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.125065803527832  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1250662803649902  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1195831298828125  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 7, 4: 6, 5: 5, 2: 5, 1: 3, 6: 3, 9: 2, 10: 2, 11: 1, 12: 1, 21: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.119616985321045  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.119616985321045  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.5244154930114746  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.5244174003601074  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4842243194580078  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

pseudo mini batch 1 input nodes size: 983
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.484179973602295  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.484179973602295  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4896626472473145  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4896631240844727  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826102256774902  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 9, 1: 6, 4: 5, 2: 5, 5: 4, 6: 2, 30: 1, 19: 1, 9: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826374053955078  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826374053955078  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.7890381813049316  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.7890396118164062  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826745986938477  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

pseudo mini batch 2 input nodes size: 989
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.482640266418457  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.482640266418457  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4879202842712402  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4879207611083984  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4824376106262207  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 9, 4: 6, 2: 5, 1: 4, 6: 3, 8: 3, 5: 3, 9: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.482466697692871  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.482466697692871  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.8098220825195312  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.8098235130310059  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4825067520141602  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

pseudo mini batch 3 input nodes size: 912
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4824705123901367  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4824705123901367  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4879531860351562  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4879536628723145  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.482673168182373  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 10, 1: 7, 4: 5, 7: 4, 6: 3, 5: 3, 3: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826955795288086  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826955795288086  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.7425870895385742  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.7425885200500488  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4827280044555664  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4827280044555664  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1181411743164062  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06169760227203369 |0.0007205605506896973 |0.10119056701660156 |0.00010162591934204102 |0.26444578170776367 |0.003335714340209961 |
----------------------------------------------------------pseudo_mini_loss sum 2.4067270755767822
Total (block generation + training)time/epoch 1.8805872973273783
Training time/epoch 1.8172357082366943
Training time without block to device /epoch 1.8143534660339355
Training time without total dataloading part /epoch 1.466287612915039
load block tensor time/epoch 0.24679040908813477
block to device time/epoch 0.002882242202758789
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  6659
Number of first layer input nodes during this epoch:  4057
Number of first layer output nodes during this epoch:  1945
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1180415153503418  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.537 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.537 GB
Metis partitioning: 0.000 seconds, peak memory: 16.537 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009783267974853516
pure dgl.metis_partition the time spent:  0.004200935363769531

block_gen_time in "generate_blocks_for_one_layer_block"  0.0077075958251953125


block_gen_time in "generate_blocks_for_one_layer_block"  0.010469913482666016


block_gen_time in "generate_blocks_for_one_layer_block"  0.016722440719604492

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1180415153503418  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

connection checking time:  0.015092611312866211
block generation total time  0.03489995002746582
average batch blocks generation time:  0.008724987506866455
block dataloader generation time/epoch 0.07872757646772596
pseudo mini batch 0 input nodes size: 1141
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1180105209350586  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1180105209350586  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1250629425048828  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.125063419342041  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1195802688598633  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 7, 3: 7, 2: 4, 5: 4, 1: 4, 6: 3, 9: 2, 10: 1, 12: 1, 11: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1196112632751465  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1196112632751465  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4782648086547852  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.478266716003418  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.484217643737793  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

pseudo mini batch 1 input nodes size: 1038
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4841771125793457  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4841771125793457  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4901995658874512  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4902000427246094  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.483147144317627  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 10, 3: 8, 4: 4, 6: 3, 5: 3, 9: 1, 2: 1, 10: 1, 21: 1, 7: 1, 30: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4831790924072266  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4831790924072266  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.8519549369812012  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.8519563674926758  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4832239151000977  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

pseudo mini batch 2 input nodes size: 974
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4831833839416504  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4831833839416504  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.48866605758667  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4886665344238281  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826436042785645  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 7, 4: 6, 2: 6, 5: 5, 8: 3, 1: 2, 6: 2, 7: 1, 9: 1, 30: 1, 19: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826717376708984  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826717376708984  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.8192691802978516  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.8192706108093262  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.482710838317871  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

pseudo mini batch 3 input nodes size: 709
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826765060424805  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4826765060424805  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4865827560424805  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4865832328796387  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.481100082397461  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 14, 4: 5, 1: 4, 3: 4, 5: 3, 6: 3, 10: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.481116771697998  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.481116771697998  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.6759886741638184  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.675990104675293  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4811396598815918  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.4811396598815918  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.86474609375 GB
    Memory Allocated: 1.1165528297424316  GigaBytes
Max Memory Allocated: 2.173737049102783  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.060882568359375 |0.0007185935974121094 |0.09950464963912964 |9.518861770629883e-05 |0.26362156867980957 |0.0028924942016601562 |
----------------------------------------------------------pseudo_mini_loss sum 2.2919387817382812
Total (block generation + training)time/epoch 1.8804496261808608
Training time/epoch 1.7996344566345215
Training time without block to device /epoch 1.796760082244873
Training time without total dataloading part /epoch 1.4557781219482422
load block tensor time/epoch 0.2435302734375
block to device time/epoch 0.0028743743896484375
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  6366
Number of first layer input nodes during this epoch:  3862
Number of first layer output nodes during this epoch:  1859
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(1433, 1433, batch_first=True)
      (fc_self): Linear(in_features=1433, out_features=2048, bias=False)
      (fc_neigh): Linear(in_features=1433, out_features=2048, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(2048, 2048, batch_first=True)
      (fc_self): Linear(in_features=2048, out_features=2048, bias=False)
      (fc_neigh): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (2): SAGEConv(
      (lstm): LSTM(2048, 2048, batch_first=True)
      (fc_self): Linear(in_features=2048, out_features=7, bias=False)
      (fc_neigh): Linear(in_features=2048, out_features=7, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  97867856
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([5732, 1433])
layers.0.lstm.weight_hh_l0, torch.Size([5732, 1433])
layers.0.lstm.bias_ih_l0, torch.Size([5732])
layers.0.lstm.bias_hh_l0, torch.Size([5732])
layers.0.fc_self.weight, torch.Size([2048, 1433])
layers.0.fc_neigh.weight, torch.Size([2048, 1433])
layers.1.lstm.weight_ih_l0, torch.Size([8192, 2048])
layers.1.lstm.weight_hh_l0, torch.Size([8192, 2048])
layers.1.lstm.bias_ih_l0, torch.Size([8192])
layers.1.lstm.bias_hh_l0, torch.Size([8192])
layers.1.fc_self.weight, torch.Size([2048, 2048])
layers.1.fc_neigh.weight, torch.Size([2048, 2048])
layers.2.lstm.weight_ih_l0, torch.Size([8192, 2048])
layers.2.lstm.weight_hh_l0, torch.Size([8192, 2048])
layers.2.lstm.bias_ih_l0, torch.Size([8192])
layers.2.lstm.bias_hh_l0, torch.Size([8192])
layers.2.fc_self.weight, torch.Size([7, 2048])
layers.2.fc_neigh.weight, torch.Size([7, 2048])
----------------------------------------
un-trainable parameters
