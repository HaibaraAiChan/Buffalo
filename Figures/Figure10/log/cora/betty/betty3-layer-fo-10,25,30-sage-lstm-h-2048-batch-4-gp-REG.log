main start at this time 1733091883.2621005
-----------------------------------------before load data 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

----------------------------------------start of run function 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  1433
----------------------------------------before model to device 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 0.88623046875 GB
    Memory Allocated: 0.3674592971801758  GigaBytes
Max Memory Allocated: 0.3674592971801758  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 0.88818359375 GB
    Memory Allocated: 0.3674592971801758  GigaBytes
Max Memory Allocated: 0.3674592971801758  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 13.818 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 13.818 GB
Metis partitioning: 0.000 seconds, peak memory: 13.818 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.023633956909179688
pure dgl.metis_partition the time spent:  0.005111217498779297
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.009786128997802734

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.011222600936889648

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.0171201229095459

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 0.88818359375 GB
    Memory Allocated: 0.3674592971801758  GigaBytes
Max Memory Allocated: 0.3674592971801758  GigaBytes

connection checking time:  0.014944314956665039
block generation total time  0.03812885284423828
average batch blocks generation time:  0.00953221321105957
pseudo mini batch 0 input nodes size: 1321
----------------------------------------before load block subtensor 
 Nvidia-smi: 0.88818359375 GB
    Memory Allocated: 0.3674592971801758  GigaBytes
Max Memory Allocated: 0.3674592971801758  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 0.88818359375 GB
    Memory Allocated: 0.3674592971801758  GigaBytes
Max Memory Allocated: 0.3674592971801758  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 0.90771484375 GB
    Memory Allocated: 0.37451171875  GigaBytes
Max Memory Allocated: 0.37451171875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 0.90771484375 GB
    Memory Allocated: 0.3745121955871582  GigaBytes
Max Memory Allocated: 0.3745121955871582  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 0.90771484375 GB
    Memory Allocated: 0.3745121955871582  GigaBytes
Max Memory Allocated: 0.3745121955871582  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 6, 3: 6, 4: 6, 5: 4, 6: 3, 9: 2, 10: 2, 7: 2, 12: 2, 1: 1, 11: 1, 21: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 0.90771484375 GB
    Memory Allocated: 0.37454891204833984  GigaBytes
Max Memory Allocated: 0.37454891204833984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 0.90771484375 GB
    Memory Allocated: 0.37454891204833984  GigaBytes
Max Memory Allocated: 0.37454891204833984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.40576171875 GB
    Memory Allocated: 0.8263378143310547  GigaBytes
Max Memory Allocated: 0.8284335136413574  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.40576171875 GB
    Memory Allocated: 0.8263397216796875  GigaBytes
Max Memory Allocated: 0.8284335136413574  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.85107421875 GB
    Memory Allocated: 0.7557220458984375  GigaBytes
Max Memory Allocated: 1.207221508026123  GigaBytes

pseudo mini batch 1 input nodes size: 726
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.85107421875 GB
    Memory Allocated: 0.7556734085083008  GigaBytes
Max Memory Allocated: 1.207221508026123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.85107421875 GB
    Memory Allocated: 0.7556734085083008  GigaBytes
Max Memory Allocated: 1.207221508026123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.85107421875 GB
    Memory Allocated: 0.7602176666259766  GigaBytes
Max Memory Allocated: 1.207221508026123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.85107421875 GB
    Memory Allocated: 0.7602181434631348  GigaBytes
Max Memory Allocated: 1.207221508026123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.85107421875 GB
    Memory Allocated: 0.7531652450561523  GigaBytes
Max Memory Allocated: 1.207221508026123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 9, 3: 9, 1: 7, 4: 4, 5: 2, 19: 1, 9: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 1.85107421875 GB
    Memory Allocated: 0.7531828880310059  GigaBytes
Max Memory Allocated: 1.207221508026123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.85107421875 GB
    Memory Allocated: 0.7531828880310059  GigaBytes
Max Memory Allocated: 1.207221508026123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.85107421875 GB
    Memory Allocated: 0.9508056640625  GigaBytes
Max Memory Allocated: 1.207221508026123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.85107421875 GB
    Memory Allocated: 0.9508070945739746  GigaBytes
Max Memory Allocated: 1.207221508026123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.03857421875 GB
    Memory Allocated: 0.7532086372375488  GigaBytes
Max Memory Allocated: 1.207221508026123  GigaBytes

pseudo mini batch 2 input nodes size: 847
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.03857421875 GB
    Memory Allocated: 0.7531862258911133  GigaBytes
Max Memory Allocated: 1.207221508026123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.03857421875 GB
    Memory Allocated: 0.7531862258911133  GigaBytes
Max Memory Allocated: 1.207221508026123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.03857421875 GB
    Memory Allocated: 0.7577080726623535  GigaBytes
Max Memory Allocated: 1.207221508026123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.03857421875 GB
    Memory Allocated: 0.7577085494995117  GigaBytes
Max Memory Allocated: 1.207221508026123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.03857421875 GB
    Memory Allocated: 0.7531638145446777  GigaBytes
Max Memory Allocated: 1.207221508026123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 6, 1: 6, 3: 5, 5: 5, 6: 4, 8: 3, 2: 3, 7: 1, 30: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.03857421875 GB
    Memory Allocated: 0.7531890869140625  GigaBytes
Max Memory Allocated: 1.207221508026123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.03857421875 GB
    Memory Allocated: 0.7531890869140625  GigaBytes
Max Memory Allocated: 1.207221508026123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.03857421875 GB
    Memory Allocated: 1.0408039093017578  GigaBytes
Max Memory Allocated: 1.207221508026123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.03857421875 GB
    Memory Allocated: 1.0408053398132324  GigaBytes
Max Memory Allocated: 1.207221508026123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.03857421875 GB
    Memory Allocated: 0.7532243728637695  GigaBytes
Max Memory Allocated: 1.2894916534423828  GigaBytes

pseudo mini batch 3 input nodes size: 1027
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.03857421875 GB
    Memory Allocated: 0.7531938552856445  GigaBytes
Max Memory Allocated: 1.2894916534423828  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.03857421875 GB
    Memory Allocated: 0.7531938552856445  GigaBytes
Max Memory Allocated: 1.2894916534423828  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.03857421875 GB
    Memory Allocated: 0.7586765289306641  GigaBytes
Max Memory Allocated: 1.2894916534423828  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.03857421875 GB
    Memory Allocated: 0.7586770057678223  GigaBytes
Max Memory Allocated: 1.2894916534423828  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.03857421875 GB
    Memory Allocated: 0.7541546821594238  GigaBytes
Max Memory Allocated: 1.2894916534423828  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 7, 4: 6, 1: 6, 3: 6, 5: 4, 6: 3, 10: 1, 7: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.03857421875 GB
    Memory Allocated: 0.7541847229003906  GigaBytes
Max Memory Allocated: 1.2894916534423828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.03857421875 GB
    Memory Allocated: 0.7541847229003906  GigaBytes
Max Memory Allocated: 1.2894916534423828  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.03857421875 GB
    Memory Allocated: 1.088707447052002  GigaBytes
Max Memory Allocated: 1.2894916534423828  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.03857421875 GB
    Memory Allocated: 1.0887088775634766  GigaBytes
Max Memory Allocated: 1.2894916534423828  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.03857421875 GB
    Memory Allocated: 0.7542257308959961  GigaBytes
Max Memory Allocated: 1.3371696472167969  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.4833993911743164  GigaBytes
Max Memory Allocated: 1.8492870330810547  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.1181488037109375  GigaBytes
Max Memory Allocated: 1.8492870330810547  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06185770034790039 |0.002129495143890381 |0.35048097372055054 |0.003575921058654785 |0.2584812641143799 |0.13475871086120605 |
----------------------------------------------------------pseudo_mini_loss sum 1.9504709243774414
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6469
Number of first layer input nodes during this epoch:  3921
Number of first layer output nodes during this epoch:  1895
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.1180577278137207  GigaBytes
Max Memory Allocated: 1.8492870330810547  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.183 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.183 GB
Metis partitioning: 0.000 seconds, peak memory: 16.183 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.011696815490722656
pure dgl.metis_partition the time spent:  0.00455784797668457
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.009721517562866211

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.011335134506225586

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.01817035675048828

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.1180577278137207  GigaBytes
Max Memory Allocated: 1.8492870330810547  GigaBytes

connection checking time:  0.015908002853393555
block generation total time  0.03922700881958008
average batch blocks generation time:  0.00980675220489502
pseudo mini batch 0 input nodes size: 1212
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.1180191040039062  GigaBytes
Max Memory Allocated: 1.8492870330810547  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.1180191040039062  GigaBytes
Max Memory Allocated: 1.8492870330810547  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.1250715255737305  GigaBytes
Max Memory Allocated: 1.8492870330810547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.1250720024108887  GigaBytes
Max Memory Allocated: 1.8492870330810547  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.119588851928711  GigaBytes
Max Memory Allocated: 1.8492870330810547  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 7, 2: 5, 1: 4, 5: 4, 4: 4, 6: 3, 9: 2, 12: 2, 10: 2, 11: 1, 7: 1, 21: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.1196227073669434  GigaBytes
Max Memory Allocated: 1.8492870330810547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.1196227073669434  GigaBytes
Max Memory Allocated: 1.8492870330810547  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.5305185317993164  GigaBytes
Max Memory Allocated: 1.8492870330810547  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.5305204391479492  GigaBytes
Max Memory Allocated: 1.8492870330810547  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.4842243194580078  GigaBytes
Max Memory Allocated: 1.9037699699401855  GigaBytes

pseudo mini batch 1 input nodes size: 935
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.484179973602295  GigaBytes
Max Memory Allocated: 1.9037699699401855  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.484179973602295  GigaBytes
Max Memory Allocated: 1.9037699699401855  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.4896626472473145  GigaBytes
Max Memory Allocated: 1.9037699699401855  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.4896631240844727  GigaBytes
Max Memory Allocated: 1.9037699699401855  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.4826102256774902  GigaBytes
Max Memory Allocated: 1.9037699699401855  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 8, 3: 6, 2: 5, 5: 4, 1: 3, 6: 3, 9: 2, 8: 2, 30: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.4826383590698242  GigaBytes
Max Memory Allocated: 1.9037699699401855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.4826383590698242  GigaBytes
Max Memory Allocated: 1.9037699699401855  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.8059186935424805  GigaBytes
Max Memory Allocated: 1.9037699699401855  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.805920124053955  GigaBytes
Max Memory Allocated: 1.9037699699401855  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826774597167969  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

pseudo mini batch 2 input nodes size: 929
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826431274414062  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826431274414062  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.487602710723877  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4876031875610352  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4821200370788574  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 8, 3: 8, 1: 6, 4: 5, 5: 3, 7: 2, 6: 2, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.482142448425293  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.482142448425293  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.7503113746643066  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.7503128051757812  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4821748733520508  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

pseudo mini batch 3 input nodes size: 968
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4821443557739258  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4821443557739258  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4876270294189453  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4876275062561035  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826674461364746  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 7, 2: 7, 4: 5, 3: 5, 5: 4, 6: 3, 30: 1, 19: 1, 8: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826946258544922  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826946258544922  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.7985520362854004  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.798553466796875  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.482731819152832  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.482731819152832  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1181449890136719  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06011950969696045 |0.0008561015129089355 |0.10780948400497437 |0.00011855363845825195 |0.274150013923645 |0.00402379035949707 |
----------------------------------------------------------pseudo_mini_loss sum 52.52025604248047
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6683
Number of first layer input nodes during this epoch:  4044
Number of first layer output nodes during this epoch:  1978
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1180510520935059  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.281 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.281 GB
Metis partitioning: 0.000 seconds, peak memory: 16.281 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.010297536849975586
pure dgl.metis_partition the time spent:  0.004511117935180664
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.009552478790283203

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.011586666107177734

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.01732468605041504

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1180510520935059  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

connection checking time:  0.015084981918334961
block generation total time  0.03846383094787598
average batch blocks generation time:  0.009615957736968994
block dataloader generation time/epoch 0.08472585678100586
pseudo mini batch 0 input nodes size: 1276
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.118016242980957  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.118016242980957  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1250686645507812  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1250691413879395  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1195859909057617  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 7, 4: 6, 2: 5, 6: 3, 5: 3, 7: 2, 12: 2, 1: 2, 9: 2, 10: 2, 21: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1196227073669434  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1196227073669434  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.5547256469726562  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.554727554321289  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.484231948852539  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

pseudo mini batch 1 input nodes size: 979
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4841833114624023  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4841833114624023  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4896659851074219  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.48966646194458  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826135635375977  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 9, 4: 6, 1: 3, 8: 3, 6: 3, 5: 3, 2: 3, 30: 2, 9: 2, 19: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826436042785645  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826436042785645  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.8423452377319336  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.8423466682434082  GigaBytes
Max Memory Allocated: 2.054396629333496  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826855659484863  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

pseudo mini batch 2 input nodes size: 909
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.482649326324463  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.482649326324463  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.487502098083496  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4875025749206543  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4820194244384766  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 9, 2: 8, 3: 7, 4: 4, 6: 3, 5: 3, 10: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.482041835784912  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.482041835784912  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.7461810111999512  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.7461824417114258  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.48207426071167  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

pseudo mini batch 3 input nodes size: 773
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.482043743133545  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.482043743133545  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4865880012512207  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.486588478088379  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4817352294921875  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 9, 4: 6, 5: 6, 1: 6, 3: 3, 6: 2, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4817538261413574  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4817538261413574  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.7003183364868164  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.700319766998291  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4817805290222168  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4817805290222168  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1171936988830566  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05986565351486206 |0.0008360147476196289 |0.10493052005767822 |0.00011497735977172852 |0.25512850284576416 |0.002971172332763672 |
----------------------------------------------------------pseudo_mini_loss sum 111.05778503417969
Total (block generation + training)time/epoch 1.8775811195373535
Training time/epoch 1.7926576137542725
Training time without block to device /epoch 1.789313554763794
Training time without total dataloading part /epoch 1.4436671733856201
load block tensor time/epoch 0.23946261405944824
block to device time/epoch 0.0033440589904785156
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  6488
Number of first layer input nodes during this epoch:  3937
Number of first layer output nodes during this epoch:  1898
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.117093563079834  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.281 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.281 GB
Metis partitioning: 0.000 seconds, peak memory: 16.281 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.003 seconds
REG metis partition end ----................................
REG construction  time spent:  0.010169029235839844
pure dgl.metis_partition the time spent:  0.005227565765380859
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.009447813034057617

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.011098146438598633

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.017593860626220703

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.117093563079834  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

connection checking time:  0.015272855758666992
block generation total time  0.03813982009887695
average batch blocks generation time:  0.009534955024719238
block dataloader generation time/epoch 0.08462011814117432
pseudo mini batch 0 input nodes size: 876
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1170687675476074  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1170687675476074  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.122551441192627  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1225519180297852  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1180071830749512  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 10, 3: 7, 1: 4, 6: 4, 8: 3, 5: 3, 9: 1, 19: 1, 30: 1, 2: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1180334091186523  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1180334091186523  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4209184646606445  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4209203720092773  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826364517211914  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

pseudo mini batch 1 input nodes size: 941
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826040267944336  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826040267944336  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4876275062561035  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4876279830932617  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.482144832611084  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 8, 2: 8, 6: 4, 4: 3, 5: 3, 3: 3, 7: 3, 9: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4821672439575195  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4821672439575195  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.7580461502075195  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.7580475807189941  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4821996688842773  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

pseudo mini batch 2 input nodes size: 1209
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4821691513061523  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4821691513061523  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4886236190795898  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.488624095916748  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.48360013961792  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 6, 2: 6, 3: 6, 5: 4, 6: 3, 10: 2, 9: 2, 1: 2, 12: 1, 7: 1, 21: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4836339950561523  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4836339950561523  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.892477035522461  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.8924784660339355  GigaBytes
Max Memory Allocated: 2.0906286239624023  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4836807250976562  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

pseudo mini batch 3 input nodes size: 923
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4836363792419434  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4836363792419434  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.489119052886963  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.489119529724121  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826645851135254  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 10, 2: 10, 1: 6, 5: 5, 4: 3, 12: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826898574829102  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826898574829102  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.7565999031066895  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.756601333618164  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4827241897583008  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4827241897583008  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1181373596191406  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06054508686065674 |0.0007262825965881348 |0.09867990016937256 |0.00011205673217773438 |0.26004183292388916 |0.003699064254760742 |
----------------------------------------------------------pseudo_mini_loss sum 136.74124145507812
Total (block generation + training)time/epoch 1.8739076852798462
Training time/epoch 1.7856080532073975
Training time without block to device /epoch 1.782702922821045
Training time without total dataloading part /epoch 1.4390342235565186
load block tensor time/epoch 0.24218034744262695
block to device time/epoch 0.002905130386352539
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  6483
Number of first layer input nodes during this epoch:  3949
Number of first layer output nodes during this epoch:  1881
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1180462837219238  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.281 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.281 GB
Metis partitioning: 0.000 seconds, peak memory: 16.281 GB
Split the graph: 0.002 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.010698080062866211
pure dgl.metis_partition the time spent:  0.004959821701049805
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.007630109786987305

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.009860515594482422

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.015783071517944336

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1180462837219238  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

connection checking time:  0.014670133590698242
block generation total time  0.03327369689941406
average batch blocks generation time:  0.008318424224853516
block dataloader generation time/epoch 0.0824900468190511
pseudo mini batch 0 input nodes size: 1209
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1180133819580078  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1180133819580078  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.125065803527832  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1250662803649902  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1195831298828125  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 11, 4: 5, 1: 4, 2: 4, 10: 2, 6: 2, 5: 2, 12: 2, 21: 1, 9: 1, 19: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1196188926696777  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1196188926696777  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.5522217750549316  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.5522236824035645  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4842300415039062  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

pseudo mini batch 1 input nodes size: 1204
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4841833114624023  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4841833114624023  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4906110763549805  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4906115531921387  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4835586547851562  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 8, 2: 8, 1: 5, 5: 4, 7: 3, 3: 3, 9: 2, 11: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.483588695526123  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.483588695526123  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.8304057121276855  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.8304071426391602  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4836297035217285  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

pseudo mini batch 2 input nodes size: 896
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4835891723632812  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4835891723632812  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4890718460083008  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.489072322845459  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826440811157227  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 7, 1: 6, 2: 5, 6: 4, 4: 4, 8: 3, 5: 2, 30: 1, 9: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826703071594238  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826703071594238  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.7849459648132324  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.784947395324707  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4827065467834473  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

pseudo mini batch 3 input nodes size: 740
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826741218566895  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826741218566895  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4872183799743652  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4872188568115234  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4817357063293457  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 8, 5: 7, 4: 5, 1: 5, 3: 5, 6: 4, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4817543029785156  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4817543029785156  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.7014694213867188  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.7014708518981934  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.481781005859375  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.481781005859375  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1171941757202148  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06150805950164795 |0.0007225871086120605 |0.09690260887145996 |9.930133819580078e-05 |0.2452968955039978 |0.002842426300048828 |
----------------------------------------------------------pseudo_mini_loss sum 69.99978637695312
Total (block generation + training)time/epoch 1.849128007888794
Training time/epoch 1.7212333679199219
Training time without block to device /epoch 1.7183430194854736
Training time without total dataloading part /epoch 1.372037649154663
load block tensor time/epoch 0.2460322380065918
block to device time/epoch 0.002890348434448242
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  6653
Number of first layer input nodes during this epoch:  4049
Number of first layer output nodes during this epoch:  1950
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.117093563079834  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.281 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.281 GB
Metis partitioning: 0.000 seconds, peak memory: 16.281 GB
Split the graph: 0.002 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.010516643524169922
pure dgl.metis_partition the time spent:  0.004899740219116211
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.007622957229614258

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.009647130966186523

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.015593290328979492

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.117093563079834  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

connection checking time:  0.014335155487060547
block generation total time  0.03286337852478027
average batch blocks generation time:  0.008215844631195068
block dataloader generation time/epoch 0.08104252815246582
pseudo mini batch 0 input nodes size: 1236
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1170687675476074  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1170687675476074  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1241211891174316  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1241216659545898  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1195769309997559  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 8, 5: 5, 4: 5, 2: 4, 1: 4, 6: 3, 9: 2, 7: 1, 21: 1, 12: 1, 10: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1196117401123047  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1196117401123047  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.5307211875915527  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.5307230949401855  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.484227180480957  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

pseudo mini batch 1 input nodes size: 1085
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4841804504394531  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4841804504394531  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4899725914001465  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4899730682373047  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4829201698303223  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 9, 3: 7, 4: 7, 5: 3, 2: 3, 7: 2, 12: 1, 9: 1, 10: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4829492568969727  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4829492568969727  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.82157564163208  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.8215770721435547  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4829893112182617  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

pseudo mini batch 2 input nodes size: 866
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4829506874084473  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4829506874084473  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4884333610534668  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.488433837890625  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826412200927734  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 7, 2: 7, 4: 5, 1: 3, 8: 3, 6: 3, 5: 2, 9: 1, 19: 1, 30: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826664924621582  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826664924621582  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.7820496559143066  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.7820510864257812  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4827017784118652  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

pseudo mini batch 3 input nodes size: 716
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826712608337402  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826712608337402  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4865775108337402  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4865779876708984  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4810948371887207  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 11, 4: 5, 6: 5, 5: 5, 3: 4, 1: 4, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4811134338378906  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4811134338378906  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.7035551071166992  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.7035565376281738  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.48114013671875  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.48114013671875  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1165533065795898  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.061189353466033936 |0.0007334351539611816 |0.1002039909362793 |0.00010383129119873047 |0.26721858978271484 |0.0030574798583984375 |
----------------------------------------------------------pseudo_mini_loss sum 227.77064514160156
Total (block generation + training)time/epoch 1.861044466495514
Training time/epoch 1.819986343383789
Training time without block to device /epoch 1.8170526027679443
Training time without total dataloading part /epoch 1.47316312789917
load block tensor time/epoch 0.24475741386413574
block to device time/epoch 0.0029337406158447266
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  6442
Number of first layer input nodes during this epoch:  3903
Number of first layer output nodes during this epoch:  1888
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1164555549621582  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.281 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.281 GB
Metis partitioning: 0.000 seconds, peak memory: 16.281 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.011133193969726562
pure dgl.metis_partition the time spent:  0.004399538040161133
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.007719516754150391

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.009559869766235352

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.016013622283935547

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1164555549621582  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

connection checking time:  0.014565467834472656
block generation total time  0.03329300880432129
average batch blocks generation time:  0.008323252201080322
block dataloader generation time/epoch 0.08052325248718262
pseudo mini batch 0 input nodes size: 1177
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1164307594299316  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1164307594299316  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1234831809997559  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.123483657836914  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1195769309997559  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 9, 2: 5, 4: 5, 1: 3, 5: 3, 6: 3, 9: 2, 12: 2, 10: 2, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1196088790893555  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1196088790893555  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.495384693145752  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4953866004943848  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4842195510864258  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

pseudo mini batch 1 input nodes size: 902
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4841771125793457  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4841771125793457  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4896597862243652  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4896602630615234  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.482607364654541  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 7, 4: 6, 5: 4, 1: 4, 3: 4, 8: 3, 6: 3, 9: 2, 30: 1, 10: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826345443725586  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826345443725586  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.8042283058166504  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.804229736328125  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826726913452148  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

pseudo mini batch 2 input nodes size: 925
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.482640266418457  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.482640266418457  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4875783920288086  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4875788688659668  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.482095718383789  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 10, 4: 8, 1: 5, 2: 4, 5: 3, 19: 1, 7: 1, 30: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4821209907531738  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4821209907531738  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.7659530639648438  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.7659544944763184  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4821562767028809  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

pseudo mini batch 3 input nodes size: 1025
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4821257591247559  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4821257591247559  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4876084327697754  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4876089096069336  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826703071594238  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 9, 1: 8, 5: 5, 6: 4, 3: 3, 4: 3, 7: 2, 21: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826984405517578  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826984405517578  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.796797275543213  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.7967987060546875  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.482736587524414  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.482736587524414  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.118149757385254  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06022906303405762 |0.0007268190383911133 |0.10122013092041016 |9.85860824584961e-05 |0.27125120162963867 |0.0030243396759033203 |
----------------------------------------------------------pseudo_mini_loss sum 159.025634765625
Total (block generation + training)time/epoch 1.8724877834320068
Training time/epoch 1.8396987915039062
Training time without block to device /epoch 1.8367915153503418
Training time without total dataloading part /epoch 1.4933040142059326
load block tensor time/epoch 0.24091625213623047
block to device time/epoch 0.002907276153564453
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  6617
Number of first layer input nodes during this epoch:  4029
Number of first layer output nodes during this epoch:  1936
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1180529594421387  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.281 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.281 GB
Metis partitioning: 0.000 seconds, peak memory: 16.281 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.00943303108215332
pure dgl.metis_partition the time spent:  0.004693031311035156
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.0076558589935302734

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.009511709213256836

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.01592278480529785

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1180529594421387  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

connection checking time:  0.014458656311035156
block generation total time  0.03309035301208496
average batch blocks generation time:  0.00827258825302124
block dataloader generation time/epoch 0.07973885536193848
pseudo mini batch 0 input nodes size: 1194
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.118016242980957  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.118016242980957  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1250686645507812  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1250691413879395  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1195859909057617  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 7, 2: 7, 4: 6, 6: 4, 1: 4, 5: 2, 7: 2, 10: 1, 12: 1, 9: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1196179389953613  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1196179389953613  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4841117858886719  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4841136932373047  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4842195510864258  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

pseudo mini batch 1 input nodes size: 905
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4841771125793457  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4841771125793457  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4896597862243652  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4896602630615234  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.482607364654541  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 8, 3: 7, 1: 7, 4: 5, 5: 3, 6: 1, 10: 1, 21: 1, 9: 1, 19: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826335906982422  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826335906982422  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.7859244346618652  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.7859258651733398  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826698303222656  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

pseudo mini batch 2 input nodes size: 746
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826374053955078  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826374053955078  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4871816635131836  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4871821403503418  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.481698989868164  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 8, 5: 7, 1: 5, 6: 4, 2: 3, 3: 3, 8: 2, 9: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4817233085632324  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4817233085632324  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.7512941360473633  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.751295566558838  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4817566871643066  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

pseudo mini batch 3 input nodes size: 1098
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4817285537719727  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4817285537719727  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4875903129577637  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4875907897949219  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.483046054840088  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 9, 2: 7, 1: 4, 5: 3, 4: 3, 6: 2, 7: 2, 8: 1, 12: 1, 30: 1, 9: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4830760955810547  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4830760955810547  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.8328008651733398  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.8328022956848145  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4831180572509766  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4831180572509766  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1185312271118164  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05876576900482178 |0.000742495059967041 |0.10064190626144409 |0.00010019540786743164 |0.26853615045547485 |0.003297567367553711 |
----------------------------------------------------------pseudo_mini_loss sum 80.79476928710938
Total (block generation + training)time/epoch 1.87717072168986
Training time/epoch 1.8246490955352783
Training time without block to device /epoch 1.8216791152954102
Training time without total dataloading part /epoch 1.4804105758666992
load block tensor time/epoch 0.2350630760192871
block to device time/epoch 0.002969980239868164
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  6504
Number of first layer input nodes during this epoch:  3943
Number of first layer output nodes during this epoch:  1907
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1184377670288086  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.281 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.281 GB
Metis partitioning: 0.000 seconds, peak memory: 16.281 GB
Split the graph: 0.002 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.010681867599487305
pure dgl.metis_partition the time spent:  0.004929065704345703
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.007633686065673828

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.010151863098144531

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.0162961483001709

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1184377670288086  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

connection checking time:  0.014748096466064453
block generation total time  0.03408169746398926
average batch blocks generation time:  0.008520424365997314
block dataloader generation time/epoch 0.07960367202758789
pseudo mini batch 0 input nodes size: 1054
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.118398666381836  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.118398666381836  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1240253448486328  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.124025821685791  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1181635856628418  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 7, 4: 7, 6: 4, 5: 4, 2: 3, 8: 3, 9: 2, 19: 1, 1: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.118194580078125  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.118194580078125  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4857850074768066  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4857869148254395  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.482792854309082  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

pseudo mini batch 1 input nodes size: 1145
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4827542304992676  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4827542304992676  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4898066520690918  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.48980712890625  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.484179973602295  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 8, 1: 6, 4: 5, 5: 4, 2: 3, 12: 2, 10: 2, 6: 2, 11: 1, 21: 1, 7: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.484212875366211  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.484212875366211  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.8651866912841797  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.8651881217956543  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4842586517333984  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

pseudo mini batch 2 input nodes size: 957
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4842162132263184  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4842162132263184  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.489698886871338  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.489699363708496  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826464653015137  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 11, 3: 7, 1: 4, 6: 4, 5: 3, 4: 3, 9: 1, 7: 1, 30: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826726913452148  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826726913452148  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.7772541046142578  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.7772555351257324  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4827089309692383  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

pseudo mini batch 3 input nodes size: 1022
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826765060424805  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826765060424805  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4881324768066406  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4881329536437988  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.482649803161621  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 9, 2: 8, 4: 7, 3: 4, 5: 4, 7: 2, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.482673168182373  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.482673168182373  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.7567343711853027  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.7567358016967773  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4827055931091309  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4827055931091309  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1181187629699707  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0615617036819458 |0.0007520318031311035 |0.10248202085494995 |9.948015213012695e-05 |0.27241653203964233 |0.003332376480102539 |
----------------------------------------------------------pseudo_mini_loss sum 44.315616607666016
Total (block generation + training)time/epoch 1.884901864188058
Training time/epoch 1.85237455368042
Training time without block to device /epoch 1.8493664264678955
Training time without total dataloading part /epoch 1.5033245086669922
load block tensor time/epoch 0.2462468147277832
block to device time/epoch 0.003008127212524414
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  6812
Number of first layer input nodes during this epoch:  4178
Number of first layer output nodes during this epoch:  1972
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1180157661437988  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.281 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.281 GB
Metis partitioning: 0.000 seconds, peak memory: 16.281 GB
Split the graph: 0.002 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.010227441787719727
pure dgl.metis_partition the time spent:  0.004878044128417969
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.007670879364013672

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.010117530822753906

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.016030550003051758

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1180157661437988  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

connection checking time:  0.014820575714111328
block generation total time  0.033818960189819336
average batch blocks generation time:  0.008454740047454834
block dataloader generation time/epoch 0.07953453063964844
pseudo mini batch 0 input nodes size: 1267
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1179828643798828  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1179828643798828  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1247467994689941  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1247472763061523  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.119290828704834  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 9, 4: 5, 2: 4, 5: 4, 6: 3, 1: 2, 10: 2, 12: 2, 9: 1, 7: 1, 11: 1, 21: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1193275451660156  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1193275451660156  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.568009376525879  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.5680112838745117  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4839434623718262  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

pseudo mini batch 1 input nodes size: 902
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4838948249816895  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4838948249816895  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.489377498626709  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4893779754638672  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826135635375977  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 9, 2: 9, 5: 5, 4: 3, 6: 3, 3: 3, 10: 1, 19: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.482637882232666  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.482637882232666  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.7454609870910645  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.745462417602539  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826712608337402  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

pseudo mini batch 2 input nodes size: 768
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826407432556152  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826407432556152  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.487185001373291  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4871854782104492  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4817023277282715  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 6, 2: 6, 3: 6, 5: 4, 6: 4, 8: 3, 1: 3, 9: 2, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4817266464233398  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4817266464233398  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.7651281356811523  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.765129566192627  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.481760025024414  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

pseudo mini batch 3 input nodes size: 1082
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.48173189163208  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.48173189163208  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4875082969665527  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.487508773803711  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.482964038848877  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 8, 3: 8, 2: 6, 1: 6, 7: 3, 5: 2, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4829883575439453  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4829883575439453  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.7834901809692383  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.783491611480713  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.483022689819336  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.483022689819336  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1184358596801758  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06143176555633545 |0.0007262825965881348 |0.09716641902923584 |0.00011301040649414062 |0.24839341640472412 |0.003458738327026367 |
----------------------------------------------------------pseudo_mini_loss sum 22.74163055419922
Total (block generation + training)time/epoch 1.876318097114563
Training time/epoch 1.7370717525482178
Training time without block to device /epoch 1.7341666221618652
Training time without total dataloading part /epoch 1.3861501216888428
load block tensor time/epoch 0.2457270622253418
block to device time/epoch 0.002905130386352539
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  6605
Number of first layer input nodes during this epoch:  4019
Number of first layer output nodes during this epoch:  1935
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1183390617370605  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.281 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.281 GB
Metis partitioning: 0.000 seconds, peak memory: 16.281 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.010428667068481445
pure dgl.metis_partition the time spent:  0.004819393157958984
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.0076389312744140625

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.0100250244140625

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.015779972076416016

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1183390617370605  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

connection checking time:  0.014362573623657227
block generation total time  0.03344392776489258
average batch blocks generation time:  0.008360981941223145
block dataloader generation time/epoch 0.07935531934102376
pseudo mini batch 0 input nodes size: 895
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1183042526245117  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1183042526245117  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1237869262695312  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1237874031066895  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1180105209350586  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 7, 2: 6, 5: 5, 4: 5, 6: 4, 8: 3, 9: 2, 1: 2, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1180377006530762  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1180377006530762  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4318146705627441  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.431816577911377  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4833030700683594  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

pseudo mini batch 1 input nodes size: 1011
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4832706451416016  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4832706451416016  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4886679649353027  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.488668441772461  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4831852912902832  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 10, 4: 8, 2: 7, 3: 2, 6: 2, 5: 2, 7: 2, 19: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4832096099853516  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4832096099853516  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.781752586364746  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.7817540168762207  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4832448959350586  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

pseudo mini batch 2 input nodes size: 1236
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4832124710083008  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4832124710083008  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4898109436035156  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4898114204406738  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4844136238098145  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 10, 2: 5, 5: 4, 6: 4, 12: 2, 4: 2, 10: 2, 1: 2, 7: 1, 9: 1, 30: 1, 11: 1, 21: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4844493865966797  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4844493865966797  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.924400806427002  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.9244022369384766  GigaBytes
Max Memory Allocated: 2.141012191772461  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4844999313354492  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

pseudo mini batch 3 input nodes size: 857
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4844532012939453  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4844532012939453  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4899358749389648  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.489936351776123  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.48333740234375  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 7, 3: 7, 2: 7, 1: 6, 5: 4, 7: 1, 9: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4833569526672363  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4833569526672363  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.711787223815918  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.7117886543273926  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4833836555480957  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4833836555480957  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1181330680847168  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.060643672943115234 |0.0007268190383911133 |0.09759706258773804 |0.0001023411750793457 |0.2519342303276062 |0.003160238265991211 |
----------------------------------------------------------pseudo_mini_loss sum 15.237285614013672
Total (block generation + training)time/epoch 1.8706944783528645
Training time/epoch 1.7476513385772705
Training time without block to device /epoch 1.744744062423706
Training time without total dataloading part /epoch 1.4016947746276855
load block tensor time/epoch 0.24257469177246094
block to device time/epoch 0.002907276153564453
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  6561
Number of first layer input nodes during this epoch:  3999
Number of first layer output nodes during this epoch:  1909
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1180329322814941  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.281 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.281 GB
Metis partitioning: 0.000 seconds, peak memory: 16.281 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.010703086853027344
pure dgl.metis_partition the time spent:  0.004823923110961914
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.0077207088470458984

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.00974726676940918

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.016129255294799805

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1180329322814941  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

connection checking time:  0.014430999755859375
block generation total time  0.03359723091125488
average batch blocks generation time:  0.00839930772781372
block dataloader generation time/epoch 0.07925384044647217
pseudo mini batch 0 input nodes size: 1217
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1180062294006348  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1180062294006348  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.125058650970459  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1250591278076172  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1195759773254395  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 8, 4: 5, 2: 4, 5: 4, 1: 3, 6: 3, 10: 2, 9: 2, 12: 1, 11: 1, 8: 1, 21: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1196098327636719  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1196098327636719  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.5279221534729004  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.5279240608215332  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4842243194580078  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

pseudo mini batch 1 input nodes size: 1038
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.484179973602295  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.484179973602295  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4897212982177734  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4897217750549316  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826688766479492  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 9, 1: 8, 4: 5, 2: 4, 5: 4, 6: 1, 30: 1, 7: 1, 19: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826970100402832  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826970100402832  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.8125743865966797  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.8125758171081543  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4827351570129395  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

pseudo mini batch 2 input nodes size: 810
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.482698917388916  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.482698917388916  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4872431755065918  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.48724365234375  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4817018508911133  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 11, 4: 7, 1: 7, 6: 4, 7: 2, 9: 1, 10: 1, 3: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4817214012145996  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4817214012145996  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.718252182006836  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.7182536125183105  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4817490577697754  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

pseudo mini batch 3 input nodes size: 882
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4817228317260742  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4817228317260742  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4872055053710938  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.487205982208252  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.482661247253418  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 8, 2: 6, 5: 6, 4: 5, 6: 3, 8: 2, 1: 2, 30: 1, 7: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826874732971191  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826874732971191  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.7928104400634766  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.7928118705749512  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4827237129211426  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4827237129211426  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1181368827819824  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06066769361495972 |0.0007483959197998047 |0.10161888599395752 |0.00010436773300170898 |0.272869348526001 |0.002990245819091797 |
----------------------------------------------------------pseudo_mini_loss sum 10.483072280883789
Total (block generation + training)time/epoch 1.876262640953064
Training time/epoch 1.847930908203125
Training time without block to device /epoch 1.8449373245239258
Training time without total dataloading part /epoch 1.5013606548309326
load block tensor time/epoch 0.24267077445983887
block to device time/epoch 0.0029935836791992188
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  6519
Number of first layer input nodes during this epoch:  3947
Number of first layer output nodes during this epoch:  1918
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.118049144744873  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.281 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.281 GB
Metis partitioning: 0.000 seconds, peak memory: 16.281 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009567022323608398
pure dgl.metis_partition the time spent:  0.0047893524169921875
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.007596731185913086

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.010285615921020508

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.01629042625427246

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.118049144744873  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

connection checking time:  0.014858245849609375
block generation total time  0.034172773361206055
average batch blocks generation time:  0.008543193340301514
block dataloader generation time/epoch 0.07915936816822398
pseudo mini batch 0 input nodes size: 1255
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.118016242980957  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.118016242980957  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1250686645507812  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1250691413879395  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1195859909057617  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 9, 4: 6, 2: 5, 5: 5, 6: 4, 9: 2, 1: 1, 11: 1, 7: 1, 12: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1196188926696777  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1196188926696777  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.5087924003601074  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.5087943077087402  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4842214584350586  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

pseudo mini batch 1 input nodes size: 993
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4841771125793457  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4841771125793457  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4896597862243652  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4896602630615234  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.482607364654541  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 8, 3: 6, 4: 6, 2: 5, 5: 3, 6: 2, 10: 2, 12: 1, 19: 1, 21: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826383590698242  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826383590698242  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.843238353729248  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.8432397842407227  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.482682228088379  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

pseudo mini batch 2 input nodes size: 797
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826436042785645  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826436042785645  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4871878623962402  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4871883392333984  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4817051887512207  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 7, 3: 6, 5: 5, 2: 5, 6: 3, 8: 3, 1: 2, 30: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.481729507446289  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.481729507446289  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.7571120262145996  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.7571134567260742  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4817628860473633  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

pseudo mini batch 3 input nodes size: 1079
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4817347526550293  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4817347526550293  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.487494945526123  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4874954223632812  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4829506874084473  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 10, 1: 9, 3: 5, 7: 3, 4: 3, 5: 2, 6: 2, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4829750061035156  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4829750061035156  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.773918628692627  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.7739200592041016  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4830093383789062  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4830093383789062  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.118422508239746  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06083083152770996 |0.0007128119468688965 |0.09996098279953003 |0.00010061264038085938 |0.25981056690216064 |0.0038187503814697266 |
----------------------------------------------------------pseudo_mini_loss sum 5.798800468444824
Total (block generation + training)time/epoch 1.8755672411485151
Training time/epoch 1.7902939319610596
Training time without block to device /epoch 1.787442684173584
Training time without total dataloading part /epoch 1.4433073997497559
load block tensor time/epoch 0.24332332611083984
block to device time/epoch 0.002851247787475586
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  6743
Number of first layer input nodes during this epoch:  4124
Number of first layer output nodes during this epoch:  1964
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1183228492736816  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.281 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.281 GB
Metis partitioning: 0.000 seconds, peak memory: 16.281 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.010434865951538086
pure dgl.metis_partition the time spent:  0.00446319580078125
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.007615566253662109

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.009802818298339844

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.01591658592224121

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1183228492736816  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

connection checking time:  0.01483297348022461
block generation total time  0.033334970474243164
average batch blocks generation time:  0.008333742618560791
block dataloader generation time/epoch 0.07900867859522502
pseudo mini batch 0 input nodes size: 1196
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1182880401611328  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1182880401611328  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1246728897094727  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1246733665466309  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.118912696838379  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 7, 1: 5, 2: 4, 6: 4, 5: 4, 4: 3, 12: 2, 10: 2, 21: 1, 7: 1, 9: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.118945598602295  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.118945598602295  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.506838321685791  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.5068402290344238  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4835548400878906  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

pseudo mini batch 1 input nodes size: 1156
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4835124015808105  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4835124015808105  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4905648231506348  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.490565299987793  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.484179973602295  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 10, 4: 8, 3: 4, 5: 3, 1: 3, 7: 3, 6: 2, 9: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4842090606689453  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4842090606689453  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.8198857307434082  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.8198871612548828  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4842491149902344  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

pseudo mini batch 2 input nodes size: 700
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.48421049118042  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.48421049118042  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.48811674118042  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4881172180175781  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4810643196105957  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 6, 2: 5, 3: 5, 1: 5, 5: 4, 8: 3, 6: 3, 9: 2, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4810867309570312  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4810867309570312  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.730712890625  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.7307143211364746  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4811172485351562  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

pseudo mini batch 3 input nodes size: 1026
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.481091022491455  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.481091022491455  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4865736961364746  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4865741729736328  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826674461364746  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 10, 1: 7, 2: 6, 4: 5, 5: 4, 6: 2, 19: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826955795288086  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826955795288086  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.8027963638305664  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.802797794342041  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4827337265014648  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4827337265014648  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1181468963623047  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06107717752456665 |0.0007295012474060059 |0.09952259063720703 |9.697675704956055e-05 |0.2624467611312866 |0.0030012130737304688 |
----------------------------------------------------------pseudo_mini_loss sum 6.29526424407959
Total (block generation + training)time/epoch 1.8756349086761475
Training time/epoch 1.7989232540130615
Training time without block to device /epoch 1.7960052490234375
Training time without total dataloading part /epoch 1.4512665271759033
load block tensor time/epoch 0.2443087100982666
block to device time/epoch 0.0029180049896240234
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  6654
Number of first layer input nodes during this epoch:  4078
Number of first layer output nodes during this epoch:  1926
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1180529594421387  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.281 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.281 GB
Metis partitioning: 0.000 seconds, peak memory: 16.281 GB
Split the graph: 0.002 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.010870695114135742
pure dgl.metis_partition the time spent:  0.005075931549072266
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.0076596736907958984

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.010403633117675781

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.016096830368041992

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1180529594421387  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

connection checking time:  0.014515399932861328
block generation total time  0.03416013717651367
average batch blocks generation time:  0.008540034294128418
block dataloader generation time/epoch 0.07910849497868465
pseudo mini batch 0 input nodes size: 1294
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.118016242980957  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.118016242980957  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1250686645507812  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1250691413879395  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1195859909057617  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 6, 4: 5, 3: 5, 6: 4, 2: 4, 5: 3, 10: 2, 7: 2, 9: 2, 11: 1, 21: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1196227073669434  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.1196227073669434  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.5501551628112793  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.550157070159912  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.484231948852539  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

pseudo mini batch 1 input nodes size: 900
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4841833114624023  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4841833114624023  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4896659851074219  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.48966646194458  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826135635375977  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 10, 3: 7, 4: 6, 5: 4, 1: 4, 6: 2, 10: 1, 9: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826359748840332  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.4826359748840332  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.755335807800293  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.78857421875 GB
    Memory Allocated: 1.7553372383117676  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.482668399810791  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

pseudo mini batch 2 input nodes size: 1027
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.482637882232666  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.482637882232666  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4881205558776855  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4881210327148438  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.482637882232666  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 7, 4: 4, 6: 4, 2: 4, 8: 3, 5: 3, 1: 3, 30: 2, 9: 1, 7: 1, 19: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4826688766479492  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4826688766479492  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.8636841773986816  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.8636856079101562  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.482712745666504  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

pseudo mini batch 3 input nodes size: 852
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4826741218566895  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4826741218566895  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.488156795501709  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4881572723388672  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4826741218566895  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 7, 3: 7, 4: 7, 1: 7, 5: 5, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4826946258544922  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4826946258544922  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.7202482223510742  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.7202496528625488  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4827232360839844  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4827232360839844  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.1181364059448242  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.061483025550842285 |0.0007236599922180176 |0.10109215974807739 |0.00010979175567626953 |0.260029673576355 |0.0033490657806396484 |
----------------------------------------------------------pseudo_mini_loss sum 4.350029468536377
Total (block generation + training)time/epoch 1.8757320183974047
Training time/epoch 1.7964658737182617
Training time without block to device /epoch 1.7935712337493896
Training time without total dataloading part /epoch 1.4482755661010742
load block tensor time/epoch 0.24593210220336914
block to device time/epoch 0.0028946399688720703
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  6700
Number of first layer input nodes during this epoch:  4073
Number of first layer output nodes during this epoch:  1962
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.1180357933044434  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.357 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.357 GB
Metis partitioning: 0.000 seconds, peak memory: 16.357 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.010269880294799805
pure dgl.metis_partition the time spent:  0.004913330078125
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.007616996765136719

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.009658336639404297

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.016080379486083984

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.1180357933044434  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

connection checking time:  0.014204740524291992
block generation total time  0.033355712890625
average batch blocks generation time:  0.00833892822265625
block dataloader generation time/epoch 0.07896959781646729
pseudo mini batch 0 input nodes size: 1162
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.1180071830749512  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.1180071830749512  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.1250596046447754  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.1250600814819336  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.1195769309997559  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 7, 4: 6, 5: 5, 1: 4, 2: 4, 6: 3, 9: 2, 10: 2, 12: 1, 21: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.1196107864379883  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.1196107864379883  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.5180859565734863  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.5180878639221191  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4842243194580078  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

pseudo mini batch 1 input nodes size: 954
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.484179973602295  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.484179973602295  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4896626472473145  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4896631240844727  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4826102256774902  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 9, 4: 6, 1: 5, 6: 3, 8: 3, 5: 3, 30: 2, 2: 2, 19: 1, 9: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.482640266418457  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.482640266418457  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.8402867317199707  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.8402881622314453  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.482682228088379  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

pseudo mini batch 2 input nodes size: 864
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4826459884643555  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4826459884643555  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4872584342956543  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4872589111328125  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4817757606506348  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 8, 2: 7, 3: 5, 5: 4, 4: 4, 6: 4, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4817962646484375  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4817962646484375  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.7201266288757324  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.720128059387207  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.481825828552246  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

pseudo mini batch 3 input nodes size: 956
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.481797218322754  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.481797218322754  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4872798919677734  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4872803688049316  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4826674461364746  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 12, 4: 6, 3: 5, 5: 3, 7: 3, 1: 3, 9: 1, 10: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4826898574829102  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4826898574829102  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.760650634765625  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.7606520652770996  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.482722282409668  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.482722282409668  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.1181354522705078  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06091940402984619 |0.0007072091102600098 |0.09886342287063599 |9.804964065551758e-05 |0.2528514266014099 |0.003345012664794922 |
----------------------------------------------------------pseudo_mini_loss sum 4.456282138824463
Total (block generation + training)time/epoch 1.8728734425136022
Training time/epoch 1.758434772491455
Training time without block to device /epoch 1.755605936050415
Training time without total dataloading part /epoch 1.4105966091156006
load block tensor time/epoch 0.24367761611938477
block to device time/epoch 0.002828836441040039
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  6486
Number of first layer input nodes during this epoch:  3936
Number of first layer output nodes during this epoch:  1897
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.1180415153503418  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.357 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.357 GB
Metis partitioning: 0.000 seconds, peak memory: 16.357 GB
Split the graph: 0.002 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.01009678840637207
pure dgl.metis_partition the time spent:  0.0049746036529541016
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.007688045501708984

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.009606122970581055

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.016073226928710938

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.1180415153503418  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

connection checking time:  0.014354944229125977
block generation total time  0.03336739540100098
average batch blocks generation time:  0.008341848850250244
block dataloader generation time/epoch 0.0788709004720052
pseudo mini batch 0 input nodes size: 1222
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.1180105209350586  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.1180105209350586  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.1250629425048828  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.125063419342041  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.1195802688598633  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 9, 2: 6, 4: 6, 5: 4, 6: 3, 1: 2, 9: 2, 7: 1, 21: 1, 12: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.1196141242980957  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.1196141242980957  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.520378589630127  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.5203804969787598  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4842243194580078  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

pseudo mini batch 1 input nodes size: 784
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.484179973602295  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.484179973602295  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4887242317199707  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.488724708557129  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4816718101501465  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 6, 2: 5, 3: 5, 6: 4, 5: 4, 4: 3, 8: 3, 9: 2, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4816970825195312  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4816970825195312  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.767392635345459  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.7673940658569336  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4817323684692383  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

pseudo mini batch 2 input nodes size: 1066
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4817018508911133  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4817018508911133  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4873929023742676  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4873933792114258  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4828486442565918  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 8, 1: 7, 2: 7, 4: 3, 5: 3, 6: 2, 12: 1, 30: 1, 10: 1, 7: 1, 19: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4828767776489258  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4828767776489258  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.8059759140014648  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.8059773445129395  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.482914924621582  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

pseudo mini batch 3 input nodes size: 947
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4828786849975586  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4828786849975586  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4883613586425781  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4883618354797363  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4826703071594238  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 10, 2: 7, 1: 5, 3: 4, 5: 4, 7: 2, 6: 2, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4826936721801758  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4826936721801758  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.7586913108825684  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.758692741394043  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.48272705078125  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.48272705078125  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.1181402206420898  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06047844886779785 |0.000725090503692627 |0.10045206546783447 |0.00010502338409423828 |0.2663624882698059 |0.002705812454223633 |
----------------------------------------------------------pseudo_mini_loss sum 2.9774019718170166
Total (block generation + training)time/epoch 1.8742669900258382
Training time/epoch 1.8161673545837402
Training time without block to device /epoch 1.8132669925689697
Training time without total dataloading part /epoch 1.470384120941162
load block tensor time/epoch 0.2419137954711914
block to device time/epoch 0.002900362014770508
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  6584
Number of first layer input nodes during this epoch:  4019
Number of first layer output nodes during this epoch:  1916
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.1180434226989746  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.357 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.357 GB
Metis partitioning: 0.000 seconds, peak memory: 16.357 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.010094642639160156
pure dgl.metis_partition the time spent:  0.004332304000854492
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.0076105594635009766

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.009908437728881836

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.01582956314086914

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.1180434226989746  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

connection checking time:  0.014678239822387695
block generation total time  0.03334856033325195
average batch blocks generation time:  0.008337140083312988
block dataloader generation time/epoch 0.07875962555408478
pseudo mini batch 0 input nodes size: 1188
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.1180105209350586  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.1180105209350586  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.1250629425048828  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.125063419342041  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.1195802688598633  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 7, 2: 5, 4: 4, 1: 4, 5: 4, 6: 3, 10: 2, 7: 2, 9: 2, 11: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.119612216949463  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.119612216949463  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4913544654846191  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.491356372833252  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4842195510864258  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

pseudo mini batch 1 input nodes size: 1179
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4841771125793457  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4841771125793457  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.490471363067627  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4904718399047852  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4834189414978027  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 8, 4: 6, 2: 6, 1: 3, 6: 2, 5: 2, 12: 1, 7: 1, 30: 1, 10: 1, 19: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4834508895874023  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4834508895874023  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.8596925735473633  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.859694004058838  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.483494758605957  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

pseudo mini batch 2 input nodes size: 746
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.483452320098877  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.483452320098877  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4879965782165527  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.487997055053711  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4817023277282715  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 9, 1: 7, 3: 6, 4: 6, 5: 5, 6: 2, 21: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4817209243774414  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4817209243774414  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.7045893669128418  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.7045907974243164  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4817476272583008  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

pseudo mini batch 3 input nodes size: 920
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4817233085632324  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4817233085632324  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.487205982208252  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4872064590454102  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4826617240905762  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 6, 1: 6, 2: 5, 3: 5, 6: 4, 5: 4, 8: 3, 30: 1, 7: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4826898574829102  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4826898574829102  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.8075799942016602  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.8075814247131348  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4827289581298828  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4827289581298828  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.1181421279907227  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06133311986923218 |0.0007188320159912109 |0.10264062881469727 |0.00010120868682861328 |0.2727694511413574 |0.0032050609588623047 |
----------------------------------------------------------pseudo_mini_loss sum 2.5622897148132324
Total (block generation + training)time/epoch 1.8777679204940796
Training time/epoch 1.8530879020690918
Training time without block to device /epoch 1.850212574005127
Training time without total dataloading part /epoch 1.5052502155303955
load block tensor time/epoch 0.2453324794769287
block to device time/epoch 0.0028753280639648438
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  6624
Number of first layer input nodes during this epoch:  4033
Number of first layer output nodes during this epoch:  1937
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.118053913116455  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.357 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.357 GB
Metis partitioning: 0.000 seconds, peak memory: 16.357 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.00885629653930664
pure dgl.metis_partition the time spent:  0.004494905471801758
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.007640838623046875

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.009563684463500977

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.015595436096191406

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.118053913116455  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

connection checking time:  0.014219999313354492
block generation total time  0.03279995918273926
average batch blocks generation time:  0.008199989795684814
block dataloader generation time/epoch 0.07851115395041074
pseudo mini batch 0 input nodes size: 1230
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.1180191040039062  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.1180191040039062  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.1250715255737305  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.1250720024108887  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.119588851928711  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 7, 4: 7, 2: 6, 5: 4, 9: 3, 6: 3, 1: 2, 11: 1, 12: 1, 21: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.1196236610412598  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.1196236610412598  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.538642406463623  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.5386443138122559  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4842262268066406  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

pseudo mini batch 1 input nodes size: 1074
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.484179973602295  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.484179973602295  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4899134635925293  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4899139404296875  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.482861042022705  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 6, 3: 6, 2: 5, 6: 5, 5: 4, 8: 3, 1: 3, 30: 2, 19: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4828929901123047  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4828929901123047  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.8766212463378906  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.8766226768493652  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4829378128051758  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

pseudo mini batch 2 input nodes size: 777
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4828972816467285  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4828972816467285  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4874415397644043  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4874420166015625  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.48170804977417  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 8, 3: 8, 1: 6, 6: 3, 4: 3, 5: 2, 7: 2, 10: 2, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.481729507446289  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.481729507446289  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.715625286102295  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.7156267166137695  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4817581176757812  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

pseudo mini batch 3 input nodes size: 899
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.48173189163208  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.48173189163208  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4868359565734863  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4868364334106445  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4822916984558105  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 9, 2: 6, 4: 6, 5: 5, 3: 5, 7: 2})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4823122024536133  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4823122024536133  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.7282443046569824  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.728245735168457  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4823408126831055  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4823408126831055  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.1177539825439453  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.061536967754364014 |0.0007856488227844238 |0.0988125205039978 |9.816884994506836e-05 |0.2496001124382019 |0.002694845199584961 |
----------------------------------------------------------pseudo_mini_loss sum 2.4557371139526367
Total (block generation + training)time/epoch 1.8743502111995922
Training time/epoch 1.7450246810913086
Training time without block to device /epoch 1.741882085800171
Training time without total dataloading part /epoch 1.396738052368164
load block tensor time/epoch 0.24614787101745605
block to device time/epoch 0.0031425952911376953
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  6558
Number of first layer input nodes during this epoch:  3980
Number of first layer output nodes during this epoch:  1926
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.11765718460083  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.357 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.357 GB
Metis partitioning: 0.000 seconds, peak memory: 16.357 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0110626220703125
pure dgl.metis_partition the time spent:  0.004594087600708008
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.007622957229614258

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.00985264778137207

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.016782522201538086

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.11765718460083  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

connection checking time:  0.014390945434570312
block generation total time  0.034258127212524414
average batch blocks generation time:  0.008564531803131104
block dataloader generation time/epoch 0.07852266894446479
pseudo mini batch 0 input nodes size: 1007
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.1176280975341797  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.1176280975341797  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.1231107711791992  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.1231112480163574  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.118006706237793  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 7, 3: 6, 1: 5, 4: 5, 5: 4, 6: 3, 9: 1, 10: 1, 7: 1, 19: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.1180338859558105  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.1180338859558105  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4381537437438965  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4381556510925293  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4826383590698242  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

pseudo mini batch 1 input nodes size: 762
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4826040267944336  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4826040267944336  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4871482849121094  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4871487617492676  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4816656112670898  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 9, 2: 8, 4: 5, 3: 5, 5: 3, 6: 2, 7: 2})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4816842079162598  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4816842079162598  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.698807716369629  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.6988091468811035  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4817099571228027  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

pseudo mini batch 2 input nodes size: 1234
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4816856384277344  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4816856384277344  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4887380599975586  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4887385368347168  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4841938018798828  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 7, 4: 6, 2: 5, 5: 4, 6: 3, 10: 2, 9: 2, 1: 2, 12: 2, 21: 1, 11: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.484229564666748  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.484229564666748  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.9141082763671875  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.914109706878662  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4842801094055176  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

pseudo mini batch 3 input nodes size: 909
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4842333793640137  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4842333793640137  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4897160530090332  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4897165298461914  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.482663631439209  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 8, 4: 6, 2: 5, 1: 4, 5: 4, 8: 3, 6: 3, 9: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4826898574829102  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4826898574829102  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.7833952903747559  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.7833967208862305  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4827260971069336  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.4827260971069336  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.85107421875 GB
    Memory Allocated: 1.1181392669677734  GigaBytes
Max Memory Allocated: 2.1727070808410645  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.060078442096710205 |0.0008924603462219238 |0.10451281070709229 |0.00011897087097167969 |0.26273995637893677 |0.004057884216308594 |
----------------------------------------------------------pseudo_mini_loss sum 2.7079453468322754
Total (block generation + training)time/epoch 1.8757290840148926
Training time/epoch 1.82027268409729
Training time without block to device /epoch 1.8167028427124023
Training time without total dataloading part /epoch 1.4735448360443115
load block tensor time/epoch 0.24031376838684082
block to device time/epoch 0.0035698413848876953
input features size transfer per epoch 5.960464477539062e-07
blocks size to device per epoch 3.2782554626464844e-07
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  6441
Number of first layer input nodes during this epoch:  3912
Number of first layer output nodes during this epoch:  1878
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(1433, 1433, batch_first=True)
      (fc_self): Linear(in_features=1433, out_features=2048, bias=False)
      (fc_neigh): Linear(in_features=1433, out_features=2048, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(2048, 2048, batch_first=True)
      (fc_self): Linear(in_features=2048, out_features=2048, bias=False)
      (fc_neigh): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (2): SAGEConv(
      (lstm): LSTM(2048, 2048, batch_first=True)
      (fc_self): Linear(in_features=2048, out_features=7, bias=False)
      (fc_neigh): Linear(in_features=2048, out_features=7, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  97867856
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([5732, 1433])
layers.0.lstm.weight_hh_l0, torch.Size([5732, 1433])
layers.0.lstm.bias_ih_l0, torch.Size([5732])
layers.0.lstm.bias_hh_l0, torch.Size([5732])
layers.0.fc_self.weight, torch.Size([2048, 1433])
layers.0.fc_neigh.weight, torch.Size([2048, 1433])
layers.1.lstm.weight_ih_l0, torch.Size([8192, 2048])
layers.1.lstm.weight_hh_l0, torch.Size([8192, 2048])
layers.1.lstm.bias_ih_l0, torch.Size([8192])
layers.1.lstm.bias_hh_l0, torch.Size([8192])
layers.1.fc_self.weight, torch.Size([2048, 2048])
layers.1.fc_neigh.weight, torch.Size([2048, 2048])
layers.2.lstm.weight_ih_l0, torch.Size([8192, 2048])
layers.2.lstm.weight_hh_l0, torch.Size([8192, 2048])
layers.2.lstm.bias_ih_l0, torch.Size([8192])
layers.2.lstm.bias_hh_l0, torch.Size([8192])
layers.2.fc_self.weight, torch.Size([7, 2048])
layers.2.fc_neigh.weight, torch.Size([7, 2048])
----------------------------------------
un-trainable parameters
