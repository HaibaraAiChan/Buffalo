main start at this time 1733011009.5443592
-----------------------------------------before load data 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

----------------------------------------start of run function 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  1433
----------------------------------------before model to device 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 0.88623046875 GB
    Memory Allocated: 0.3674592971801758  GigaBytes
Max Memory Allocated: 0.3674592971801758  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 0.88818359375 GB
    Memory Allocated: 0.3674592971801758  GigaBytes
Max Memory Allocated: 0.3674592971801758  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 13.818 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 13.818 GB
Metis partitioning: 0.001 seconds, peak memory: 13.818 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.004 seconds
REG metis partition end ----................................
REG construction  time spent:  0.020241498947143555
pure dgl.metis_partition the time spent:  0.006100654602050781

block_gen_time in "generate_blocks_for_one_layer_block"  0.014000415802001953


block_gen_time in "generate_blocks_for_one_layer_block"  0.015916109085083008


block_gen_time in "generate_blocks_for_one_layer_block"  0.02374744415283203

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 0.88818359375 GB
    Memory Allocated: 0.3674592971801758  GigaBytes
Max Memory Allocated: 0.3674592971801758  GigaBytes

connection checking time:  0.02270793914794922
block generation total time  0.05366396903991699
average batch blocks generation time:  0.006707996129989624
pseudo mini batch 0 input nodes size: 825
----------------------------------------before load block subtensor 
 Nvidia-smi: 0.88818359375 GB
    Memory Allocated: 0.3674592971801758  GigaBytes
Max Memory Allocated: 0.3674592971801758  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 0.88818359375 GB
    Memory Allocated: 0.3674592971801758  GigaBytes
Max Memory Allocated: 0.3674592971801758  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 0.90771484375 GB
    Memory Allocated: 0.37186384201049805  GigaBytes
Max Memory Allocated: 0.37186384201049805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 0.90771484375 GB
    Memory Allocated: 0.37186431884765625  GigaBytes
Max Memory Allocated: 0.37186431884765625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 0.90771484375 GB
    Memory Allocated: 0.37186431884765625  GigaBytes
Max Memory Allocated: 0.37186431884765625  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 5, 6: 3, 4: 3, 9: 1, 1: 1, 10: 1, 5: 1, 2: 1, 11: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 0.90771484375 GB
    Memory Allocated: 0.371884822845459  GigaBytes
Max Memory Allocated: 0.371884822845459  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 0.90771484375 GB
    Memory Allocated: 0.371884822845459  GigaBytes
Max Memory Allocated: 0.371884822845459  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.17919921875 GB
    Memory Allocated: 0.6144781112670898  GigaBytes
Max Memory Allocated: 0.6154890060424805  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.17919921875 GB
    Memory Allocated: 0.6144795417785645  GigaBytes
Max Memory Allocated: 0.6154890060424805  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.64404296875 GB
    Memory Allocated: 0.7530336380004883  GigaBytes
Max Memory Allocated: 1.0127630233764648  GigaBytes

pseudo mini batch 1 input nodes size: 888
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.64404296875 GB
    Memory Allocated: 0.7530055046081543  GigaBytes
Max Memory Allocated: 1.0127630233764648  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.64404296875 GB
    Memory Allocated: 0.7530055046081543  GigaBytes
Max Memory Allocated: 1.0127630233764648  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.64404296875 GB
    Memory Allocated: 0.7577462196350098  GigaBytes
Max Memory Allocated: 1.0127630233764648  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.64404296875 GB
    Memory Allocated: 0.757746696472168  GigaBytes
Max Memory Allocated: 1.0127630233764648  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.64404296875 GB
    Memory Allocated: 0.7533416748046875  GigaBytes
Max Memory Allocated: 1.0127630233764648  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 5, 5: 3, 4: 3, 7: 2, 9: 1, 3: 1, 10: 1, 21: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 1.64404296875 GB
    Memory Allocated: 0.753364086151123  GigaBytes
Max Memory Allocated: 1.0127630233764648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.64404296875 GB
    Memory Allocated: 0.753364086151123  GigaBytes
Max Memory Allocated: 1.0127630233764648  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.66162109375 GB
    Memory Allocated: 1.0123262405395508  GigaBytes
Max Memory Allocated: 1.013420581817627  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.66162109375 GB
    Memory Allocated: 1.0123271942138672  GigaBytes
Max Memory Allocated: 1.013420581817627  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.7533955574035645  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

pseudo mini batch 2 input nodes size: 546
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.7533650398254395  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.7533650398254395  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.7562799453735352  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.7562804222106934  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.7515392303466797  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 8, 2: 4, 1: 2, 4: 2, 19: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.7515521049499512  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.7515521049499512  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.8862519264221191  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.8862528800964355  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.7515692710876465  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

pseudo mini batch 3 input nodes size: 463
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.7515530586242676  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.7515530586242676  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.7540249824523926  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.7540254592895508  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.7511100769042969  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 5, 1: 5, 3: 3, 4: 2, 5: 1, 9: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.751121997833252  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.751121997833252  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.8626155853271484  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.8626165390014648  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.7511382102966309  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

pseudo mini batch 4 input nodes size: 713
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.7511239051818848  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.7511239051818848  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.7549304962158203  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.7549309730529785  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.7524585723876953  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3, 8: 3, 3: 2, 4: 2, 6: 2, 5: 2, 7: 1, 2: 1, 30: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.7524771690368652  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.7524771690368652  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.9760904312133789  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.9760913848876953  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.7525029182434082  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

pseudo mini batch 5 input nodes size: 663
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.7524785995483398  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.7524785995483398  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.7560181617736816  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.7560186386108398  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.7522115707397461  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 5, 3: 4, 4: 2, 6: 2, 10: 1, 7: 1, 5: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.7522282600402832  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.7522282600402832  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.9425535202026367  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.9425544738769531  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.752251148223877  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

pseudo mini batch 6 input nodes size: 224
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.7522287368774414  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.7522287368774414  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.7535295486450195  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.7535300254821777  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.7499899864196777  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 5, 1: 4, 2: 3, 6: 2, 5: 2})

----------------------------------------after blocks to device 
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.7499980926513672  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.7499980926513672  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.8194212913513184  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.8194222450256348  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.7500085830688477  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

pseudo mini batch 7 input nodes size: 602
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.7500004768371582  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.7500004768371582  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.7532143592834473  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.7532148361206055  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.7519135475158691  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 5, 5: 4, 3: 3, 4: 3, 6: 1, 2: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.751927375793457  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.751927375793457  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.9039921760559082  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.9039931297302246  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.84912109375 GB
    Memory Allocated: 0.7519454956054688  GigaBytes
Max Memory Allocated: 1.2614030838012695  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.481119155883789  GigaBytes
Max Memory Allocated: 1.8485784530639648  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.1158685684204102  GigaBytes
Max Memory Allocated: 1.8485784530639648  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06775447726249695 |0.001299142837524414 |0.1979786455631256 |0.0018139183521270752 |0.17434269189834595 |0.1368710994720459 |
----------------------------------------------------------pseudo_mini_loss sum 1.95863938331604
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  7684
Number of first layer input nodes during this epoch:  4924
Number of first layer output nodes during this epoch:  2093
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.1157493591308594  GigaBytes
Max Memory Allocated: 1.8485784530639648  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.091 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.091 GB
Metis partitioning: 0.001 seconds, peak memory: 16.091 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.003 seconds
REG metis partition end ----................................
REG construction  time spent:  0.012751579284667969
pure dgl.metis_partition the time spent:  0.0055086612701416016

block_gen_time in "generate_blocks_for_one_layer_block"  0.01444697380065918


block_gen_time in "generate_blocks_for_one_layer_block"  0.01581287384033203


block_gen_time in "generate_blocks_for_one_layer_block"  0.02380967140197754

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.1157493591308594  GigaBytes
Max Memory Allocated: 1.8485784530639648  GigaBytes

connection checking time:  0.022821903228759766
block generation total time  0.05406951904296875
average batch blocks generation time:  0.006758689880371094
pseudo mini batch 0 input nodes size: 781
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.1157307624816895  GigaBytes
Max Memory Allocated: 1.8485784530639648  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.1157307624816895  GigaBytes
Max Memory Allocated: 1.8485784530639648  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.1204228401184082  GigaBytes
Max Memory Allocated: 1.8485784530639648  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.1204233169555664  GigaBytes
Max Memory Allocated: 1.8485784530639648  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.1172089576721191  GigaBytes
Max Memory Allocated: 1.8485784530639648  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 6: 3, 2: 2, 4: 2, 5: 2, 1: 1, 12: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.1172285079956055  GigaBytes
Max Memory Allocated: 1.8485784530639648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.1172285079956055  GigaBytes
Max Memory Allocated: 1.8485784530639648  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.3337388038635254  GigaBytes
Max Memory Allocated: 1.8485784530639648  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.333740234375  GigaBytes
Max Memory Allocated: 1.8485784530639648  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.4824795722961426  GigaBytes
Max Memory Allocated: 1.8485784530639648  GigaBytes

pseudo mini batch 1 input nodes size: 754
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.4824533462524414  GigaBytes
Max Memory Allocated: 1.8485784530639648  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.4824533462524414  GigaBytes
Max Memory Allocated: 1.8485784530639648  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.4864788055419922  GigaBytes
Max Memory Allocated: 1.8485784530639648  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.4864792823791504  GigaBytes
Max Memory Allocated: 1.8485784530639648  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.4817867279052734  GigaBytes
Max Memory Allocated: 1.8485784530639648  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3, 2: 3, 9: 2, 5: 2, 4: 2, 3: 1, 11: 1, 7: 1, 10: 1, 21: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.4818062782287598  GigaBytes
Max Memory Allocated: 1.8485784530639648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.4818062782287598  GigaBytes
Max Memory Allocated: 1.8485784530639648  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.7149910926818848  GigaBytes
Max Memory Allocated: 1.8485784530639648  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.7149920463562012  GigaBytes
Max Memory Allocated: 1.8485784530639648  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.4818329811096191  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

pseudo mini batch 2 input nodes size: 629
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.481806755065918  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.481806755065918  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.4851646423339844  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.4851651191711426  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.4811391830444336  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 5: 3, 4: 3, 2: 2, 8: 2, 6: 2, 30: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.481156826019287  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.481156826019287  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.6871004104614258  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.6871013641357422  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.4811816215515137  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

pseudo mini batch 3 input nodes size: 499
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.4811592102050781  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.4811592102050781  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.483823299407959  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.4838237762451172  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.4804654121398926  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 6, 1: 3, 2: 3, 3: 2, 9: 1, 6: 1, 5: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.4804792404174805  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.4804792404174805  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.6225099563598633  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.6225109100341797  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.4804983139038086  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

pseudo mini batch 4 input nodes size: 703
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.4804821014404297  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.4804821014404297  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.4851741790771484  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.4851746559143066  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.4825100898742676  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 5, 3: 5, 4: 3, 5: 2, 6: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.4825267791748047  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.4825267791748047  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.6697416305541992  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.6697425842285156  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.4825496673583984  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

pseudo mini batch 5 input nodes size: 420
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.482527256011963  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.482527256011963  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.4847698211669922  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.4847702980041504  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.4800777435302734  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 5, 2: 4, 5: 2, 6: 2, 4: 2, 3: 1, 8: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.480088710784912  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.480088710784912  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.5844707489013672  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.5844717025756836  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.4801039695739746  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

pseudo mini batch 6 input nodes size: 614
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.4800915718078613  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.4800915718078613  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.4833693504333496  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.4833698272705078  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.4811267852783203  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 3, 4: 3, 1: 3, 7: 2, 3: 2, 6: 1, 5: 1, 19: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.481142520904541  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.481142520904541  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.6607446670532227  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.660745620727539  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.4811644554138184  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

pseudo mini batch 7 input nodes size: 377
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.4811439514160156  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.4811439514160156  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.483156681060791  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.4831571578979492  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.4798789024353027  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 5, 3: 5, 2: 3, 5: 2, 6: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.479888916015625  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.479888916015625  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.576704502105713  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.5767054557800293  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.63818359375 GB
    Memory Allocated: 1.4799022674560547  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4799022674560547  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.1146650314331055  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06850063800811768 |0.0006804168224334717 |0.0756257176399231 |9.28342342376709e-05 |0.1758280098438263 |0.003137350082397461 |
----------------------------------------------------------pseudo_mini_loss sum 61.786949157714844
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  7527
Number of first layer input nodes during this epoch:  4777
Number of first layer output nodes during this epoch:  2083
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.114539623260498  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.191 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.191 GB
Metis partitioning: 0.001 seconds, peak memory: 16.191 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.004 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0098419189453125
pure dgl.metis_partition the time spent:  0.006729602813720703

block_gen_time in "generate_blocks_for_one_layer_block"  0.014170646667480469


block_gen_time in "generate_blocks_for_one_layer_block"  0.015532732009887695


block_gen_time in "generate_blocks_for_one_layer_block"  0.02355670928955078

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.114539623260498  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

connection checking time:  0.023102760314941406
block generation total time  0.053260087966918945
average batch blocks generation time:  0.006657510995864868
block dataloader generation time/epoch 0.11725139617919922
pseudo mini batch 0 input nodes size: 846
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.1145267486572266  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.1145267486572266  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.1192188262939453  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.1192193031311035  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.11720609664917  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 5, 4: 3, 6: 2, 7: 1, 5: 1, 12: 1, 2: 1, 11: 1, 9: 1, 10: 1, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.1172266006469727  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.1172266006469727  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.3545713424682617  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.3545727729797363  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4824814796447754  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

pseudo mini batch 1 input nodes size: 856
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4824533462524414  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4824533462524414  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4870233535766602  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4870238304138184  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4823312759399414  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 4, 4: 4, 5: 2, 12: 1, 3: 1, 21: 1, 6: 1, 7: 1, 1: 1, 9: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.482353687286377  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.482353687286377  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.7384185791015625  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.738419532775879  GigaBytes
Max Memory Allocated: 1.9640374183654785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4823851585388184  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

pseudo mini batch 2 input nodes size: 514
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4823546409606934  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4823546409606934  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4850988388061523  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4850993156433105  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4805288314819336  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 8: 3, 6: 2, 5: 2, 4: 2, 1: 1, 2: 1, 30: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4805455207824707  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4805455207824707  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.6633563041687012  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.6633572578430176  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4805684089660645  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

pseudo mini batch 3 input nodes size: 662
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.48054838180542  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.48054838180542  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4840826988220215  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4840831756591797  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4813385009765625  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 5, 4: 3, 1: 2, 2: 2, 6: 1, 30: 1, 5: 1, 19: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4813551902770996  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4813551902770996  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.6668858528137207  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.666886806488037  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4813780784606934  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

pseudo mini batch 4 input nodes size: 447
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4813556671142578  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4813556671142578  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4837422370910645  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4837427139282227  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.480207920074463  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 6, 2: 4, 6: 3, 5: 3, 4: 1, 3: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.480219841003418  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.480219841003418  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.590475082397461  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.5904760360717773  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4802360534667969  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

pseudo mini batch 5 input nodes size: 351
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4802217483520508  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4802217483520508  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.482527256011963  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.482527732849121  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4801406860351562  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 6, 2: 6, 3: 3, 5: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.480149745941162  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.480149745941162  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.5595483779907227  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.559549331665039  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4801621437072754  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

pseudo mini batch 6 input nodes size: 638
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.480151653289795  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.480151653289795  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4835577011108398  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.483558177947998  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4812521934509277  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 5, 4: 5, 3: 4, 7: 2, 10: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4812679290771484  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4812679290771484  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.6510348320007324  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.6510357856750488  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4812889099121094  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

pseudo mini batch 7 input nodes size: 529
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4812688827514648  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4812688827514648  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.484093189239502  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4840936660766602  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.480687141418457  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({5: 5, 1: 3, 3: 3, 4: 3, 2: 2, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4807000160217285  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4807000160217285  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.6184520721435547  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.618453025817871  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4807171821594238  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4807171821594238  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.1154799461364746  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06897175312042236 |0.0006749629974365234 |0.07638224959373474 |8.976459503173828e-05 |0.174735426902771 |0.0035407543182373047 |
----------------------------------------------------------pseudo_mini_loss sum 86.00896453857422
Total (block generation + training)time/epoch 2.795610189437866
Training time/epoch 2.6781845092773438
Training time without block to device /epoch 2.6727848052978516
Training time without total dataloading part /epoch 2.013200283050537
load block tensor time/epoch 0.5517740249633789
block to device time/epoch 0.0053997039794921875
input features size transfer per epoch 1.1920928955078125e-06
blocks size to device per epoch 6.556510925292969e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  7559
Number of first layer input nodes during this epoch:  4843
Number of first layer output nodes during this epoch:  2053
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.1153578758239746  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.191 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.191 GB
Metis partitioning: 0.001 seconds, peak memory: 16.191 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.004 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009505748748779297
pure dgl.metis_partition the time spent:  0.006411075592041016

block_gen_time in "generate_blocks_for_one_layer_block"  0.013936281204223633


block_gen_time in "generate_blocks_for_one_layer_block"  0.015670061111450195


block_gen_time in "generate_blocks_for_one_layer_block"  0.023257017135620117

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.1153578758239746  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

connection checking time:  0.023382186889648438
block generation total time  0.052863359451293945
average batch blocks generation time:  0.006607919931411743
block dataloader generation time/epoch 0.11749577522277832
pseudo mini batch 0 input nodes size: 787
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.1153411865234375  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.1153411865234375  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.1195425987243652  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.1195430755615234  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.1167182922363281  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 5, 6: 3, 2: 2, 5: 2, 4: 2, 12: 1, 10: 1, 1: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.1167378425598145  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.1167378425598145  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.3381481170654297  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.3381495475769043  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4819889068603516  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

pseudo mini batch 1 input nodes size: 819
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4819626808166504  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4819626808166504  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4863595962524414  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4863600730895996  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4821581840515137  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 4, 5: 3, 1: 2, 2: 2, 3: 2, 10: 1, 9: 1, 7: 1, 21: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4821796417236328  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4821796417236328  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.7307405471801758  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.7307415008544922  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4822092056274414  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

pseudo mini batch 2 input nodes size: 670
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4821810722351074  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4821810722351074  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4863824844360352  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4863829612731934  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4819855690002441  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 7, 3: 5, 12: 1, 4: 1, 7: 1, 30: 1, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4820013046264648  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4820013046264648  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.6535282135009766  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.653529167175293  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4820232391357422  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

pseudo mini batch 3 input nodes size: 508
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4820027351379395  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4820027351379395  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4847149848937988  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.484715461730957  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.480513572692871  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 4, 1: 4, 3: 2, 2: 2, 5: 2, 7: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4805264472961426  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4805264472961426  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.6127171516418457  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.612718105316162  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.480543613433838  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

pseudo mini batch 4 input nodes size: 576
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.480527400970459  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.480527400970459  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.483602523803711  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4836030006408691  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4808902740478516  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({5: 3, 3: 3, 8: 3, 1: 2, 4: 2, 6: 2, 9: 1, 30: 1, 2: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4809069633483887  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4809069633483887  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.6723041534423828  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.6723051071166992  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4809298515319824  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

pseudo mini batch 5 input nodes size: 526
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.480909824371338  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.480909824371338  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.483717918395996  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4837183952331543  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4806427955627441  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 5, 4: 4, 2: 3, 5: 2, 9: 1, 6: 1, 3: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4806556701660156  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4806556701660156  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.6068048477172852  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.6068058013916016  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.480672836303711  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

pseudo mini batch 6 input nodes size: 459
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.480656623840332  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.480656623840332  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.483107089996338  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.483107566833496  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4802989959716797  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 5, 2: 5, 3: 3, 6: 2, 1: 1, 5: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4803109169006348  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4803109169006348  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.6008915901184082  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.6008925437927246  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4803271293640137  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

pseudo mini batch 7 input nodes size: 559
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4803128242492676  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4803128242492676  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.483297348022461  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4832978248596191  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.480846881866455  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 5, 1: 4, 2: 3, 5: 2, 6: 2, 19: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4808597564697266  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4808597564697266  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.622401237487793  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.6224021911621094  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4808769226074219  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4808769226074219  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.1156396865844727  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06827455759048462 |0.0006859898567199707 |0.07642388343811035 |9.295344352722168e-05 |0.17492416501045227 |0.003599405288696289 |
----------------------------------------------------------pseudo_mini_loss sum 245.21913146972656
Total (block generation + training)time/epoch 2.795038938522339
Training time/epoch 2.6765778064727783
Training time without block to device /epoch 2.6710898876190186
Training time without total dataloading part /epoch 2.015127420425415
load block tensor time/epoch 0.546196460723877
block to device time/epoch 0.005487918853759766
input features size transfer per epoch 1.1920928955078125e-06
blocks size to device per epoch 6.556510925292969e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  7612
Number of first layer input nodes during this epoch:  4904
Number of first layer output nodes during this epoch:  2049
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.1155180931091309  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.191 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.191 GB
Metis partitioning: 0.001 seconds, peak memory: 16.191 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.004 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009334325790405273
pure dgl.metis_partition the time spent:  0.006891727447509766

block_gen_time in "generate_blocks_for_one_layer_block"  0.013960838317871094


block_gen_time in "generate_blocks_for_one_layer_block"  0.01579737663269043


block_gen_time in "generate_blocks_for_one_layer_block"  0.02334284782409668

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.1155180931091309  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

connection checking time:  0.023394107818603516
block generation total time  0.0531010627746582
average batch blocks generation time:  0.006637632846832275
block dataloader generation time/epoch 0.11610523859659831
pseudo mini batch 0 input nodes size: 824
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.1155014038085938  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.1155014038085938  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.1199002265930176  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.1199007034301758  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.1169157028198242  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 2: 3, 6: 2, 5: 2, 4: 2, 10: 1, 21: 1, 9: 1, 1: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.1169371604919434  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.1169371604919434  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.3692946434020996  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.3692960739135742  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.482192039489746  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

pseudo mini batch 1 input nodes size: 802
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.482163429260254  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.482163429260254  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4868555068969727  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4868559837341309  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4824566841125488  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 5, 2: 3, 4: 2, 10: 1, 1: 1, 11: 1, 30: 1, 5: 1, 12: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4824762344360352  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4824762344360352  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.7079143524169922  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.7079153060913086  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4825029373168945  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

pseudo mini batch 2 input nodes size: 760
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4824767112731934  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4824767112731934  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.487168788909912  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4871692657470703  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4824767112731934  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 3, 2: 3, 7: 3, 1: 3, 3: 3, 5: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4824934005737305  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4824934005737305  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.6666035652160645  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.6666045188903809  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4825162887573242  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

pseudo mini batch 3 input nodes size: 476
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4824938774108887  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4824938774108887  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4851250648498535  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4851255416870117  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4804329872131348  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 6: 3, 5: 3, 2: 2, 1: 2, 4: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4804458618164062  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4804458618164062  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.6097326278686523  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.6097335815429688  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4804630279541016  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

pseudo mini batch 4 input nodes size: 493
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4804468154907227  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4804468154907227  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.483078956604004  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.483079433441162  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.480447769165039  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 8: 3, 1: 3, 6: 2, 4: 2, 5: 2, 30: 1, 9: 1, 2: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4804635047912598  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4804635047912598  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.6589303016662598  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.6589312553405762  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.480485439300537  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

pseudo mini batch 5 input nodes size: 481
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4804673194885254  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4804673194885254  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4830985069274902  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4830989837646484  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.480466365814209  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 4, 1: 4, 2: 3, 3: 3, 6: 2, 5: 1, 19: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.480478286743164  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.480478286743164  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.60443115234375  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.6044321060180664  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.480494499206543  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

pseudo mini batch 6 input nodes size: 529
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4804801940917969  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4804801940917969  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.483304500579834  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4833049774169922  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4806733131408691  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 5, 4: 4, 5: 2, 3: 2, 1: 2, 9: 1, 10: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.480687141418457  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.480687141418457  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.6250214576721191  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.6250224113464355  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4807062149047852  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

pseudo mini batch 7 input nodes size: 557
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4806900024414062  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4806900024414062  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.483663558959961  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4836640357971191  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4808392524719238  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 5, 4: 4, 1: 4, 5: 3, 3: 2})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4808521270751953  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4808521270751953  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.611987590789795  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.6119885444641113  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4808692932128906  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4808692932128906  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.1156320571899414  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06796768307685852 |0.0006851851940155029 |0.07626393437385559 |8.943676948547363e-05 |0.179548978805542 |0.003297567367553711 |
----------------------------------------------------------pseudo_mini_loss sum 106.54302978515625
Total (block generation + training)time/epoch 2.8044116497039795
Training time/epoch 2.709723949432373
Training time without block to device /epoch 2.704242467880249
Training time without total dataloading part /epoch 2.050516366958618
load block tensor time/epoch 0.5437414646148682
block to device time/epoch 0.0054814815521240234
input features size transfer per epoch 1.1920928955078125e-06
blocks size to device per epoch 6.556510925292969e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  7653
Number of first layer input nodes during this epoch:  4922
Number of first layer output nodes during this epoch:  2071
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.1155071258544922  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.191 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.191 GB
Metis partitioning: 0.001 seconds, peak memory: 16.191 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.004 seconds
REG metis partition end ----................................
REG construction  time spent:  0.014714479446411133
pure dgl.metis_partition the time spent:  0.006740093231201172

block_gen_time in "generate_blocks_for_one_layer_block"  0.014123201370239258


block_gen_time in "generate_blocks_for_one_layer_block"  0.016209125518798828


block_gen_time in "generate_blocks_for_one_layer_block"  0.18821978569030762

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.1155071258544922  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

connection checking time:  0.024199962615966797
block generation total time  0.2185521125793457
average batch blocks generation time:  0.027319014072418213
block dataloader generation time/epoch 0.15872132778167725
pseudo mini batch 0 input nodes size: 405
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.115490436553955  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.115490436553955  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.1176528930664062  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.1176533699035645  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.1146793365478516  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 6, 1: 6, 3: 3, 4: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.1146893501281738  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.1146893501281738  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.2050251960754395  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.205026626586914  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4806041717529297  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

pseudo mini batch 1 input nodes size: 809
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4805917739868164  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4805917739868164  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4849109649658203  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4849114418029785  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4827485084533691  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 4: 4, 1: 3, 19: 1, 12: 1, 9: 1, 5: 1, 10: 1, 2: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4827680587768555  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70068359375 GB
    Memory Allocated: 1.4827680587768555  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.7177910804748535  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.71779203414917  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4827947616577148  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

pseudo mini batch 2 input nodes size: 806
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4827685356140137  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4827685356140137  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4874606132507324  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4874610900878906  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4831414222717285  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 4: 3, 2: 2, 6: 2, 5: 2, 21: 1, 9: 1, 12: 1, 1: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4831628799438477  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4831628799438477  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.733384609222412  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.7333855628967285  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4831924438476562  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

pseudo mini batch 3 input nodes size: 682
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4831643104553223  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4831643104553223  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4868054389953613  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4868059158325195  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4821133613586426  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 4: 3, 2: 3, 5: 3, 7: 2, 9: 1, 1: 1, 6: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4821300506591797  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4821300506591797  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6760506629943848  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6760516166687012  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4821529388427734  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

pseudo mini batch 4 input nodes size: 415
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.482130527496338  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.482130527496338  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4843463897705078  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.484346866607666  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4807052612304688  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 4, 4: 4, 5: 3, 6: 3, 1: 2})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4807162284851074  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4807162284851074  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.589559555053711  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.5895605087280273  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.48073148727417  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

pseudo mini batch 5 input nodes size: 490
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4807190895080566  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4807190895080566  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.483335018157959  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4833354949951172  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.481119155883789  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 4: 4, 1: 4, 2: 4, 6: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4811320304870605  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4811320304870605  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6066255569458008  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6066265106201172  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4811491966247559  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

pseudo mini batch 6 input nodes size: 574
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.481132984161377  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.481132984161377  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4841976165771484  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4841980934143066  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.481581687927246  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 2: 3, 8: 3, 5: 2, 6: 2, 9: 1, 30: 1, 1: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4815993309020996  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4815993309020996  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6811175346374512  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6811184883117676  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4816241264343262  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

pseudo mini batch 7 input nodes size: 466
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4816017150878906  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4816017150878906  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4840898513793945  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4840903282165527  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.481025218963623  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 5: 3, 1: 2, 6: 2, 2: 2, 4: 2, 7: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4810380935668945  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4810380935668945  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6118545532226562  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6118555068969727  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4810552597045898  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4810552597045898  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1151409149169922  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06893455982208252 |0.0008099079132080078 |0.07651197910308838 |9.110569953918457e-05 |0.17878171801567078 |0.0034012794494628906 |
----------------------------------------------------------pseudo_mini_loss sum 169.2373504638672
Total (block generation + training)time/epoch 2.853547751903534
Training time/epoch 2.714256763458252
Training time without block to device /epoch 2.707777500152588
Training time without total dataloading part /epoch 2.0464797019958496
load block tensor time/epoch 0.5514764785766602
block to device time/epoch 0.0064792633056640625
input features size transfer per epoch 1.1920928955078125e-06
blocks size to device per epoch 6.556510925292969e-07
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  7310
Number of first layer input nodes during this epoch:  4647
Number of first layer output nodes during this epoch:  2005
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1150217056274414  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.191 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.191 GB
Metis partitioning: 0.001 seconds, peak memory: 16.191 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.004 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009823799133300781
pure dgl.metis_partition the time spent:  0.005941629409790039

block_gen_time in "generate_blocks_for_one_layer_block"  0.014199256896972656


block_gen_time in "generate_blocks_for_one_layer_block"  0.016282081604003906


block_gen_time in "generate_blocks_for_one_layer_block"  0.023906946182250977

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1150217056274414  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

connection checking time:  0.023395061492919922
block generation total time  0.05438828468322754
average batch blocks generation time:  0.006798535585403442
block dataloader generation time/epoch 0.1509042739868164
pseudo mini batch 0 input nodes size: 666
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1150050163269043  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1150050163269043  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.118560791015625  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1185612678527832  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.116072654724121  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 1: 3, 2: 3, 5: 1, 11: 1, 4: 1, 6: 1, 7: 1, 10: 1, 12: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1160893440246582  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1160893440246582  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.3005218505859375  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.300523281097412  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4820137023925781  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

pseudo mini batch 1 input nodes size: 932
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4819912910461426  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4819912910461426  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4869670867919922  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4869675636291504  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4834113121032715  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 6, 2: 3, 3: 3, 5: 2, 9: 1, 19: 1, 30: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4834346771240234  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4834346771240234  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.755052089691162  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.7550530433654785  GigaBytes
Max Memory Allocated: 1.9875259399414062  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4834671020507812  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

pseudo mini batch 2 input nodes size: 649
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4834346771240234  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4834346771240234  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4870572090148926  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4870576858520508  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.482081413269043  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 6, 2: 4, 5: 3, 3: 2, 4: 2, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4820961952209473  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4820961952209473  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6408028602600098  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6408038139343262  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4821162223815918  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

pseudo mini batch 3 input nodes size: 548
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.482095718383789  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.482095718383789  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4850215911865234  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4850220680236816  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4813990592956543  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 4, 2: 4, 4: 3, 6: 2, 5: 1, 9: 1, 7: 1, 3: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4814119338989258  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4814119338989258  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6262621879577637  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.62626314163208  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.481429100036621  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

pseudo mini batch 4 input nodes size: 529
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4814128875732422  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4814128875732422  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4842371940612793  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4842376708984375  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.481311321258545  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({8: 3, 3: 3, 5: 2, 2: 2, 6: 2, 4: 2, 30: 1, 9: 1, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.481328010559082  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.481328010559082  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6656713485717773  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6656723022460938  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4813508987426758  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

pseudo mini batch 5 input nodes size: 599
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4813308715820312  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4813308715820312  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4845285415649414  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4845290184020996  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4817042350769043  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 2: 4, 5: 3, 4: 2, 1: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4817180633544922  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4817180633544922  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6302828788757324  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6302838325500488  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.481736183166504  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

pseudo mini batch 6 input nodes size: 217
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4817180633544922  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4817180633544922  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4830188751220703  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4830193519592285  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4798212051391602  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 4: 3, 6: 3, 5: 3, 1: 3, 2: 2})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4798293113708496  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4798293113708496  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.555696964263916  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.5556979179382324  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.47983980178833  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

pseudo mini batch 7 input nodes size: 738
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4798316955566406  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4798316955566406  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4845237731933594  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4845242500305176  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4832229614257812  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 4: 3, 2: 3, 1: 2, 6: 2, 21: 1, 12: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4832425117492676  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4832425117492676  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.7136168479919434  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.7136178016662598  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.483269214630127  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.483269214630127  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1173548698425293  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06887367367744446 |0.0006891191005706787 |0.07967561483383179 |9.420514106750488e-05 |0.19106623530387878 |0.003036022186279297 |
----------------------------------------------------------pseudo_mini_loss sum 86.00452423095703
Total (block generation + training)time/epoch 2.873894548416138
Training time/epoch 2.835541009902954
Training time without block to device /epoch 2.8300280570983887
Training time without total dataloading part /epoch 2.169724464416504
load block tensor time/epoch 0.5509893894195557
block to device time/epoch 0.00551295280456543
input features size transfer per epoch 1.1920928955078125e-06
blocks size to device per epoch 6.556510925292969e-07
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  7685
Number of first layer input nodes during this epoch:  4878
Number of first layer output nodes during this epoch:  2140
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1172418594360352  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.191 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.191 GB
Metis partitioning: 0.001 seconds, peak memory: 16.191 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.004 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009083032608032227
pure dgl.metis_partition the time spent:  0.006522178649902344

block_gen_time in "generate_blocks_for_one_layer_block"  0.013973474502563477


block_gen_time in "generate_blocks_for_one_layer_block"  0.01568913459777832


block_gen_time in "generate_blocks_for_one_layer_block"  0.02342677116394043

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1172418594360352  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

connection checking time:  0.023397445678710938
block generation total time  0.05308938026428223
average batch blocks generation time:  0.006636172533035278
block dataloader generation time/epoch 0.1451401710510254
pseudo mini batch 0 input nodes size: 669
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1172151565551758  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1172151565551758  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1207866668701172  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1207871437072754  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1160945892333984  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 5, 1: 3, 2: 3, 6: 2, 4: 2, 10: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1161112785339355  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1161112785339355  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.2946219444274902  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.2946233749389648  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4821515083312988  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

pseudo mini batch 1 input nodes size: 717
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4821290969848633  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4821290969848633  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.486821174621582  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4868216514587402  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4832496643066406  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 4, 4: 3, 5: 2, 6: 2, 7: 2, 3: 2, 9: 1, 11: 1, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4832673072814941  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4832673072814941  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6834235191345215  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.683424472808838  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4832921028137207  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

pseudo mini batch 2 input nodes size: 656
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4832696914672852  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4832696914672852  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.486772060394287  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4867725372314453  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4820799827575684  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 3, 3: 3, 1: 2, 4: 2, 5: 2, 6: 1, 10: 1, 21: 1, 9: 1, 19: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4820985794067383  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4820985794067383  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6977815628051758  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6977825164794922  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4821243286132812  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

pseudo mini batch 3 input nodes size: 525
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.482100009918213  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.482100009918213  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4849028587341309  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.484903335571289  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.481400489807129  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 5, 2: 5, 4: 3, 3: 3, 5: 2})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.481412410736084  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.481412410736084  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.5969562530517578  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.5969572067260742  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.481428623199463  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

pseudo mini batch 4 input nodes size: 498
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4814143180847168  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4814143180847168  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4840731620788574  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4840736389160156  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4812703132629395  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 5, 1: 4, 3: 4, 4: 2, 5: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4812822341918945  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4812822341918945  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.5983643531799316  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.598365306854248  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4812984466552734  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

pseudo mini batch 5 input nodes size: 607
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4812841415405273  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4812841415405273  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4845247268676758  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.484525203704834  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4818658828735352  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({6: 4, 4: 3, 3: 3, 8: 2, 5: 2, 9: 1, 30: 1, 10: 1, 2: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4818835258483887  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4818835258483887  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6913509368896484  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6913518905639648  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4819083213806152  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

pseudo mini batch 6 input nodes size: 503
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4818859100341797  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4818859100341797  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4845714569091797  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.484571933746338  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4813308715820312  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 2: 3, 5: 2, 4: 2, 1: 2, 6: 2, 12: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4813446998596191  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4813446998596191  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.624453067779541  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6244540214538574  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4813637733459473  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

pseudo mini batch 7 input nodes size: 734
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4813475608825684  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4813475608825684  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.486039638519287  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4860401153564453  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.483354091644287  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 5, 5: 4, 1: 3, 3: 2, 7: 2, 2: 1, 8: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4833717346191406  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4833717346191406  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.677161693572998  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6771626472473145  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4833955764770508  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4833955764770508  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1173591613769531  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06857645511627197 |0.0006814002990722656 |0.07651862502098083 |9.122490882873535e-05 |0.17844784259796143 |0.0032472610473632812 |
----------------------------------------------------------pseudo_mini_loss sum 79.36148834228516
Total (block generation + training)time/epoch 2.8658827543258667
Training time/epoch 2.709397077560425
Training time without block to device /epoch 2.7039458751678467
Training time without total dataloading part /epoch 2.0437088012695312
load block tensor time/epoch 0.5486116409301758
block to device time/epoch 0.005451202392578125
input features size transfer per epoch 1.1920928955078125e-06
blocks size to device per epoch 6.556510925292969e-07
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  7658
Number of first layer input nodes during this epoch:  4909
Number of first layer output nodes during this epoch:  2084
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1172370910644531  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.191 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.191 GB
Metis partitioning: 0.001 seconds, peak memory: 16.191 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.004 seconds
REG metis partition end ----................................
REG construction  time spent:  0.010719776153564453
pure dgl.metis_partition the time spent:  0.006700038909912109

block_gen_time in "generate_blocks_for_one_layer_block"  0.013934135437011719


block_gen_time in "generate_blocks_for_one_layer_block"  0.015761137008666992


block_gen_time in "generate_blocks_for_one_layer_block"  0.023437023162841797

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1172370910644531  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

connection checking time:  0.023320436477661133
block generation total time  0.05313229560852051
average batch blocks generation time:  0.0066415369510650635
block dataloader generation time/epoch 0.1411334787096296
pseudo mini batch 0 input nodes size: 730
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1172122955322266  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1172122955322266  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1211094856262207  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.121109962463379  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.116417407989502  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 1: 2, 5: 2, 6: 1, 21: 1, 7: 1, 10: 1, 4: 1, 12: 1, 30: 1, 2: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1164379119873047  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1164379119873047  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.347670555114746  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.3476719856262207  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4826087951660156  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

pseudo mini batch 1 input nodes size: 834
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4825825691223145  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4825825691223145  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4872746467590332  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4872751235961914  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.483377456665039  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 5, 4: 3, 6: 3, 11: 1, 1: 1, 12: 1, 5: 1, 9: 1, 2: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4833979606628418  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4833979606628418  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.7198824882507324  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.7198834419250488  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4834256172180176  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

pseudo mini batch 2 input nodes size: 626
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4833974838256836  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4833974838256836  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4867396354675293  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4867401123046875  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4820475578308105  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 5, 1: 3, 9: 2, 2: 2, 5: 2, 7: 1, 6: 1, 3: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4820632934570312  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4820632934570312  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6557903289794922  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6557912826538086  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4820852279663086  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

pseudo mini batch 3 input nodes size: 583
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4820647239685059  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4820647239685059  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4851770401000977  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4851775169372559  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.481834888458252  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 7, 1: 5, 4: 3, 3: 1, 6: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4818477630615234  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4818477630615234  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.615818977355957  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6158199310302734  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4818649291992188  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

pseudo mini batch 4 input nodes size: 573
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4818487167358398  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4818487167358398  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.484907627105713  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.484908103942871  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.481795310974121  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 8: 3, 6: 2, 2: 2, 4: 2, 5: 2, 30: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4818129539489746  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4818129539489746  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.680361270904541  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6803622245788574  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4818377494812012  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

pseudo mini batch 5 input nodes size: 585
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4818153381347656  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4818153381347656  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.484938621520996  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4849390983581543  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.481879711151123  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({5: 4, 4: 4, 3: 3, 2: 3, 6: 2, 19: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4818944931030273  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4818944931030273  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6452999114990234  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6453008651733398  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4819145202636719  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

pseudo mini batch 6 input nodes size: 495
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4818964004516602  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4818964004516602  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4845390319824219  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.48453950881958  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4814157485961914  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 5, 3: 4, 4: 3, 2: 3, 5: 2, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4814276695251465  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4814276695251465  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6031222343444824  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6031231880187988  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4814438819885254  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

pseudo mini batch 7 input nodes size: 420
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4814295768737793  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4814295768737793  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4836721420288086  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4836726188659668  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4810295104980469  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 6, 1: 4, 3: 2, 5: 2, 4: 1, 6: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4810404777526855  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4810404777526855  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.5878291130065918  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.5878300666809082  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.481055736541748  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.481055736541748  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1148972511291504  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06902721524238586 |0.0006804466247558594 |0.07502517104148865 |9.205937385559082e-05 |0.16848886013031006 |0.0034623146057128906 |
----------------------------------------------------------pseudo_mini_loss sum 47.677146911621094
Total (block generation + training)time/epoch 2.847788027354649
Training time/epoch 2.6220145225524902
Training time without block to device /epoch 2.6165709495544434
Training time without total dataloading part /epoch 1.9523110389709473
load block tensor time/epoch 0.5522177219390869
block to device time/epoch 0.005443572998046875
input features size transfer per epoch 1.1920928955078125e-06
blocks size to device per epoch 6.556510925292969e-07
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  7586
Number of first layer input nodes during this epoch:  4846
Number of first layer output nodes during this epoch:  2071
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1147723197937012  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.191 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.191 GB
Metis partitioning: 0.001 seconds, peak memory: 16.191 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.004 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009265661239624023
pure dgl.metis_partition the time spent:  0.006443977355957031

block_gen_time in "generate_blocks_for_one_layer_block"  0.014002323150634766


block_gen_time in "generate_blocks_for_one_layer_block"  0.01585245132446289


block_gen_time in "generate_blocks_for_one_layer_block"  0.023217201232910156

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1147723197937012  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

connection checking time:  0.023595571517944336
block generation total time  0.05307197570800781
average batch blocks generation time:  0.0066339969635009766
block dataloader generation time/epoch 0.13871410489082336
pseudo mini batch 0 input nodes size: 736
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1147594451904297  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1147594451904297  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1186885833740234  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1186890602111816  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1164460182189941  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 6: 3, 2: 2, 1: 2, 10: 1, 5: 1, 12: 1, 9: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1164636611938477  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1164636611938477  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.3227133750915527  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.3227148056030273  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4817118644714355  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

pseudo mini batch 1 input nodes size: 871
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4816875457763672  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4816875457763672  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4863567352294922  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4863572120666504  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4824275970458984  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 5: 3, 2: 2, 4: 2, 9: 1, 7: 1, 1: 1, 11: 1, 21: 1, 30: 1, 10: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4824538230895996  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4824538230895996  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.7730412483215332  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.7730422019958496  GigaBytes
Max Memory Allocated: 2.0040602684020996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.482490062713623  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 2 input nodes size: 444
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4824576377868652  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4824576377868652  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.484827995300293  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4848284721374512  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.480158805847168  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 6, 1: 5, 5: 2, 6: 2, 10: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.480170726776123  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.480170726776123  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.595860481262207  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.5958614349365234  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.480186939239502  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 3 input nodes size: 581
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4801726341247559  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4801726341247559  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4832744598388672  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4832749366760254  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4809041023254395  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 4, 2: 4, 1: 3, 3: 3, 5: 2, 19: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4809179306030273  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4809179306030273  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6304926872253418  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6304936408996582  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.480936050415039  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 4 input nodes size: 516
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4809179306030273  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4809179306030273  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4836726188659668  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.483673095703125  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4805707931518555  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 4, 3: 4, 8: 3, 5: 2, 6: 2, 2: 1, 30: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4805874824523926  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4805874824523926  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6724424362182617  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6724433898925781  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4806103706359863  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 5 input nodes size: 334
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4805903434753418  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4805903434753418  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4823737144470215  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4823741912841797  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.479619026184082  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 5, 2: 3, 5: 3, 4: 2, 3: 2, 9: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.479628086090088  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.479628086090088  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.5688114166259766  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.568812370300293  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4796404838562012  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 6 input nodes size: 615
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4796299934387207  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4796299934387207  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4829134941101074  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4829139709472656  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4811301231384277  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 5, 3: 4, 2: 2, 1: 2, 5: 2, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4811439514160156  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4811439514160156  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6260700225830078  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6260709762573242  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4811620712280273  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 7 input nodes size: 746
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4811439514160156  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4811439514160156  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4858360290527344  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4858365058898926  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4825525283813477  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 5, 3: 4, 7: 3, 4: 3, 1: 2, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4825692176818848  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4825692176818848  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.670015811920166  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6700167655944824  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4825921058654785  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4825921058654785  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1173548698425293  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06901714205741882 |0.0006769895553588867 |0.07583600282669067 |8.878111839294434e-05 |0.1753627359867096 |0.0029840469360351562 |
----------------------------------------------------------pseudo_mini_loss sum 37.549354553222656
Total (block generation + training)time/epoch 2.8418328166007996
Training time/epoch 2.6782631874084473
Training time without block to device /epoch 2.672847270965576
Training time without total dataloading part /epoch 2.013284206390381
load block tensor time/epoch 0.5521371364593506
block to device time/epoch 0.005415916442871094
input features size transfer per epoch 1.1920928955078125e-06
blocks size to device per epoch 6.556510925292969e-07
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  7597
Number of first layer input nodes during this epoch:  4843
Number of first layer output nodes during this epoch:  2091
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1172351837158203  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.191 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.191 GB
Metis partitioning: 0.001 seconds, peak memory: 16.191 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.004 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009615182876586914
pure dgl.metis_partition the time spent:  0.006366252899169922

block_gen_time in "generate_blocks_for_one_layer_block"  0.013911247253417969


block_gen_time in "generate_blocks_for_one_layer_block"  0.0157010555267334


block_gen_time in "generate_blocks_for_one_layer_block"  0.02410602569580078

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1172351837158203  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

connection checking time:  0.023186922073364258
block generation total time  0.05371832847595215
average batch blocks generation time:  0.0067147910594940186
block dataloader generation time/epoch 0.13594460487365723
pseudo mini batch 0 input nodes size: 587
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1172122955322266  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1172122955322266  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1203460693359375  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1203465461730957  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1156539916992188  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 2: 3, 8: 3, 6: 2, 5: 2, 4: 2, 9: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1156716346740723  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1156716346740723  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.3172812461853027  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.3172826766967773  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4815945625305176  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 1 input nodes size: 439
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.481572151184082  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.481572151184082  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4839158058166504  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4839162826538086  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4807820320129395  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 3, 5: 3, 3: 3, 4: 3, 6: 2, 1: 2, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4807939529418945  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4807939529418945  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.5990967750549316  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.599097728729248  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4808101654052734  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 2 input nodes size: 659
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4807958602905273  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4807958602905273  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.48431396484375  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4843144416809082  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4819703102111816  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 7, 2: 3, 7: 2, 3: 1, 6: 1, 5: 1, 4: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.481985092163086  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.481985092163086  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6394867897033691  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6394877433776855  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4820051193237305  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 3 input nodes size: 677
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4819846153259277  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4819846153259277  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4855990409851074  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4855995178222656  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4820809364318848  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 7, 1: 3, 2: 3, 5: 2, 3: 1, 19: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4820966720581055  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4820966720581055  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6450276374816895  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6450285911560059  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4821176528930664  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 4 input nodes size: 900
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4820976257324219  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4820976257324219  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4869022369384766  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4869027137756348  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4832878112792969  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 6: 2, 4: 2, 2: 2, 5: 1, 7: 1, 12: 1, 9: 1, 10: 1, 1: 1, 11: 1, 21: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4833111763000488  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4833111763000488  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.7625961303710938  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.7625970840454102  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4833436012268066  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 5 input nodes size: 900
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4833111763000488  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4833111763000488  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4881157875061035  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4881162643432617  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4833111763000488  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 5, 2: 3, 5: 2, 4: 2, 12: 1, 7: 1, 6: 1, 10: 1, 9: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4833335876464844  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4833335876464844  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.745345115661621  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.7453460693359375  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4833650588989258  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 6 input nodes size: 283
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4833345413208008  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4833345413208008  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4848456382751465  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4848461151123047  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4800410270690918  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 5: 3, 4: 3, 1: 3, 2: 3, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4800491333007812  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4800491333007812  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.5536255836486816  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.553626537322998  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4800596237182617  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 7 input nodes size: 509
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4800515174865723  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4800515174865723  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4827690124511719  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.48276948928833  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4812579154968262  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 5, 1: 4, 3: 4, 4: 2, 6: 2, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4812707901000977  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4812707901000977  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6065235137939453  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6065244674682617  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.481287956237793  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.481287956237793  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1153736114501953  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06793269515037537 |0.000721365213394165 |0.07462790608406067 |9.110569953918457e-05 |0.17159691452980042 |0.002934694290161133 |
----------------------------------------------------------pseudo_mini_loss sum 17.297611236572266
Total (block generation + training)time/epoch 2.8310016526116266
Training time/epoch 2.630458116531372
Training time without block to device /epoch 2.6246871948242188
Training time without total dataloading part /epoch 1.9734621047973633
load block tensor time/epoch 0.5434615612030029
block to device time/epoch 0.00577092170715332
input features size transfer per epoch 1.1920928955078125e-06
blocks size to device per epoch 6.556510925292969e-07
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  7719
Number of first layer input nodes during this epoch:  4954
Number of first layer output nodes during this epoch:  2101
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.115251064300537  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.191 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.191 GB
Metis partitioning: 0.001 seconds, peak memory: 16.191 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.006 seconds
REG metis partition end ----................................
REG construction  time spent:  0.010392427444458008
pure dgl.metis_partition the time spent:  0.008868217468261719

block_gen_time in "generate_blocks_for_one_layer_block"  0.014415979385375977


block_gen_time in "generate_blocks_for_one_layer_block"  0.01600027084350586


block_gen_time in "generate_blocks_for_one_layer_block"  0.02353811264038086

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.115251064300537  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

connection checking time:  0.023418903350830078
block generation total time  0.053954362869262695
average batch blocks generation time:  0.006744295358657837
block dataloader generation time/epoch 0.13447864055633546
pseudo mini batch 0 input nodes size: 798
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.115234375  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.115234375  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1194944381713867  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.119494915008545  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.116776943206787  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 5, 4: 4, 6: 3, 12: 1, 11: 1, 10: 1, 9: 1, 2: 1, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1167974472045898  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1167974472045898  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.3488316535949707  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.3488330841064453  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4820494651794434  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 1 input nodes size: 772
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4820213317871094  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4820213317871094  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4863595962524414  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4863600730895996  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4820995330810547  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 6, 4: 3, 5: 3, 6: 1, 1: 1, 7: 1, 3: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4821171760559082  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4821171760559082  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6755542755126953  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6755552291870117  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4821410179138184  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 2 input nodes size: 848
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.48211669921875  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.48211669921875  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4868087768554688  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.486809253692627  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4824705123901367  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({5: 4, 3: 4, 4: 2, 2: 2, 30: 1, 10: 1, 19: 1, 21: 1, 12: 1, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4824957847595215  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4824957847595215  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.7649850845336914  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.7649860382080078  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4825310707092285  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 3 input nodes size: 443
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4825005531311035  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4825005531311035  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.484865665435791  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4848661422729492  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4801735877990723  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 1: 5, 2: 2, 4: 2, 6: 1, 8: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4801855087280273  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4801855087280273  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.592841625213623  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.5928425788879395  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4802017211914062  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 4 input nodes size: 597
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4801874160766602  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4801874160766602  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4833745956420898  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.483375072479248  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4810094833374023  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 2: 3, 4: 2, 6: 2, 8: 2, 5: 2, 7: 1, 30: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4810271263122559  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4810271263122559  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6801643371582031  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6801652908325195  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4810519218444824  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 5 input nodes size: 401
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4810295104980469  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4810295104980469  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.483170509338379  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.483170986175537  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4799833297729492  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 6, 3: 3, 4: 3, 5: 2, 2: 2, 10: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.479994297027588  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.479994297027588  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.588775634765625  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.5887765884399414  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4800095558166504  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 6 input nodes size: 390
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.479997158050537  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.479997158050537  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4820795059204102  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4820799827575684  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4799385070800781  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 5, 1: 3, 4: 3, 6: 2, 5: 1, 3: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4799485206604004  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4799485206604004  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.5768861770629883  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.5768871307373047  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.47996187210083  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 7 input nodes size: 528
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4799494743347168  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4799494743347168  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4827685356140137  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4827690124511719  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4806861877441406  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 4, 1: 3, 4: 3, 5: 2, 3: 2, 6: 1, 9: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.480699062347412  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.480699062347412  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6125164031982422  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6125173568725586  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4807162284851074  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4807162284851074  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1154789924621582  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06882843375205994 |0.0006887614727020264 |0.07421556115150452 |9.53972339630127e-05 |0.16568750143051147 |0.003243684768676758 |
----------------------------------------------------------pseudo_mini_loss sum 11.138864517211914
Total (block generation + training)time/epoch 2.8184890031814573
Training time/epoch 2.5844786167144775
Training time without block to device /epoch 2.5789685249328613
Training time without total dataloading part /epoch 1.9232313632965088
load block tensor time/epoch 0.5506274700164795
block to device time/epoch 0.005510091781616211
input features size transfer per epoch 1.1920928955078125e-06
blocks size to device per epoch 6.556510925292969e-07
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  7500
Number of first layer input nodes during this epoch:  4777
Number of first layer output nodes during this epoch:  2062
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1153526306152344  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.191 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.191 GB
Metis partitioning: 0.001 seconds, peak memory: 16.191 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.004 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009709835052490234
pure dgl.metis_partition the time spent:  0.006267547607421875

block_gen_time in "generate_blocks_for_one_layer_block"  0.013963937759399414


block_gen_time in "generate_blocks_for_one_layer_block"  0.01578235626220703


block_gen_time in "generate_blocks_for_one_layer_block"  0.023656606674194336

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1153526306152344  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

connection checking time:  0.02334737777709961
block generation total time  0.05340290069580078
average batch blocks generation time:  0.006675362586975098
block dataloader generation time/epoch 0.13270998001098633
pseudo mini batch 0 input nodes size: 821
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1153359413146973  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1153359413146973  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.120028018951416  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1200284957885742  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1172089576721191  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 6: 3, 4: 2, 5: 2, 9: 1, 1: 1, 12: 1, 10: 1, 2: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1172285079956055  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1172285079956055  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.3436965942382812  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.3436980247497559  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4824795722961426  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 1 input nodes size: 741
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4824533462524414  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4824533462524414  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4864091873168945  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4864096641540527  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4817171096801758  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 5, 2: 4, 5: 3, 3: 3, 11: 1, 7: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4817347526550293  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4817347526550293  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6746468544006348  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6746478080749512  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4817585945129395  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 2 input nodes size: 575
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.481734275817871  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.481734275817871  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4848041534423828  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.484804630279541  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4808483123779297  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({5: 3, 4: 3, 1: 3, 2: 3, 12: 1, 6: 1, 21: 1, 3: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4808640480041504  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4808640480041504  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.662736415863037  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6627373695373535  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4808859825134277  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 3 input nodes size: 405
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.480865478515625  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.480865478515625  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4830279350280762  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4830284118652344  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4799580574035645  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 5, 3: 4, 2: 4, 4: 2, 10: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4799699783325195  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4799699783325195  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.5902318954467773  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.5902328491210938  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4799861907958984  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 4 input nodes size: 477
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4799718856811523  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4799718856811523  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4825186729431152  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4825191497802734  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.480356216430664  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 8: 3, 5: 2, 6: 2, 4: 2, 1: 1, 30: 1, 9: 1, 2: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4803719520568848  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4803719520568848  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6562585830688477  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.656259536743164  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.480393886566162  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 5 input nodes size: 618
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4803757667541504  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4803757667541504  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4836750030517578  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.483675479888916  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.481128215789795  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 5, 1: 4, 3: 4, 4: 2, 9: 1, 5: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4811420440673828  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4811420440673828  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6212735176086426  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.621274471282959  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4811601638793945  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 6 input nodes size: 837
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4811420440673828  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4811420440673828  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4858341217041016  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4858345985412598  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4825348854064941  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 5, 5: 3, 1: 2, 3: 2, 4: 2, 19: 1, 30: 1, 6: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4825553894042969  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4825553894042969  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.7247428894042969  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.7247438430786133  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4825830459594727  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 7 input nodes size: 479
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4825549125671387  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4825549125671387  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.485112190246582  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4851126670837402  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4804201126098633  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 4, 1: 4, 2: 2, 3: 2, 6: 2, 7: 1, 9: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4804320335388184  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4804320335388184  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.5968828201293945  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.596883773803711  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4804482460021973  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4804482460021973  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.115211009979248  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.067778080701828 |0.0006869733333587646 |0.07465380430221558 |9.268522262573242e-05 |0.17143091559410095 |0.0032033920288085938 |
----------------------------------------------------------pseudo_mini_loss sum 5.919389724731445
Total (block generation + training)time/epoch 2.8116838281804863
Training time/epoch 2.628491163253784
Training time without block to device /epoch 2.622995376586914
Training time without total dataloading part /epoch 1.9726226329803467
load block tensor time/epoch 0.542224645614624
block to device time/epoch 0.005495786666870117
input features size transfer per epoch 1.1920928955078125e-06
blocks size to device per epoch 6.556510925292969e-07
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  7719
Number of first layer input nodes during this epoch:  4953
Number of first layer output nodes during this epoch:  2100
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.115088939666748  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.191 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.191 GB
Metis partitioning: 0.001 seconds, peak memory: 16.191 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.004 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009685516357421875
pure dgl.metis_partition the time spent:  0.006619691848754883

block_gen_time in "generate_blocks_for_one_layer_block"  0.01399683952331543


block_gen_time in "generate_blocks_for_one_layer_block"  0.015734195709228516


block_gen_time in "generate_blocks_for_one_layer_block"  0.023194074630737305

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.115088939666748  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

connection checking time:  0.02297067642211914
block generation total time  0.05292510986328125
average batch blocks generation time:  0.006615638732910156
block dataloader generation time/epoch 0.13121561209360758
pseudo mini batch 0 input nodes size: 607
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1150741577148438  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1150741577148438  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1183147430419922  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1183152198791504  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1157574653625488  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 1: 3, 4: 3, 2: 3, 6: 2, 12: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1157732009887695  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1157732009887695  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.2852249145507812  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.2852263450622559  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.481696605682373  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 1 input nodes size: 751
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4816761016845703  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4816761016845703  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4856853485107422  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4856858253479004  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4824447631835938  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({5: 4, 2: 3, 4: 3, 3: 2, 7: 2, 6: 1, 1: 1, 9: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4824633598327637  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4824633598327637  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6894145011901855  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.689415454864502  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4824891090393066  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 2 input nodes size: 543
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4824647903442383  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4824647903442383  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4853639602661133  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4853644371032715  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4813547134399414  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 5, 1: 3, 8: 2, 6: 2, 5: 2, 30: 1, 9: 1, 2: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.481370449066162  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.481370449066162  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6562519073486328  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6562528610229492  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.481391429901123  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 3 input nodes size: 694
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4813714027404785  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4813714027404785  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4853806495666504  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4853811264038086  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4824814796447754  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 4, 4: 3, 1: 2, 5: 2, 10: 2, 12: 1, 6: 1, 21: 1, 9: 1, 3: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4825000762939453  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4825000762939453  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.7043023109436035  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.70430326461792  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4825258255004883  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 4 input nodes size: 665
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.48250150680542  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.48250150680542  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4860515594482422  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4860520362854004  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4820423126220703  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 5, 3: 4, 2: 3, 1: 3, 19: 1, 5: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4820599555969238  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4820599555969238  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6748428344726562  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6748437881469727  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4820847511291504  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 5 input nodes size: 541
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4820623397827148  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4820623397827148  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4849505424499512  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4849510192871094  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.481400489807129  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 5, 2: 4, 4: 3, 1: 3, 5: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4814143180847168  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4814143180847168  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6208834648132324  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6208844184875488  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4814324378967285  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 6 input nodes size: 333
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4814143180847168  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4814143180847168  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4831924438476562  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4831929206848145  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.48030424118042  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 3, 5: 3, 6: 3, 1: 3, 3: 2, 4: 2, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4803142547607422  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4803142547607422  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.5769600868225098  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.5769610404968262  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4803285598754883  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 7 input nodes size: 450
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4803180694580078  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4803180694580078  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.483232021331787  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4832324981689453  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4814538955688477  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 4, 3: 3, 1: 2, 6: 2, 4: 2, 5: 2, 7: 1, 8: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4814658164978027  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4814658164978027  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6027393341064453  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6027402877807617  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4814820289611816  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4814820289611816  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.115567684173584  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06898915767669678 |0.0006904006004333496 |0.07612636685371399 |9.119510650634766e-05 |0.17228463292121887 |0.003510713577270508 |
----------------------------------------------------------pseudo_mini_loss sum 5.1152801513671875
Total (block generation + training)time/epoch 2.8084603349367776
Training time/epoch 2.6581175327301025
Training time without block to device /epoch 2.6525943279266357
Training time without total dataloading part /epoch 1.9915282726287842
load block tensor time/epoch 0.5519132614135742
block to device time/epoch 0.005523204803466797
input features size transfer per epoch 1.1920928955078125e-06
blocks size to device per epoch 6.556510925292969e-07
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  7244
Number of first layer input nodes during this epoch:  4584
Number of first layer output nodes during this epoch:  2004
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.115445613861084  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.191 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.191 GB
Metis partitioning: 0.001 seconds, peak memory: 16.191 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.004 seconds
REG metis partition end ----................................
REG construction  time spent:  0.008625268936157227
pure dgl.metis_partition the time spent:  0.0064046382904052734

block_gen_time in "generate_blocks_for_one_layer_block"  0.013893842697143555


block_gen_time in "generate_blocks_for_one_layer_block"  0.015732765197753906


block_gen_time in "generate_blocks_for_one_layer_block"  0.02407050132751465

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.115445613861084  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

connection checking time:  0.023270845413208008
block generation total time  0.05369710922241211
average batch blocks generation time:  0.006712138652801514
block dataloader generation time/epoch 0.12990390337430513
pseudo mini batch 0 input nodes size: 757
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1154308319091797  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1154308319091797  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1194720268249512  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1194725036621094  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1165580749511719  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 4, 3: 3, 2: 3, 5: 2, 7: 2, 6: 1, 11: 1, 12: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1165766716003418  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1165766716003418  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.326979637145996  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.3269810676574707  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4818267822265625  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 1 input nodes size: 796
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4818024635314941  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4818024635314941  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4863595962524414  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4863600730895996  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.48231840133667  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 4, 3: 4, 10: 2, 6: 2, 1: 2, 5: 1, 2: 1, 9: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4823389053344727  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4823389053344727  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.713179111480713  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.7131800651550293  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4823665618896484  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 2 input nodes size: 781
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4823384284973145  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4823384284973145  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4870305061340332  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4870309829711914  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.482473373413086  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 5, 4: 3, 2: 2, 1: 2, 5: 1, 6: 1, 10: 1, 30: 1, 19: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4824938774108887  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4824938774108887  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.7205595970153809  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.7205605506896973  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4825224876403809  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 3 input nodes size: 482
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4824962615966797  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4824962615966797  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.485069751739502  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4850702285766602  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4803776741027832  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 6, 5: 2, 3: 2, 2: 2, 4: 2, 6: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4803895950317383  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4803895950317383  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.5961298942565918  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.5961308479309082  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4804058074951172  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 4 input nodes size: 522
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.480391502380371  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.480391502380371  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4831781387329102  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4831786155700684  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.480604648590088  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 8: 3, 2: 3, 4: 2, 6: 2, 5: 2, 9: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.480621337890625  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.480621337890625  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6672601699829102  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6672611236572266  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4806442260742188  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 5 input nodes size: 472
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4806241989135742  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4806241989135742  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4831442832946777  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.483144760131836  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4803576469421387  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 4, 5: 3, 6: 3, 3: 2, 4: 2, 2: 2, 21: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4803705215454102  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4803705215454102  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6208710670471191  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6208720207214355  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4803876876831055  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 6 input nodes size: 725
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4803714752197266  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4803714752197266  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4850635528564453  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4850640296936035  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4825434684753418  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 5, 5: 4, 1: 2, 3: 2, 4: 2, 6: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.482560157775879  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.482560157775879  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.654982089996338  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6549830436706543  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4825830459594727  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 7 input nodes size: 298
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.482560634613037  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.482560634613037  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.484151840209961  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4841523170471191  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4794597625732422  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 7, 3: 4, 1: 4, 4: 3})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.479468822479248  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.479468822479248  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.5545997619628906  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.554600715637207  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4794812202453613  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4794812202453613  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.114243984222412  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06870436668395996 |0.0006798803806304932 |0.07556790113449097 |8.90195369720459e-05 |0.17301350831985474 |0.0016617774963378906 |
----------------------------------------------------------pseudo_mini_loss sum 5.357155799865723
Total (block generation + training)time/epoch 2.8050651733691874
Training time/epoch 2.650054693222046
Training time without block to device /epoch 2.644615650177002
Training time without total dataloading part /epoch 1.9910252094268799
load block tensor time/epoch 0.5496349334716797
block to device time/epoch 0.005439043045043945
input features size transfer per epoch 1.1920928955078125e-06
blocks size to device per epoch 6.556510925292969e-07
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  7558
Number of first layer input nodes during this epoch:  4833
Number of first layer output nodes during this epoch:  2062
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1141161918640137  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.191 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.191 GB
Metis partitioning: 0.001 seconds, peak memory: 16.191 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.004 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009153127670288086
pure dgl.metis_partition the time spent:  0.006403446197509766

block_gen_time in "generate_blocks_for_one_layer_block"  0.014116525650024414


block_gen_time in "generate_blocks_for_one_layer_block"  0.015755414962768555


block_gen_time in "generate_blocks_for_one_layer_block"  0.026304006576538086

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1141161918640137  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

connection checking time:  0.02308058738708496
block generation total time  0.056175947189331055
average batch blocks generation time:  0.007021993398666382
block dataloader generation time/epoch 0.1296737023762294
pseudo mini batch 0 input nodes size: 807
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.114105224609375  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.114105224609375  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1187973022460938  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.118797779083252  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.11720609664917  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 6: 2, 2: 2, 4: 2, 10: 2, 5: 2, 12: 1, 9: 1, 21: 1, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.117227554321289  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.117227554321289  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.3776779174804688  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.3776793479919434  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.482485294342041  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 1 input nodes size: 562
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4824566841125488  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4824566841125488  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.485456943511963  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.485457420349121  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4807648658752441  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({5: 3, 3: 3, 4: 3, 1: 3, 2: 2, 9: 1, 6: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4807796478271484  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4807796478271484  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.63922119140625  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6392221450805664  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4808006286621094  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 2 input nodes size: 520
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4807820320129395  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4807820320129395  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.483558177947998  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4835586547851562  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.480557918548584  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 8: 3, 1: 3, 4: 2, 6: 2, 5: 2, 30: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.480574607849121  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.480574607849121  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6687979698181152  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6687989234924316  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4805974960327148  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 3 input nodes size: 630
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4805774688720703  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4805774688720703  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4839410781860352  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4839415550231934  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4811649322509766  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 4: 4, 1: 2, 2: 2, 19: 1, 5: 1, 30: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4811806678771973  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4811806678771973  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.664557933807373  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6645588874816895  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4812026023864746  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 4 input nodes size: 659
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4811820983886719  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4811820983886719  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4847002029418945  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4847006797790527  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4813365936279297  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 5, 2: 4, 3: 3, 7: 2, 1: 2, 5: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4813523292541504  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4813523292541504  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6451659202575684  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6451668739318848  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4813742637634277  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 5 input nodes size: 502
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.481353759765625  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.481353759765625  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4840340614318848  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.484034538269043  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.480515956878662  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 7, 4: 3, 3: 2, 6: 2, 5: 2, 7: 1, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4805288314819336  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4805288314819336  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6183724403381348  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6183733940124512  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.480545997619629  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 6 input nodes size: 447
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.48052978515625  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.48052978515625  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4831504821777344  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4831509590148926  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4804701805114746  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 4, 1: 4, 5: 4, 3: 2, 7: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4804821014404297  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4804821014404297  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.5933914184570312  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.5933923721313477  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4804983139038086  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 7 input nodes size: 552
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4804840087890625  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4804840087890625  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4834308624267578  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.483431339263916  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4808101654052734  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 4, 2: 4, 4: 3, 3: 2, 6: 2, 9: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.480823040008545  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.480823040008545  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6144070625305176  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.614408016204834  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4808402061462402  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4808402061462402  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.115602970123291  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0689464807510376 |0.0006744563579559326 |0.07380574941635132 |9.79006290435791e-05 |0.16715428233146667 |0.0035517215728759766 |
----------------------------------------------------------pseudo_mini_loss sum 4.292171478271484
Total (block generation + training)time/epoch 2.7991359744753157
Training time/epoch 2.595127582550049
Training time without block to device /epoch 2.5897319316864014
Training time without total dataloading part /epoch 1.9320151805877686
load block tensor time/epoch 0.5515718460083008
block to device time/epoch 0.005395650863647461
input features size transfer per epoch 1.1920928955078125e-06
blocks size to device per epoch 6.556510925292969e-07
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  7349
Number of first layer input nodes during this epoch:  4679
Number of first layer output nodes during this epoch:  2005
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1154804229736328  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.191 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.191 GB
Metis partitioning: 0.001 seconds, peak memory: 16.191 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.005 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009440898895263672
pure dgl.metis_partition the time spent:  0.00732874870300293

block_gen_time in "generate_blocks_for_one_layer_block"  0.013993024826049805


block_gen_time in "generate_blocks_for_one_layer_block"  0.01574230194091797


block_gen_time in "generate_blocks_for_one_layer_block"  0.023286819458007812

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1154804229736328  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

connection checking time:  0.023041248321533203
block generation total time  0.053022146224975586
average batch blocks generation time:  0.006627768278121948
block dataloader generation time/epoch 0.12865378061930338
pseudo mini batch 0 input nodes size: 489
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1154637336730957  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1154637336730957  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1180744171142578  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.118074893951416  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1151275634765625  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 4: 3, 8: 3, 6: 2, 5: 2, 30: 1, 2: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1151432991027832  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.1151432991027832  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.2914433479309082  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.2914447784423828  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4810667037963867  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 1 input nodes size: 391
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.481048583984375  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.481048583984375  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4831361770629883  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4831366539001465  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4805254936218262  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 4, 1: 3, 6: 3, 3: 3, 4: 2, 7: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4805364608764648  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4805364608764648  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.5901799201965332  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.5901808738708496  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4805517196655273  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 2 input nodes size: 747
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.480539321899414  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.480539321899414  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4845271110534668  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.484527587890625  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4824395179748535  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 5, 2: 5, 1: 2, 4: 2, 10: 1, 30: 1, 6: 1, 19: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4824581146240234  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4824581146240234  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6855454444885254  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6855463981628418  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4824838638305664  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 3 input nodes size: 547
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.482459545135498  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.482459545135498  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.485379695892334  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4853801727294922  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4813919067382812  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 5, 3: 4, 4: 3, 2: 3, 9: 1, 5: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4814047813415527  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4814047813415527  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6109495162963867  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.6109504699707031  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.481421947479248  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 4 input nodes size: 813
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4814057350158691  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.4814057350158691  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.486097812652588  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.486098289489746  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.483177661895752  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 4: 3, 2: 2, 1: 2, 5: 2, 6: 2, 21: 1, 9: 1, 12: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.483199119567871  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.70849609375 GB
    Memory Allocated: 1.483199119567871  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.7306370735168457  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.730638027191162  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4832286834716797  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 5 input nodes size: 821
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4832005500793457  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4832005500793457  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4875836372375488  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.487584114074707  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.48289155960083  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 3, 3: 3, 4: 3, 7: 2, 5: 2, 1: 1, 10: 1, 9: 1, 6: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4829111099243164  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4829111099243164  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.7073636054992676  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.707364559173584  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4829378128051758  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 6 input nodes size: 362
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4829115867614746  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4829115867614746  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4848442077636719  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.48484468460083  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4804611206054688  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 4, 5: 4, 4: 3, 2: 2, 6: 2, 3: 2})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.480471134185791  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.480471134185791  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.577378749847412  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.5773797035217285  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4804844856262207  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 7 input nodes size: 706
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4804720878601074  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4804720878601074  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4848551750183105  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4848556518554688  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4829225540161133  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 5, 4: 3, 1: 3, 5: 3, 3: 2, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4829373359680176  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4829373359680176  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.646777629852295  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.6467785835266113  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.482957363128662  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.482957363128662  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.1170430183410645  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06957495212554932 |0.0006790757179260254 |0.07374626398086548 |8.90493392944336e-05 |0.16565516591072083 |0.003395557403564453 |
----------------------------------------------------------pseudo_mini_loss sum 3.7494349479675293
Total (block generation + training)time/epoch 2.7926220734914144
Training time/epoch 2.5869545936584473
Training time without block to device /epoch 2.581521987915039
Training time without total dataloading part /epoch 1.9193193912506104
load block tensor time/epoch 0.5565996170043945
block to device time/epoch 0.005432605743408203
input features size transfer per epoch 1.1920928955078125e-06
blocks size to device per epoch 6.556510925292969e-07
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  7578
Number of first layer input nodes during this epoch:  4876
Number of first layer output nodes during this epoch:  2045
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.1169214248657227  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.191 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.191 GB
Metis partitioning: 0.001 seconds, peak memory: 16.191 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.004 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009033203125
pure dgl.metis_partition the time spent:  0.006539106369018555

block_gen_time in "generate_blocks_for_one_layer_block"  0.013861417770385742


block_gen_time in "generate_blocks_for_one_layer_block"  0.015674591064453125


block_gen_time in "generate_blocks_for_one_layer_block"  0.023195743560791016

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.1169214248657227  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

connection checking time:  0.02284550666809082
block generation total time  0.05273175239562988
average batch blocks generation time:  0.006591469049453735
block dataloader generation time/epoch 0.1275666058063507
pseudo mini batch 0 input nodes size: 773
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.1169004440307617  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.1169004440307617  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.1211156845092773  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.1211161613464355  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.1167325973510742  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 2: 3, 4: 3, 10: 2, 6: 2, 1: 1, 5: 1, 9: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.1167521476745605  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.1167521476745605  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.3393573760986328  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.3393588066101074  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4820027351379395  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 1 input nodes size: 665
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4819765090942383  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4819765090942383  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4863595962524414  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4863600730895996  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4821443557739258  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 3, 5: 3, 1: 3, 3: 2, 7: 2, 4: 2, 6: 1, 11: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4821600914001465  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4821600914001465  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.6583714485168457  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.658372402191162  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4821820259094238  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 2 input nodes size: 844
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.482161521911621  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.482161521911621  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4868535995483398  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.486854076385498  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4824705123901367  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 5, 1: 3, 4: 2, 12: 1, 2: 1, 6: 1, 5: 1, 30: 1, 10: 1, 19: 1, 21: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.482494831085205  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.482494831085205  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.7514104843139648  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.7514114379882812  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.482527256011963  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 3 input nodes size: 653
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.482496738433838  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.482496738433838  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.485982894897461  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4859833717346191  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4812908172607422  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 2: 4, 4: 3, 5: 2, 7: 1, 6: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.481306552886963  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.481306552886963  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.6469078063964844  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.6469087600708008  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4813284873962402  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 4 input nodes size: 491
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4813079833984375  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4813079833984375  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.48392915725708  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4839296340942383  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.480443000793457  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 5, 8: 3, 1: 2, 5: 2, 4: 2, 6: 2, 30: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4804587364196777  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4804587364196777  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.6592578887939453  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.6592588424682617  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.480480670928955  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 5 input nodes size: 626
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4804625511169434  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4804625511169434  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.483804702758789  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4838051795959473  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4811835289001465  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 4, 1: 4, 2: 3, 5: 2, 3: 2, 6: 2, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4811973571777344  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4811973571777344  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.6281342506408691  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.6281352043151855  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.481215476989746  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 6 input nodes size: 292
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4811973571777344  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4811973571777344  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4827566146850586  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4827570915222168  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.479414463043213  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 8, 5: 3, 6: 2, 1: 2, 4: 2})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4794235229492188  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4794235229492188  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.5580224990844727  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.558023452758789  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4794349670410156  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 7 input nodes size: 464
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4794249534606934  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4794249534606934  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.482557773590088  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.482558250427246  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4809985160827637  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 5, 3: 4, 4: 4, 2: 3, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4810094833374023  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4810094833374023  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.5863680839538574  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.5863690376281738  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4810247421264648  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4810247421264648  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.1157875061035156  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06882429122924805 |0.0006836354732513428 |0.07405200600624084 |9.068846702575684e-05 |0.1672954559326172 |0.0035572052001953125 |
----------------------------------------------------------pseudo_mini_loss sum 3.258436679840088
Total (block generation + training)time/epoch 2.787600561976433
Training time/epoch 2.6009228229522705
Training time without block to device /epoch 2.5954537391662598
Training time without total dataloading part /epoch 1.9350624084472656
load block tensor time/epoch 0.5505943298339844
block to device time/epoch 0.005469083786010742
input features size transfer per epoch 1.1920928955078125e-06
blocks size to device per epoch 6.556510925292969e-07
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  7507
Number of first layer input nodes during this epoch:  4808
Number of first layer output nodes during this epoch:  2045
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.1156625747680664  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.191 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.191 GB
Metis partitioning: 0.001 seconds, peak memory: 16.191 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.004 seconds
REG metis partition end ----................................
REG construction  time spent:  0.008469820022583008
pure dgl.metis_partition the time spent:  0.006112813949584961

block_gen_time in "generate_blocks_for_one_layer_block"  0.013890266418457031


block_gen_time in "generate_blocks_for_one_layer_block"  0.01599574089050293


block_gen_time in "generate_blocks_for_one_layer_block"  0.0238649845123291

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.1156625747680664  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

connection checking time:  0.02327728271484375
block generation total time  0.05375099182128906
average batch blocks generation time:  0.006718873977661133
block dataloader generation time/epoch 0.1267381415647619
pseudo mini batch 0 input nodes size: 699
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.115649700164795  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.115649700164795  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.1193814277648926  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.1193819046020508  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.116248607635498  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({5: 5, 1: 4, 4: 2, 2: 2, 9: 1, 11: 1, 21: 1, 3: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.1162681579589844  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.1162681579589844  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.3427314758300781  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.3427329063415527  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4824414253234863  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 1 input nodes size: 719
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.482417106628418  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.482417106628418  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4871091842651367  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.487109661102295  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.483377456665039  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 7, 6: 3, 2: 2, 4: 2, 12: 1, 5: 1, 1: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4833950996398926  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4833950996398926  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.6795778274536133  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.6795787811279297  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4834189414978027  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 2 input nodes size: 697
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4833946228027344  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4833946228027344  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4871158599853516  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4871163368225098  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4824237823486328  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 5, 2: 3, 1: 2, 4: 2, 30: 1, 19: 1, 9: 1, 12: 1, 5: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4824414253234863  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4824414253234863  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.682558536529541  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.6825594902038574  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.482466220855713  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 3 input nodes size: 500
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4824438095092773  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4824438095092773  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4851131439208984  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4851136207580566  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4813919067382812  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 5, 3: 4, 4: 3, 1: 3, 5: 2, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4814038276672363  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4814038276672363  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.600275993347168  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.6002769470214844  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4814200401306152  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 4 input nodes size: 567
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4814057350158691  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4814057350158691  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4844326972961426  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4844331741333008  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4817633628845215  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({5: 4, 8: 3, 4: 3, 3: 3, 6: 2, 9: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.481781005859375  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.481781005859375  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.6845183372497559  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.6845192909240723  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4818058013916016  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 5 input nodes size: 538
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.481783390045166  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.481783390045166  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4846558570861816  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4846563339233398  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4816288948059082  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 5, 4: 3, 1: 3, 5: 2, 3: 2, 6: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4816408157348633  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4816408157348633  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.6028809547424316  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.602881908416748  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4816570281982422  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 6 input nodes size: 578
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.481642723083496  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.481642723083496  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4847283363342285  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4847288131713867  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.481855869293213  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 5, 4: 3, 1: 3, 7: 2, 3: 2, 6: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4818706512451172  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4818706512451172  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.6366395950317383  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.6366405487060547  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4818906784057617  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 7 input nodes size: 563
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.48187255859375  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.48187255859375  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4848780632019043  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4848785400390625  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4817924499511719  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 4, 1: 4, 2: 3, 3: 2, 6: 2, 9: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4818062782287598  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4818062782287598  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.6243977546691895  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.6243987083435059  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4818243980407715  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4818243980407715  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.1156659126281738  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06980830430984497 |0.0006887316703796387 |0.07709506154060364 |9.045004844665527e-05 |0.18094995617866516 |0.0038635730743408203 |
----------------------------------------------------------pseudo_mini_loss sum 2.7244412899017334
Total (block generation + training)time/epoch 2.7914710605845734
Training time/epoch 2.7398102283477783
Training time without block to device /epoch 2.734300374984741
Training time without total dataloading part /epoch 2.0689473152160645
load block tensor time/epoch 0.5584664344787598
block to device time/epoch 0.005509853363037109
input features size transfer per epoch 1.1920928955078125e-06
blocks size to device per epoch 6.556510925292969e-07
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  7595
Number of first layer input nodes during this epoch:  4861
Number of first layer output nodes during this epoch:  2066
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.1155409812927246  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.191 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.191 GB
Metis partitioning: 0.001 seconds, peak memory: 16.191 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.004 seconds
REG metis partition end ----................................
REG construction  time spent:  0.008645772933959961
pure dgl.metis_partition the time spent:  0.006256580352783203

block_gen_time in "generate_blocks_for_one_layer_block"  0.013930082321166992


block_gen_time in "generate_blocks_for_one_layer_block"  0.015618324279785156


block_gen_time in "generate_blocks_for_one_layer_block"  0.023451566696166992

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.1155409812927246  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

connection checking time:  0.02308201789855957
block generation total time  0.05299997329711914
average batch blocks generation time:  0.006624996662139893
block dataloader generation time/epoch 0.1260820362302992
pseudo mini batch 0 input nodes size: 848
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.1155223846435547  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.1155223846435547  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.1200494766235352  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.1200499534606934  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.1170439720153809  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 4: 3, 6: 2, 2: 2, 10: 1, 9: 1, 5: 1, 1: 1, 12: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.1170644760131836  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.1170644760131836  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.354182243347168  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.3541836738586426  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.482316493988037  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 1 input nodes size: 829
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4822883605957031  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4822883605957031  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4869804382324219  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.48698091506958  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4824533462524414  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 4, 5: 4, 2: 3, 3: 3, 7: 2, 9: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4824728965759277  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4824728965759277  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.7116637229919434  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.7116646766662598  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.482499599456787  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 2 input nodes size: 721
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.482473373413086  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.482473373413086  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4863224029541016  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4863228797912598  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4816303253173828  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 5, 1: 4, 6: 1, 5: 1, 2: 1, 10: 1, 4: 1, 21: 1, 19: 1, 30: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4816508293151855  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71240234375 GB
    Memory Allocated: 1.4816508293151855  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.7293663024902344  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.7293672561645508  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.4816794395446777  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 3 input nodes size: 495
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.4816532135009766  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.4816532135009766  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.4842958450317383  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.4842963218688965  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.4804468154907227  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 6, 2: 4, 6: 2, 5: 2, 9: 1, 10: 1, 3: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.4804596900939941  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.4804596900939941  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.607506275177002  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.6075072288513184  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.4804768562316895  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 4 input nodes size: 482
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.4804606437683105  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.4804606437683105  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.4830341339111328  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.483034610748291  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.480391502380371  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 8: 3, 4: 2, 5: 2, 6: 2, 2: 1, 9: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.4804072380065918  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.4804072380065918  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.6597237586975098  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.6597247123718262  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.4804291725158691  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 5 input nodes size: 489
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.4804110527038574  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.4804110527038574  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.4830217361450195  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.4830222129821777  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.4804482460021973  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 5, 1: 4, 4: 4, 2: 3, 7: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.4804601669311523  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.4804601669311523  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.598505973815918  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.5985069274902344  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.4804763793945312  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 6 input nodes size: 470
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.4804620742797852  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.4804620742797852  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.48297119140625  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.4829716682434082  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.480360507965088  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 5, 4: 4, 5: 3, 1: 2, 6: 2, 3: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.4803714752197266  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.4803714752197266  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.5870442390441895  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.5870451927185059  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.4803857803344727  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

pseudo mini batch 7 input nodes size: 409
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.4803714752197266  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.4803714752197266  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.4825549125671387  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.4825553894042969  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.4800457954406738  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 6, 4: 4, 1: 3, 5: 2, 3: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.4800567626953125  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.4800567626953125  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.585172176361084  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.5851731300354004  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.480072021484375  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.480072021484375  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.71826171875 GB
    Memory Allocated: 1.1148347854614258  GigaBytes
Max Memory Allocated: 2.0216221809387207  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0680273175239563 |0.0006812810897827148 |0.07374805212020874 |9.369850158691406e-05 |0.1660485565662384 |0.0032050609588623047 |
----------------------------------------------------------pseudo_mini_loss sum 2.546203136444092
Total (block generation + training)time/epoch 2.786143528090583
Training time/epoch 2.580537796020508
Training time without block to device /epoch 2.575087547302246
Training time without total dataloading part /epoch 1.9223275184631348
load block tensor time/epoch 0.5442185401916504
block to device time/epoch 0.005450248718261719
input features size transfer per epoch 1.1920928955078125e-06
blocks size to device per epoch 6.556510925292969e-07
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  7446
Number of first layer input nodes during this epoch:  4743
Number of first layer output nodes during this epoch:  2044
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(1433, 1433, batch_first=True)
      (fc_self): Linear(in_features=1433, out_features=2048, bias=False)
      (fc_neigh): Linear(in_features=1433, out_features=2048, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(2048, 2048, batch_first=True)
      (fc_self): Linear(in_features=2048, out_features=2048, bias=False)
      (fc_neigh): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (2): SAGEConv(
      (lstm): LSTM(2048, 2048, batch_first=True)
      (fc_self): Linear(in_features=2048, out_features=7, bias=False)
      (fc_neigh): Linear(in_features=2048, out_features=7, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  97867856
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([5732, 1433])
layers.0.lstm.weight_hh_l0, torch.Size([5732, 1433])
layers.0.lstm.bias_ih_l0, torch.Size([5732])
layers.0.lstm.bias_hh_l0, torch.Size([5732])
layers.0.fc_self.weight, torch.Size([2048, 1433])
layers.0.fc_neigh.weight, torch.Size([2048, 1433])
layers.1.lstm.weight_ih_l0, torch.Size([8192, 2048])
layers.1.lstm.weight_hh_l0, torch.Size([8192, 2048])
layers.1.lstm.bias_ih_l0, torch.Size([8192])
layers.1.lstm.bias_hh_l0, torch.Size([8192])
layers.1.fc_self.weight, torch.Size([2048, 2048])
layers.1.fc_neigh.weight, torch.Size([2048, 2048])
layers.2.lstm.weight_ih_l0, torch.Size([8192, 2048])
layers.2.lstm.weight_hh_l0, torch.Size([8192, 2048])
layers.2.lstm.bias_ih_l0, torch.Size([8192])
layers.2.lstm.bias_hh_l0, torch.Size([8192])
layers.2.fc_self.weight, torch.Size([7, 2048])
layers.2.fc_neigh.weight, torch.Size([7, 2048])
----------------------------------------
un-trainable parameters
