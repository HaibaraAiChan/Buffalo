main start at this time 1733091843.3469074
-----------------------------------------before load data 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

----------------------------------------start of run function 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  1433
----------------------------------------before model to device 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 0.88623046875 GB
    Memory Allocated: 0.3674592971801758  GigaBytes
Max Memory Allocated: 0.3674592971801758  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 0.88818359375 GB
    Memory Allocated: 0.3674592971801758  GigaBytes
Max Memory Allocated: 0.3674592971801758  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 13.818 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 13.818 GB
Metis partitioning: 0.000 seconds, peak memory: 13.818 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.018263578414916992
pure dgl.metis_partition the time spent:  0.003949642181396484
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.00629115104675293

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.008087158203125

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.013878822326660156

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 0.88818359375 GB
    Memory Allocated: 0.3674592971801758  GigaBytes
Max Memory Allocated: 0.3674592971801758  GigaBytes

connection checking time:  0.012288570404052734
block generation total time  0.028257131576538086
average batch blocks generation time:  0.00941904385884603
pseudo mini batch 0 input nodes size: 975
----------------------------------------before load block subtensor 
 Nvidia-smi: 0.88818359375 GB
    Memory Allocated: 0.3674592971801758  GigaBytes
Max Memory Allocated: 0.3674592971801758  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 0.88818359375 GB
    Memory Allocated: 0.3674592971801758  GigaBytes
Max Memory Allocated: 0.3674592971801758  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 0.90771484375 GB
    Memory Allocated: 0.3726644515991211  GigaBytes
Max Memory Allocated: 0.3726644515991211  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 0.90771484375 GB
    Memory Allocated: 0.3726649284362793  GigaBytes
Max Memory Allocated: 0.3726649284362793  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 0.90771484375 GB
    Memory Allocated: 0.3726649284362793  GigaBytes
Max Memory Allocated: 0.3726649284362793  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 12, 4: 7, 2: 7, 6: 6, 5: 5, 8: 3, 1: 2, 10: 1, 7: 1, 30: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 0.90771484375 GB
    Memory Allocated: 0.3726949691772461  GigaBytes
Max Memory Allocated: 0.3726949691772461  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 0.90771484375 GB
    Memory Allocated: 0.3726949691772461  GigaBytes
Max Memory Allocated: 0.3726949691772461  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.31982421875 GB
    Memory Allocated: 0.745905876159668  GigaBytes
Max Memory Allocated: 0.7483053207397461  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.31982421875 GB
    Memory Allocated: 0.745908260345459  GigaBytes
Max Memory Allocated: 0.7483053207397461  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.76513671875 GB
    Memory Allocated: 0.7531952857971191  GigaBytes
Max Memory Allocated: 1.1256494522094727  GigaBytes

pseudo mini batch 1 input nodes size: 1392
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.76513671875 GB
    Memory Allocated: 0.7531590461730957  GigaBytes
Max Memory Allocated: 1.1256494522094727  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.76513671875 GB
    Memory Allocated: 0.7531590461730957  GigaBytes
Max Memory Allocated: 1.1256494522094727  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.76513671875 GB
    Memory Allocated: 0.7605900764465332  GigaBytes
Max Memory Allocated: 1.1256494522094727  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.76513671875 GB
    Memory Allocated: 0.7605905532836914  GigaBytes
Max Memory Allocated: 1.1256494522094727  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.76513671875 GB
    Memory Allocated: 0.7553849220275879  GigaBytes
Max Memory Allocated: 1.1256494522094727  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 8, 4: 8, 3: 7, 2: 6, 5: 6, 9: 3, 6: 3, 10: 2, 7: 2, 11: 1, 12: 1, 21: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 1.76513671875 GB
    Memory Allocated: 0.7554254531860352  GigaBytes
Max Memory Allocated: 1.1256494522094727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.76513671875 GB
    Memory Allocated: 0.7554254531860352  GigaBytes
Max Memory Allocated: 1.1256494522094727  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.82958984375 GB
    Memory Allocated: 1.2492289543151855  GigaBytes
Max Memory Allocated: 1.251699447631836  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.82958984375 GB
    Memory Allocated: 1.2492308616638184  GigaBytes
Max Memory Allocated: 1.251699447631836  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.07958984375 GB
    Memory Allocated: 0.7554817199707031  GigaBytes
Max Memory Allocated: 1.4973750114440918  GigaBytes

pseudo mini batch 2 input nodes size: 1088
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.07958984375 GB
    Memory Allocated: 0.755427360534668  GigaBytes
Max Memory Allocated: 1.4973750114440918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.07958984375 GB
    Memory Allocated: 0.755427360534668  GigaBytes
Max Memory Allocated: 1.4973750114440918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.07958984375 GB
    Memory Allocated: 0.7613296508789062  GigaBytes
Max Memory Allocated: 1.4973750114440918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.07958984375 GB
    Memory Allocated: 0.7613301277160645  GigaBytes
Max Memory Allocated: 1.4973750114440918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.07958984375 GB
    Memory Allocated: 0.7538986206054688  GigaBytes
Max Memory Allocated: 1.4973750114440918  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 12, 1: 10, 4: 7, 3: 7, 5: 4, 6: 2, 7: 1, 19: 1, 30: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.07958984375 GB
    Memory Allocated: 0.7539286613464355  GigaBytes
Max Memory Allocated: 1.4973750114440918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.07958984375 GB
    Memory Allocated: 0.7539286613464355  GigaBytes
Max Memory Allocated: 1.4973750114440918  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.07958984375 GB
    Memory Allocated: 1.1046853065490723  GigaBytes
Max Memory Allocated: 1.4973750114440918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.07958984375 GB
    Memory Allocated: 1.104687213897705  GigaBytes
Max Memory Allocated: 1.4973750114440918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.07958984375 GB
    Memory Allocated: 0.7539706230163574  GigaBytes
Max Memory Allocated: 1.4973750114440918  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.71630859375 GB
    Memory Allocated: 1.4844584465026855  GigaBytes
Max Memory Allocated: 1.8504815101623535  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.71630859375 GB
    Memory Allocated: 1.1198716163635254  GigaBytes
Max Memory Allocated: 1.8504815101623535  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05593713124593099 |0.002412001291910807 |0.4483184814453125 |0.004758437474568685 |0.4044477939605713 |0.14011549949645996 |
----------------------------------------------------------pseudo_mini_loss sum 1.9502735137939453
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5896
Number of first layer input nodes during this epoch:  3455
Number of first layer output nodes during this epoch:  1795
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.71630859375 GB
    Memory Allocated: 1.1197929382324219  GigaBytes
Max Memory Allocated: 1.8504815101623535  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.215 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.215 GB
Metis partitioning: 0.000 seconds, peak memory: 16.215 GB
Split the graph: 0.002 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.011146783828735352
pure dgl.metis_partition the time spent:  0.004362821578979492
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.005979061126708984

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.008699655532836914

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.014435529708862305

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.71630859375 GB
    Memory Allocated: 1.1197929382324219  GigaBytes
Max Memory Allocated: 1.8504815101623535  GigaBytes

connection checking time:  0.013128995895385742
block generation total time  0.029114246368408203
average batch blocks generation time:  0.0097047487894694
pseudo mini batch 0 input nodes size: 1081
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.71630859375 GB
    Memory Allocated: 1.1197538375854492  GigaBytes
Max Memory Allocated: 1.8504815101623535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.71630859375 GB
    Memory Allocated: 1.1197538375854492  GigaBytes
Max Memory Allocated: 1.8504815101623535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.71630859375 GB
    Memory Allocated: 1.1255249977111816  GigaBytes
Max Memory Allocated: 1.8504815101623535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.71630859375 GB
    Memory Allocated: 1.1255254745483398  GigaBytes
Max Memory Allocated: 1.8504815101623535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.71630859375 GB
    Memory Allocated: 1.1196227073669434  GigaBytes
Max Memory Allocated: 1.8504815101623535  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 8, 1: 8, 3: 7, 4: 6, 6: 5, 5: 5, 7: 2, 8: 2, 30: 1, 9: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.71630859375 GB
    Memory Allocated: 1.119654655456543  GigaBytes
Max Memory Allocated: 1.8504815101623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71630859375 GB
    Memory Allocated: 1.119654655456543  GigaBytes
Max Memory Allocated: 1.8504815101623535  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71630859375 GB
    Memory Allocated: 1.5109524726867676  GigaBytes
Max Memory Allocated: 1.8504815101623535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.71630859375 GB
    Memory Allocated: 1.5109548568725586  GigaBytes
Max Memory Allocated: 1.8504815101623535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.71630859375 GB
    Memory Allocated: 1.4842538833618164  GigaBytes
Max Memory Allocated: 1.8843064308166504  GigaBytes

pseudo mini batch 1 input nodes size: 1344
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.71630859375 GB
    Memory Allocated: 1.4842133522033691  GigaBytes
Max Memory Allocated: 1.8843064308166504  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.71630859375 GB
    Memory Allocated: 1.4842133522033691  GigaBytes
Max Memory Allocated: 1.8843064308166504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.71630859375 GB
    Memory Allocated: 1.4913883209228516  GigaBytes
Max Memory Allocated: 1.8843064308166504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.71630859375 GB
    Memory Allocated: 1.4913887977600098  GigaBytes
Max Memory Allocated: 1.8843064308166504  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.71630859375 GB
    Memory Allocated: 1.4856171607971191  GigaBytes
Max Memory Allocated: 1.8843064308166504  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({5: 7, 4: 7, 3: 7, 2: 6, 6: 5, 1: 5, 9: 2, 12: 2, 10: 2, 7: 2, 11: 1, 21: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.71630859375 GB
    Memory Allocated: 1.48565673828125  GigaBytes
Max Memory Allocated: 1.8843064308166504  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71630859375 GB
    Memory Allocated: 1.48565673828125  GigaBytes
Max Memory Allocated: 1.8843064308166504  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.71630859375 GB
    Memory Allocated: 1.9784936904907227  GigaBytes
Max Memory Allocated: 1.9810481071472168  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.71630859375 GB
    Memory Allocated: 1.9784955978393555  GigaBytes
Max Memory Allocated: 1.9810481071472168  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4857120513916016  GigaBytes
Max Memory Allocated: 2.226609230041504  GigaBytes

pseudo mini batch 2 input nodes size: 1123
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4856595993041992  GigaBytes
Max Memory Allocated: 2.226609230041504  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4856595993041992  GigaBytes
Max Memory Allocated: 2.226609230041504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.491654872894287  GigaBytes
Max Memory Allocated: 2.226609230041504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4916553497314453  GigaBytes
Max Memory Allocated: 2.226609230041504  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4844799041748047  GigaBytes
Max Memory Allocated: 2.226609230041504  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 12, 2: 11, 4: 9, 1: 7, 5: 3, 9: 1, 30: 1, 6: 1, 19: 1, 8: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4845099449157715  GigaBytes
Max Memory Allocated: 2.226609230041504  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4845099449157715  GigaBytes
Max Memory Allocated: 2.226609230041504  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.8423638343811035  GigaBytes
Max Memory Allocated: 2.226609230041504  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.8423657417297363  GigaBytes
Max Memory Allocated: 2.226609230041504  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4845519065856934  GigaBytes
Max Memory Allocated: 2.226609230041504  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4845519065856934  GigaBytes
Max Memory Allocated: 2.226609230041504  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.1199650764465332  GigaBytes
Max Memory Allocated: 2.226609230041504  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.056653738021850586 |0.0007370313008626302 |0.11637202898661296 |9.886423746744792e-05 |0.3195890585581462 |0.0025336742401123047 |
----------------------------------------------------------pseudo_mini_loss sum 60.73321533203125
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  6038
Number of first layer input nodes during this epoch:  3548
Number of first layer output nodes during this epoch:  1840
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.1198859214782715  GigaBytes
Max Memory Allocated: 2.226609230041504  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.377 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.377 GB
Metis partitioning: 0.000 seconds, peak memory: 16.377 GB
Split the graph: 0.002 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.011519670486450195
pure dgl.metis_partition the time spent:  0.004632711410522461
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.0060040950775146484

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.008257389068603516

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.014061927795410156

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.1198859214782715  GigaBytes
Max Memory Allocated: 2.226609230041504  GigaBytes

connection checking time:  0.012698650360107422
block generation total time  0.02832341194152832
average batch blocks generation time:  0.009441137313842773
block dataloader generation time/epoch 0.07168841361999512
pseudo mini batch 0 input nodes size: 803
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.1198468208312988  GigaBytes
Max Memory Allocated: 2.226609230041504  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.1198468208312988  GigaBytes
Max Memory Allocated: 2.226609230041504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.124133586883545  GigaBytes
Max Memory Allocated: 2.226609230041504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.1241340637207031  GigaBytes
Max Memory Allocated: 2.226609230041504  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.118138313293457  GigaBytes
Max Memory Allocated: 2.226609230041504  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 10, 4: 9, 1: 7, 5: 5, 3: 5, 6: 4, 8: 3, 30: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.1181635856628418  GigaBytes
Max Memory Allocated: 2.226609230041504  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.1181635856628418  GigaBytes
Max Memory Allocated: 2.226609230041504  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.410013198852539  GigaBytes
Max Memory Allocated: 2.226609230041504  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.41001558303833  GigaBytes
Max Memory Allocated: 2.226609230041504  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4827532768249512  GigaBytes
Max Memory Allocated: 2.226609230041504  GigaBytes

pseudo mini batch 1 input nodes size: 1363
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4827227592468262  GigaBytes
Max Memory Allocated: 2.226609230041504  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4827227592468262  GigaBytes
Max Memory Allocated: 2.226609230041504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4901461601257324  GigaBytes
Max Memory Allocated: 2.226609230041504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4901466369628906  GigaBytes
Max Memory Allocated: 2.226609230041504  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4858593940734863  GigaBytes
Max Memory Allocated: 2.226609230041504  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 11, 2: 8, 4: 7, 5: 6, 1: 4, 6: 4, 9: 2, 10: 2, 21: 1, 12: 1, 7: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4858999252319336  GigaBytes
Max Memory Allocated: 2.226609230041504  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4858999252319336  GigaBytes
Max Memory Allocated: 2.226609230041504  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.979341983795166  GigaBytes
Max Memory Allocated: 2.226609230041504  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.9793438911437988  GigaBytes
Max Memory Allocated: 2.226609230041504  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4859561920166016  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

pseudo mini batch 2 input nodes size: 1289
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4859018325805664  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4859018325805664  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4927830696105957  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.492783546447754  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4853596687316895  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 10, 1: 9, 2: 7, 4: 6, 5: 4, 7: 3, 6: 3, 12: 1, 10: 1, 30: 1, 19: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4853954315185547  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4853954315185547  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.9258618354797363  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.9258637428283691  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4854459762573242  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4854459762573242  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.120859146118164  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.055283705393473305 |0.0007606347401936849 |0.11348843574523926 |0.00010315577189127605 |0.3124292691548665 |0.003660440444946289 |
----------------------------------------------------------pseudo_mini_loss sum 93.77014923095703
Total (block generation + training)time/epoch 1.6247317790985107
Training time/epoch 1.5528385639190674
Training time without block to device /epoch 1.5505566596984863
Training time without total dataloading part /epoch 1.2817230224609375
load block tensor time/epoch 0.16585111618041992
block to device time/epoch 0.0022819042205810547
input features size transfer per epoch 4.470348358154297e-07
blocks size to device per epoch 2.4586915969848633e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  5915
Number of first layer input nodes during this epoch:  3455
Number of first layer output nodes during this epoch:  1813
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.120786190032959  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.377 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.377 GB
Metis partitioning: 0.000 seconds, peak memory: 16.377 GB
Split the graph: 0.002 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009681940078735352
pure dgl.metis_partition the time spent:  0.004090070724487305
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.005995035171508789

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.008381843566894531

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.013818740844726562

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.120786190032959  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

connection checking time:  0.012877702713012695
block generation total time  0.028195619583129883
average batch blocks generation time:  0.009398539861043295
block dataloader generation time/epoch 0.06980383396148682
pseudo mini batch 0 input nodes size: 946
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.1207389831542969  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.1207389831542969  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.1257891654968262  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.1257896423339844  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.1189079284667969  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 9, 2: 8, 4: 7, 5: 6, 6: 6, 1: 4, 8: 3, 9: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.1189370155334473  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.1189370155334473  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4608550071716309  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4608573913574219  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.483525276184082  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

pseudo mini batch 1 input nodes size: 1312
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4834890365600586  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4834890365600586  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4904932975769043  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4904937744140625  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.485443115234375  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 9, 2: 8, 1: 6, 4: 6, 5: 4, 6: 4, 9: 3, 12: 2, 10: 2, 7: 1, 21: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.485480785369873  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.485480785369873  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.9466981887817383  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.946700096130371  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4855332374572754  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

pseudo mini batch 2 input nodes size: 1333
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4854826927185059  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4854826927185059  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.492906093597412  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4929065704345703  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4859018325805664  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 10, 4: 9, 2: 9, 3: 8, 5: 5, 7: 3, 19: 1, 6: 1, 30: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.485938549041748  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.485938549041748  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.9222602844238281  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.922262191772461  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.485990047454834  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.485990047454834  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.1214032173156738  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05567161242167155 |0.0007462501525878906 |0.11185383796691895 |0.00010315577189127605 |0.3033946355183919 |0.0024957656860351562 |
----------------------------------------------------------pseudo_mini_loss sum 170.3882293701172
Total (block generation + training)time/epoch 1.6053614616394043
Training time/epoch 1.5179638862609863
Training time without block to device /epoch 1.5157251358032227
Training time without total dataloading part /epoch 1.2485506534576416
load block tensor time/epoch 0.16701483726501465
block to device time/epoch 0.002238750457763672
input features size transfer per epoch 4.470348358154297e-07
blocks size to device per epoch 2.4586915969848633e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  6078
Number of first layer input nodes during this epoch:  3591
Number of first layer output nodes during this epoch:  1838
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.1213302612304688  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.377 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.377 GB
Metis partitioning: 0.000 seconds, peak memory: 16.377 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.00925302505493164
pure dgl.metis_partition the time spent:  0.004279613494873047
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.005972146987915039

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.008431196212768555

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.013632535934448242

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.1213302612304688  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

connection checking time:  0.012709856033325195
block generation total time  0.028035879135131836
average batch blocks generation time:  0.009345293045043945
block dataloader generation time/epoch 0.06920599937438965
pseudo mini batch 0 input nodes size: 1071
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.1212811470031738  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.1212811470031738  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.1269989013671875  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.1269993782043457  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.1195755004882812  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 12, 2: 10, 1: 10, 4: 5, 5: 4, 19: 1, 6: 1, 30: 1, 12: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.119605541229248  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.119605541229248  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4792084693908691  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4792108535766602  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4841957092285156  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

pseudo mini batch 1 input nodes size: 1019
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4841570854187012  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4841570854187012  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4895973205566406  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4895977973937988  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.483879566192627  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 10, 2: 8, 1: 7, 5: 6, 3: 5, 6: 5, 8: 3, 30: 1, 9: 1, 10: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4839105606079102  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4839105606079102  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.8575310707092285  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.8575329780578613  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4839544296264648  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

pseudo mini batch 2 input nodes size: 1346
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4839158058166504  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4839158058166504  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4911012649536133  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4911017417907715  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4856610298156738  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 9, 4: 7, 2: 7, 6: 5, 5: 5, 1: 3, 9: 3, 10: 2, 7: 2, 21: 1, 11: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4857006072998047  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4857006072998047  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.974353313446045  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.9743552207946777  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4857559204101562  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4857559204101562  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.121169090270996  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0547033945719401 |0.0007232824961344401 |0.11614775657653809 |0.00010101000467936198 |0.32045380274454754 |0.0025489330291748047 |
----------------------------------------------------------pseudo_mini_loss sum 159.62448120117188
Total (block generation + training)time/epoch 1.6202311515808105
Training time/epoch 1.5818533897399902
Training time without block to device /epoch 1.579683542251587
Training time without total dataloading part /epoch 1.3126566410064697
load block tensor time/epoch 0.1641101837158203
block to device time/epoch 0.0021698474884033203
input features size transfer per epoch 4.470348358154297e-07
blocks size to device per epoch 2.4586915969848633e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  5885
Number of first layer input nodes during this epoch:  3436
Number of first layer output nodes during this epoch:  1799
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.1210989952087402  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.377 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.377 GB
Metis partitioning: 0.000 seconds, peak memory: 16.377 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009750127792358398
pure dgl.metis_partition the time spent:  0.003827333450317383
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.005974531173706055

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.008188486099243164

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.014014482498168945

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.1210989952087402  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

connection checking time:  0.01310586929321289
block generation total time  0.028177499771118164
average batch blocks generation time:  0.009392499923706055
block dataloader generation time/epoch 0.06884348392486572
pseudo mini batch 0 input nodes size: 1007
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.1210460662841797  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.1210460662841797  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.1264219284057617  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.12642240524292  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.1192364692687988  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 9, 2: 9, 4: 7, 5: 6, 1: 5, 6: 4, 8: 3, 9: 1, 30: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.119267463684082  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.119267463684082  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.48573637008667  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.485738754272461  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4838557243347168  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

pseudo mini batch 1 input nodes size: 1284
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4838175773620605  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4838175773620605  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4908442497253418  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4908447265625  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4854683876037598  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 10, 3: 10, 4: 8, 1: 6, 5: 4, 19: 1, 6: 1, 7: 1, 21: 1, 12: 1, 9: 1, 10: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4855051040649414  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4855051040649414  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.9324378967285156  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.9324398040771484  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4855566024780273  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

pseudo mini batch 2 input nodes size: 1442
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4855079650878906  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4855079650878906  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4941062927246094  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4941067695617676  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4870796203613281  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 9, 3: 7, 4: 7, 2: 6, 6: 6, 5: 5, 7: 3, 9: 2, 12: 1, 10: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4871172904968262  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.84130859375 GB
    Memory Allocated: 1.4871172904968262  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.84326171875 GB
    Memory Allocated: 1.941256046295166  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.84326171875 GB
    Memory Allocated: 1.9412579536437988  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.4871697425842285  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.4871697425842285  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.1225829124450684  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.055326620737711586 |0.0007368723551432291 |0.11537464459737141 |9.695688883463542e-05 |0.31677929560343426 |0.002702951431274414 |
----------------------------------------------------------pseudo_mini_loss sum 224.78302001953125
Total (block generation + training)time/epoch 1.6243432760238647
Training time/epoch 1.5687849521636963
Training time without block to device /epoch 1.5665743350982666
Training time without total dataloading part /epoch 1.2994556427001953
load block tensor time/epoch 0.16597986221313477
block to device time/epoch 0.0022106170654296875
input features size transfer per epoch 4.470348358154297e-07
blocks size to device per epoch 2.4586915969848633e-07
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  6267
Number of first layer input nodes during this epoch:  3733
Number of first layer output nodes during this epoch:  1887
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.122507095336914  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.377 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.377 GB
Metis partitioning: 0.000 seconds, peak memory: 16.377 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009640216827392578
pure dgl.metis_partition the time spent:  0.004352569580078125
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.006093740463256836

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.009315013885498047

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.015402555465698242

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.122507095336914  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

connection checking time:  0.012933492660522461
block generation total time  0.030811309814453125
average batch blocks generation time:  0.010270436604817709
block dataloader generation time/epoch 0.06964421272277832
pseudo mini batch 0 input nodes size: 1266
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.1224560737609863  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.1224560737609863  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.1298794746398926  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.1298799514770508  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.1212811470031738  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 9, 3: 8, 4: 8, 1: 7, 5: 4, 6: 4, 7: 2, 9: 1, 19: 1, 30: 1, 12: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.121316909790039  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.121316909790039  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.5501036643981934  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.5501060485839844  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.486565113067627  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

pseudo mini batch 1 input nodes size: 1342
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.4865188598632812  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.4865188598632812  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.4936833381652832  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.4936838150024414  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.486259937286377  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 10, 2: 9, 4: 7, 1: 5, 5: 4, 6: 3, 9: 2, 10: 2, 7: 2, 21: 1, 12: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.4862995147705078  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.4862995147705078  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.963892936706543  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.9638948440551758  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.4863548278808594  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

pseudo mini batch 2 input nodes size: 971
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.486302375793457  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.486302375793457  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.4914860725402832  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.4914865493774414  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.4843215942382812  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 8, 3: 8, 5: 7, 2: 7, 4: 7, 6: 4, 8: 3, 30: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.4843497276306152  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.4843497276306152  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.8238825798034668  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.8238844871520996  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.484388828277588  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.484388828277588  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.1191515922546387  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05667924880981445 |0.0007379055023193359 |0.11133511861165364 |0.0001049041748046875 |0.3059991200764974 |0.002642393112182617 |
----------------------------------------------------------pseudo_mini_loss sum 84.15130615234375
Total (block generation + training)time/epoch 1.6191718578338623
Training time/epoch 1.525519847869873
Training time without block to device /epoch 1.523306131362915
Training time without total dataloading part /epoch 1.2549598217010498
load block tensor time/epoch 0.17003774642944336
block to device time/epoch 0.002213716506958008
input features size transfer per epoch 4.470348358154297e-07
blocks size to device per epoch 2.4586915969848633e-07
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  6067
Number of first layer input nodes during this epoch:  3579
Number of first layer output nodes during this epoch:  1840
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.1190695762634277  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.377 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.377 GB
Metis partitioning: 0.000 seconds, peak memory: 16.377 GB
Split the graph: 0.002 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.00944972038269043
pure dgl.metis_partition the time spent:  0.004783153533935547
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.005937814712524414

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.009597539901733398

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.015666723251342773

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.1190695762634277  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

connection checking time:  0.012883663177490234
block generation total time  0.031202077865600586
average batch blocks generation time:  0.010400692621866861
block dataloader generation time/epoch 0.07005743185679118
pseudo mini batch 0 input nodes size: 1193
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.119034767150879  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.119034767150879  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.125403881072998  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.1254043579101562  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.1202201843261719  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 14, 4: 10, 3: 9, 1: 5, 6: 2, 5: 2, 30: 1, 9: 1, 10: 1, 19: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.120253086090088  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.120253086090088  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.5098061561584473  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.5098085403442383  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.4862213134765625  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

pseudo mini batch 1 input nodes size: 1423
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.4861788749694824  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.4861788749694824  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.4937753677368164  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.4937758445739746  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.4874062538146973  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 9, 1: 8, 5: 6, 4: 6, 2: 4, 6: 3, 7: 2, 10: 2, 12: 2, 9: 2, 8: 1, 21: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.4874467849731445  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.4874467849731445  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.9858498573303223  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.985851764678955  GigaBytes
Max Memory Allocated: 2.2274651527404785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.4875030517578125  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

pseudo mini batch 2 input nodes size: 998
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.4874486923217773  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.4874486923217773  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.4927763938903809  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.492776870727539  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.4851799011230469  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 8, 5: 7, 1: 7, 2: 7, 6: 6, 4: 6, 8: 2, 7: 2, 9: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.4852099418640137  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.84521484375 GB
    Memory Allocated: 1.4852099418640137  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.8436040878295898  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.8436059951782227  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.4852519035339355  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.4852519035339355  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.1192975044250488  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05717651049296061 |0.000728607177734375 |0.11274441083272298 |9.965896606445312e-05 |0.30703115463256836 |0.0033795833587646484 |
----------------------------------------------------------pseudo_mini_loss sum 32.44502639770508
Total (block generation + training)time/epoch 1.616837700208028
Training time/epoch 1.5329244136810303
Training time without block to device /epoch 1.5307385921478271
Training time without total dataloading part /epoch 1.263005256652832
load block tensor time/epoch 0.17152953147888184
block to device time/epoch 0.002185821533203125
input features size transfer per epoch 4.470348358154297e-07
blocks size to device per epoch 2.4586915969848633e-07
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  6129
Number of first layer input nodes during this epoch:  3614
Number of first layer output nodes during this epoch:  1865
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.119218349456787  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.423 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.423 GB
Metis partitioning: 0.000 seconds, peak memory: 16.423 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.010309219360351562
pure dgl.metis_partition the time spent:  0.0041124820709228516
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.005933046340942383

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.009337663650512695

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.01520681381225586

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.119218349456787  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

connection checking time:  0.012819766998291016
block generation total time  0.030477523803710938
average batch blocks generation time:  0.010159174601236979
block dataloader generation time/epoch 0.07023569515773229
pseudo mini batch 0 input nodes size: 995
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.1191816329956055  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.1191816329956055  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.1244935989379883  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.1244940757751465  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.1191658973693848  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 10, 1: 9, 3: 8, 4: 7, 5: 6, 6: 4, 9: 1, 7: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.1191930770874023  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.1191930770874023  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.4385933876037598  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.4385957717895508  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.4837822914123535  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

pseudo mini batch 1 input nodes size: 1312
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.483747959136963  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.483747959136963  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.4911713600158691  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.4911718368530273  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.4858593940734863  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 9, 3: 8, 1: 6, 4: 6, 5: 5, 6: 4, 7: 2, 10: 2, 9: 2, 11: 1, 21: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.4858980178833008  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.4858980178833008  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.950303554534912  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.950305461883545  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.485952377319336  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

pseudo mini batch 2 input nodes size: 1202
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.4859018325805664  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.4859018325805664  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.4923186302185059  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.492319107055664  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.4848952293395996  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 10, 4: 9, 2: 6, 1: 5, 5: 4, 6: 3, 8: 3, 30: 2, 19: 1, 7: 1, 12: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.4849319458007812  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.4849319458007812  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.9341139793395996  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.9341158866882324  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.4849834442138672  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.4849834442138672  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.120396614074707  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05550265312194824 |0.0007277329762776693 |0.1148378849029541 |9.830792744954427e-05 |0.3135506312052409 |0.002924680709838867 |
----------------------------------------------------------pseudo_mini_loss sum 32.64373779296875
Total (block generation + training)time/epoch 1.6185969965798515
Training time/epoch 1.557723045349121
Training time without block to device /epoch 1.555539846420288
Training time without total dataloading part /epoch 1.2883851528167725
load block tensor time/epoch 0.16650795936584473
block to device time/epoch 0.002183198928833008
input features size transfer per epoch 4.470348358154297e-07
blocks size to device per epoch 2.4586915969848633e-07
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  5978
Number of first layer input nodes during this epoch:  3509
Number of first layer output nodes during this epoch:  1819
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.120323657989502  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.423 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.423 GB
Metis partitioning: 0.000 seconds, peak memory: 16.423 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009169578552246094
pure dgl.metis_partition the time spent:  0.0035965442657470703
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.006021022796630859

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.009598493576049805

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.01605677604675293

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.120323657989502  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

connection checking time:  0.012815713882446289
block generation total time  0.031676292419433594
average batch blocks generation time:  0.010558764139811197
block dataloader generation time/epoch 0.07032826542854309
pseudo mini batch 0 input nodes size: 1074
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.120276927947998  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.120276927947998  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.1260104179382324  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.1260108947753906  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.119593620300293  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 9, 3: 8, 2: 7, 5: 6, 1: 5, 8: 3, 6: 3, 7: 2, 9: 2, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.1196255683898926  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.1196255683898926  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.4959344863891602  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.4959368705749512  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.4842162132263184  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

pseudo mini batch 1 input nodes size: 1447
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.484175682067871  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.484175682067871  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.4927740097045898  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.492774486541748  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.4870405197143555  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 10, 4: 9, 2: 6, 5: 5, 6: 3, 1: 3, 9: 2, 10: 2, 12: 2, 19: 1, 7: 1, 11: 1, 21: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.4870867729187012  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 1.4870867729187012  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 2.0307445526123047  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.86279296875 GB
    Memory Allocated: 2.0307464599609375  GigaBytes
Max Memory Allocated: 2.233980655670166  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4871516227722168  GigaBytes
Max Memory Allocated: 2.278615951538086  GigaBytes

pseudo mini batch 2 input nodes size: 1047
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4870929718017578  GigaBytes
Max Memory Allocated: 2.278615951538086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4870929718017578  GigaBytes
Max Memory Allocated: 2.278615951538086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4926824569702148  GigaBytes
Max Memory Allocated: 2.278615951538086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.492682933807373  GigaBytes
Max Memory Allocated: 2.278615951538086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.484084129333496  GigaBytes
Max Memory Allocated: 2.278615951538086  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 12, 1: 12, 3: 8, 6: 5, 4: 4, 5: 4, 10: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4841113090515137  GigaBytes
Max Memory Allocated: 2.278615951538086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4841113090515137  GigaBytes
Max Memory Allocated: 2.278615951538086  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.8024802207946777  GigaBytes
Max Memory Allocated: 2.278615951538086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.8024821281433105  GigaBytes
Max Memory Allocated: 2.278615951538086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.48414945602417  GigaBytes
Max Memory Allocated: 2.278615951538086  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.48414945602417  GigaBytes
Max Memory Allocated: 2.278615951538086  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1195626258850098  GigaBytes
Max Memory Allocated: 2.278615951538086  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05622371037801107 |0.0007612705230712891 |0.11131683985392253 |0.00010275840759277344 |0.3028481801350911 |0.0033113956451416016 |
----------------------------------------------------------pseudo_mini_loss sum 19.558494567871094
Total (block generation + training)time/epoch 1.6146318316459656
Training time/epoch 1.5157597064971924
Training time without block to device /epoch 1.5134758949279785
Training time without total dataloading part /epoch 1.246114730834961
load block tensor time/epoch 0.1686711311340332
block to device time/epoch 0.002283811569213867
input features size transfer per epoch 4.470348358154297e-07
blocks size to device per epoch 2.4586915969848633e-07
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  6060
Number of first layer input nodes during this epoch:  3568
Number of first layer output nodes during this epoch:  1843
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1194734573364258  GigaBytes
Max Memory Allocated: 2.278615951538086  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.485 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.485 GB
Metis partitioning: 0.000 seconds, peak memory: 16.485 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.02388596534729004
pure dgl.metis_partition the time spent:  0.004500150680541992
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.005781650543212891

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.008463621139526367

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.014203786849975586

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1194734573364258  GigaBytes
Max Memory Allocated: 2.278615951538086  GigaBytes

connection checking time:  0.013138294219970703
block generation total time  0.028449058532714844
average batch blocks generation time:  0.009483019510904947
block dataloader generation time/epoch 0.07198641035291883
pseudo mini batch 0 input nodes size: 955
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1194381713867188  GigaBytes
Max Memory Allocated: 2.278615951538086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1194381713867188  GigaBytes
Max Memory Allocated: 2.278615951538086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1245365142822266  GigaBytes
Max Memory Allocated: 2.278615951538086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1245369911193848  GigaBytes
Max Memory Allocated: 2.278615951538086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1189470291137695  GigaBytes
Max Memory Allocated: 2.278615951538086  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 14, 4: 11, 1: 8, 5: 4, 3: 4, 6: 4, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.118971347808838  GigaBytes
Max Memory Allocated: 2.278615951538086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.118971347808838  GigaBytes
Max Memory Allocated: 2.278615951538086  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.3973474502563477  GigaBytes
Max Memory Allocated: 2.278615951538086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.3973498344421387  GigaBytes
Max Memory Allocated: 2.278615951538086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4835619926452637  GigaBytes
Max Memory Allocated: 2.278615951538086  GigaBytes

pseudo mini batch 1 input nodes size: 1486
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4835314750671387  GigaBytes
Max Memory Allocated: 2.278615951538086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4835314750671387  GigaBytes
Max Memory Allocated: 2.278615951538086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4921298027038574  GigaBytes
Max Memory Allocated: 2.278615951538086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4921302795410156  GigaBytes
Max Memory Allocated: 2.278615951538086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4870314598083496  GigaBytes
Max Memory Allocated: 2.278615951538086  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 11, 4: 6, 2: 6, 5: 4, 6: 4, 7: 3, 1: 3, 9: 3, 12: 2, 10: 2, 30: 1, 11: 1, 21: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4870786666870117  GigaBytes
Max Memory Allocated: 2.278615951538086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4870786666870117  GigaBytes
Max Memory Allocated: 2.278615951538086  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 2.0511627197265625  GigaBytes
Max Memory Allocated: 2.278615951538086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 2.0511646270751953  GigaBytes
Max Memory Allocated: 2.278615951538086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4871444702148438  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

pseudo mini batch 2 input nodes size: 1054
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.487083911895752  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.487083911895752  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4933972358703613  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4933977127075195  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4847989082336426  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 11, 1: 9, 5: 7, 2: 5, 4: 5, 8: 3, 6: 3, 9: 1, 30: 1, 19: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4848308563232422  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4848308563232422  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.8735127449035645  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.8735146522521973  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4848756790161133  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4848756790161133  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1202888488769531  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.056569178899129234 |0.0007647673288981119 |0.11080082257588704 |0.0001152356465657552 |0.28783098856608075 |0.003430604934692383 |
----------------------------------------------------------pseudo_mini_loss sum 8.834607124328613
Total (block generation + training)time/epoch 1.6081191168891058
Training time/epoch 1.4706037044525146
Training time without block to device /epoch 1.4683094024658203
Training time without total dataloading part /epoch 1.199671745300293
load block tensor time/epoch 0.1697075366973877
block to device time/epoch 0.002294301986694336
input features size transfer per epoch 4.470348358154297e-07
blocks size to device per epoch 2.4586915969848633e-07
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  5968
Number of first layer input nodes during this epoch:  3495
Number of first layer output nodes during this epoch:  1825
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.120208740234375  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.485 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.485 GB
Metis partitioning: 0.000 seconds, peak memory: 16.485 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009691238403320312
pure dgl.metis_partition the time spent:  0.004417896270751953
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.0060045719146728516

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.00816035270690918

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.013553619384765625

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.120208740234375  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

connection checking time:  0.012710094451904297
block generation total time  0.027718544006347656
average batch blocks generation time:  0.009239514668782553
block dataloader generation time/epoch 0.07153558731079102
pseudo mini batch 0 input nodes size: 992
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1201677322387695  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1201677322387695  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1254634857177734  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1254639625549316  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.119150161743164  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 9, 4: 9, 1: 8, 3: 8, 5: 6, 6: 4, 7: 2})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1191773414611816  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1191773414611816  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4268155097961426  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4268178939819336  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4837660789489746  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

pseudo mini batch 1 input nodes size: 1316
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.483731746673584  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.483731746673584  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4907574653625488  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.490757942199707  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.485461711883545  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 9, 4: 6, 3: 6, 1: 6, 5: 5, 6: 4, 10: 3, 7: 2, 9: 2, 12: 1, 11: 1, 21: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4855003356933594  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4855003356933594  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.9547576904296875  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.9547595977783203  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4855546951293945  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

pseudo mini batch 2 input nodes size: 1151
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.485504150390625  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.485504150390625  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4916486740112305  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4916491508483887  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4846229553222656  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 12, 2: 7, 4: 7, 1: 6, 5: 4, 6: 3, 8: 3, 9: 2, 30: 2, 19: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4846587181091309  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4846587181091309  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.9314255714416504  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.9314274787902832  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4847092628479004  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4847092628479004  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1201224327087402  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05629857381184896 |0.0007344086964925131 |0.11098400751749675 |9.72747802734375e-05 |0.2938499450683594 |0.002897977828979492 |
----------------------------------------------------------pseudo_mini_loss sum 7.685318470001221
Total (block generation + training)time/epoch 1.6029677391052246
Training time/epoch 1.489013433456421
Training time without block to device /epoch 1.4868102073669434
Training time without total dataloading part /epoch 1.2176916599273682
load block tensor time/epoch 0.16889572143554688
block to device time/epoch 0.002203226089477539
input features size transfer per epoch 4.470348358154297e-07
blocks size to device per epoch 2.4586915969848633e-07
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  5916
Number of first layer input nodes during this epoch:  3459
Number of first layer output nodes during this epoch:  1809
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1200494766235352  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.485 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.485 GB
Metis partitioning: 0.000 seconds, peak memory: 16.485 GB
Split the graph: 0.002 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.00983881950378418
pure dgl.metis_partition the time spent:  0.0040607452392578125
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.005927085876464844

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.008323907852172852

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.013713598251342773

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1200494766235352  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

connection checking time:  0.012848615646362305
block generation total time  0.02796459197998047
average batch blocks generation time:  0.00932153065999349
block dataloader generation time/epoch 0.0711433237249201
pseudo mini batch 0 input nodes size: 1095
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.120004653930664  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.120004653930664  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1258502006530762  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1258506774902344  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1197056770324707  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 12, 1: 9, 4: 8, 2: 8, 5: 3, 6: 3, 12: 1, 19: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1197357177734375  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1197357177734375  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4826974868774414  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4826998710632324  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4844837188720703  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

pseudo mini batch 1 input nodes size: 1320
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4844450950622559  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4844450950622559  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.491868495941162  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4918689727783203  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.48602294921875  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 9, 3: 9, 2: 8, 1: 6, 5: 4, 6: 3, 9: 2, 7: 2, 10: 2, 21: 1, 11: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4860615730285645  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4860615730285645  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.948153018951416  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.9481549263000488  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4861159324645996  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

pseudo mini batch 2 input nodes size: 1097
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.48606538772583  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.48606538772583  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4919219017028809  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.491922378540039  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4844985008239746  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 9, 5: 8, 1: 5, 6: 5, 4: 5, 3: 5, 8: 3, 7: 2, 9: 2, 10: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.484532356262207  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.484532356262207  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.8884930610656738  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.8884949684143066  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4845800399780273  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4845800399780273  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.119832992553711  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05650949478149414 |0.0007380644480387369 |0.11120915412902832 |0.00010553995768229167 |0.30210455258687335 |0.0031316280364990234 |
----------------------------------------------------------pseudo_mini_loss sum 3.9388527870178223
Total (block generation + training)time/epoch 1.601029547778043
Training time/epoch 1.514310598373413
Training time without block to device /epoch 1.5120964050292969
Training time without total dataloading part /epoch 1.243389368057251
load block tensor time/epoch 0.16952848434448242
block to device time/epoch 0.002214193344116211
input features size transfer per epoch 4.470348358154297e-07
blocks size to device per epoch 2.4586915969848633e-07
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  5971
Number of first layer input nodes during this epoch:  3512
Number of first layer output nodes during this epoch:  1810
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1197566986083984  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.485 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.485 GB
Metis partitioning: 0.000 seconds, peak memory: 16.485 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009616851806640625
pure dgl.metis_partition the time spent:  0.004535198211669922
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.006035566329956055

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.009128093719482422

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.015232324600219727

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1197566986083984  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

connection checking time:  0.012788772583007812
block generation total time  0.030395984649658203
average batch blocks generation time:  0.0101319948832194
block dataloader generation time/epoch 0.07112530867258708
pseudo mini batch 0 input nodes size: 963
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1197137832641602  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1197137832641602  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1248550415039062  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1248555183410645  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1189985275268555  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 8, 1: 8, 2: 6, 5: 6, 6: 6, 3: 5, 8: 3, 30: 1, 10: 1, 7: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1190285682678223  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1190285682678223  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4792556762695312  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4792580604553223  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.483619213104248  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

pseudo mini batch 1 input nodes size: 1384
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4835829734802246  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4835829734802246  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.490971565246582  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4909720420837402  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.485830307006836  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 9, 4: 8, 3: 7, 5: 5, 1: 5, 6: 3, 7: 3, 9: 2, 10: 2, 21: 1, 11: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4858698844909668  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4858698844909668  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.9777584075927734  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.9777603149414062  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4859251976013184  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

pseudo mini batch 2 input nodes size: 1162
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.485872745513916  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.485872745513916  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4920759201049805  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4920763969421387  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.484687328338623  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 14, 2: 10, 1: 7, 4: 6, 5: 4, 6: 2, 12: 1, 19: 1, 9: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4847192764282227  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4847192764282227  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.8625364303588867  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.8625383377075195  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4847640991210938  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4847640991210938  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1201772689819336  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05612929662068685 |0.0007623831431070963 |0.11313692728678386 |9.799003601074219e-05 |0.3130507469177246 |0.002844095230102539 |
----------------------------------------------------------pseudo_mini_loss sum 4.146720886230469
Total (block generation + training)time/epoch 1.6028181711832683
Training time/epoch 1.5514461994171143
Training time without block to device /epoch 1.549159049987793
Training time without total dataloading part /epoch 1.2817010879516602
load block tensor time/epoch 0.16838788986206055
block to device time/epoch 0.002287149429321289
input features size transfer per epoch 4.470348358154297e-07
blocks size to device per epoch 2.4586915969848633e-07
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  5961
Number of first layer input nodes during this epoch:  3509
Number of first layer output nodes during this epoch:  1805
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.12009859085083  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.485 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.485 GB
Metis partitioning: 0.000 seconds, peak memory: 16.485 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.0088348388671875
pure dgl.metis_partition the time spent:  0.004508256912231445
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.006062746047973633

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.009193658828735352

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.015420675277709961

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.12009859085083  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

connection checking time:  0.013182640075683594
block generation total time  0.030677080154418945
average batch blocks generation time:  0.010225693384806315
block dataloader generation time/epoch 0.07113869373614971
pseudo mini batch 0 input nodes size: 1068
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1200575828552246  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1200575828552246  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1257591247558594  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1257596015930176  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.119555950164795  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 17, 3: 8, 1: 7, 4: 5, 5: 4, 6: 2, 10: 1, 9: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1195831298828125  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1195831298828125  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4322853088378906  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4322876930236816  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4841718673706055  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

pseudo mini batch 1 input nodes size: 1389
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4841375350952148  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4841375350952148  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.491560935974121  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4915614128112793  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4858593940734863  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 9, 3: 7, 2: 7, 1: 6, 5: 5, 6: 4, 10: 2, 7: 2, 9: 2, 11: 1, 21: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4858989715576172  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4858989715576172  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.9738221168518066  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.9738240242004395  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4859542846679688  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

pseudo mini batch 2 input nodes size: 1217
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4859018325805664  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4859018325805664  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.492398738861084  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4923992156982422  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4849753379821777  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 11, 4: 8, 1: 7, 5: 6, 6: 5, 8: 3, 30: 2, 9: 1, 2: 1, 7: 1, 19: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4850139617919922  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4850139617919922  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.932302474975586  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.9323043823242188  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4850664138793945  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4850664138793945  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1204795837402344  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.056042989095052086 |0.0007205804189046224 |0.11527101198832194 |9.640057881673177e-05 |0.30865661303202313 |0.0025756359100341797 |
----------------------------------------------------------pseudo_mini_loss sum 3.5166749954223633
Total (block generation + training)time/epoch 1.6039513991429255
Training time/epoch 1.5461444854736328
Training time without block to device /epoch 1.543982744216919
Training time without total dataloading part /epoch 1.2746477127075195
load block tensor time/epoch 0.16812896728515625
block to device time/epoch 0.002161741256713867
input features size transfer per epoch 4.470348358154297e-07
blocks size to device per epoch 2.4586915969848633e-07
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  6173
Number of first layer input nodes during this epoch:  3674
Number of first layer output nodes during this epoch:  1847
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1204066276550293  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.485 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.485 GB
Metis partitioning: 0.000 seconds, peak memory: 16.485 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.008987903594970703
pure dgl.metis_partition the time spent:  0.003537893295288086
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.0071108341217041016

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.009643316268920898

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.01569390296936035

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1204066276550293  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

connection checking time:  0.014099836349487305
block generation total time  0.03244805335998535
average batch blocks generation time:  0.010816017786661783
block dataloader generation time/epoch 0.07125752312796456
pseudo mini batch 0 input nodes size: 987
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1203598976135254  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1203598976135254  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.12562894821167  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1256294250488281  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1191320419311523  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 11, 1: 10, 4: 9, 5: 6, 3: 3, 6: 3, 7: 2, 9: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1191582679748535  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1191582679748535  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.417372703552246  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.417375087738037  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4837374687194824  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

pseudo mini batch 1 input nodes size: 1380
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4837050437927246  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4837050437927246  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.491072177886963  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.491072654724121  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4858031272888184  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 9, 3: 9, 1: 7, 4: 6, 6: 4, 5: 4, 9: 2, 7: 2, 10: 2, 12: 1, 21: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4858417510986328  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4858417510986328  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.9603314399719238  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.9603333473205566  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.485896110534668  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

pseudo mini batch 2 input nodes size: 1238
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4858455657958984  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4858455657958984  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4932689666748047  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.493269443511963  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4859018325805664  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 14, 4: 7, 2: 5, 5: 5, 6: 4, 1: 3, 8: 3, 30: 2, 19: 1, 9: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4859395027160645  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4859395027160645  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.9576797485351562  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.957681655883789  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4859929084777832  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4859929084777832  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.121406078338623  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05605761210123698 |0.0007603168487548828 |0.10952345530192058 |0.00010267893473307292 |0.2854885260264079 |0.002313375473022461 |
----------------------------------------------------------pseudo_mini_loss sum 3.337787389755249
Total (block generation + training)time/epoch 1.5989815848214286
Training time/epoch 1.4613909721374512
Training time without block to device /epoch 1.4591100215911865
Training time without total dataloading part /epoch 1.187657356262207
load block tensor time/epoch 0.16817283630371094
block to device time/epoch 0.0022809505462646484
input features size transfer per epoch 4.470348358154297e-07
blocks size to device per epoch 2.4586915969848633e-07
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  6089
Number of first layer input nodes during this epoch:  3605
Number of first layer output nodes during this epoch:  1834
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.121333122253418  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.485 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.485 GB
Metis partitioning: 0.000 seconds, peak memory: 16.485 GB
Split the graph: 0.002 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.010417938232421875
pure dgl.metis_partition the time spent:  0.004856586456298828
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.0060825347900390625

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.00933218002319336

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.015647411346435547

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.121333122253418  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

connection checking time:  0.012938976287841797
block generation total time  0.03106212615966797
average batch blocks generation time:  0.010354042053222656
block dataloader generation time/epoch 0.07142319679260253
pseudo mini batch 0 input nodes size: 862
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.121284008026123  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.121284008026123  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1258859634399414  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1258864402770996  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1184625625610352  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 11, 5: 8, 3: 6, 2: 5, 6: 5, 4: 5, 8: 3, 30: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1184887886047363  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1184887886047363  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4271836280822754  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4271860122680664  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4830713272094727  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

pseudo mini batch 1 input nodes size: 1284
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4830408096313477  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4830408096313477  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.490464210510254  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.490464687347412  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4858622550964355  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 13, 4: 10, 1: 6, 3: 6, 5: 4, 6: 3, 7: 2, 9: 2, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4858970642089844  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4858970642089844  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.8976998329162598  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.8977017402648926  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.485945701599121  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

pseudo mini batch 2 input nodes size: 1446
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4858989715576172  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4858989715576172  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.494497299194336  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4944977760314941  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4870738983154297  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 14, 2: 7, 4: 7, 1: 3, 5: 3, 6: 3, 7: 2, 12: 2, 10: 2, 30: 1, 21: 1, 9: 1, 19: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4871172904968262  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4871172904968262  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.9973196983337402  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.997321605682373  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4871773719787598  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4871773719787598  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1225905418395996  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05559976895650228 |0.0007488727569580078 |0.1696610450744629 |9.862581888834636e-05 |0.2996176878611247 |0.002096414566040039 |
----------------------------------------------------------pseudo_mini_loss sum 2.6804425716400146
Total (block generation + training)time/epoch 1.6095422744750976
Training time/epoch 1.6835317611694336
Training time without block to device /epoch 1.6812851428985596
Training time without total dataloading part /epoch 1.4102284908294678
load block tensor time/epoch 0.16679930686950684
block to device time/epoch 0.0022466182708740234
input features size transfer per epoch 4.470348358154297e-07
blocks size to device per epoch 2.4586915969848633e-07
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  6062
Number of first layer input nodes during this epoch:  3592
Number of first layer output nodes during this epoch:  1826
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1225204467773438  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.485 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.485 GB
Metis partitioning: 0.000 seconds, peak memory: 16.485 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009001493453979492
pure dgl.metis_partition the time spent:  0.003912687301635742
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.006214141845703125

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.00944066047668457

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.015833616256713867

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1225204467773438  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

connection checking time:  0.013628959655761719
block generation total time  0.03148841857910156
average batch blocks generation time:  0.010496139526367188
block dataloader generation time/epoch 0.07148341834545135
pseudo mini batch 0 input nodes size: 1012
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1224656105041504  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1224656105041504  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1278681755065918  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.12786865234375  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.119269847869873  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 10, 3: 10, 4: 9, 1: 8, 5: 5, 6: 3, 19: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1192970275878906  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1192970275878906  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.432431697845459  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.43243408203125  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4846587181091309  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

pseudo mini batch 1 input nodes size: 1443
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4846243858337402  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4846243858337402  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.493222713470459  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4932231903076172  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4878201484680176  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 10, 4: 8, 2: 6, 6: 4, 5: 4, 1: 3, 7: 3, 12: 2, 10: 2, 9: 2, 30: 1, 21: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.487863540649414  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.487863540649414  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 2.0097575187683105  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 2.0097594261169434  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.487924575805664  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

pseudo mini batch 2 input nodes size: 1083
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4878697395324707  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4878697395324707  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4936513900756836  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4936518669128418  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4850530624389648  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 9, 1: 9, 5: 6, 3: 6, 4: 5, 6: 4, 8: 3, 9: 2, 30: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4850850105285645  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4850850105285645  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.8692164421081543  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.869218349456787  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4851298332214355  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4851298332214355  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1197571754455566  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05664809544881185 |0.0007696151733398438 |0.11171865463256836 |0.00011110305786132812 |0.2988700866699219 |0.003031492233276367 |
----------------------------------------------------------pseudo_mini_loss sum 2.5647029876708984
Total (block generation + training)time/epoch 1.6077460795640945
Training time/epoch 1.508305311203003
Training time without block to device /epoch 1.5059964656829834
Training time without total dataloading part /epoch 1.235131025314331
load block tensor time/epoch 0.16994428634643555
block to device time/epoch 0.0023088455200195312
input features size transfer per epoch 4.470348358154297e-07
blocks size to device per epoch 2.4586915969848633e-07
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  6000
Number of first layer input nodes during this epoch:  3538
Number of first layer output nodes during this epoch:  1818
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1196770668029785  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.485 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.485 GB
Metis partitioning: 0.000 seconds, peak memory: 16.485 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009824037551879883
pure dgl.metis_partition the time spent:  0.003911018371582031
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.006453514099121094

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.009628057479858398

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.015568971633911133

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1196770668029785  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

connection checking time:  0.01282644271850586
block generation total time  0.031650543212890625
average batch blocks generation time:  0.010550181070963541
block dataloader generation time/epoch 0.07152487249935374
pseudo mini batch 0 input nodes size: 970
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.119636058807373  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.119636058807373  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.124814510345459  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1248149871826172  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.119032859802246  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 13, 1: 8, 4: 6, 5: 6, 3: 6, 6: 4, 7: 2, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1190590858459473  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1190590858459473  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4260916709899902  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4260940551757812  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4850831031799316  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

pseudo mini batch 1 input nodes size: 1429
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4850506782531738  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4850506782531738  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4936490058898926  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4936494827270508  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4884705543518066  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 9, 3: 9, 4: 7, 5: 5, 1: 3, 6: 3, 9: 2, 7: 2, 12: 2, 10: 2, 30: 1, 11: 1, 21: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4885149002075195  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4885149002075195  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 2.009517192840576  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 2.009519100189209  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4885759353637695  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

pseudo mini batch 2 input nodes size: 1108
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4885191917419434  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4885191917419434  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4944343566894531  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4944348335266113  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4858360290527344  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 11, 1: 9, 4: 9, 6: 4, 5: 4, 8: 3, 2: 3, 9: 2, 19: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4858689308166504  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4858689308166504  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.8820290565490723  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.882030963897705  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.485914707183838  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.485914707183838  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.11989164352417  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05632098515828451 |0.0007321834564208984 |0.11344377199808757 |0.00010045369466145833 |0.31165870030721027 |0.002655029296875 |
----------------------------------------------------------pseudo_mini_loss sum 2.669499397277832
Total (block generation + training)time/epoch 1.6085142388063318
Training time/epoch 1.5485057830810547
Training time without block to device /epoch 1.546309232711792
Training time without total dataloading part /epoch 1.278263807296753
load block tensor time/epoch 0.16896295547485352
block to device time/epoch 0.0021965503692626953
input features size transfer per epoch 4.470348358154297e-07
blocks size to device per epoch 2.4586915969848633e-07
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  5961
Number of first layer input nodes during this epoch:  3507
Number of first layer output nodes during this epoch:  1804
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1198124885559082  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.485 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.485 GB
Metis partitioning: 0.000 seconds, peak memory: 16.485 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.010616302490234375
pure dgl.metis_partition the time spent:  0.004739999771118164
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.005960941314697266

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.009106874465942383

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.015154600143432617

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1198124885559082  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

connection checking time:  0.012964487075805664
block generation total time  0.030222415924072266
average batch blocks generation time:  0.010074138641357422
block dataloader generation time/epoch 0.07157076729668511
pseudo mini batch 0 input nodes size: 933
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.11976957321167  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.11976957321167  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1247506141662598  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.124751091003418  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.11883544921875  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 11, 4: 9, 3: 7, 2: 6, 5: 5, 8: 3, 6: 3, 9: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1188626289367676  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.1188626289367676  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4369010925292969  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.436903476715088  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.483452320098877  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

pseudo mini batch 1 input nodes size: 1472
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4834198951721191  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4834198951721191  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.492018222808838  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.492018699645996  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.487037181854248  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 10, 4: 9, 2: 8, 1: 4, 7: 4, 9: 3, 6: 3, 5: 3, 10: 1, 12: 1, 11: 1, 19: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4870777130126953  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4870777130126953  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.9837756156921387  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.9837775230407715  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4871349334716797  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

pseudo mini batch 2 input nodes size: 1193
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4870800971984863  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4870800971984863  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4934492111206055  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4934496879577637  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.4848508834838867  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 11, 3: 9, 5: 7, 1: 5, 6: 5, 4: 4, 10: 2, 21: 1, 30: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.484886646270752  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.484886646270752  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.9157004356384277  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.9157023429870605  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.484936237335205  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.484936237335205  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.92529296875 GB
    Memory Allocated: 1.120349407196045  GigaBytes
Max Memory Allocated: 2.2990798950195312  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.05577929814656576 |0.0007295608520507812 |0.11159952481587727 |0.00010307629903157552 |0.3018774191538493 |0.0025093555450439453 |
----------------------------------------------------------pseudo_mini_loss sum 2.555699110031128
Total (block generation + training)time/epoch 1.6072875128851996
Training time/epoch 1.5139546394348145
Training time without block to device /epoch 1.511765956878662
Training time without total dataloading part /epoch 1.2432494163513184
load block tensor time/epoch 0.16733789443969727
block to device time/epoch 0.0021886825561523438
input features size transfer per epoch 4.470348358154297e-07
blocks size to device per epoch 2.4586915969848633e-07
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  6093
Number of first layer input nodes during this epoch:  3598
Number of first layer output nodes during this epoch:  1846
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(1433, 1433, batch_first=True)
      (fc_self): Linear(in_features=1433, out_features=2048, bias=False)
      (fc_neigh): Linear(in_features=1433, out_features=2048, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(2048, 2048, batch_first=True)
      (fc_self): Linear(in_features=2048, out_features=2048, bias=False)
      (fc_neigh): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (2): SAGEConv(
      (lstm): LSTM(2048, 2048, batch_first=True)
      (fc_self): Linear(in_features=2048, out_features=7, bias=False)
      (fc_neigh): Linear(in_features=2048, out_features=7, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  97867856
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([5732, 1433])
layers.0.lstm.weight_hh_l0, torch.Size([5732, 1433])
layers.0.lstm.bias_ih_l0, torch.Size([5732])
layers.0.lstm.bias_hh_l0, torch.Size([5732])
layers.0.fc_self.weight, torch.Size([2048, 1433])
layers.0.fc_neigh.weight, torch.Size([2048, 1433])
layers.1.lstm.weight_ih_l0, torch.Size([8192, 2048])
layers.1.lstm.weight_hh_l0, torch.Size([8192, 2048])
layers.1.lstm.bias_ih_l0, torch.Size([8192])
layers.1.lstm.bias_hh_l0, torch.Size([8192])
layers.1.fc_self.weight, torch.Size([2048, 2048])
layers.1.fc_neigh.weight, torch.Size([2048, 2048])
layers.2.lstm.weight_ih_l0, torch.Size([8192, 2048])
layers.2.lstm.weight_hh_l0, torch.Size([8192, 2048])
layers.2.lstm.bias_ih_l0, torch.Size([8192])
layers.2.lstm.bias_hh_l0, torch.Size([8192])
layers.2.fc_self.weight, torch.Size([7, 2048])
layers.2.fc_neigh.weight, torch.Size([7, 2048])
----------------------------------------
un-trainable parameters
