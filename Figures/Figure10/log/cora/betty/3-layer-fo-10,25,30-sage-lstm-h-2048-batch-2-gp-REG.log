main start at this time 1733010928.8416998
-----------------------------------------before load data 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

----------------------------------------start of run function 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  1433
----------------------------------------before model to device 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 0.88623046875 GB
    Memory Allocated: 0.3674592971801758  GigaBytes
Max Memory Allocated: 0.3674592971801758  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 0.88818359375 GB
    Memory Allocated: 0.3674592971801758  GigaBytes
Max Memory Allocated: 0.3674592971801758  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.001 seconds, peak memory: 13.818 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 13.818 GB
Metis partitioning: 0.001 seconds, peak memory: 13.818 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.028994083404541016
pure dgl.metis_partition the time spent:  0.004189729690551758

block_gen_time in "generate_blocks_for_one_layer_block"  0.005018711090087891


block_gen_time in "generate_blocks_for_one_layer_block"  0.007898807525634766


block_gen_time in "generate_blocks_for_one_layer_block"  0.013237714767456055

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 0.88818359375 GB
    Memory Allocated: 0.3674592971801758  GigaBytes
Max Memory Allocated: 0.3674592971801758  GigaBytes

connection checking time:  0.011130332946777344
block generation total time  0.02615523338317871
average batch blocks generation time:  0.013077616691589355
pseudo mini batch 0 input nodes size: 1635
----------------------------------------before load block subtensor 
 Nvidia-smi: 0.88818359375 GB
    Memory Allocated: 0.3674592971801758  GigaBytes
Max Memory Allocated: 0.3674592971801758  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 0.88818359375 GB
    Memory Allocated: 0.3674592971801758  GigaBytes
Max Memory Allocated: 0.3674592971801758  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 0.90771484375 GB
    Memory Allocated: 0.376187801361084  GigaBytes
Max Memory Allocated: 0.376187801361084  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 0.90771484375 GB
    Memory Allocated: 0.3761887550354004  GigaBytes
Max Memory Allocated: 0.3761887550354004  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 0.90771484375 GB
    Memory Allocated: 0.3761887550354004  GigaBytes
Max Memory Allocated: 0.3761887550354004  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 14, 2: 13, 4: 11, 1: 9, 5: 6, 6: 5, 9: 3, 10: 3, 7: 2, 12: 2, 30: 1, 11: 1, 21: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 0.90771484375 GB
    Memory Allocated: 0.37624073028564453  GigaBytes
Max Memory Allocated: 0.37624073028564453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 0.90771484375 GB
    Memory Allocated: 0.37624073028564453  GigaBytes
Max Memory Allocated: 0.37624073028564453  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.61865234375 GB
    Memory Allocated: 1.0316038131713867  GigaBytes
Max Memory Allocated: 1.0352792739868164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.61865234375 GB
    Memory Allocated: 1.031606674194336  GigaBytes
Max Memory Allocated: 1.0352792739868164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.06591796875 GB
    Memory Allocated: 0.7567729949951172  GigaBytes
Max Memory Allocated: 1.3905086517333984  GigaBytes

pseudo mini batch 1 input nodes size: 1288
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.06591796875 GB
    Memory Allocated: 0.7567062377929688  GigaBytes
Max Memory Allocated: 1.3905086517333984  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.06591796875 GB
    Memory Allocated: 0.7567062377929688  GigaBytes
Max Memory Allocated: 1.3905086517333984  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.06591796875 GB
    Memory Allocated: 0.7635822296142578  GigaBytes
Max Memory Allocated: 1.3905086517333984  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.06591796875 GB
    Memory Allocated: 0.7635831832885742  GigaBytes
Max Memory Allocated: 1.3905086517333984  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.06591796875 GB
    Memory Allocated: 0.7548537254333496  GigaBytes
Max Memory Allocated: 1.3905086517333984  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 12, 3: 12, 4: 11, 1: 11, 5: 9, 6: 6, 8: 3, 7: 2, 19: 1, 30: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.06591796875 GB
    Memory Allocated: 0.7548961639404297  GigaBytes
Max Memory Allocated: 1.3905086517333984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.06591796875 GB
    Memory Allocated: 0.7548961639404297  GigaBytes
Max Memory Allocated: 1.3905086517333984  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.06591796875 GB
    Memory Allocated: 1.2647452354431152  GigaBytes
Max Memory Allocated: 1.3905086517333984  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.06591796875 GB
    Memory Allocated: 1.2647476196289062  GigaBytes
Max Memory Allocated: 1.3905086517333984  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.25341796875 GB
    Memory Allocated: 0.7549552917480469  GigaBytes
Max Memory Allocated: 1.5123720169067383  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.90966796875 GB
    Memory Allocated: 1.4841289520263672  GigaBytes
Max Memory Allocated: 1.8493661880493164  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.90966796875 GB
    Memory Allocated: 1.119542121887207  GigaBytes
Max Memory Allocated: 1.8493661880493164  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04661130905151367 |0.003322601318359375 |1.4259965419769287 |0.006735682487487793 |0.4676774740219116 |0.14216852188110352 |
----------------------------------------------------------pseudo_mini_loss sum 1.9481446743011475
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5267
Number of first layer input nodes during this epoch:  2923
Number of first layer output nodes during this epoch:  1702
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.90966796875 GB
    Memory Allocated: 1.1194829940795898  GigaBytes
Max Memory Allocated: 1.8493661880493164  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.517 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.517 GB
Metis partitioning: 0.000 seconds, peak memory: 16.517 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.010812759399414062
pure dgl.metis_partition the time spent:  0.003008604049682617

block_gen_time in "generate_blocks_for_one_layer_block"  0.004316091537475586


block_gen_time in "generate_blocks_for_one_layer_block"  0.008967161178588867


block_gen_time in "generate_blocks_for_one_layer_block"  0.01419830322265625

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.90966796875 GB
    Memory Allocated: 1.1194829940795898  GigaBytes
Max Memory Allocated: 1.8493661880493164  GigaBytes

connection checking time:  0.01138615608215332
block generation total time  0.027481555938720703
average batch blocks generation time:  0.013740777969360352
pseudo mini batch 0 input nodes size: 1728
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.90966796875 GB
    Memory Allocated: 1.1194300651550293  GigaBytes
Max Memory Allocated: 1.8493661880493164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.90966796875 GB
    Memory Allocated: 1.1194300651550293  GigaBytes
Max Memory Allocated: 1.8493661880493164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.90966796875 GB
    Memory Allocated: 1.128654956817627  GigaBytes
Max Memory Allocated: 1.8493661880493164  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.90966796875 GB
    Memory Allocated: 1.1286559104919434  GigaBytes
Max Memory Allocated: 1.8493661880493164  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.90966796875 GB
    Memory Allocated: 1.121778964996338  GigaBytes
Max Memory Allocated: 1.8493661880493164  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 16, 4: 13, 2: 11, 1: 8, 5: 6, 6: 5, 10: 3, 9: 2, 12: 2, 7: 1, 30: 1, 11: 1, 19: 1, 21: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.90966796875 GB
    Memory Allocated: 1.1218347549438477  GigaBytes
Max Memory Allocated: 1.8493661880493164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.90966796875 GB
    Memory Allocated: 1.1218347549438477  GigaBytes
Max Memory Allocated: 1.8493661880493164  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92138671875 GB
    Memory Allocated: 1.8155031204223633  GigaBytes
Max Memory Allocated: 1.8493661880493164  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.92138671875 GB
    Memory Allocated: 1.8155059814453125  GigaBytes
Max Memory Allocated: 1.8493661880493164  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.92138671875 GB
    Memory Allocated: 1.486452579498291  GigaBytes
Max Memory Allocated: 2.1650538444519043  GigaBytes

pseudo mini batch 1 input nodes size: 1361
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.92138671875 GB
    Memory Allocated: 1.486379623413086  GigaBytes
Max Memory Allocated: 2.1650538444519043  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.92138671875 GB
    Memory Allocated: 1.486379623413086  GigaBytes
Max Memory Allocated: 2.1650538444519043  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.92138671875 GB
    Memory Allocated: 1.493645191192627  GigaBytes
Max Memory Allocated: 2.1650538444519043  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.92138671875 GB
    Memory Allocated: 1.4936461448669434  GigaBytes
Max Memory Allocated: 2.1650538444519043  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.92138671875 GB
    Memory Allocated: 1.4844202995300293  GigaBytes
Max Memory Allocated: 2.1650538444519043  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 14, 1: 12, 3: 10, 5: 9, 4: 9, 6: 6, 7: 3, 8: 3, 9: 2, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.92138671875 GB
    Memory Allocated: 1.484461784362793  GigaBytes
Max Memory Allocated: 2.1650538444519043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92138671875 GB
    Memory Allocated: 1.484461784362793  GigaBytes
Max Memory Allocated: 2.1650538444519043  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.92138671875 GB
    Memory Allocated: 1.978886604309082  GigaBytes
Max Memory Allocated: 2.1650538444519043  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.92138671875 GB
    Memory Allocated: 1.978888988494873  GigaBytes
Max Memory Allocated: 2.1650538444519043  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.4845199584960938  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.4845199584960938  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.1199331283569336  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0460737943649292 |0.0008045434951782227 |0.1301182508468628 |0.00011622905731201172 |0.3524972200393677 |0.0030379295349121094 |
----------------------------------------------------------pseudo_mini_loss sum 58.82183837890625
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5506
Number of first layer input nodes during this epoch:  3089
Number of first layer output nodes during this epoch:  1768
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.119870662689209  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.712 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.712 GB
Metis partitioning: 0.000 seconds, peak memory: 16.712 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009284257888793945
pure dgl.metis_partition the time spent:  0.0032548904418945312

block_gen_time in "generate_blocks_for_one_layer_block"  0.004384756088256836


block_gen_time in "generate_blocks_for_one_layer_block"  0.010206937789916992


block_gen_time in "generate_blocks_for_one_layer_block"  0.01428675651550293

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.119870662689209  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

connection checking time:  0.012474536895751953
block generation total time  0.028878450393676758
average batch blocks generation time:  0.014439225196838379
block dataloader generation time/epoch 0.06729722023010254
pseudo mini batch 0 input nodes size: 1729
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.1198196411132812  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.1198196411132812  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.1290497779846191  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.1290507316589355  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.1217842102050781  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 18, 5: 10, 4: 9, 1: 8, 2: 8, 6: 6, 10: 3, 9: 3, 12: 2, 7: 1, 30: 1, 21: 1, 19: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.1218409538269043  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.1218409538269043  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.8290648460388184  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.8290677070617676  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.4864606857299805  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

pseudo mini batch 1 input nodes size: 1351
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.4863877296447754  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.4863877296447754  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.494520664215088  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.4945216178894043  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.48529052734375  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 17, 4: 13, 1: 12, 3: 8, 6: 5, 5: 5, 8: 3, 7: 3, 30: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.4853310585021973  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.4853310585021973  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.9747414588928223  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.9747438430786133  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.4853873252868652  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.4853873252868652  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.120800495147705  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04674530029296875 |0.0007940530776977539 |0.12670505046844482 |0.00010037422180175781 |0.33928346633911133 |0.0029458999633789062 |
----------------------------------------------------------pseudo_mini_loss sum 88.4949722290039
Total (block generation + training)time/epoch 1.1985654830932617
Training time/epoch 1.1310241222381592
Training time without block to device /epoch 1.1294360160827637
Training time without total dataloading part /epoch 0.9351236820220947
load block tensor time/epoch 0.0934906005859375
block to device time/epoch 0.0015881061553955078
input features size transfer per epoch 2.980232238769531e-07
blocks size to device per epoch 1.6391277313232422e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  5495
Number of first layer input nodes during this epoch:  3080
Number of first layer output nodes during this epoch:  1769
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.1207351684570312  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.712 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.712 GB
Metis partitioning: 0.000 seconds, peak memory: 16.712 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009574413299560547
pure dgl.metis_partition the time spent:  0.002775430679321289

block_gen_time in "generate_blocks_for_one_layer_block"  0.00455784797668457


block_gen_time in "generate_blocks_for_one_layer_block"  0.008589982986450195


block_gen_time in "generate_blocks_for_one_layer_block"  0.013540267944335938

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.1207351684570312  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

connection checking time:  0.011539459228515625
block generation total time  0.026688098907470703
average batch blocks generation time:  0.013344049453735352
block dataloader generation time/epoch 0.06494700908660889
pseudo mini batch 0 input nodes size: 1589
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.1206841468811035  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.1206841468811035  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.1292824745178223  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.1292834281921387  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.1211495399475098  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 14, 3: 12, 4: 11, 1: 10, 5: 8, 6: 8, 12: 2, 10: 2, 19: 1, 9: 1, 7: 1, 21: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.1211986541748047  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.1211986541748047  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.7266960144042969  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.726698875427246  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.4864602088928223  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

pseudo mini batch 1 input nodes size: 1478
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.4863972663879395  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.4863972663879395  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.4949955940246582  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.4949965476989746  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.4863972663879395  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 14, 4: 11, 2: 11, 1: 10, 5: 7, 9: 3, 6: 3, 8: 3, 7: 3, 30: 2, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.486445426940918  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.486445426940918  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 2.0777292251586914  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 2.0777316093444824  GigaBytes
Max Memory Allocated: 2.2265820503234863  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.4865131378173828  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.4865131378173828  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.1212759017944336  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0459057092666626 |0.0007882118225097656 |0.1291111707687378 |0.00010323524475097656 |0.3370169401168823 |0.003158092498779297 |
----------------------------------------------------------pseudo_mini_loss sum 207.72145080566406
Total (block generation + training)time/epoch 1.196882963180542
Training time/epoch 1.132495641708374
Training time without block to device /epoch 1.1309192180633545
Training time without total dataloading part /epoch 0.9356207847595215
load block tensor time/epoch 0.0918114185333252
block to device time/epoch 0.0015764236450195312
input features size transfer per epoch 2.980232238769531e-07
blocks size to device per epoch 1.6391277313232422e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  5475
Number of first layer input nodes during this epoch:  3067
Number of first layer output nodes during this epoch:  1756
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.1212196350097656  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.712 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.712 GB
Metis partitioning: 0.000 seconds, peak memory: 16.712 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.00894021987915039
pure dgl.metis_partition the time spent:  0.0030868053436279297

block_gen_time in "generate_blocks_for_one_layer_block"  0.00438237190246582


block_gen_time in "generate_blocks_for_one_layer_block"  0.008354663848876953


block_gen_time in "generate_blocks_for_one_layer_block"  0.013573646545410156

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.1212196350097656  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

connection checking time:  0.01129293441772461
block generation total time  0.02631068229675293
average batch blocks generation time:  0.013155341148376465
block dataloader generation time/epoch 0.06386701265970866
pseudo mini batch 0 input nodes size: 1641
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.1211585998535156  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.1211585998535156  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.1299190521240234  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.1299200057983398  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.1213207244873047  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 16, 4: 13, 1: 11, 2: 9, 6: 5, 5: 5, 10: 2, 7: 2, 9: 2, 12: 2, 21: 1, 19: 1, 11: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.1213746070861816  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.1213746070861816  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.7876286506652832  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.7876315116882324  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.4868855476379395  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

pseudo mini batch 1 input nodes size: 1239
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.4868168830871582  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.4868168830871582  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.4934310913085938  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.4934320449829102  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.484670639038086  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 16, 3: 10, 5: 10, 4: 9, 1: 9, 6: 6, 8: 3, 9: 2, 7: 2, 30: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.4847111701965332  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.4847111701965332  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.9796385765075684  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.9796409606933594  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.4847683906555176  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.4847683906555176  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.119279384613037  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.047652244567871094 |0.0007785558700561523 |0.13247311115264893 |0.00010180473327636719 |0.3678029775619507 |0.002778291702270508 |
----------------------------------------------------------pseudo_mini_loss sum 56.87044906616211
Total (block generation + training)time/epoch 1.2181767622629802
Training time/epoch 1.1989476680755615
Training time without block to device /epoch 1.1973905563354492
Training time without total dataloading part /epoch 1.0035340785980225
load block tensor time/epoch 0.09530448913574219
block to device time/epoch 0.0015571117401123047
input features size transfer per epoch 2.980232238769531e-07
blocks size to device per epoch 1.6391277313232422e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  5218
Number of first layer input nodes during this epoch:  2880
Number of first layer output nodes during this epoch:  1696
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.1192173957824707  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.712 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.712 GB
Metis partitioning: 0.000 seconds, peak memory: 16.712 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009782791137695312
pure dgl.metis_partition the time spent:  0.003370523452758789

block_gen_time in "generate_blocks_for_one_layer_block"  0.004332542419433594


block_gen_time in "generate_blocks_for_one_layer_block"  0.008635997772216797


block_gen_time in "generate_blocks_for_one_layer_block"  0.014100313186645508

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.1192173957824707  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

connection checking time:  0.011718034744262695
block generation total time  0.0270688533782959
average batch blocks generation time:  0.01353442668914795
block dataloader generation time/epoch 0.06392639875411987
pseudo mini batch 0 input nodes size: 1700
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.1191682815551758  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.1191682815551758  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.1282439231872559  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.1282448768615723  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.1216297149658203  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 13, 2: 11, 1: 9, 5: 8, 6: 7, 4: 7, 9: 4, 8: 3, 10: 3, 7: 2, 12: 2, 30: 1, 21: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.1216864585876465  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.04638671875 GB
    Memory Allocated: 1.1216864585876465  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.825666904449463  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.825669765472412  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4863052368164062  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

pseudo mini batch 1 input nodes size: 1444
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4862327575683594  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4862327575683594  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4948310852050781  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4948320388793945  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.485755443572998  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 15, 2: 14, 3: 13, 1: 11, 5: 7, 6: 4, 7: 2, 19: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4857988357543945  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4857988357543945  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.994649887084961  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.994652271270752  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4858598709106445  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4858598709106445  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1212730407714844  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.047616004943847656 |0.0007853507995605469 |0.1317228078842163 |0.00011968612670898438 |0.34960901737213135 |0.0024535655975341797 |
----------------------------------------------------------pseudo_mini_loss sum 101.6365737915039
Total (block generation + training)time/epoch 1.2205184698104858
Training time/epoch 1.1633269786834717
Training time without block to device /epoch 1.1617562770843506
Training time without total dataloading part /epoch 0.9653565883636475
load block tensor time/epoch 0.09523200988769531
block to device time/epoch 0.0015707015991210938
input features size transfer per epoch 2.980232238769531e-07
blocks size to device per epoch 1.6391277313232422e-07
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  5585
Number of first layer input nodes during this epoch:  3144
Number of first layer output nodes during this epoch:  1793
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1212081909179688  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.712 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.712 GB
Metis partitioning: 0.000 seconds, peak memory: 16.712 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009888648986816406
pure dgl.metis_partition the time spent:  0.003067493438720703

block_gen_time in "generate_blocks_for_one_layer_block"  0.004292011260986328


block_gen_time in "generate_blocks_for_one_layer_block"  0.010574102401733398


block_gen_time in "generate_blocks_for_one_layer_block"  0.013679027557373047

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1212081909179688  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

connection checking time:  0.011263847351074219
block generation total time  0.028545141220092773
average batch blocks generation time:  0.014272570610046387
block dataloader generation time/epoch 0.06413397789001465
pseudo mini batch 0 input nodes size: 1724
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1211528778076172  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1211528778076172  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1303563117980957  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.130357265472412  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.121757984161377  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 18, 4: 11, 1: 10, 2: 9, 5: 6, 6: 4, 7: 3, 9: 2, 12: 2, 10: 2, 19: 1, 21: 1, 11: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1218137741088867  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1218137741088867  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.8207898139953613  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.8207926750183105  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4864311218261719  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

pseudo mini batch 1 input nodes size: 1215
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4863581657409668  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4863581657409668  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.492844581604004  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4928455352783203  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4836411476135254  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 16, 4: 11, 1: 10, 5: 9, 3: 8, 6: 7, 8: 3, 9: 2, 30: 1, 7: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4836807250976562  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4836807250976562  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.959059238433838  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.959061622619629  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4837369918823242  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4837369918823242  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.119150161743164  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04718315601348877 |0.0007762908935546875 |0.1317962408065796 |0.00010418891906738281 |0.35672926902770996 |0.0029506683349609375 |
----------------------------------------------------------pseudo_mini_loss sum 73.3077392578125
Total (block generation + training)time/epoch 1.2246337413787842
Training time/epoch 1.1759967803955078
Training time without block to device /epoch 1.1744441986083984
Training time without total dataloading part /epoch 0.9802100658416748
load block tensor time/epoch 0.09436631202697754
block to device time/epoch 0.001552581787109375
input features size transfer per epoch 2.980232238769531e-07
blocks size to device per epoch 1.6391277313232422e-07
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  5292
Number of first layer input nodes during this epoch:  2939
Number of first layer output nodes during this epoch:  1708
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1190876960754395  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.712 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.712 GB
Metis partitioning: 0.000 seconds, peak memory: 16.712 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.01077127456665039
pure dgl.metis_partition the time spent:  0.003081798553466797

block_gen_time in "generate_blocks_for_one_layer_block"  0.004333972930908203


block_gen_time in "generate_blocks_for_one_layer_block"  0.008497476577758789


block_gen_time in "generate_blocks_for_one_layer_block"  0.01384592056274414

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1190876960754395  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

connection checking time:  0.01163172721862793
block generation total time  0.026677370071411133
average batch blocks generation time:  0.013338685035705566
block dataloader generation time/epoch 0.0642471710840861
pseudo mini batch 0 input nodes size: 1679
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1190404891967773  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1190404891967773  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1280035972595215  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.128004550933838  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1215171813964844  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 16, 3: 14, 4: 11, 5: 6, 1: 6, 6: 6, 10: 3, 12: 2, 9: 2, 21: 1, 11: 1, 7: 1, 30: 1, 19: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1215720176696777  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1215720176696777  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.8038945198059082  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.8038973808288574  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4861879348754883  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

pseudo mini batch 1 input nodes size: 1344
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4861173629760742  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4861173629760742  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4932923316955566  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.493293285369873  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4843292236328125  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 14, 3: 12, 4: 11, 5: 9, 2: 9, 6: 5, 8: 3, 7: 3, 9: 2, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4843707084655762  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4843707084655762  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.979926586151123  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.979928970336914  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.484428882598877  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.484428882598877  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1198420524597168  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04703116416931152 |0.000800013542175293 |0.12952899932861328 |0.00010633468627929688 |0.35305309295654297 |0.003046751022338867 |
----------------------------------------------------------pseudo_mini_loss sum 40.481388092041016
Total (block generation + training)time/epoch 1.2254387935002644
Training time/epoch 1.164513111114502
Training time without block to device /epoch 1.1629130840301514
Training time without total dataloading part /epoch 0.96842360496521
load block tensor time/epoch 0.09406232833862305
block to device time/epoch 0.001600027084350586
input features size transfer per epoch 2.980232238769531e-07
blocks size to device per epoch 1.6391277313232422e-07
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  5406
Number of first layer input nodes during this epoch:  3023
Number of first layer output nodes during this epoch:  1740
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1197800636291504  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.712 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.712 GB
Metis partitioning: 0.000 seconds, peak memory: 16.712 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.010565996170043945
pure dgl.metis_partition the time spent:  0.0033016204833984375

block_gen_time in "generate_blocks_for_one_layer_block"  0.004313468933105469


block_gen_time in "generate_blocks_for_one_layer_block"  0.008478164672851562


block_gen_time in "generate_blocks_for_one_layer_block"  0.013803243637084961

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1197800636291504  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

connection checking time:  0.011468648910522461
block generation total time  0.026594877243041992
average batch blocks generation time:  0.013297438621520996
block dataloader generation time/epoch 0.0642401831490653
pseudo mini batch 0 input nodes size: 1680
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1197290420532227  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1197290420532227  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1286978721618652  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1286988258361816  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1215229034423828  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 16, 4: 11, 2: 10, 5: 8, 1: 7, 6: 6, 7: 3, 12: 2, 10: 2, 9: 2, 11: 1, 21: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1215758323669434  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1215758323669434  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.777888298034668  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.7778911590576172  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4868392944335938  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

pseudo mini batch 1 input nodes size: 1302
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4867706298828125  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4867706298828125  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4942855834960938  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4942865371704102  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4853167533874512  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 15, 1: 13, 4: 11, 3: 10, 5: 7, 6: 5, 8: 3, 9: 2, 19: 1, 30: 1, 7: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4853601455688477  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4853601455688477  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 2.0023155212402344  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 2.0023179054260254  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4854211807250977  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4854211807250977  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1201839447021484  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04705703258514404 |0.000784754753112793 |0.13400256633758545 |0.00010442733764648438 |0.37043821811676025 |0.0025358200073242188 |
----------------------------------------------------------pseudo_mini_loss sum 35.445560455322266
Total (block generation + training)time/epoch 1.2322078432355608
Training time/epoch 1.2085039615631104
Training time without block to device /epoch 1.2069344520568848
Training time without total dataloading part /epoch 1.0116262435913086
load block tensor time/epoch 0.09411406517028809
block to device time/epoch 0.001569509506225586
input features size transfer per epoch 2.980232238769531e-07
blocks size to device per epoch 1.6391277313232422e-07
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  5350
Number of first layer input nodes during this epoch:  2982
Number of first layer output nodes during this epoch:  1723
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1201248168945312  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.712 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.712 GB
Metis partitioning: 0.000 seconds, peak memory: 16.712 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009514331817626953
pure dgl.metis_partition the time spent:  0.0029435157775878906

block_gen_time in "generate_blocks_for_one_layer_block"  0.004476308822631836


block_gen_time in "generate_blocks_for_one_layer_block"  0.009009122848510742


block_gen_time in "generate_blocks_for_one_layer_block"  0.013803482055664062

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1201248168945312  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

connection checking time:  0.011712074279785156
block generation total time  0.02728891372680664
average batch blocks generation time:  0.01364445686340332
block dataloader generation time/epoch 0.06414756178855896
pseudo mini batch 0 input nodes size: 1655
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1200718879699707  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1200718879699707  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1289072036743164  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1289081573486328  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1213922500610352  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 15, 2: 14, 4: 10, 1: 9, 5: 8, 9: 3, 6: 3, 7: 2, 10: 2, 12: 2, 19: 1, 11: 1, 21: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.121446132659912  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.121446132659912  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.7886552810668945  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.7886581420898438  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.486708641052246  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

pseudo mini batch 1 input nodes size: 1432
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4866399765014648  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4866399765014648  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4952383041381836  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4952392578125  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.486402988433838  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 12, 2: 11, 1: 11, 3: 11, 6: 8, 5: 7, 8: 3, 7: 2, 10: 1, 30: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4864473342895508  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4864473342895508  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 2.0197925567626953  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 2.0197949409484863  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4865093231201172  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4865093231201172  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.121272087097168  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04705250263214111 |0.0007948875427246094 |0.13798785209655762 |0.00011157989501953125 |0.3811584711074829 |0.0028181076049804688 |
----------------------------------------------------------pseudo_mini_loss sum 18.376632690429688
Total (block generation + training)time/epoch 1.2409295737743378
Training time/epoch 1.2383670806884766
Training time without block to device /epoch 1.2367773056030273
Training time without total dataloading part /epoch 1.0413339138031006
load block tensor time/epoch 0.09410500526428223
block to device time/epoch 0.0015897750854492188
input features size transfer per epoch 2.980232238769531e-07
blocks size to device per epoch 1.6391277313232422e-07
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  5509
Number of first layer input nodes during this epoch:  3087
Number of first layer output nodes during this epoch:  1776
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1212100982666016  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.712 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.712 GB
Metis partitioning: 0.000 seconds, peak memory: 16.712 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.010197639465332031
pure dgl.metis_partition the time spent:  0.0028405189514160156

block_gen_time in "generate_blocks_for_one_layer_block"  0.004341602325439453


block_gen_time in "generate_blocks_for_one_layer_block"  0.011830806732177734


block_gen_time in "generate_blocks_for_one_layer_block"  0.013590812683105469

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1212100982666016  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

connection checking time:  0.013254404067993164
block generation total time  0.029763221740722656
average batch blocks generation time:  0.014881610870361328
block dataloader generation time/epoch 0.06474333339267307
pseudo mini batch 0 input nodes size: 1715
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1211528778076172  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1211528778076172  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1303081512451172  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1303091049194336  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1217098236083984  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 15, 4: 12, 1: 10, 2: 8, 5: 7, 7: 4, 6: 4, 12: 2, 9: 2, 10: 2, 19: 1, 30: 1, 11: 1, 21: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1217646598815918  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1217646598815918  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.8131589889526367  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.813161849975586  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4863810539245605  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

pseudo mini batch 1 input nodes size: 1303
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4863100051879883  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4863100051879883  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4932661056518555  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4932670593261719  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4841108322143555  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 17, 3: 11, 4: 10, 1: 10, 5: 8, 6: 7, 8: 3, 9: 2, 30: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4841523170471191  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4841523170471191  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.9734196662902832  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.9734220504760742  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.48421049118042  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.48421049118042  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1196236610412598  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04686713218688965 |0.0007764101028442383 |0.13419580459594727 |0.00012481212615966797 |0.3672558069229126 |0.003464937210083008 |
----------------------------------------------------------pseudo_mini_loss sum 11.591968536376953
Total (block generation + training)time/epoch 1.2442820072174072
Training time/epoch 1.2014565467834473
Training time without block to device /epoch 1.1999037265777588
Training time without total dataloading part /epoch 1.006617784500122
load block tensor time/epoch 0.0937342643737793
block to device time/epoch 0.0015528202056884766
input features size transfer per epoch 2.980232238769531e-07
blocks size to device per epoch 1.6391277313232422e-07
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  5393
Number of first layer input nodes during this epoch:  3018
Number of first layer output nodes during this epoch:  1733
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1195611953735352  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.712 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.712 GB
Metis partitioning: 0.000 seconds, peak memory: 16.712 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.011203289031982422
pure dgl.metis_partition the time spent:  0.002939462661743164

block_gen_time in "generate_blocks_for_one_layer_block"  0.004287242889404297


block_gen_time in "generate_blocks_for_one_layer_block"  0.008292198181152344


block_gen_time in "generate_blocks_for_one_layer_block"  0.012987136840820312

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1195611953735352  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

connection checking time:  0.011145353317260742
block generation total time  0.025566577911376953
average batch blocks generation time:  0.012783288955688477
block dataloader generation time/epoch 0.06466827392578126
pseudo mini batch 0 input nodes size: 1694
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1195101737976074  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1195101737976074  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1285533905029297  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.128554344177246  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1215972900390625  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 14, 3: 13, 4: 11, 5: 8, 1: 8, 6: 5, 7: 3, 10: 3, 12: 2, 9: 2, 11: 1, 30: 1, 21: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1216521263122559  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1216521263122559  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.8044099807739258  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.804412841796875  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4862689971923828  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

pseudo mini batch 1 input nodes size: 1195
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4861979484558105  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4861979484558105  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4925775527954102  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4925785064697266  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.483534336090088  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 13, 1: 12, 2: 11, 4: 11, 5: 7, 6: 6, 8: 3, 9: 2, 19: 1, 30: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4835739135742188  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4835739135742188  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.9572739601135254  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.9572763442993164  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4836301803588867  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4836301803588867  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1190433502197266  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0461883544921875 |0.0007805824279785156 |0.1350945234298706 |0.0001207590103149414 |0.36417508125305176 |0.0026786327362060547 |
----------------------------------------------------------pseudo_mini_loss sum 10.262187957763672
Total (block generation + training)time/epoch 1.2459818840026855
Training time/epoch 1.1971182823181152
Training time without block to device /epoch 1.1955571174621582
Training time without total dataloading part /epoch 1.0014593601226807
load block tensor time/epoch 0.092376708984375
block to device time/epoch 0.0015611648559570312
input features size transfer per epoch 2.980232238769531e-07
blocks size to device per epoch 1.6391277313232422e-07
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  5214
Number of first layer input nodes during this epoch:  2889
Number of first layer output nodes during this epoch:  1688
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.118980884552002  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.712 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.712 GB
Metis partitioning: 0.000 seconds, peak memory: 16.712 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.011090278625488281
pure dgl.metis_partition the time spent:  0.002814054489135742

block_gen_time in "generate_blocks_for_one_layer_block"  0.004231691360473633


block_gen_time in "generate_blocks_for_one_layer_block"  0.00890803337097168


block_gen_time in "generate_blocks_for_one_layer_block"  0.013058662414550781

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.118980884552002  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

connection checking time:  0.011245250701904297
block generation total time  0.026198387145996094
average batch blocks generation time:  0.013099193572998047
block dataloader generation time/epoch 0.06454337726939809
pseudo mini batch 0 input nodes size: 1715
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1189336776733398  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1189336776733398  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1280889511108398  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1280899047851562  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1217093467712402  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 13, 4: 12, 2: 10, 1: 9, 5: 7, 6: 6, 9: 3, 7: 3, 12: 2, 10: 2, 19: 1, 21: 1, 11: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1217660903930664  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1217660903930664  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.823509693145752  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.8235125541687012  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4864773750305176  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

pseudo mini batch 1 input nodes size: 1191
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4864044189453125  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4864044189453125  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4933300018310547  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.493330955505371  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4841747283935547  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 15, 3: 13, 1: 11, 4: 10, 5: 8, 6: 5, 8: 3, 7: 1, 10: 1, 30: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4842133522033691  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4842133522033691  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.9447078704833984  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.9447102546691895  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4842677116394043  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4842677116394043  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1195893287658691  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04718053340911865 |0.0007867813110351562 |0.1352161169052124 |9.918212890625e-05 |0.3810974359512329 |0.0031228065490722656 |
----------------------------------------------------------pseudo_mini_loss sum 8.509709358215332
Total (block generation + training)time/epoch 1.2503408952192827
Training time/epoch 1.2305035591125488
Training time without block to device /epoch 1.2289299964904785
Training time without total dataloading part /epoch 1.0359482765197754
load block tensor time/epoch 0.0943610668182373
block to device time/epoch 0.0015735626220703125
input features size transfer per epoch 2.980232238769531e-07
blocks size to device per epoch 1.6391277313232422e-07
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  5244
Number of first layer input nodes during this epoch:  2906
Number of first layer output nodes during this epoch:  1695
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1195240020751953  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.712 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.712 GB
Metis partitioning: 0.000 seconds, peak memory: 16.712 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.011226892471313477
pure dgl.metis_partition the time spent:  0.0030028820037841797

block_gen_time in "generate_blocks_for_one_layer_block"  0.004296064376831055


block_gen_time in "generate_blocks_for_one_layer_block"  0.008362293243408203


block_gen_time in "generate_blocks_for_one_layer_block"  0.013275623321533203

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1195240020751953  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

connection checking time:  0.011308431625366211
block generation total time  0.02593398094177246
average batch blocks generation time:  0.01296699047088623
block dataloader generation time/epoch 0.06445689996083577
pseudo mini batch 0 input nodes size: 1574
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1194767951965332  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1194767951965332  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.128075122833252  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1280760765075684  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1211495399475098  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 14, 2: 11, 4: 10, 1: 10, 5: 8, 6: 4, 9: 3, 10: 3, 12: 2, 19: 1, 21: 1, 7: 1, 11: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1212005615234375  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1212005615234375  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.7639412879943848  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.763944149017334  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4864649772644043  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

pseudo mini batch 1 input nodes size: 1418
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4864001274108887  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4864001274108887  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4939699172973633  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4939708709716797  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4853715896606445  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 14, 3: 12, 4: 12, 1: 10, 5: 7, 6: 7, 8: 3, 7: 3, 30: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4854159355163574  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4854159355163574  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 2.0128917694091797  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 2.0128941535949707  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4854788780212402  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4854788780212402  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.120241641998291  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04658865928649902 |0.0007712841033935547 |0.13099467754364014 |0.00010001659393310547 |0.36302876472473145 |0.0030088424682617188 |
----------------------------------------------------------pseudo_mini_loss sum 6.066777229309082
Total (block generation + training)time/epoch 1.250373661518097
Training time/epoch 1.1871106624603271
Training time without block to device /epoch 1.18556809425354
Training time without total dataloading part /epoch 0.9912557601928711
load block tensor time/epoch 0.09317731857299805
block to device time/epoch 0.0015425682067871094
input features size transfer per epoch 2.980232238769531e-07
blocks size to device per epoch 1.6391277313232422e-07
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  5345
Number of first layer input nodes during this epoch:  2992
Number of first layer output nodes during this epoch:  1713
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1201825141906738  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.712 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.712 GB
Metis partitioning: 0.000 seconds, peak memory: 16.712 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009386062622070312
pure dgl.metis_partition the time spent:  0.0030541419982910156

block_gen_time in "generate_blocks_for_one_layer_block"  0.004414558410644531


block_gen_time in "generate_blocks_for_one_layer_block"  0.008461236953735352


block_gen_time in "generate_blocks_for_one_layer_block"  0.013553857803344727

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1201825141906738  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

connection checking time:  0.011423587799072266
block generation total time  0.02642965316772461
average batch blocks generation time:  0.013214826583862305
block dataloader generation time/epoch 0.06429419150719276
pseudo mini batch 0 input nodes size: 1654
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1201272010803223  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1201272010803223  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1289572715759277  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1289582252502441  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1213874816894531  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 15, 3: 12, 4: 11, 1: 9, 5: 8, 6: 4, 7: 3, 9: 3, 10: 2, 11: 1, 21: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1214394569396973  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1214394569396973  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.748857021331787  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.7488598823547363  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.486091136932373  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

pseudo mini batch 1 input nodes size: 1381
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4860243797302246  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4860243797302246  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4933967590332031  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4933977127075195  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4845666885375977  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 14, 4: 11, 1: 11, 2: 10, 5: 7, 6: 7, 8: 3, 30: 2, 9: 1, 10: 1, 7: 1, 19: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.484611988067627  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.484611988067627  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 2.0399746894836426  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 2.0399770736694336  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4846758842468262  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4846758842468262  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1200461387634277  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0458836555480957 |0.0007727146148681641 |0.13568198680877686 |0.00011169910430908203 |0.36803221702575684 |0.0025098323822021484 |
----------------------------------------------------------pseudo_mini_loss sum 4.473209381103516
Total (block generation + training)time/epoch 1.2519005995530348
Training time/epoch 1.2077083587646484
Training time without block to device /epoch 1.206162929534912
Training time without total dataloading part /epoch 1.0101616382598877
load block tensor time/epoch 0.0917673110961914
block to device time/epoch 0.0015454292297363281
input features size transfer per epoch 2.980232238769531e-07
blocks size to device per epoch 1.6391277313232422e-07
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  5416
Number of first layer input nodes during this epoch:  3035
Number of first layer output nodes during this epoch:  1735
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1199870109558105  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.712 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.712 GB
Metis partitioning: 0.000 seconds, peak memory: 16.712 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.008654594421386719
pure dgl.metis_partition the time spent:  0.002966642379760742

block_gen_time in "generate_blocks_for_one_layer_block"  0.004186153411865234


block_gen_time in "generate_blocks_for_one_layer_block"  0.00872659683227539


block_gen_time in "generate_blocks_for_one_layer_block"  0.01353597640991211

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1199870109558105  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

connection checking time:  0.011417627334594727
block generation total time  0.026448726654052734
average batch blocks generation time:  0.013224363327026367
block dataloader generation time/epoch 0.06408306530543736
pseudo mini batch 0 input nodes size: 1622
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1199297904968262  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1199297904968262  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1285886764526367  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1285896301269531  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1212162971496582  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 16, 1: 12, 3: 11, 4: 9, 6: 6, 5: 5, 9: 3, 10: 3, 7: 2, 12: 1, 21: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1212663650512695  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1212663650512695  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.7205872535705566  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.7205901145935059  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4871044158935547  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

pseudo mini batch 1 input nodes size: 1411
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.487039566040039  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.487039566040039  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4945721626281738  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4945731163024902  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4859132766723633  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 15, 4: 13, 5: 10, 2: 9, 1: 8, 6: 5, 8: 3, 7: 2, 30: 2, 19: 1, 9: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4859604835510254  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4859604835510254  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 2.0672030448913574  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 2.0672054290771484  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4860272407531738  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4860272407531738  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1202082633972168  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04618263244628906 |0.000774383544921875 |0.13193416595458984 |0.00010371208190917969 |0.3511650562286377 |0.0029616355895996094 |
----------------------------------------------------------pseudo_mini_loss sum 3.8600211143493652
Total (block generation + training)time/epoch 1.2501789501735143
Training time/epoch 1.1663432121276855
Training time without block to device /epoch 1.1647944450378418
Training time without total dataloading part /epoch 0.969367504119873
load block tensor time/epoch 0.09236526489257812
block to device time/epoch 0.00154876708984375
input features size transfer per epoch 2.980232238769531e-07
blocks size to device per epoch 1.6391277313232422e-07
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  5420
Number of first layer input nodes during this epoch:  3033
Number of first layer output nodes during this epoch:  1742
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1201519966125488  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.712 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.712 GB
Metis partitioning: 0.000 seconds, peak memory: 16.712 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.01004338264465332
pure dgl.metis_partition the time spent:  0.003342866897583008

block_gen_time in "generate_blocks_for_one_layer_block"  0.004578113555908203


block_gen_time in "generate_blocks_for_one_layer_block"  0.009015083312988281


block_gen_time in "generate_blocks_for_one_layer_block"  0.013469934463500977

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1201519966125488  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

connection checking time:  0.011798858642578125
block generation total time  0.02706313133239746
average batch blocks generation time:  0.01353156566619873
block dataloader generation time/epoch 0.06412069002787273
pseudo mini batch 0 input nodes size: 1326
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1200928688049316  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1200928688049316  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.127171516418457  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1271724700927734  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1196389198303223  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 14, 4: 13, 1: 11, 2: 10, 5: 7, 6: 5, 9: 3, 8: 3, 7: 2, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1196813583374023  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1196813583374023  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.621159553527832  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.6211624145507812  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4842729568481445  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

pseudo mini batch 1 input nodes size: 1647
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4842205047607422  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4842205047607422  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4930129051208496  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.493013858795166  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4859342575073242  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 15, 3: 12, 1: 9, 4: 9, 5: 8, 6: 6, 10: 3, 12: 2, 7: 2, 30: 1, 21: 1, 9: 1, 19: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4859881401062012  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4859881401062012  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 2.1509690284729004  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 2.1509714126586914  GigaBytes
Max Memory Allocated: 2.3241143226623535  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4860644340515137  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4860644340515137  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1214776039123535  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04471898078918457 |0.0007798671722412109 |0.21725928783416748 |0.00010406970977783203 |0.36279332637786865 |0.0025451183319091797 |
----------------------------------------------------------pseudo_mini_loss sum 2.865938186645508
Total (block generation + training)time/epoch 1.2617730140686034
Training time/epoch 1.3593354225158691
Training time without block to device /epoch 1.3577756881713867
Training time without total dataloading part /epoch 1.162858486175537
load block tensor time/epoch 0.08943796157836914
block to device time/epoch 0.0015597343444824219
input features size transfer per epoch 2.980232238769531e-07
blocks size to device per epoch 1.6391277313232422e-07
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  5332
Number of first layer input nodes during this epoch:  2973
Number of first layer output nodes during this epoch:  1717
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1214280128479004  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.712 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.712 GB
Metis partitioning: 0.000 seconds, peak memory: 16.712 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.010684013366699219
pure dgl.metis_partition the time spent:  0.0033020973205566406

block_gen_time in "generate_blocks_for_one_layer_block"  0.004210710525512695


block_gen_time in "generate_blocks_for_one_layer_block"  0.00838470458984375


block_gen_time in "generate_blocks_for_one_layer_block"  0.014192581176757812

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1214280128479004  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

connection checking time:  0.011562585830688477
block generation total time  0.026787996292114258
average batch blocks generation time:  0.013393998146057129
block dataloader generation time/epoch 0.06416343152523041
pseudo mini batch 0 input nodes size: 1629
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.121358871459961  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.121358871459961  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1300554275512695  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.130056381225586  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.121263027191162  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 13, 2: 12, 4: 11, 1: 8, 5: 8, 6: 5, 8: 3, 9: 3, 12: 2, 10: 2, 7: 2, 30: 1, 21: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.121316909790039  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.121316909790039  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.7907538414001465  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.7907567024230957  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.486569881439209  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

pseudo mini batch 1 input nodes size: 1466
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4865012168884277  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4865012168884277  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4950995445251465  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.495100498199463  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.486402988433838  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 13, 3: 13, 1: 12, 4: 11, 5: 7, 6: 6, 7: 2, 10: 1, 30: 1, 19: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4864463806152344  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4864463806152344  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 2.0075740814208984  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 2.0075764656066895  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4865074157714844  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4865074157714844  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1212701797485352  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04522883892059326 |0.0009669065475463867 |0.13849949836730957 |0.00012063980102539062 |0.38606691360473633 |0.0029315948486328125 |
----------------------------------------------------------pseudo_mini_loss sum 3.2711143493652344
Total (block generation + training)time/epoch 1.2650903314352036
Training time/epoch 1.2495918273925781
Training time without block to device /epoch 1.2476580142974854
Training time without total dataloading part /epoch 1.0523056983947754
load block tensor time/epoch 0.09045767784118652
block to device time/epoch 0.0019338130950927734
input features size transfer per epoch 2.980232238769531e-07
blocks size to device per epoch 1.6391277313232422e-07
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  5494
Number of first layer input nodes during this epoch:  3095
Number of first layer output nodes during this epoch:  1755
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1212081909179688  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.712 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.712 GB
Metis partitioning: 0.000 seconds, peak memory: 16.712 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.00891256332397461
pure dgl.metis_partition the time spent:  0.003142118453979492

block_gen_time in "generate_blocks_for_one_layer_block"  0.00422215461730957


block_gen_time in "generate_blocks_for_one_layer_block"  0.00801539421081543


block_gen_time in "generate_blocks_for_one_layer_block"  0.01360940933227539

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1212081909179688  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

connection checking time:  0.011293172836303711
block generation total time  0.02584695816040039
average batch blocks generation time:  0.012923479080200195
block dataloader generation time/epoch 0.06399934432085823
pseudo mini batch 0 input nodes size: 1699
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1211528778076172  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1211528778076172  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1302227973937988  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1302237510681152  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.12162446975708  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 13, 4: 12, 2: 9, 1: 9, 5: 8, 6: 6, 9: 3, 7: 2, 12: 2, 10: 2, 30: 1, 11: 1, 19: 1, 21: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.121678352355957  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.121678352355957  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.7954483032226562  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.7954511642456055  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.486292839050293  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

pseudo mini batch 1 input nodes size: 1261
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4862241744995117  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4862241744995117  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4929561614990234  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4929571151733398  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4838862419128418  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 16, 3: 13, 1: 11, 4: 10, 5: 7, 6: 5, 8: 3, 7: 2, 10: 1, 9: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.483926773071289  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.483926773071289  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.9703950881958008  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.9703974723815918  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4839839935302734  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4839839935302734  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1193971633911133  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04721701145172119 |0.0007764101028442383 |0.13229572772979736 |0.00010943412780761719 |0.3671445846557617 |0.0032150745391845703 |
----------------------------------------------------------pseudo_mini_loss sum 3.0047707557678223
Total (block generation + training)time/epoch 1.2647374517777388
Training time/epoch 1.197589635848999
Training time without block to device /epoch 1.1960368156433105
Training time without total dataloading part /epoch 1.002314567565918
load block tensor time/epoch 0.09443402290344238
block to device time/epoch 0.0015528202056884766
input features size transfer per epoch 2.980232238769531e-07
blocks size to device per epoch 1.6391277313232422e-07
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  5291
Number of first layer input nodes during this epoch:  2960
Number of first layer output nodes during this epoch:  1691
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1193351745605469  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.712 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.712 GB
Metis partitioning: 0.000 seconds, peak memory: 16.712 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009426116943359375
pure dgl.metis_partition the time spent:  0.0027685165405273438

block_gen_time in "generate_blocks_for_one_layer_block"  0.0042266845703125


block_gen_time in "generate_blocks_for_one_layer_block"  0.008111238479614258


block_gen_time in "generate_blocks_for_one_layer_block"  0.013516902923583984

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1193351745605469  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

connection checking time:  0.011338949203491211
block generation total time  0.025854825973510742
average batch blocks generation time:  0.012927412986755371
block dataloader generation time/epoch 0.06387525134616429
pseudo mini batch 0 input nodes size: 1691
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.119286060333252  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.119286060333252  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1283135414123535  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.12831449508667  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1215815544128418  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 13, 2: 11, 4: 9, 1: 8, 5: 8, 6: 6, 9: 3, 7: 3, 10: 2, 12: 2, 21: 1, 11: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1216354370117188  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1216354370117188  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.7836570739746094  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.7836599349975586  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4869999885559082  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

pseudo mini batch 1 input nodes size: 1271
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.486931324005127  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.486931324005127  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4937167167663574  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4937176704406738  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4846892356872559  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 14, 4: 13, 3: 13, 1: 12, 5: 7, 6: 5, 8: 3, 10: 1, 9: 1, 7: 1, 30: 1, 19: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4847307205200195  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4847307205200195  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.9882211685180664  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.9882235527038574  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4847888946533203  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.4847888946533203  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.06396484375 GB
    Memory Allocated: 1.1194524765014648  GigaBytes
Max Memory Allocated: 2.398191452026367  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.046900033950805664 |0.0007768869400024414 |0.12950623035430908 |0.00012350082397460938 |0.356270432472229 |0.0027353763580322266 |
----------------------------------------------------------pseudo_mini_loss sum 2.69171142578125
Total (block generation + training)time/epoch 1.2629435724682279
Training time/epoch 1.1705594062805176
Training time without block to device /epoch 1.1690056324005127
Training time without total dataloading part /epoch 0.9745357036590576
load block tensor time/epoch 0.09380006790161133
block to device time/epoch 0.0015537738800048828
input features size transfer per epoch 2.980232238769531e-07
blocks size to device per epoch 1.6391277313232422e-07
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  5309
Number of first layer input nodes during this epoch:  2962
Number of first layer output nodes during this epoch:  1705
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(1433, 1433, batch_first=True)
      (fc_self): Linear(in_features=1433, out_features=2048, bias=False)
      (fc_neigh): Linear(in_features=1433, out_features=2048, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(2048, 2048, batch_first=True)
      (fc_self): Linear(in_features=2048, out_features=2048, bias=False)
      (fc_neigh): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (2): SAGEConv(
      (lstm): LSTM(2048, 2048, batch_first=True)
      (fc_self): Linear(in_features=2048, out_features=7, bias=False)
      (fc_neigh): Linear(in_features=2048, out_features=7, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  97867856
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([5732, 1433])
layers.0.lstm.weight_hh_l0, torch.Size([5732, 1433])
layers.0.lstm.bias_ih_l0, torch.Size([5732])
layers.0.lstm.bias_hh_l0, torch.Size([5732])
layers.0.fc_self.weight, torch.Size([2048, 1433])
layers.0.fc_neigh.weight, torch.Size([2048, 1433])
layers.1.lstm.weight_ih_l0, torch.Size([8192, 2048])
layers.1.lstm.weight_hh_l0, torch.Size([8192, 2048])
layers.1.lstm.bias_ih_l0, torch.Size([8192])
layers.1.lstm.bias_hh_l0, torch.Size([8192])
layers.1.fc_self.weight, torch.Size([2048, 2048])
layers.1.fc_neigh.weight, torch.Size([2048, 2048])
layers.2.lstm.weight_ih_l0, torch.Size([8192, 2048])
layers.2.lstm.weight_hh_l0, torch.Size([8192, 2048])
layers.2.lstm.bias_ih_l0, torch.Size([8192])
layers.2.lstm.bias_hh_l0, torch.Size([8192])
layers.2.fc_self.weight, torch.Size([7, 2048])
layers.2.fc_neigh.weight, torch.Size([7, 2048])
----------------------------------------
un-trainable parameters
