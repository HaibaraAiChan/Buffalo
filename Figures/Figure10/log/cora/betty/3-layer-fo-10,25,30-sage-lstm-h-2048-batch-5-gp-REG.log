main start at this time 1733091928.3983207
-----------------------------------------before load data 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

----------------------------------------start of run function 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  1433
----------------------------------------before model to device 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 0.88623046875 GB
    Memory Allocated: 0.3674592971801758  GigaBytes
Max Memory Allocated: 0.3674592971801758  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 0.88818359375 GB
    Memory Allocated: 0.3674592971801758  GigaBytes
Max Memory Allocated: 0.3674592971801758  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 13.818 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 13.818 GB
Metis partitioning: 0.000 seconds, peak memory: 13.818 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.022102832794189453
pure dgl.metis_partition the time spent:  0.005049943923950195
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.009376287460327148

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.01118326187133789

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.018151283264160156

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 0.88818359375 GB
    Memory Allocated: 0.3674592971801758  GigaBytes
Max Memory Allocated: 0.3674592971801758  GigaBytes

connection checking time:  0.0156707763671875
block generation total time  0.038710832595825195
average batch blocks generation time:  0.007742166519165039
pseudo mini batch 0 input nodes size: 1036
----------------------------------------before load block subtensor 
 Nvidia-smi: 0.88818359375 GB
    Memory Allocated: 0.3674592971801758  GigaBytes
Max Memory Allocated: 0.3674592971801758  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 0.88818359375 GB
    Memory Allocated: 0.3674592971801758  GigaBytes
Max Memory Allocated: 0.3674592971801758  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 0.90771484375 GB
    Memory Allocated: 0.37299013137817383  GigaBytes
Max Memory Allocated: 0.37299013137817383  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 0.90771484375 GB
    Memory Allocated: 0.37299060821533203  GigaBytes
Max Memory Allocated: 0.37299060821533203  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 0.90771484375 GB
    Memory Allocated: 0.37299060821533203  GigaBytes
Max Memory Allocated: 0.37299060821533203  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 8, 1: 3, 6: 3, 5: 3, 9: 2, 10: 2, 4: 2, 2: 2, 12: 2, 21: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 0.90771484375 GB
    Memory Allocated: 0.37302064895629883  GigaBytes
Max Memory Allocated: 0.37302064895629883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 0.90771484375 GB
    Memory Allocated: 0.37302064895629883  GigaBytes
Max Memory Allocated: 0.37302064895629883  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.29638671875 GB
    Memory Allocated: 0.7180595397949219  GigaBytes
Max Memory Allocated: 0.7196803092956543  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.29638671875 GB
    Memory Allocated: 0.7180614471435547  GigaBytes
Max Memory Allocated: 0.7196803092956543  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.74365234375 GB
    Memory Allocated: 0.7535195350646973  GigaBytes
Max Memory Allocated: 1.1069889068603516  GigaBytes

pseudo mini batch 1 input nodes size: 916
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.74365234375 GB
    Memory Allocated: 0.753481388092041  GigaBytes
Max Memory Allocated: 1.1069889068603516  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.74365234375 GB
    Memory Allocated: 0.753481388092041  GigaBytes
Max Memory Allocated: 1.1069889068603516  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.74365234375 GB
    Memory Allocated: 0.7583713531494141  GigaBytes
Max Memory Allocated: 1.1069889068603516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.74365234375 GB
    Memory Allocated: 0.7583718299865723  GigaBytes
Max Memory Allocated: 1.1069889068603516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.74365234375 GB
    Memory Allocated: 0.752840518951416  GigaBytes
Max Memory Allocated: 1.1069889068603516  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 8, 2: 7, 4: 6, 7: 2, 9: 1, 6: 1, 5: 1, 11: 1, 3: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 1.74365234375 GB
    Memory Allocated: 0.7528610229492188  GigaBytes
Max Memory Allocated: 1.1069889068603516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.74365234375 GB
    Memory Allocated: 0.7528610229492188  GigaBytes
Max Memory Allocated: 1.1069889068603516  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.74365234375 GB
    Memory Allocated: 0.9940848350524902  GigaBytes
Max Memory Allocated: 1.1069889068603516  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.74365234375 GB
    Memory Allocated: 0.9940862655639648  GigaBytes
Max Memory Allocated: 1.1069889068603516  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.93115234375 GB
    Memory Allocated: 0.7528896331787109  GigaBytes
Max Memory Allocated: 1.2431387901306152  GigaBytes

pseudo mini batch 2 input nodes size: 874
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.93115234375 GB
    Memory Allocated: 0.7528610229492188  GigaBytes
Max Memory Allocated: 1.2431387901306152  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.93115234375 GB
    Memory Allocated: 0.7528610229492188  GigaBytes
Max Memory Allocated: 1.2431387901306152  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.93115234375 GB
    Memory Allocated: 0.7583918571472168  GigaBytes
Max Memory Allocated: 1.2431387901306152  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.93115234375 GB
    Memory Allocated: 0.758392333984375  GigaBytes
Max Memory Allocated: 1.2431387901306152  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.93115234375 GB
    Memory Allocated: 0.7535018920898438  GigaBytes
Max Memory Allocated: 1.2431387901306152  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 5, 4: 5, 5: 5, 6: 4, 8: 3, 2: 2, 1: 2, 30: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 1.93115234375 GB
    Memory Allocated: 0.7535281181335449  GigaBytes
Max Memory Allocated: 1.2431387901306152  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.93115234375 GB
    Memory Allocated: 0.7535281181335449  GigaBytes
Max Memory Allocated: 1.2431387901306152  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.93115234375 GB
    Memory Allocated: 1.0485620498657227  GigaBytes
Max Memory Allocated: 1.2431387901306152  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.93115234375 GB
    Memory Allocated: 1.0485634803771973  GigaBytes
Max Memory Allocated: 1.2431387901306152  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.93115234375 GB
    Memory Allocated: 0.7535643577575684  GigaBytes
Max Memory Allocated: 1.2973031997680664  GigaBytes

pseudo mini batch 3 input nodes size: 912
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.93115234375 GB
    Memory Allocated: 0.7535319328308105  GigaBytes
Max Memory Allocated: 1.2973031997680664  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.93115234375 GB
    Memory Allocated: 0.7535319328308105  GigaBytes
Max Memory Allocated: 1.2973031997680664  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.93115234375 GB
    Memory Allocated: 0.7584009170532227  GigaBytes
Max Memory Allocated: 1.2973031997680664  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.93115234375 GB
    Memory Allocated: 0.7584013938903809  GigaBytes
Max Memory Allocated: 1.2973031997680664  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.93115234375 GB
    Memory Allocated: 0.7528700828552246  GigaBytes
Max Memory Allocated: 1.2973031997680664  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 9, 3: 4, 1: 4, 4: 4, 5: 2, 6: 2, 10: 1, 7: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 1.93115234375 GB
    Memory Allocated: 0.7528934478759766  GigaBytes
Max Memory Allocated: 1.2973031997680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.93115234375 GB
    Memory Allocated: 0.7528934478759766  GigaBytes
Max Memory Allocated: 1.2973031997680664  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.93115234375 GB
    Memory Allocated: 1.0264034271240234  GigaBytes
Max Memory Allocated: 1.2973031997680664  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.93115234375 GB
    Memory Allocated: 1.026404857635498  GigaBytes
Max Memory Allocated: 1.2973031997680664  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.93115234375 GB
    Memory Allocated: 0.7529268264770508  GigaBytes
Max Memory Allocated: 1.2973031997680664  GigaBytes

pseudo mini batch 4 input nodes size: 681
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.93115234375 GB
    Memory Allocated: 0.752894401550293  GigaBytes
Max Memory Allocated: 1.2973031997680664  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.93115234375 GB
    Memory Allocated: 0.752894401550293  GigaBytes
Max Memory Allocated: 1.2973031997680664  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.93115234375 GB
    Memory Allocated: 0.7565302848815918  GigaBytes
Max Memory Allocated: 1.2973031997680664  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.93115234375 GB
    Memory Allocated: 0.75653076171875  GigaBytes
Max Memory Allocated: 1.2973031997680664  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.93115234375 GB
    Memory Allocated: 0.7516613006591797  GigaBytes
Max Memory Allocated: 1.2973031997680664  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 8, 4: 5, 2: 5, 5: 4, 1: 3, 6: 1, 19: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 1.93115234375 GB
    Memory Allocated: 0.7516789436340332  GigaBytes
Max Memory Allocated: 1.2973031997680664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.93115234375 GB
    Memory Allocated: 0.7516789436340332  GigaBytes
Max Memory Allocated: 1.2973031997680664  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.93115234375 GB
    Memory Allocated: 0.9488654136657715  GigaBytes
Max Memory Allocated: 1.2973031997680664  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.93115234375 GB
    Memory Allocated: 0.9488668441772461  GigaBytes
Max Memory Allocated: 1.2973031997680664  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.93115234375 GB
    Memory Allocated: 0.7517037391662598  GigaBytes
Max Memory Allocated: 1.2973031997680664  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4822049140930176  GigaBytes
Max Memory Allocated: 1.8488783836364746  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.1176180839538574  GigaBytes
Max Memory Allocated: 1.8488783836364746  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06370310783386231 |0.0017217159271240234 |0.31650619506835936 |0.0028516292572021485 |0.24317221641540526 |0.1350390911102295 |
----------------------------------------------------------pseudo_mini_loss sum 1.946083426475525
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  7127
Number of first layer input nodes during this epoch:  4419
Number of first layer output nodes during this epoch:  2036
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.1175098419189453  GigaBytes
Max Memory Allocated: 1.8488783836364746  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.093 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.093 GB
Metis partitioning: 0.000 seconds, peak memory: 16.093 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.002 seconds
REG metis partition end ----................................
REG construction  time spent:  0.010420083999633789
pure dgl.metis_partition the time spent:  0.00453639030456543
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.009223461151123047

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.011753320693969727

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.018520355224609375

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.1175098419189453  GigaBytes
Max Memory Allocated: 1.8488783836364746  GigaBytes

connection checking time:  0.01659560203552246
block generation total time  0.03949713706970215
average batch blocks generation time:  0.00789942741394043
pseudo mini batch 0 input nodes size: 1048
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.1174869537353516  GigaBytes
Max Memory Allocated: 1.8488783836364746  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.1174869537353516  GigaBytes
Max Memory Allocated: 1.8488783836364746  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.1230816841125488  GigaBytes
Max Memory Allocated: 1.8488783836364746  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.123082160949707  GigaBytes
Max Memory Allocated: 1.8488783836364746  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.11944580078125  GigaBytes
Max Memory Allocated: 1.8488783836364746  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 7, 5: 4, 4: 4, 2: 3, 6: 3, 7: 2, 1: 2, 9: 1, 12: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.1194729804992676  GigaBytes
Max Memory Allocated: 1.8488783836364746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.1194729804992676  GigaBytes
Max Memory Allocated: 1.8488783836364746  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4439992904663086  GigaBytes
Max Memory Allocated: 1.8488783836364746  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4440011978149414  GigaBytes
Max Memory Allocated: 1.8488783836364746  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4840798377990723  GigaBytes
Max Memory Allocated: 1.8488783836364746  GigaBytes

pseudo mini batch 1 input nodes size: 989
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4840412139892578  GigaBytes
Max Memory Allocated: 1.8488783836364746  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4840412139892578  GigaBytes
Max Memory Allocated: 1.8488783836364746  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.489321231842041  GigaBytes
Max Memory Allocated: 1.8488783836364746  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4893217086791992  GigaBytes
Max Memory Allocated: 1.8488783836364746  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4837265014648438  GigaBytes
Max Memory Allocated: 1.8488783836364746  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 6, 5: 4, 4: 4, 1: 3, 3: 3, 6: 2, 11: 1, 9: 1, 7: 1, 10: 1, 21: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4837536811828613  GigaBytes
Max Memory Allocated: 1.8488783836364746  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4837536811828613  GigaBytes
Max Memory Allocated: 1.8488783836364746  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.7916169166564941  GigaBytes
Max Memory Allocated: 1.8488783836364746  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.7916183471679688  GigaBytes
Max Memory Allocated: 1.8488783836364746  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4837908744812012  GigaBytes
Max Memory Allocated: 2.0403122901916504  GigaBytes

pseudo mini batch 2 input nodes size: 950
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4837565422058105  GigaBytes
Max Memory Allocated: 2.0403122901916504  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4837565422058105  GigaBytes
Max Memory Allocated: 2.0403122901916504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.488828182220459  GigaBytes
Max Memory Allocated: 2.0403122901916504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4888286590576172  GigaBytes
Max Memory Allocated: 2.0403122901916504  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4835481643676758  GigaBytes
Max Memory Allocated: 2.0403122901916504  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 8, 4: 7, 5: 3, 6: 3, 8: 2, 1: 2, 30: 1, 9: 1, 19: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4835762977600098  GigaBytes
Max Memory Allocated: 2.0403122901916504  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4835762977600098  GigaBytes
Max Memory Allocated: 2.0403122901916504  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.8077516555786133  GigaBytes
Max Memory Allocated: 2.0403122901916504  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.807753086090088  GigaBytes
Max Memory Allocated: 2.0403122901916504  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4836153984069824  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

pseudo mini batch 3 input nodes size: 922
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4835810661315918  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4835810661315918  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4885034561157227  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4885039329528809  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4834318161010742  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 2: 5, 4: 4, 1: 3, 5: 3, 6: 2, 9: 1, 7: 1, 30: 1, 8: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4834561347961426  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4834561347961426  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.7616238594055176  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.7616252899169922  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4834895133972168  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

pseudo mini batch 4 input nodes size: 603
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4834589958190918  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4834589958190918  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4871349334716797  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.487135410308838  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4822125434875488  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 11, 1: 10, 4: 3, 3: 2, 5: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4822263717651367  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4822263717651367  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.6338815689086914  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.633882999420166  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4822454452514648  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4822454452514648  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.1176586151123047  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06699352264404297 |0.0010138511657714843 |0.09932775497436523 |9.489059448242188e-05 |0.25727481842041017 |0.003354787826538086 |
----------------------------------------------------------pseudo_mini_loss sum 60.54644775390625
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  7307
Number of first layer input nodes during this epoch:  4512
Number of first layer output nodes during this epoch:  2120
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.1175403594970703  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.101 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.101 GB
Metis partitioning: 0.000 seconds, peak memory: 16.101 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.003 seconds
REG metis partition end ----................................
REG construction  time spent:  0.008848428726196289
pure dgl.metis_partition the time spent:  0.005106687545776367
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.009176254272460938

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.01145792007446289

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.017124176025390625

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.1175403594970703  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

connection checking time:  0.015527725219726562
block generation total time  0.03775835037231445
average batch blocks generation time:  0.007551670074462891
block dataloader generation time/epoch 0.08321428298950195
pseudo mini batch 0 input nodes size: 943
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.1175212860107422  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.1175212860107422  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.1225557327270508  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.122556209564209  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.118879795074463  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 4: 6, 6: 4, 2: 4, 5: 3, 12: 1, 7: 1, 9: 1, 10: 1, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.1189041137695312  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.1189041137695312  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4086580276489258  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4086599349975586  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4835119247436523  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

pseudo mini batch 1 input nodes size: 729
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4834794998168945  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4834794998168945  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4873857498168945  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4873862266540527  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.482351303100586  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 5, 2: 4, 5: 4, 8: 3, 6: 3, 1: 3, 4: 3, 7: 1, 30: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.482374668121338  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.482374668121338  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.7411808967590332  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.7411823272705078  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4824070930480957  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

pseudo mini batch 2 input nodes size: 616
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4823808670043945  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4823808670043945  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4862871170043945  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4862875938415527  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4823808670043945  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 6, 3: 6, 2: 6, 4: 3, 5: 3, 6: 2, 7: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4823956489562988  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4823956489562988  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.6458306312561035  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.6458320617675781  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4824156761169434  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

pseudo mini batch 3 input nodes size: 1068
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4823975563049316  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4823975563049316  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4880990982055664  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4880995750427246  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4841928482055664  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 4: 5, 2: 4, 10: 2, 5: 2, 1: 2, 12: 1, 30: 1, 19: 1, 7: 1, 11: 1, 6: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4842228889465332  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.4842228889465332  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.8416972160339355  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.66162109375 GB
    Memory Allocated: 1.8416986465454102  GigaBytes
Max Memory Allocated: 2.0564165115356445  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.484264850616455  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

pseudo mini batch 4 input nodes size: 851
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4842262268066406  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4842262268066406  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4889183044433594  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4889187812805176  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4832167625427246  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 8, 2: 7, 4: 5, 5: 3, 3: 3, 21: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4832382202148438  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4832382202148438  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.7346892356872559  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.7346906661987305  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4832687377929688  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4832687377929688  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.1186819076538086  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06395273208618164 |0.0007045745849609375 |0.09305524826049805 |0.00010318756103515625 |0.24161300659179688 |0.002638101577758789 |
----------------------------------------------------------pseudo_mini_loss sum 97.09954071044922
Total (block generation + training)time/epoch 2.185744524002075
Training time/epoch 2.1023595333099365
Training time without block to device /epoch 2.098836660385132
Training time without total dataloading part /epoch 1.6764953136444092
load block tensor time/epoch 0.3197636604309082
block to device time/epoch 0.0035228729248046875
input features size transfer per epoch 7.450580596923828e-07
blocks size to device per epoch 4.0978193283081055e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  6842
Number of first layer input nodes during this epoch:  4207
Number of first layer output nodes during this epoch:  1978
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.1185755729675293  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.197 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.197 GB
Metis partitioning: 0.000 seconds, peak memory: 16.197 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.003 seconds
REG metis partition end ----................................
REG construction  time spent:  0.01022958755493164
pure dgl.metis_partition the time spent:  0.005499601364135742
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.009195327758789062

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.011631011962890625

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.017548084259033203

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.1185755729675293  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

connection checking time:  0.015586376190185547
block generation total time  0.03837442398071289
average batch blocks generation time:  0.007674884796142578
block dataloader generation time/epoch 0.08457863330841064
pseudo mini batch 0 input nodes size: 866
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.118546485900879  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.118546485900879  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.1231698989868164  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.1231703758239746  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.1184778213500977  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 7, 4: 4, 6: 4, 8: 3, 5: 3, 9: 2, 1: 2, 19: 1, 30: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.1185050010681152  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.1185050010681152  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.434321403503418  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4343233108520508  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.483107566833496  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

pseudo mini batch 1 input nodes size: 745
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4830751419067383  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4830751419067383  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4870524406433105  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4870529174804688  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.482429027557373  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 8, 2: 7, 3: 5, 5: 4, 6: 2, 4: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4824457168579102  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4824457168579102  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.668778419494629  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.6687798500061035  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.482468605041504  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

pseudo mini batch 2 input nodes size: 892
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4824461936950684  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4824461936950684  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.487208366394043  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4872088432312012  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4832310676574707  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 9, 4: 7, 5: 3, 3: 3, 1: 2, 7: 2, 6: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4832525253295898  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4832525253295898  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.7368059158325195  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.7368073463439941  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4832830429077148  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

pseudo mini batch 3 input nodes size: 1016
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4832544326782227  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4832544326782227  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4886784553527832  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4886789321899414  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4839162826538086  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 5, 2: 4, 1: 3, 5: 3, 6: 3, 4: 3, 10: 2, 12: 1, 9: 1, 7: 1, 21: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.483945369720459  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.483945369720459  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.813957691192627  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.8139591217041016  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.483985424041748  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

pseudo mini batch 4 input nodes size: 772
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4839491844177246  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4839491844177246  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4880704879760742  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4880709648132324  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4826464653015137  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 7, 3: 6, 2: 5, 1: 5, 5: 2, 12: 1, 6: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.482666015625  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.482666015625  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.711575984954834  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.7115774154663086  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4826927185058594  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4826927185058594  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.1181058883666992  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06429848670959473 |0.0007042884826660156 |0.0897667407989502 |9.989738464355469e-05 |0.22330150604248047 |0.0031223297119140625 |
----------------------------------------------------------pseudo_mini_loss sum 219.2191925048828
Total (block generation + training)time/epoch 2.1345670223236084
Training time/epoch 1.9972882270812988
Training time without block to device /epoch 1.9937667846679688
Training time without total dataloading part /epoch 1.5689630508422852
load block tensor time/epoch 0.32149243354797363
block to device time/epoch 0.003521442413330078
input features size transfer per epoch 7.450580596923828e-07
blocks size to device per epoch 4.0978193283081055e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  6918
Number of first layer input nodes during this epoch:  4291
Number of first layer output nodes during this epoch:  1964
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.1179990768432617  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.197 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.197 GB
Metis partitioning: 0.000 seconds, peak memory: 16.197 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.003 seconds
REG metis partition end ----................................
REG construction  time spent:  0.008805036544799805
pure dgl.metis_partition the time spent:  0.005089998245239258
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.00931239128112793

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.011426687240600586

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.017826318740844727

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.1179990768432617  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

connection checking time:  0.015726089477539062
block generation total time  0.03856539726257324
average batch blocks generation time:  0.0077130794525146484
block dataloader generation time/epoch 0.08427667617797852
pseudo mini batch 0 input nodes size: 705
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.1179723739624023  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.1179723739624023  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.1218786239624023  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.1218791007995605  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.1177573204040527  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 6, 1: 4, 4: 3, 3: 3, 8: 3, 5: 3, 6: 3, 7: 1, 30: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.1177797317504883  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.1177797317504883  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.3635897636413574  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.3635916709899902  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4823780059814453  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

pseudo mini batch 1 input nodes size: 683
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4823517799377441  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4823517799377441  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4862580299377441  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4862585067749023  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4823517799377441  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 8, 4: 6, 5: 4, 1: 4, 3: 3, 6: 1, 9: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4823684692382812  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4823684692382812  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.6730380058288574  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.673039436340332  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.482391357421875  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

pseudo mini batch 2 input nodes size: 768
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4823689460754395  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4823689460754395  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4870610237121582  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4870615005493164  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4831547737121582  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 7, 3: 5, 2: 5, 5: 4, 6: 3, 4: 3, 19: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4831733703613281  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4831733703613281  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.698096752166748  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.6980981826782227  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.483199119567871  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

pseudo mini batch 3 input nodes size: 1087
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4831748008728027  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4831748008728027  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4889779090881348  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.488978385925293  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.484285831451416  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 7, 2: 3, 6: 3, 5: 3, 4: 3, 10: 2, 1: 2, 12: 2, 21: 1, 9: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4843168258666992  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.4843168258666992  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.8386859893798828  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.72412109375 GB
    Memory Allocated: 1.8386874198913574  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.4843597412109375  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

pseudo mini batch 4 input nodes size: 1060
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.4843192100524902  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.4843192100524902  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.489978313446045  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.4899787902832031  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.484175205230713  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 8, 4: 7, 1: 3, 2: 3, 7: 2, 9: 1, 5: 1, 30: 1, 10: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.4842033386230469  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.4842033386230469  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.8071603775024414  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.807161808013916  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.4842414855957031  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.4842414855957031  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.119654655456543  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06358923912048339 |0.0007285118103027344 |0.09002141952514649 |9.989738464355469e-05 |0.2303755283355713 |0.003382444381713867 |
----------------------------------------------------------pseudo_mini_loss sum 124.94910430908203
Total (block generation + training)time/epoch 2.128195603688558
Training time/epoch 2.031665802001953
Training time without block to device /epoch 2.0280232429504395
Training time without total dataloading part /epoch 1.6058666706085205
load block tensor time/epoch 0.317946195602417
block to device time/epoch 0.003642559051513672
input features size transfer per epoch 7.450580596923828e-07
blocks size to device per epoch 4.0978193283081055e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  6961
Number of first layer input nodes during this epoch:  4303
Number of first layer output nodes during this epoch:  1996
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.1195569038391113  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.234 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.234 GB
Metis partitioning: 0.000 seconds, peak memory: 16.234 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.003 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009319067001342773
pure dgl.metis_partition the time spent:  0.005120038986206055
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.009246587753295898

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.01134800910949707

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.017699241638183594

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.1195569038391113  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

connection checking time:  0.015634536743164062
block generation total time  0.03829383850097656
average batch blocks generation time:  0.007658767700195313
block dataloader generation time/epoch 0.08421856164932251
pseudo mini batch 0 input nodes size: 634
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.1195201873779297  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.1195201873779297  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.1234264373779297  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.123426914215088  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.117767333984375  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 5, 5: 4, 4: 4, 3: 3, 1: 3, 8: 3, 6: 3, 9: 1, 30: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.1177887916564941  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.1177887916564941  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.343522548675537  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.34352445602417  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.482375144958496  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

pseudo mini batch 1 input nodes size: 624
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.4823508262634277  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.4823508262634277  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.4862570762634277  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.486257553100586  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.4823508262634277  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 8, 3: 5, 4: 4, 1: 4, 6: 3, 5: 3, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.4823665618896484  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.4823665618896484  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.67210054397583  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.6721019744873047  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.4823884963989258  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

pseudo mini batch 2 input nodes size: 937
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.482367992401123  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.482367992401123  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.487370491027832  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.4873709678649902  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.483464241027832  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 7, 3: 7, 4: 4, 2: 3, 5: 2, 19: 1, 7: 1, 12: 1, 9: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.4834885597229004  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.4834885597229004  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.758122444152832  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.7581238746643066  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.4835219383239746  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

pseudo mini batch 3 input nodes size: 1112
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.4834914207458496  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.4834914207458496  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.4894280433654785  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.4894285202026367  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.4844255447387695  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 5: 4, 4: 4, 2: 3, 6: 3, 9: 2, 10: 2, 21: 1, 12: 1, 1: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.4844565391540527  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.72607421875 GB
    Memory Allocated: 1.4844565391540527  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.8502440452575684  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.850245475769043  GigaBytes
Max Memory Allocated: 2.090278148651123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.484499454498291  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

pseudo mini batch 4 input nodes size: 981
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4844589233398438  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4844589233398438  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4896960258483887  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4896965026855469  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4837594032287598  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 6, 4: 6, 1: 5, 3: 5, 5: 2, 7: 2, 6: 2})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4837827682495117  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4837827682495117  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7473039627075195  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7473053932189941  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4838151931762695  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4838151931762695  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1192283630371094  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06423144340515137 |0.0007258892059326172 |0.09236764907836914 |9.984970092773438e-05 |0.23046207427978516 |0.002998828887939453 |
----------------------------------------------------------pseudo_mini_loss sum 154.9053192138672
Total (block generation + training)time/epoch 2.1291263699531555
Training time/epoch 2.0477521419525146
Training time without block to device /epoch 2.0441226959228516
Training time without total dataloading part /epoch 1.6176466941833496
load block tensor time/epoch 0.32115721702575684
block to device time/epoch 0.003629446029663086
input features size transfer per epoch 7.450580596923828e-07
blocks size to device per epoch 4.0978193283081055e-07
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  6917
Number of first layer input nodes during this epoch:  4288
Number of first layer output nodes during this epoch:  1975
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.119124412536621  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.234 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.234 GB
Metis partitioning: 0.000 seconds, peak memory: 16.234 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.003 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009633064270019531
pure dgl.metis_partition the time spent:  0.005020618438720703
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.009196043014526367

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.011993646621704102

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.018845558166503906

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.119124412536621  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

connection checking time:  0.01658463478088379
block generation total time  0.040035247802734375
average batch blocks generation time:  0.008007049560546875
block dataloader generation time/epoch 0.08548593521118164
pseudo mini batch 0 input nodes size: 1120
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.119091510772705  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.119091510772705  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.125070571899414  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1250710487365723  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1198334693908691  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 8, 4: 6, 6: 3, 2: 2, 5: 2, 21: 1, 12: 1, 11: 1, 1: 1, 10: 1, 7: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1198644638061523  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1198644638061523  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4791522026062012  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.479154109954834  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4844717979431152  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

pseudo mini batch 1 input nodes size: 1001
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.484431266784668  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.484431266784668  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4904212951660156  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4904217720031738  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4844422340393066  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 7, 5: 5, 4: 4, 1: 3, 2: 3, 6: 2, 9: 1, 10: 1, 12: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4844675064086914  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4844675064086914  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7832331657409668  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7832345962524414  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4845037460327148  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

pseudo mini batch 2 input nodes size: 763
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4844694137573242  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4844694137573242  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4885430335998535  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4885435104370117  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4825530052185059  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 6, 3: 5, 4: 5, 2: 5, 5: 3, 6: 2, 19: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4825716018676758  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4825716018676758  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.70554780960083  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7055492401123047  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4825973510742188  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

pseudo mini batch 3 input nodes size: 860
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4825730323791504  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4825730323791504  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.48716402053833  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4871644973754883  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4830904006958008  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 8, 3: 4, 4: 4, 5: 3, 1: 3, 8: 2, 6: 2, 30: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4831147193908691  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4831147193908691  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.757920742034912  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7579221725463867  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4831480979919434  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

pseudo mini batch 4 input nodes size: 927
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4831175804138184  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4831175804138184  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4880666732788086  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4880671501159668  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483475685119629  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 7, 2: 7, 4: 3, 5: 2, 7: 2, 3: 2, 6: 2, 8: 1, 9: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483497142791748  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483497142791748  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7389655113220215  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.738966941833496  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483527660369873  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483527660369873  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.118940830230713  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06491179466247558 |0.0007167339324951171 |0.09665489196777344 |9.737014770507812e-05 |0.2517693996429443 |0.0035054683685302734 |
----------------------------------------------------------pseudo_mini_loss sum 82.95716094970703
Total (block generation + training)time/epoch 2.15681734085083
Training time/epoch 2.17692494392395
Training time without block to device /epoch 2.1733412742614746
Training time without total dataloading part /epoch 1.7461137771606445
load block tensor time/epoch 0.32455897331237793
block to device time/epoch 0.003583669662475586
input features size transfer per epoch 7.450580596923828e-07
blocks size to device per epoch 4.0978193283081055e-07
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  7480
Number of first layer input nodes during this epoch:  4671
Number of first layer output nodes during this epoch:  2138
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1188325881958008  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.234 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.234 GB
Metis partitioning: 0.000 seconds, peak memory: 16.234 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.003 seconds
REG metis partition end ----................................
REG construction  time spent:  0.00945138931274414
pure dgl.metis_partition the time spent:  0.005093812942504883
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.009197711944580078

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.011588811874389648

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.01796722412109375

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1188325881958008  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

connection checking time:  0.01613616943359375
block generation total time  0.03875374794006348
average batch blocks generation time:  0.007750749588012695
block dataloader generation time/epoch 0.0854571262995402
pseudo mini batch 0 input nodes size: 989
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1188015937805176  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1188015937805176  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1240816116333008  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.124082088470459  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1191325187683105  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 4: 5, 6: 5, 2: 5, 5: 2, 7: 1, 1: 1, 10: 1, 12: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1191577911376953  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1191577911376953  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4253273010253906  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4253292083740234  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4837603569030762  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

pseudo mini batch 1 input nodes size: 881
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4837260246276855  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4837260246276855  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4884295463562012  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4884300231933594  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483149528503418  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 6, 1: 5, 5: 4, 4: 3, 3: 3, 9: 2, 6: 1, 10: 1, 21: 1, 11: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4831748008728027  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4831748008728027  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7667627334594727  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7667641639709473  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4832100868225098  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

pseudo mini batch 2 input nodes size: 785
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4831795692443848  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4831795692443848  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.487370491027832  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4873709678649902  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4826669692993164  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 6, 3: 5, 1: 4, 6: 3, 2: 3, 5: 3, 8: 2, 9: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4826903343200684  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4826903343200684  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7372865676879883  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.737287998199463  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4827218055725098  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

pseudo mini batch 3 input nodes size: 571
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4826936721801758  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4826936721801758  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4865999221801758  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.486600399017334  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4824090003967285  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 8, 5: 5, 3: 5, 2: 5, 4: 3, 8: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4824237823486328  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4824237823486328  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.6473369598388672  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.6473383903503418  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4824447631835938  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

pseudo mini batch 4 input nodes size: 1001
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4824261665344238  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4824261665344238  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4877700805664062  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4877705574035645  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4838638305664062  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 7, 2: 6, 4: 5, 7: 2, 1: 2, 6: 1, 12: 1, 5: 1, 30: 1, 10: 1, 19: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4838910102844238  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4838910102844238  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.799135684967041  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7991371154785156  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4839282035827637  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4839282035827637  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1193413734436035  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06291432380676269 |0.0007223129272460937 |0.09254388809204102 |0.00010542869567871093 |0.23817524909973145 |0.003009796142578125 |
----------------------------------------------------------pseudo_mini_loss sum 67.36073303222656
Total (block generation + training)time/epoch 2.1582797368367515
Training time/epoch 2.0801761150360107
Training time without block to device /epoch 2.0765645503997803
Training time without total dataloading part /epoch 1.657132625579834
load block tensor time/epoch 0.3145716190338135
block to device time/epoch 0.0036115646362304688
input features size transfer per epoch 7.450580596923828e-07
blocks size to device per epoch 4.0978193283081055e-07
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  6891
Number of first layer input nodes during this epoch:  4227
Number of first layer output nodes during this epoch:  2000
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1192398071289062  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.234 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.234 GB
Metis partitioning: 0.000 seconds, peak memory: 16.234 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.003 seconds
REG metis partition end ----................................
REG construction  time spent:  0.010225534439086914
pure dgl.metis_partition the time spent:  0.005335807800292969
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.009254932403564453

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.011516332626342773

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.018702268600463867

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1192398071289062  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

connection checking time:  0.01648688316345215
block generation total time  0.039473533630371094
average batch blocks generation time:  0.00789470672607422
block dataloader generation time/epoch 0.08574948992047991
pseudo mini batch 0 input nodes size: 1059
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1192049980163574  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1192049980163574  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1248583793640137  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1248588562011719  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1195144653320312  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 4: 4, 6: 4, 2: 3, 5: 3, 1: 2, 10: 2, 11: 1, 21: 1, 12: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.119544506072998  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.119544506072998  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4550795555114746  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4550814628601074  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4841432571411133  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

pseudo mini batch 1 input nodes size: 1049
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.484105110168457  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.484105110168457  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4897050857543945  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4897055625915527  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4840517044067383  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 1: 6, 4: 5, 2: 4, 7: 3, 6: 1, 12: 1, 30: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4840779304504395  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4840779304504395  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.789304256439209  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7893056869506836  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4841151237487793  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

pseudo mini batch 2 input nodes size: 736
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4840788841247559  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4840788841247559  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4887709617614746  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4887714385986328  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483170986175537  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 10, 4: 5, 3: 4, 5: 4, 1: 4, 19: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4831886291503906  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4831886291503906  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.6861333847045898  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.6861348152160645  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4832134246826172  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

pseudo mini batch 3 input nodes size: 929
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4831910133361816  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4831910133361816  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4881505966186523  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4881510734558105  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4834585189819336  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 5: 4, 1: 4, 2: 4, 6: 3, 8: 3, 4: 3, 9: 2, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4834856986999512  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4834856986999512  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7956981658935547  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7956995964050293  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483522891998291  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

pseudo mini batch 4 input nodes size: 846
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4834885597229004  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4834885597229004  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4881806373596191  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4881811141967773  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4832210540771484  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 4: 5, 1: 4, 2: 4, 5: 3, 6: 3, 9: 1, 7: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4832406044006348  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4832406044006348  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7129020690917969  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7129034996032715  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4832682609558105  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4832682609558105  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1186814308166504  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06496882438659668 |0.0007049560546875 |0.0914036750793457 |9.865760803222657e-05 |0.2323378562927246 |0.003521442413330078 |
----------------------------------------------------------pseudo_mini_loss sum 37.413204193115234
Total (block generation + training)time/epoch 2.1559854234967912
Training time/epoch 2.054612636566162
Training time without block to device /epoch 2.0510878562927246
Training time without total dataloading part /epoch 1.6227223873138428
load block tensor time/epoch 0.3248441219329834
block to device time/epoch 0.0035247802734375
input features size transfer per epoch 7.450580596923828e-07
blocks size to device per epoch 4.0978193283081055e-07
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  7395
Number of first layer input nodes during this epoch:  4619
Number of first layer output nodes during this epoch:  2093
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1185708045959473  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.234 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.234 GB
Metis partitioning: 0.001 seconds, peak memory: 16.234 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.003 seconds
REG metis partition end ----................................
REG construction  time spent:  0.008655548095703125
pure dgl.metis_partition the time spent:  0.0049855709075927734
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.009174585342407227

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.011292457580566406

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.01898813247680664

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1185708045959473  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

connection checking time:  0.01616215705871582
block generation total time  0.03945517539978027
average batch blocks generation time:  0.007891035079956055
block dataloader generation time/epoch 0.08566927909851074
pseudo mini batch 0 input nodes size: 667
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.118544101715088  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.118544101715088  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.122450351715088  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.122450828552246  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1177582740783691  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 7, 1: 7, 4: 4, 5: 3, 3: 3, 6: 2, 10: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1177749633789062  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1177749633789062  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.2992472648620605  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.2992491722106934  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4823646545410156  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

pseudo mini batch 1 input nodes size: 896
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.48234224319458  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.48234224319458  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4871253967285156  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4871258735656738  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4832191467285156  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 8, 1: 5, 2: 4, 5: 4, 6: 3, 4: 2, 7: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4832396507263184  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4832396507263184  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7273306846618652  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7273321151733398  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4832673072814941  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

pseudo mini batch 2 input nodes size: 753
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4832391738891602  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4832391738891602  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4872593879699707  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.487259864807129  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4824762344360352  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 7, 3: 5, 2: 4, 8: 3, 1: 3, 5: 2, 6: 2, 30: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.482499599456787  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.482499599456787  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7373509407043457  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7373523712158203  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4825310707092285  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

pseudo mini batch 3 input nodes size: 1129
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4825029373168945  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4825029373168945  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.488530158996582  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4885306358337402  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4845099449157715  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 4: 4, 5: 4, 2: 3, 6: 3, 1: 2, 10: 2, 9: 1, 11: 1, 21: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4845409393310547  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4845409393310547  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.8519096374511719  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.8519110679626465  GigaBytes
Max Memory Allocated: 2.0982370376586914  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.484583854675293  GigaBytes
Max Memory Allocated: 2.100666046142578  GigaBytes

pseudo mini batch 4 input nodes size: 1032
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4845433235168457  GigaBytes
Max Memory Allocated: 2.100666046142578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4845433235168457  GigaBytes
Max Memory Allocated: 2.100666046142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4900527000427246  GigaBytes
Max Memory Allocated: 2.100666046142578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4900531768798828  GigaBytes
Max Memory Allocated: 2.100666046142578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.484025478363037  GigaBytes
Max Memory Allocated: 2.100666046142578  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 7, 4: 5, 3: 4, 1: 3, 7: 2, 5: 2, 19: 1, 30: 1, 9: 1, 6: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4840545654296875  GigaBytes
Max Memory Allocated: 2.100666046142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4840545654296875  GigaBytes
Max Memory Allocated: 2.100666046142578  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.8118772506713867  GigaBytes
Max Memory Allocated: 2.100666046142578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.8118786811828613  GigaBytes
Max Memory Allocated: 2.100666046142578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4840946197509766  GigaBytes
Max Memory Allocated: 2.100666046142578  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4840946197509766  GigaBytes
Max Memory Allocated: 2.100666046142578  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1195077896118164  GigaBytes
Max Memory Allocated: 2.100666046142578  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06369094848632813 |0.0007108688354492187 |0.09516568183898926 |0.00010447502136230468 |0.24702901840209962 |0.0032165050506591797 |
----------------------------------------------------------pseudo_mini_loss sum 27.211254119873047
Total (block generation + training)time/epoch 2.1649201810359955
Training time/epoch 2.142230749130249
Training time without block to device /epoch 2.138676404953003
Training time without total dataloading part /epoch 1.714712381362915
load block tensor time/epoch 0.3184547424316406
block to device time/epoch 0.0035543441772460938
input features size transfer per epoch 7.450580596923828e-07
blocks size to device per epoch 4.0978193283081055e-07
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  7218
Number of first layer input nodes during this epoch:  4477
Number of first layer output nodes during this epoch:  2070
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1194100379943848  GigaBytes
Max Memory Allocated: 2.100666046142578  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.234 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.234 GB
Metis partitioning: 0.000 seconds, peak memory: 16.234 GB
Split the graph: 0.002 seconds
Construct subgraphs: 0.003 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009420156478881836
pure dgl.metis_partition the time spent:  0.00565791130065918
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.009197235107421875

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.01130533218383789

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.01826310157775879

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1194100379943848  GigaBytes
Max Memory Allocated: 2.100666046142578  GigaBytes

connection checking time:  0.016048908233642578
block generation total time  0.038765668869018555
average batch blocks generation time:  0.007753133773803711
block dataloader generation time/epoch 0.08572530746459961
pseudo mini batch 0 input nodes size: 892
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1193733215332031  GigaBytes
Max Memory Allocated: 2.100666046142578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1193733215332031  GigaBytes
Max Memory Allocated: 2.100666046142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1241354942321777  GigaBytes
Max Memory Allocated: 2.100666046142578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.124135971069336  GigaBytes
Max Memory Allocated: 2.100666046142578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1186261177062988  GigaBytes
Max Memory Allocated: 2.100666046142578  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 7, 1: 6, 3: 6, 10: 2, 7: 1, 12: 1, 8: 1, 5: 1, 6: 1, 4: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1186504364013672  GigaBytes
Max Memory Allocated: 2.100666046142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1186504364013672  GigaBytes
Max Memory Allocated: 2.100666046142578  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.3870301246643066  GigaBytes
Max Memory Allocated: 2.100666046142578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.3870320320129395  GigaBytes
Max Memory Allocated: 2.100666046142578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483238697052002  GigaBytes
Max Memory Allocated: 2.100666046142578  GigaBytes

pseudo mini batch 1 input nodes size: 1147
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483208179473877  GigaBytes
Max Memory Allocated: 2.100666046142578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483208179473877  GigaBytes
Max Memory Allocated: 2.100666046142578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4893317222595215  GigaBytes
Max Memory Allocated: 2.100666046142578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4893321990966797  GigaBytes
Max Memory Allocated: 2.100666046142578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4845695495605469  GigaBytes
Max Memory Allocated: 2.100666046142578  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 5, 3: 5, 4: 4, 5: 3, 6: 3, 9: 2, 7: 1, 12: 1, 10: 1, 1: 1, 11: 1, 21: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4846014976501465  GigaBytes
Max Memory Allocated: 2.100666046142578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4846014976501465  GigaBytes
Max Memory Allocated: 2.100666046142578  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.860565185546875  GigaBytes
Max Memory Allocated: 2.100666046142578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.8605666160583496  GigaBytes
Max Memory Allocated: 2.100666046142578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4846453666687012  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

pseudo mini batch 2 input nodes size: 924
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.484602928161621  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.484602928161621  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4895358085632324  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4895362854003906  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483412265777588  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 7, 3: 5, 5: 5, 1: 4, 6: 3, 2: 3, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483433723449707  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483433723449707  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7322392463684082  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7322406768798828  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4834623336791992  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

pseudo mini batch 3 input nodes size: 743
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4834322929382324  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4834322929382324  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4873991012573242  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4873995780944824  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.482466220855713  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 7, 4: 6, 2: 3, 1: 3, 9: 2, 6: 2, 5: 2, 8: 2, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4824895858764648  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4824895858764648  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7387080192565918  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7387094497680664  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4825210571289062  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

pseudo mini batch 4 input nodes size: 733
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4824929237365723  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4824929237365723  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4871244430541992  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4871249198913574  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4831576347351074  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 7, 1: 6, 5: 4, 4: 4, 3: 3, 6: 2, 19: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483175277709961  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483175277709961  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.686854362487793  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.6868557929992676  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4832000732421875  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4832000732421875  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1186132431030273  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06407065391540527 |0.0007218360900878906 |0.09077348709106445 |9.684562683105468e-05 |0.22860994338989257 |0.0031642913818359375 |
----------------------------------------------------------pseudo_mini_loss sum 29.10137176513672
Total (block generation + training)time/epoch 2.1590110725826688
Training time/epoch 2.025463342666626
Training time without block to device /epoch 2.0218541622161865
Training time without total dataloading part /epoch 1.6005656719207764
load block tensor time/epoch 0.32035326957702637
block to device time/epoch 0.003609180450439453
input features size transfer per epoch 7.450580596923828e-07
blocks size to device per epoch 4.0978193283081055e-07
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  7143
Number of first layer input nodes during this epoch:  4439
Number of first layer output nodes during this epoch:  2037
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1185054779052734  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.234 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.234 GB
Metis partitioning: 0.001 seconds, peak memory: 16.234 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.003 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009561538696289062
pure dgl.metis_partition the time spent:  0.0049855709075927734
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.009120464324951172

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.01192331314086914

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.019635677337646484

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1185054779052734  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

connection checking time:  0.016204833984375
block generation total time  0.0406794548034668
average batch blocks generation time:  0.00813589096069336
block dataloader generation time/epoch 0.08593010902404785
pseudo mini batch 0 input nodes size: 782
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1184825897216797  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1184825897216797  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.122657299041748  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1226577758789062  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.118025779724121  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 5, 2: 4, 4: 4, 6: 4, 5: 4, 8: 2, 11: 1, 1: 1, 10: 1, 30: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1180500984191895  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1180500984191895  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.3940138816833496  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.3940157890319824  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4826512336730957  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

pseudo mini batch 1 input nodes size: 680
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4826231002807617  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4826231002807617  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4865293502807617  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.48652982711792  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4823546409606934  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 8, 2: 6, 4: 5, 3: 3, 6: 2, 5: 2, 7: 2})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4823713302612305  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4823713302612305  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.6669654846191406  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.6669669151306152  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4823942184448242  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

pseudo mini batch 2 input nodes size: 727
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4823718070983887  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4823718070983887  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4862780570983887  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4862785339355469  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4823718070983887  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 8, 2: 7, 1: 5, 4: 3, 6: 1, 9: 1, 7: 1, 8: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4823894500732422  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4823894500732422  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.683642864227295  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.6836442947387695  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4824142456054688  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

pseudo mini batch 3 input nodes size: 1148
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4823918342590332  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4823918342590332  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.488520622253418  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4885210990905762  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.484614372253418  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 5, 5: 5, 2: 4, 1: 4, 3: 4, 6: 1, 30: 1, 10: 1, 19: 1, 12: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4846453666687012  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4846453666687012  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.8362960815429688  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.8362975120544434  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4846882820129395  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

pseudo mini batch 4 input nodes size: 1024
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4846477508544922  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4846477508544922  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4901142120361328  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.490114688873291  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483985424041748  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 4: 5, 2: 4, 5: 3, 6: 3, 9: 2, 1: 2, 12: 1, 10: 1, 21: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4840145111083984  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4840145111083984  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.8139681816101074  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.813969612121582  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4840545654296875  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4840545654296875  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1194677352905273  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06361823081970215 |0.0007206439971923828 |0.1271148681640625 |0.00010709762573242187 |0.24004979133605958 |0.002955913543701172 |
----------------------------------------------------------pseudo_mini_loss sum 23.144927978515625
Total (block generation + training)time/epoch 2.178445744514465
Training time/epoch 2.2654385566711426
Training time without block to device /epoch 2.2618353366851807
Training time without total dataloading part /epoch 1.8393146991729736
load block tensor time/epoch 0.31809115409851074
block to device time/epoch 0.003603219985961914
input features size transfer per epoch 7.450580596923828e-07
blocks size to device per epoch 4.0978193283081055e-07
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  7054
Number of first layer input nodes during this epoch:  4361
Number of first layer output nodes during this epoch:  2027
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1193671226501465  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.234 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.234 GB
Metis partitioning: 0.000 seconds, peak memory: 16.234 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.003 seconds
REG metis partition end ----................................
REG construction  time spent:  0.010445833206176758
pure dgl.metis_partition the time spent:  0.005266427993774414
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.009171247482299805

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.01154184341430664

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.018234729766845703

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1193671226501465  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

connection checking time:  0.01651287078857422
block generation total time  0.03894782066345215
average batch blocks generation time:  0.0077895641326904295
block dataloader generation time/epoch 0.08599320324984464
pseudo mini batch 0 input nodes size: 744
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1193304061889648  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1193304061889648  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1233024597167969  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.123302936553955  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1178359985351562  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 7, 4: 5, 3: 5, 1: 4, 5: 3, 6: 2, 9: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1178536415100098  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1178536415100098  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.317265510559082  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.3172674179077148  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4824323654174805  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

pseudo mini batch 1 input nodes size: 918
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.482408046722412  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.482408046722412  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4873089790344238  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.487309455871582  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4833369255065918  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 7, 3: 6, 1: 6, 2: 5, 6: 2, 10: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4833574295043945  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4833574295043945  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7256765365600586  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7256779670715332  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4833850860595703  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

pseudo mini batch 2 input nodes size: 770
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4833569526672363  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4833569526672363  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.488049030303955  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4880495071411133  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4831480979919434  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 5, 2: 5, 5: 4, 4: 3, 8: 3, 1: 3, 6: 2, 9: 2, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4831724166870117  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4831724166870117  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7499923706054688  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7499938011169434  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483205795288086  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

pseudo mini batch 3 input nodes size: 1015
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483177661895752  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483177661895752  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4885964393615723  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4885969161987305  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4839043617248535  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 6: 3, 1: 3, 2: 3, 5: 3, 4: 3, 10: 2, 9: 1, 21: 1, 11: 1, 7: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483933448791504  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483933448791504  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.812849998474121  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.8128514289855957  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483973503112793  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

pseudo mini batch 4 input nodes size: 1039
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4839372634887695  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4839372634887695  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4894838333129883  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4894843101501465  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.484065055847168  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 5, 5: 5, 1: 4, 4: 4, 3: 4, 6: 2, 12: 1, 7: 1, 19: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.484093189239502  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.484093189239502  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.8098063468933105  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.8098077774047852  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4841313362121582  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4841313362121582  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.119544506072998  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0634763240814209 |0.0006957054138183594 |0.09290986061096192 |0.00010061264038085938 |0.2374492645263672 |0.0030982494354248047 |
----------------------------------------------------------pseudo_mini_loss sum 13.514949798583984
Total (block generation + training)time/epoch 2.1772617643529717
Training time/epoch 2.078692674636841
Training time without block to device /epoch 2.075214147567749
Training time without total dataloading part /epoch 1.6553969383239746
load block tensor time/epoch 0.3173816204071045
block to device time/epoch 0.003478527069091797
input features size transfer per epoch 7.450580596923828e-07
blocks size to device per epoch 4.0978193283081055e-07
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  7197
Number of first layer input nodes during this epoch:  4486
Number of first layer output nodes during this epoch:  2046
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1194443702697754  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.234 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.234 GB
Metis partitioning: 0.000 seconds, peak memory: 16.234 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.003 seconds
REG metis partition end ----................................
REG construction  time spent:  0.010567903518676758
pure dgl.metis_partition the time spent:  0.00523066520690918
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.00922703742980957

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.011695384979248047

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.018192291259765625

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1194443702697754  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

connection checking time:  0.015979528427124023
block generation total time  0.03911471366882324
average batch blocks generation time:  0.007822942733764649
block dataloader generation time/epoch 0.0860367218653361
pseudo mini batch 0 input nodes size: 1073
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1194076538085938  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1194076538085938  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.125135898590088  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.125136375427246  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1195893287658691  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 6: 3, 5: 3, 2: 3, 4: 3, 12: 2, 1: 2, 10: 2, 21: 1, 7: 1, 9: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.119619369506836  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.119619369506836  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.469670295715332  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4696722030639648  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4842190742492676  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

pseudo mini batch 1 input nodes size: 1022
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4841804504394531  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4841804504394531  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4896364212036133  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4896368980407715  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4839081764221191  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 6, 4: 6, 3: 4, 1: 4, 5: 3, 7: 2, 6: 1, 9: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483931541442871  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483931541442871  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7587146759033203  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.758716106414795  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483963966369629  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

pseudo mini batch 2 input nodes size: 943
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483931541442871  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483931541442871  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4889659881591797  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.488966464996338  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4835100173950195  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 5, 3: 5, 4: 3, 8: 3, 1: 3, 5: 3, 30: 2, 6: 2, 19: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4835381507873535  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4835381507873535  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.8078627586364746  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.8078641891479492  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4835772514343262  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

pseudo mini batch 3 input nodes size: 638
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4835429191589355  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4835429191589355  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4871068000793457  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.487107276916504  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.482072353363037  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 7, 3: 6, 4: 5, 2: 4, 5: 3, 6: 2, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4820880889892578  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4820880889892578  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.657559871673584  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.6575613021850586  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4821100234985352  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

pseudo mini batch 4 input nodes size: 888
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4820895195007324  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4820895195007324  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.487123966217041  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4871244430541992  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4835600852966309  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 7, 3: 5, 4: 5, 1: 4, 5: 3, 6: 3, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4835805892944336  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4835805892944336  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.715528964996338  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7155303955078125  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4836082458496094  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4836082458496094  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1190214157104492  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06385126113891601 |0.0006930351257324219 |0.09154510498046875 |9.474754333496093e-05 |0.2295376777648926 |0.0031518936157226562 |
----------------------------------------------------------pseudo_mini_loss sum 11.06453800201416
Total (block generation + training)time/epoch 2.172603646914164
Training time/epoch 2.0347468852996826
Training time without block to device /epoch 2.0312817096710205
Training time without total dataloading part /epoch 1.609039545059204
load block tensor time/epoch 0.3192563056945801
block to device time/epoch 0.0034651756286621094
input features size transfer per epoch 7.450580596923828e-07
blocks size to device per epoch 4.0978193283081055e-07
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  7278
Number of first layer input nodes during this epoch:  4564
Number of first layer output nodes during this epoch:  2050
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1189141273498535  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.234 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.234 GB
Metis partitioning: 0.001 seconds, peak memory: 16.234 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.003 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009283304214477539
pure dgl.metis_partition the time spent:  0.0051822662353515625
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.009158849716186523

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.012270212173461914

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.018187284469604492

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1189141273498535  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

connection checking time:  0.015964031219482422
block generation total time  0.03961634635925293
average batch blocks generation time:  0.007923269271850586
block dataloader generation time/epoch 0.08597984680762658
pseudo mini batch 0 input nodes size: 965
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1188855171203613  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1188855171203613  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.124037265777588  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.124037742614746  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1190028190612793  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 2: 4, 4: 3, 8: 3, 6: 3, 5: 3, 30: 2, 9: 1, 1: 1, 19: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.119032859802246  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.119032859802246  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4685802459716797  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4685821533203125  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483642578125  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

pseudo mini batch 1 input nodes size: 705
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4836063385009766  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4836063385009766  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4875125885009766  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4875130653381348  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.48236083984375  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 4: 6, 2: 5, 1: 5, 5: 4, 6: 2})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.482377529144287  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.482377529144287  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.6708283424377441  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.6708297729492188  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4824004173278809  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

pseudo mini batch 2 input nodes size: 726
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4823780059814453  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4823780059814453  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4862842559814453  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4862847328186035  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4823780059814453  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 7, 3: 6, 1: 5, 4: 4, 6: 3, 5: 2, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4823966026306152  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4823966026306152  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.6842761039733887  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.6842775344848633  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4824223518371582  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

pseudo mini batch 3 input nodes size: 1154
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4823980331420898  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4823980331420898  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4885587692260742  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4885592460632324  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4846525192260742  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 5, 1: 4, 3: 4, 2: 3, 10: 2, 5: 2, 6: 2, 9: 2, 7: 2, 21: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4846854209899902  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4846854209899902  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.865708351135254  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.8657097816467285  GigaBytes
Max Memory Allocated: 2.1084790229797363  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4847311973571777  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

pseudo mini batch 4 input nodes size: 911
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4846887588500977  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4846887588500977  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4895520210266113  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4895524978637695  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483391284942627  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 6, 1: 5, 5: 4, 3: 4, 4: 4, 7: 2, 6: 1, 11: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4834136962890625  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4834136962890625  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7362146377563477  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7362160682678223  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483445167541504  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483445167541504  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1188583374023438  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06414875984191895 |0.0007236957550048828 |0.09184160232543945 |0.00010232925415039062 |0.2316516399383545 |0.0029039382934570312 |
----------------------------------------------------------pseudo_mini_loss sum 7.971864223480225
Total (block generation + training)time/epoch 2.1696717188908505
Training time/epoch 2.049057722091675
Training time without block to device /epoch 2.0454392433166504
Training time without total dataloading part /epoch 1.6208817958831787
load block tensor time/epoch 0.3207437992095947
block to device time/epoch 0.003618478775024414
input features size transfer per epoch 7.450580596923828e-07
blocks size to device per epoch 4.0978193283081055e-07
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  7202
Number of first layer input nodes during this epoch:  4461
Number of first layer output nodes during this epoch:  2071
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.118748664855957  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.234 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.234 GB
Metis partitioning: 0.000 seconds, peak memory: 16.234 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.003 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009964227676391602
pure dgl.metis_partition the time spent:  0.00519108772277832
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.00916147232055664

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.011595964431762695

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.01825690269470215

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.118748664855957  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

connection checking time:  0.015887975692749023
block generation total time  0.039014339447021484
average batch blocks generation time:  0.0078028678894042965
block dataloader generation time/epoch 0.08600320134844099
pseudo mini batch 0 input nodes size: 904
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1187176704406738  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1187176704406738  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1235437393188477  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1235442161560059  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.118680477142334  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 6, 4: 4, 5: 4, 3: 3, 8: 3, 9: 2, 1: 2, 6: 2, 30: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1187067031860352  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1187067031860352  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.422086238861084  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4220881462097168  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4833073616027832  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

pseudo mini batch 1 input nodes size: 869
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4832749366760254  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4832749366760254  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4879140853881836  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4879145622253418  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4830880165100098  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 7, 1: 6, 3: 4, 4: 4, 6: 3, 7: 2, 5: 2})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483107566833496  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483107566833496  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7116823196411133  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.711683750152588  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4831342697143555  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

pseudo mini batch 2 input nodes size: 754
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4831080436706543  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4831080436706543  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.487133502960205  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4871339797973633  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4824943542480469  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 4: 6, 2: 6, 1: 3, 5: 3, 10: 2, 9: 1, 21: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.482515811920166  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.482515811920166  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.738656997680664  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7386584281921387  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.482546329498291  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

pseudo mini batch 3 input nodes size: 946
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.482518196105957  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.482518196105957  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4875683784484863  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4875688552856445  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4835429191589355  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 8, 4: 4, 1: 3, 5: 3, 6: 3, 2: 3, 12: 1, 9: 1, 10: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483567237854004  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483567237854004  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7740840911865234  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.774085521697998  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4836015701293945  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

pseudo mini batch 4 input nodes size: 858
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483567237854004  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483567237854004  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4881477355957031  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4881482124328613  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4830975532531738  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 6, 3: 5, 4: 4, 6: 3, 5: 3, 2: 3, 7: 1, 19: 1, 30: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4831218719482422  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4831218719482422  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7601871490478516  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7601885795593262  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4831552505493164  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4831552505493164  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1185684204101562  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.064227294921875 |0.000696563720703125 |0.09402894973754883 |9.331703186035156e-05 |0.24392256736755372 |0.0032143592834472656 |
----------------------------------------------------------pseudo_mini_loss sum 7.745266437530518
Total (block generation + training)time/epoch 2.1723945140838623
Training time/epoch 2.121379852294922
Training time without block to device /epoch 2.1178970336914062
Training time without total dataloading part /epoch 1.6934385299682617
load block tensor time/epoch 0.321136474609375
block to device time/epoch 0.003482818603515625
input features size transfer per epoch 7.450580596923828e-07
blocks size to device per epoch 4.0978193283081055e-07
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  7038
Number of first layer input nodes during this epoch:  4331
Number of first layer output nodes during this epoch:  2033
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1184697151184082  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.234 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.234 GB
Metis partitioning: 0.000 seconds, peak memory: 16.234 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.003 seconds
REG metis partition end ----................................
REG construction  time spent:  0.00937962532043457
pure dgl.metis_partition the time spent:  0.0052204132080078125
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.009216547012329102

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.011675834655761719

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.018157243728637695

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1184697151184082  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

connection checking time:  0.016220808029174805
block generation total time  0.039049625396728516
average batch blocks generation time:  0.007809925079345703
block dataloader generation time/epoch 0.08597618738810221
pseudo mini batch 0 input nodes size: 1127
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.118438720703125  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.118438720703125  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.124455451965332  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1244559288024902  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1198749542236328  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 5, 2: 4, 4: 4, 7: 3, 5: 3, 6: 3, 9: 2, 1: 1, 12: 1, 10: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1199049949645996  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1199049949645996  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4623799324035645  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4623818397521973  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.484506607055664  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

pseudo mini batch 1 input nodes size: 786
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4844660758972168  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4844660758972168  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4886622428894043  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4886627197265625  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4826455116271973  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 7, 3: 6, 5: 5, 2: 4, 4: 4, 10: 1, 21: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.482666015625  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.482666015625  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.720522403717041  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7205238342285156  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4826946258544922  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

pseudo mini batch 2 input nodes size: 704
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.482668399810791  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.482668399810791  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.486574649810791  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4865751266479492  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4823784828186035  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 4: 5, 2: 4, 6: 3, 5: 3, 8: 3, 1: 2, 30: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.482400894165039  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.482400894165039  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7344794273376465  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.734480857849121  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.482431411743164  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

pseudo mini batch 3 input nodes size: 931
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.482405185699463  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.482405185699463  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4881501197814941  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4881505966186523  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4842438697814941  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 1: 6, 2: 4, 6: 3, 4: 3, 5: 2, 9: 1, 12: 1, 30: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.484269142150879  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.484269142150879  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7698144912719727  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7698159217834473  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4843034744262695  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

pseudo mini batch 4 input nodes size: 800
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4842710494995117  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4842710494995117  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.488542079925537  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4885425567626953  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4827971458435059  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 9, 4: 6, 1: 4, 3: 3, 6: 2, 5: 2, 10: 1, 19: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4828166961669922  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4828166961669922  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7162461280822754  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.71624755859375  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.482844352722168  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.482844352722168  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1182575225830078  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06377253532409669 |0.0007219791412353515 |0.09306850433349609 |0.00010428428649902343 |0.23978166580200194 |0.003171205520629883 |
----------------------------------------------------------pseudo_mini_loss sum 5.600543975830078
Total (block generation + training)time/epoch 2.1728418986002604
Training time/epoch 2.093400716781616
Training time without block to device /epoch 2.0897908210754395
Training time without total dataloading part /epoch 1.6679434776306152
load block tensor time/epoch 0.3188626766204834
block to device time/epoch 0.003609895706176758
input features size transfer per epoch 7.450580596923828e-07
blocks size to device per epoch 4.0978193283081055e-07
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  7042
Number of first layer input nodes during this epoch:  4348
Number of first layer output nodes during this epoch:  2026
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.118149757385254  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.234 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.234 GB
Metis partitioning: 0.001 seconds, peak memory: 16.234 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.003 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009318828582763672
pure dgl.metis_partition the time spent:  0.0052568912506103516
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.009201765060424805

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.011494636535644531

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.018130064010620117

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.118149757385254  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

connection checking time:  0.016001462936401367
block generation total time  0.03882646560668945
average batch blocks generation time:  0.007765293121337891
block dataloader generation time/epoch 0.0859556496143341
pseudo mini batch 0 input nodes size: 799
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1181230545043945  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1181230545043945  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.122450351715088  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.122450828552246  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1181793212890625  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 6: 5, 2: 4, 4: 3, 1: 3, 5: 3, 8: 2, 30: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1182036399841309  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1182036399841309  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.3884596824645996  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.3884615898132324  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4828028678894043  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

pseudo mini batch 1 input nodes size: 1093
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4827728271484375  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4827728271484375  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4886078834533691  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4886083602905273  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4842805862426758  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 7, 4: 6, 1: 5, 7: 3, 12: 1, 30: 1, 5: 1, 10: 1, 19: 1, 2: 1, 8: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4843106269836426  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4843106269836426  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.8248214721679688  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.8248229026794434  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4843525886535645  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

pseudo mini batch 2 input nodes size: 783
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.48431396484375  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.48431396484375  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4884939193725586  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4884943962097168  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.482658863067627  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 11, 3: 4, 1: 4, 4: 3, 5: 3, 6: 2, 21: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4826784133911133  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4826784133911133  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7119336128234863  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.711935043334961  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4827051162719727  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

pseudo mini batch 3 input nodes size: 1083
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4826788902282715  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4826788902282715  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4884605407714844  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4884610176086426  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4842805862426758  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 4: 5, 2: 3, 6: 3, 5: 3, 10: 2, 9: 2, 1: 1, 7: 1, 11: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4843096733093262  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4843096733093262  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.825472354888916  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.8254737854003906  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4843497276306152  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

pseudo mini batch 4 input nodes size: 720
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4843111038208008  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4843111038208008  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4882173538208008  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.488217830657959  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.482435703277588  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 7, 2: 6, 5: 5, 4: 5, 3: 3, 6: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.482452392578125  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.482452392578125  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.67047119140625  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.6704726219177246  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4824752807617188  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4824752807617188  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1178884506225586  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06419134140014648 |0.0007001399993896484 |0.09165120124816895 |9.813308715820313e-05 |0.23610339164733887 |0.003027200698852539 |
----------------------------------------------------------pseudo_mini_loss sum 5.4610724449157715
Total (block generation + training)time/epoch 2.1716530472040176
Training time/epoch 2.0680599212646484
Training time without block to device /epoch 2.0645592212677
Training time without total dataloading part /epoch 1.6422908306121826
load block tensor time/epoch 0.3209567070007324
block to device time/epoch 0.003500699996948242
input features size transfer per epoch 7.450580596923828e-07
blocks size to device per epoch 4.0978193283081055e-07
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  7206
Number of first layer input nodes during this epoch:  4478
Number of first layer output nodes during this epoch:  2063
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1177773475646973  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.234 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.234 GB
Metis partitioning: 0.000 seconds, peak memory: 16.234 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.003 seconds
REG metis partition end ----................................
REG construction  time spent:  0.008925914764404297
pure dgl.metis_partition the time spent:  0.004913806915283203
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.009136438369750977

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.011945486068725586

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.01791238784790039

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1177773475646973  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

connection checking time:  0.015858173370361328
block generation total time  0.03899431228637695
average batch blocks generation time:  0.0077988624572753905
block dataloader generation time/epoch 0.08587037815767176
pseudo mini batch 0 input nodes size: 1071
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1177544593811035  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1177544593811035  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1234722137451172  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1234726905822754  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1195659637451172  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 5, 3: 5, 4: 4, 6: 3, 10: 3, 1: 2, 5: 2, 9: 1, 11: 1, 12: 1, 21: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.119596004486084  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.119596004486084  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4710144996643066  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4710164070129395  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.484208583831787  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

pseudo mini batch 1 input nodes size: 990
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4841699600219727  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4841699600219727  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.489455223083496  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4894556999206543  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4837374687194824  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 7, 2: 6, 4: 5, 1: 4, 5: 2, 30: 1, 19: 1, 12: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4837627410888672  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4837627410888672  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7753410339355469  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7753424644470215  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4837970733642578  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

pseudo mini batch 2 input nodes size: 862
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4837646484375  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4837646484375  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4883666038513184  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4883670806884766  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483081340789795  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 5, 3: 4, 1: 4, 5: 3, 6: 3, 8: 3, 2: 3, 9: 1, 7: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4831066131591797  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4831066131591797  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7730493545532227  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7730507850646973  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4831418991088867  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

pseudo mini batch 3 input nodes size: 814
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4831113815307617  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4831113815307617  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4874567985534668  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.487457275390625  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4828548431396484  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 6, 2: 5, 5: 5, 4: 4, 6: 4, 7: 2, 3: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4828743934631348  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4828743934631348  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7106823921203613  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.710683822631836  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4829010963439941  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

pseudo mini batch 4 input nodes size: 774
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.482874870300293  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.482874870300293  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4871277809143066  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4871282577514648  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4827823638916016  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 9, 2: 6, 4: 4, 1: 4, 5: 3, 7: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.482800006866455  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.482800006866455  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.6841392517089844  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.684140682220459  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4828238487243652  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4828238487243652  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.118237018585205  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06388473510742188 |0.0007121086120605469 |0.08989100456237793 |0.00010061264038085938 |0.2246396541595459 |0.003238677978515625 |
----------------------------------------------------------pseudo_mini_loss sum 4.375662803649902
Total (block generation + training)time/epoch 2.166664810741649
Training time/epoch 2.0022451877593994
Training time without block to device /epoch 1.9986846446990967
Training time without total dataloading part /epoch 1.576395034790039
load block tensor time/epoch 0.3194236755371094
block to device time/epoch 0.0035605430603027344
input features size transfer per epoch 7.450580596923828e-07
blocks size to device per epoch 4.0978193283081055e-07
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  7240
Number of first layer input nodes during this epoch:  4511
Number of first layer output nodes during this epoch:  2058
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1181259155273438  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.234 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.234 GB
Metis partitioning: 0.001 seconds, peak memory: 16.234 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.003 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009386301040649414
pure dgl.metis_partition the time spent:  0.005038738250732422
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.009250640869140625

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.01122593879699707

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.01694178581237793

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1181259155273438  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

connection checking time:  0.015547513961791992
block generation total time  0.037418365478515625
average batch blocks generation time:  0.007483673095703125
block dataloader generation time/epoch 0.08591968483395046
pseudo mini batch 0 input nodes size: 470
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1181011199951172  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1181011199951172  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.120610237121582  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1206107139587402  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1163573265075684  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 7, 2: 6, 3: 4, 4: 4, 5: 3, 6: 3, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1163711547851562  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1163711547851562  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.258763313293457  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.2587652206420898  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4823970794677734  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

pseudo mini batch 1 input nodes size: 755
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4823808670043945  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4823808670043945  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4864115715026855  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4864120483398438  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4839024543762207  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 5, 1: 4, 4: 4, 2: 4, 5: 4, 8: 3, 6: 2, 9: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4839258193969727  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4839258193969727  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.742833137512207  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7428345680236816  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483957290649414  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

pseudo mini batch 2 input nodes size: 998
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.48392915725708  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.48392915725708  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4892568588256836  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4892573356628418  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4852261543273926  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 8, 4: 5, 1: 4, 5: 3, 3: 2, 7: 2, 9: 1, 10: 1, 6: 1, 19: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4852495193481445  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4852495193481445  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.760796070098877  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7607975006103516  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4852828979492188  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

pseudo mini batch 3 input nodes size: 1014
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.485250473022461  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.485250473022461  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.490664005279541  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4906644821166992  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4853363037109375  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 8, 4: 7, 6: 3, 2: 3, 5: 2, 10: 1, 9: 1, 1: 1, 12: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4853615760803223  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4853615760803223  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7860527038574219  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7860541343688965  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4853968620300293  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

pseudo mini batch 4 input nodes size: 972
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4853625297546387  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4853625297546387  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.490551471710205  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4905519485473633  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.485137939453125  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 7, 1: 4, 2: 4, 5: 3, 6: 2, 4: 2, 9: 1, 10: 1, 21: 1, 11: 1, 30: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4851670265197754  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4851670265197754  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.8140110969543457  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.8140125274658203  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4852070808410645  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4852070808410645  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1191840171813965  GigaBytes
Max Memory Allocated: 2.1144418716430664  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06337237358093262 |0.0007170677185058594 |0.09067506790161133 |9.822845458984375e-05 |0.23221039772033691 |0.002758502960205078 |
----------------------------------------------------------pseudo_mini_loss sum 3.3136260509490967
Total (block generation + training)time/epoch 2.1646006637149386
Training time/epoch 2.042646646499634
Training time without block to device /epoch 2.0390613079071045
Training time without total dataloading part /epoch 1.6176769733428955
load block tensor time/epoch 0.3168618679046631
block to device time/epoch 0.003585338592529297
input features size transfer per epoch 7.450580596923828e-07
blocks size to device per epoch 4.0978193283081055e-07
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  6838
Number of first layer input nodes during this epoch:  4209
Number of first layer output nodes during this epoch:  1968
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(1433, 1433, batch_first=True)
      (fc_self): Linear(in_features=1433, out_features=2048, bias=False)
      (fc_neigh): Linear(in_features=1433, out_features=2048, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(2048, 2048, batch_first=True)
      (fc_self): Linear(in_features=2048, out_features=2048, bias=False)
      (fc_neigh): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (2): SAGEConv(
      (lstm): LSTM(2048, 2048, batch_first=True)
      (fc_self): Linear(in_features=2048, out_features=7, bias=False)
      (fc_neigh): Linear(in_features=2048, out_features=7, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  97867856
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([5732, 1433])
layers.0.lstm.weight_hh_l0, torch.Size([5732, 1433])
layers.0.lstm.bias_ih_l0, torch.Size([5732])
layers.0.lstm.bias_hh_l0, torch.Size([5732])
layers.0.fc_self.weight, torch.Size([2048, 1433])
layers.0.fc_neigh.weight, torch.Size([2048, 1433])
layers.1.lstm.weight_ih_l0, torch.Size([8192, 2048])
layers.1.lstm.weight_hh_l0, torch.Size([8192, 2048])
layers.1.lstm.bias_ih_l0, torch.Size([8192])
layers.1.lstm.bias_hh_l0, torch.Size([8192])
layers.1.fc_self.weight, torch.Size([2048, 2048])
layers.1.fc_neigh.weight, torch.Size([2048, 2048])
layers.2.lstm.weight_ih_l0, torch.Size([8192, 2048])
layers.2.lstm.weight_hh_l0, torch.Size([8192, 2048])
layers.2.lstm.bias_ih_l0, torch.Size([8192])
layers.2.lstm.bias_hh_l0, torch.Size([8192])
layers.2.fc_self.weight, torch.Size([7, 2048])
layers.2.fc_neigh.weight, torch.Size([7, 2048])
----------------------------------------
un-trainable parameters
