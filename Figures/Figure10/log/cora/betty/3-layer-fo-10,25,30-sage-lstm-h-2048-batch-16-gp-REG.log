main start at this time 1733011072.4840577
-----------------------------------------before load data 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

----------------------------------------start of run function 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  1433
----------------------------------------before model to device 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 0.88623046875 GB
    Memory Allocated: 0.3674592971801758  GigaBytes
Max Memory Allocated: 0.3674592971801758  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 0.88818359375 GB
    Memory Allocated: 0.3674592971801758  GigaBytes
Max Memory Allocated: 0.3674592971801758  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 13.818 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 13.818 GB
Metis partitioning: 0.001 seconds, peak memory: 13.818 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.008 seconds
REG metis partition end ----................................
REG construction  time spent:  0.020397663116455078
pure dgl.metis_partition the time spent:  0.010691404342651367

block_gen_time in "generate_blocks_for_one_layer_block"  0.024178504943847656


block_gen_time in "generate_blocks_for_one_layer_block"  0.02609539031982422


block_gen_time in "generate_blocks_for_one_layer_block"  0.035251617431640625

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 0.88818359375 GB
    Memory Allocated: 0.3674592971801758  GigaBytes
Max Memory Allocated: 0.3674592971801758  GigaBytes

connection checking time:  0.04125642776489258
block generation total time  0.0855255126953125
average batch blocks generation time:  0.005345344543457031
pseudo mini batch 0 input nodes size: 435
----------------------------------------before load block subtensor 
 Nvidia-smi: 0.88818359375 GB
    Memory Allocated: 0.3674592971801758  GigaBytes
Max Memory Allocated: 0.3674592971801758  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 0.88818359375 GB
    Memory Allocated: 0.3674592971801758  GigaBytes
Max Memory Allocated: 0.3674592971801758  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 0.90771484375 GB
    Memory Allocated: 0.369781494140625  GigaBytes
Max Memory Allocated: 0.369781494140625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 0.90771484375 GB
    Memory Allocated: 0.3697819709777832  GigaBytes
Max Memory Allocated: 0.3697819709777832  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 0.90771484375 GB
    Memory Allocated: 0.3697819709777832  GigaBytes
Max Memory Allocated: 0.3697819709777832  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 1: 1, 6: 1, 10: 1, 4: 1, 2: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 0.90771484375 GB
    Memory Allocated: 0.3697938919067383  GigaBytes
Max Memory Allocated: 0.3697938919067383  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 0.90771484375 GB
    Memory Allocated: 0.3697938919067383  GigaBytes
Max Memory Allocated: 0.3697938919067383  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.06201171875 GB
    Memory Allocated: 0.49852705001831055  GigaBytes
Max Memory Allocated: 0.4990086555480957  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.06201171875 GB
    Memory Allocated: 0.49852848052978516  GigaBytes
Max Memory Allocated: 0.4990086555480957  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.52685546875 GB
    Memory Allocated: 0.7509312629699707  GigaBytes
Max Memory Allocated: 0.905148983001709  GigaBytes

pseudo mini batch 1 input nodes size: 607
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.52685546875 GB
    Memory Allocated: 0.7509169578552246  GigaBytes
Max Memory Allocated: 0.905148983001709  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.52685546875 GB
    Memory Allocated: 0.7509169578552246  GigaBytes
Max Memory Allocated: 0.905148983001709  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.52685546875 GB
    Memory Allocated: 0.754157543182373  GigaBytes
Max Memory Allocated: 0.905148983001709  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.52685546875 GB
    Memory Allocated: 0.7541580200195312  GigaBytes
Max Memory Allocated: 0.905148983001709  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.52685546875 GB
    Memory Allocated: 0.7518353462219238  GigaBytes
Max Memory Allocated: 0.905148983001709  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({6: 2, 3: 2, 9: 1, 5: 1, 4: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 1.52685546875 GB
    Memory Allocated: 0.7518491744995117  GigaBytes
Max Memory Allocated: 0.905148983001709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.52685546875 GB
    Memory Allocated: 0.7518491744995117  GigaBytes
Max Memory Allocated: 0.905148983001709  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.54833984375 GB
    Memory Allocated: 0.8913097381591797  GigaBytes
Max Memory Allocated: 0.905148983001709  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.54833984375 GB
    Memory Allocated: 0.8913106918334961  GigaBytes
Max Memory Allocated: 0.905148983001709  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.73583984375 GB
    Memory Allocated: 0.7518672943115234  GigaBytes
Max Memory Allocated: 1.1408519744873047  GigaBytes

pseudo mini batch 2 input nodes size: 458
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.73583984375 GB
    Memory Allocated: 0.7518491744995117  GigaBytes
Max Memory Allocated: 1.1408519744873047  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.73583984375 GB
    Memory Allocated: 0.7518491744995117  GigaBytes
Max Memory Allocated: 1.1408519744873047  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.73583984375 GB
    Memory Allocated: 0.7542943954467773  GigaBytes
Max Memory Allocated: 1.1408519744873047  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.73583984375 GB
    Memory Allocated: 0.7542948722839355  GigaBytes
Max Memory Allocated: 1.1408519744873047  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.73583984375 GB
    Memory Allocated: 0.7510538101196289  GigaBytes
Max Memory Allocated: 1.1408519744873047  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 3, 5: 2, 2: 2, 9: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 1.73583984375 GB
    Memory Allocated: 0.751065731048584  GigaBytes
Max Memory Allocated: 1.1408519744873047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.73583984375 GB
    Memory Allocated: 0.751065731048584  GigaBytes
Max Memory Allocated: 1.1408519744873047  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.73583984375 GB
    Memory Allocated: 0.8700289726257324  GigaBytes
Max Memory Allocated: 1.1408519744873047  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.73583984375 GB
    Memory Allocated: 0.8700299263000488  GigaBytes
Max Memory Allocated: 1.1408519744873047  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.73583984375 GB
    Memory Allocated: 0.7510819435119629  GigaBytes
Max Memory Allocated: 1.1408519744873047  GigaBytes

pseudo mini batch 3 input nodes size: 511
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.73583984375 GB
    Memory Allocated: 0.7510676383972168  GigaBytes
Max Memory Allocated: 1.1408519744873047  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.73583984375 GB
    Memory Allocated: 0.7510676383972168  GigaBytes
Max Memory Allocated: 1.1408519744873047  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.73583984375 GB
    Memory Allocated: 0.7537956237792969  GigaBytes
Max Memory Allocated: 1.1408519744873047  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.73583984375 GB
    Memory Allocated: 0.7537961006164551  GigaBytes
Max Memory Allocated: 1.1408519744873047  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.73583984375 GB
    Memory Allocated: 0.7513504028320312  GigaBytes
Max Memory Allocated: 1.1408519744873047  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 3, 3: 1, 5: 1, 7: 1, 10: 1, 21: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 1.73583984375 GB
    Memory Allocated: 0.7513632774353027  GigaBytes
Max Memory Allocated: 1.1408519744873047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.73583984375 GB
    Memory Allocated: 0.7513632774353027  GigaBytes
Max Memory Allocated: 1.1408519744873047  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.8942904472351074  GigaBytes
Max Memory Allocated: 1.1408519744873047  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.8942914009094238  GigaBytes
Max Memory Allocated: 1.1408519744873047  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.751380443572998  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

pseudo mini batch 4 input nodes size: 116
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7513642311096191  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7513642311096191  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.751983642578125  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7519841194152832  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7492556571960449  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 4: 2, 5: 1, 1: 1, 2: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7492609024047852  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7492609024047852  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7866344451904297  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7866353988647461  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.749267578125  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

pseudo mini batch 5 input nodes size: 157
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7492632865905762  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7492632865905762  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7501015663146973  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7501020431518555  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7494821548461914  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 3, 1: 3, 3: 2, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.749488353729248  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.749488353729248  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7865047454833984  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7865056991577148  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7494959831237793  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

pseudo mini batch 6 input nodes size: 348
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7494897842407227  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7494897842407227  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.751347541809082  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7513480186462402  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7505092620849609  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 4, 3: 3, 1: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7505183219909668  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7505183219909668  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.8234829902648926  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.823483943939209  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7505297660827637  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

pseudo mini batch 7 input nodes size: 381
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7505197525024414  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7505197525024414  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7531638145446777  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7531642913818359  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7513060569763184  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 1: 2, 19: 1, 2: 1, 4: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7513151168823242  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7513151168823242  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.8374996185302734  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.8375005722045898  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7513275146484375  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

pseudo mini batch 8 input nodes size: 78
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.751317024230957  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.751317024230957  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7517337799072266  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7517342567443848  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7490897178649902  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 2, 3: 2, 6: 1, 2: 1, 5: 1, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7490949630737305  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7490949630737305  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7729430198669434  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7729439735412598  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7491016387939453  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

pseudo mini batch 9 input nodes size: 288
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7490973472595215  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7490973472595215  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7506351470947266  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7506356239318848  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.750218391418457  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2, 4: 2, 3: 1, 7: 1, 5: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7502264976501465  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7502264976501465  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.8111605644226074  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.8111615180969238  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.750236988067627  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

pseudo mini batch 10 input nodes size: 567
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7502288818359375  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7502288818359375  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7532558441162109  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7532563209533691  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7517180442810059  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 2, 1: 2, 6: 1, 30: 1, 4: 1, 5: 1, 2: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7517318725585938  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7517318725585938  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.9002022743225098  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.9002032279968262  GigaBytes
Max Memory Allocated: 1.14369535446167  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7517499923706055  GigaBytes
Max Memory Allocated: 1.1496224403381348  GigaBytes

pseudo mini batch 11 input nodes size: 366
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7517318725585938  GigaBytes
Max Memory Allocated: 1.1496224403381348  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7517318725585938  GigaBytes
Max Memory Allocated: 1.1496224403381348  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7536859512329102  GigaBytes
Max Memory Allocated: 1.1496224403381348  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7536864280700684  GigaBytes
Max Memory Allocated: 1.1496224403381348  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7506589889526367  GigaBytes
Max Memory Allocated: 1.1496224403381348  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 3, 4: 3, 3: 1, 1: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.750669002532959  GigaBytes
Max Memory Allocated: 1.1496224403381348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.750669002532959  GigaBytes
Max Memory Allocated: 1.1496224403381348  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.8351526260375977  GigaBytes
Max Memory Allocated: 1.1496224403381348  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.8351535797119141  GigaBytes
Max Memory Allocated: 1.1496224403381348  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7506823539733887  GigaBytes
Max Memory Allocated: 1.1496224403381348  GigaBytes

pseudo mini batch 12 input nodes size: 453
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7506699562072754  GigaBytes
Max Memory Allocated: 1.1496224403381348  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7506699562072754  GigaBytes
Max Memory Allocated: 1.1496224403381348  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7536969184875488  GigaBytes
Max Memory Allocated: 1.1496224403381348  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.753697395324707  GigaBytes
Max Memory Allocated: 1.1496224403381348  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7517428398132324  GigaBytes
Max Memory Allocated: 1.1496224403381348  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({8: 2, 6: 2, 3: 1, 30: 1, 9: 1, 4: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7517566680908203  GigaBytes
Max Memory Allocated: 1.1496224403381348  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.74951171875 GB
    Memory Allocated: 0.7517566680908203  GigaBytes
Max Memory Allocated: 1.1496224403381348  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.75537109375 GB
    Memory Allocated: 0.901160717010498  GigaBytes
Max Memory Allocated: 1.1496224403381348  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.75537109375 GB
    Memory Allocated: 0.9011616706848145  GigaBytes
Max Memory Allocated: 1.1496224403381348  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.75537109375 GB
    Memory Allocated: 0.7517757415771484  GigaBytes
Max Memory Allocated: 1.1505656242370605  GigaBytes

pseudo mini batch 13 input nodes size: 468
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.75537109375 GB
    Memory Allocated: 0.7517595291137695  GigaBytes
Max Memory Allocated: 1.1505656242370605  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.75537109375 GB
    Memory Allocated: 0.7517595291137695  GigaBytes
Max Memory Allocated: 1.1505656242370605  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.75537109375 GB
    Memory Allocated: 0.7542581558227539  GigaBytes
Max Memory Allocated: 1.1505656242370605  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.75537109375 GB
    Memory Allocated: 0.7542586326599121  GigaBytes
Max Memory Allocated: 1.1505656242370605  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.75537109375 GB
    Memory Allocated: 0.7512311935424805  GigaBytes
Max Memory Allocated: 1.1505656242370605  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({5: 2, 1: 2, 7: 1, 2: 1, 4: 1, 8: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 1.75537109375 GB
    Memory Allocated: 0.7512421607971191  GigaBytes
Max Memory Allocated: 1.1505656242370605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.75537109375 GB
    Memory Allocated: 0.7512421607971191  GigaBytes
Max Memory Allocated: 1.1505656242370605  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.75537109375 GB
    Memory Allocated: 0.8560714721679688  GigaBytes
Max Memory Allocated: 1.1505656242370605  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.75537109375 GB
    Memory Allocated: 0.8560724258422852  GigaBytes
Max Memory Allocated: 1.1505656242370605  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.75537109375 GB
    Memory Allocated: 0.7512564659118652  GigaBytes
Max Memory Allocated: 1.1505656242370605  GigaBytes

pseudo mini batch 14 input nodes size: 188
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.75537109375 GB
    Memory Allocated: 0.7512421607971191  GigaBytes
Max Memory Allocated: 1.1505656242370605  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.75537109375 GB
    Memory Allocated: 0.7512421607971191  GigaBytes
Max Memory Allocated: 1.1505656242370605  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.75537109375 GB
    Memory Allocated: 0.7525429725646973  GigaBytes
Max Memory Allocated: 1.1505656242370605  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.75537109375 GB
    Memory Allocated: 0.7525434494018555  GigaBytes
Max Memory Allocated: 1.1505656242370605  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.75537109375 GB
    Memory Allocated: 0.7500443458557129  GigaBytes
Max Memory Allocated: 1.1505656242370605  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 3, 1: 2, 10: 1, 3: 1, 6: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 1.75537109375 GB
    Memory Allocated: 0.7500514984130859  GigaBytes
Max Memory Allocated: 1.1505656242370605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.75537109375 GB
    Memory Allocated: 0.7500514984130859  GigaBytes
Max Memory Allocated: 1.1505656242370605  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.75537109375 GB
    Memory Allocated: 0.8028469085693359  GigaBytes
Max Memory Allocated: 1.1505656242370605  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.75537109375 GB
    Memory Allocated: 0.8028478622436523  GigaBytes
Max Memory Allocated: 1.1505656242370605  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.75537109375 GB
    Memory Allocated: 0.75006103515625  GigaBytes
Max Memory Allocated: 1.1505656242370605  GigaBytes

pseudo mini batch 15 input nodes size: 332
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.75537109375 GB
    Memory Allocated: 0.7500548362731934  GigaBytes
Max Memory Allocated: 1.1505656242370605  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.75537109375 GB
    Memory Allocated: 0.7500548362731934  GigaBytes
Max Memory Allocated: 1.1505656242370605  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.75537109375 GB
    Memory Allocated: 0.7518272399902344  GigaBytes
Max Memory Allocated: 1.1505656242370605  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.75537109375 GB
    Memory Allocated: 0.7518277168273926  GigaBytes
Max Memory Allocated: 1.1505656242370605  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.75537109375 GB
    Memory Allocated: 0.7505264282226562  GigaBytes
Max Memory Allocated: 1.1505656242370605  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({5: 3, 4: 2, 1: 2, 3: 1, 2: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 1.75537109375 GB
    Memory Allocated: 0.7505354881286621  GigaBytes
Max Memory Allocated: 1.1505656242370605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.75537109375 GB
    Memory Allocated: 0.7505354881286621  GigaBytes
Max Memory Allocated: 1.1505656242370605  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.75537109375 GB
    Memory Allocated: 0.8253178596496582  GigaBytes
Max Memory Allocated: 1.1505656242370605  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.75537109375 GB
    Memory Allocated: 0.8253188133239746  GigaBytes
Max Memory Allocated: 1.1505656242370605  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.75537109375 GB
    Memory Allocated: 0.750546932220459  GigaBytes
Max Memory Allocated: 1.1505656242370605  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.59130859375 GB
    Memory Allocated: 1.4797205924987793  GigaBytes
Max Memory Allocated: 1.847179889678955  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.59130859375 GB
    Memory Allocated: 1.1144700050354004  GigaBytes
Max Memory Allocated: 1.847179889678955  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07191579043865204 |0.0009565204381942749 |0.11521722376346588 |0.0009601116180419922 |0.12354874610900879 |0.14159297943115234 |
----------------------------------------------------------pseudo_mini_loss sum 1.9574949741363525
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  8676
Number of first layer input nodes during this epoch:  5753
Number of first layer output nodes during this epoch:  2247
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.59130859375 GB
    Memory Allocated: 1.1142964363098145  GigaBytes
Max Memory Allocated: 1.847179889678955  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.101 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.101 GB
Metis partitioning: 0.001 seconds, peak memory: 16.101 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.009 seconds
REG metis partition end ----................................
REG construction  time spent:  0.011214256286621094
pure dgl.metis_partition the time spent:  0.011234760284423828

block_gen_time in "generate_blocks_for_one_layer_block"  0.02288365364074707


block_gen_time in "generate_blocks_for_one_layer_block"  0.02638983726501465


block_gen_time in "generate_blocks_for_one_layer_block"  0.0357820987701416

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.59130859375 GB
    Memory Allocated: 1.1142964363098145  GigaBytes
Max Memory Allocated: 1.847179889678955  GigaBytes

connection checking time:  0.0427248477935791
block generation total time  0.08505558967590332
average batch blocks generation time:  0.0053159743547439575
pseudo mini batch 0 input nodes size: 445
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.59130859375 GB
    Memory Allocated: 1.114285945892334  GigaBytes
Max Memory Allocated: 1.847179889678955  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.59130859375 GB
    Memory Allocated: 1.114285945892334  GigaBytes
Max Memory Allocated: 1.847179889678955  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.59130859375 GB
    Memory Allocated: 1.1170153617858887  GigaBytes
Max Memory Allocated: 1.847179889678955  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.59130859375 GB
    Memory Allocated: 1.1170158386230469  GigaBytes
Max Memory Allocated: 1.847179889678955  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.59130859375 GB
    Memory Allocated: 1.1152429580688477  GigaBytes
Max Memory Allocated: 1.847179889678955  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 6: 2, 1: 1, 10: 1, 2: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.59130859375 GB
    Memory Allocated: 1.1152548789978027  GigaBytes
Max Memory Allocated: 1.847179889678955  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.59130859375 GB
    Memory Allocated: 1.1152548789978027  GigaBytes
Max Memory Allocated: 1.847179889678955  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.59130859375 GB
    Memory Allocated: 1.2311358451843262  GigaBytes
Max Memory Allocated: 1.847179889678955  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.59130859375 GB
    Memory Allocated: 1.2311372756958008  GigaBytes
Max Memory Allocated: 1.847179889678955  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.59130859375 GB
    Memory Allocated: 1.4812979698181152  GigaBytes
Max Memory Allocated: 1.847179889678955  GigaBytes

pseudo mini batch 1 input nodes size: 624
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.59130859375 GB
    Memory Allocated: 1.4812836647033691  GigaBytes
Max Memory Allocated: 1.847179889678955  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.59130859375 GB
    Memory Allocated: 1.4812836647033691  GigaBytes
Max Memory Allocated: 1.847179889678955  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.59130859375 GB
    Memory Allocated: 1.4846148490905762  GigaBytes
Max Memory Allocated: 1.847179889678955  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.59130859375 GB
    Memory Allocated: 1.4846153259277344  GigaBytes
Max Memory Allocated: 1.847179889678955  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.59130859375 GB
    Memory Allocated: 1.4818854331970215  GigaBytes
Max Memory Allocated: 1.847179889678955  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 5: 2, 6: 1, 12: 1, 2: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.59130859375 GB
    Memory Allocated: 1.4818992614746094  GigaBytes
Max Memory Allocated: 1.847179889678955  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.59130859375 GB
    Memory Allocated: 1.4818992614746094  GigaBytes
Max Memory Allocated: 1.847179889678955  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.59130859375 GB
    Memory Allocated: 1.628183364868164  GigaBytes
Max Memory Allocated: 1.847179889678955  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.59130859375 GB
    Memory Allocated: 1.6281843185424805  GigaBytes
Max Memory Allocated: 1.847179889678955  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.59130859375 GB
    Memory Allocated: 1.4819183349609375  GigaBytes
Max Memory Allocated: 1.8777179718017578  GigaBytes

pseudo mini batch 2 input nodes size: 601
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.59130859375 GB
    Memory Allocated: 1.4818997383117676  GigaBytes
Max Memory Allocated: 1.8777179718017578  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.59130859375 GB
    Memory Allocated: 1.4818997383117676  GigaBytes
Max Memory Allocated: 1.8777179718017578  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.59130859375 GB
    Memory Allocated: 1.4856634140014648  GigaBytes
Max Memory Allocated: 1.8777179718017578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.59130859375 GB
    Memory Allocated: 1.485663890838623  GigaBytes
Max Memory Allocated: 1.8777179718017578  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.59130859375 GB
    Memory Allocated: 1.4823322296142578  GigaBytes
Max Memory Allocated: 1.8777179718017578  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({5: 1, 3: 1, 11: 1, 9: 1, 7: 1, 10: 1, 2: 1, 21: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.59130859375 GB
    Memory Allocated: 1.4823479652404785  GigaBytes
Max Memory Allocated: 1.8777179718017578  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.59130859375 GB
    Memory Allocated: 1.4823479652404785  GigaBytes
Max Memory Allocated: 1.8777179718017578  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6662225723266602  GigaBytes
Max Memory Allocated: 1.8777179718017578  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6662235260009766  GigaBytes
Max Memory Allocated: 1.8777179718017578  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4823698997497559  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 3 input nodes size: 344
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4823493957519531  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4823493957519531  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4841861724853516  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4841866493225098  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804224967956543  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3, 2: 2, 4: 2, 9: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804315567016602  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804315567016602  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5607128143310547  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.560713768005371  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480443000793457  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 4 input nodes size: 452
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804329872131348  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804329872131348  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4828462600708008  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.482846736907959  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810094833374023  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({8: 2, 6: 2, 5: 1, 30: 1, 9: 1, 4: 1, 3: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810233116149902  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810233116149902  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6312808990478516  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.631281852722168  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810423851013184  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 5 input nodes size: 291
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810261726379395  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810261726379395  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4831147193908691  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4831151962280273  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807014465332031  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2, 3: 2, 4: 2, 9: 1, 2: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480710506439209  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480710506439209  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5592303276062012  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5592312812805176  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807229042053223  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 6 input nodes size: 275
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807124137878418  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807124137878418  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4831256866455078  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.483126163482666  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810371398925781  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 3, 5: 2, 4: 2, 3: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810452461242676  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810452461242676  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5498194694519043  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5498204231262207  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481055736541748  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 7 input nodes size: 332
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810476303100586  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810476303100586  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4831361770629883  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4831366539001465  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807229042053223  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 3, 3: 2, 5: 1, 1: 1, 2: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807319641113281  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807319641113281  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5523576736450195  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.552358627319336  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480743408203125  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 8 input nodes size: 473
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807333946228027  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807333946228027  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4832587242126465  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4832592010498047  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4811701774597168  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 6: 2, 2: 1, 4: 1, 30: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4811830520629883  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4811830520629883  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6164360046386719  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6164369583129883  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4812002182006836  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 9 input nodes size: 344
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4811840057373047  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4811840057373047  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4830207824707031  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4830212593078613  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804954528808594  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 4, 5: 2, 1: 2, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4805045127868652  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4805045127868652  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.550783634185791  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5507845878601074  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480515956878662  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 10 input nodes size: 299
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4805059432983398  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4805059432983398  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.482102394104004  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.482102870941162  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4802656173706055  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 2, 7: 1, 2: 1, 6: 1, 19: 1, 3: 1, 1: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4802746772766113  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4802746772766113  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5573620796203613  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5573630332946777  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4802861213684082  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 11 input nodes size: 420
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480276107788086  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480276107788086  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4825186729431152  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4825191497802734  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809222221374512  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 1: 2, 7: 1, 6: 1, 5: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809322357177734  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809322357177734  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5776681900024414  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5776691436767578  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809455871582031  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 12 input nodes size: 319
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809331893920898  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809331893920898  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4826364517211914  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4826369285583496  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480393886566162  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({5: 2, 4: 2, 3: 1, 6: 1, 8: 1, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480402946472168  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480402946472168  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.55955171585083  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5595526695251465  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804143905639648  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 13 input nodes size: 229
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804043769836426  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804043769836426  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4817051887512207  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481705665588379  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800019264221191  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 3, 1: 3, 3: 3})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800081253051758  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800081253051758  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5278239250183105  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.527824878692627  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480015754699707  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 14 input nodes size: 274
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800095558166504  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800095558166504  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4814724922180176  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4814729690551758  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4801716804504395  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 2, 3: 2, 2: 2, 1: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480179786682129  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480179786682129  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5416779518127441  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5416789054870605  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4801902770996094  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 15 input nodes size: 212
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.48018217086792  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.48018217086792  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481482982635498  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4814834594726562  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800200462341309  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 4, 1: 3, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800262451171875  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800262451171875  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.522395133972168  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5223960876464844  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800338745117188  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800338745117188  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.113997459411621  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0738416463136673 |0.0006843805313110352 |0.06750346720218658 |8.957087993621826e-05 |0.10682946443557739 |0.002147674560546875 |
----------------------------------------------------------pseudo_mini_loss sum 44.96173858642578
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  8960
Number of first layer input nodes during this epoch:  5934
Number of first layer output nodes during this epoch:  2337
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1138181686401367  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.167 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.167 GB
Metis partitioning: 0.001 seconds, peak memory: 16.167 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.008 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009073734283447266
pure dgl.metis_partition the time spent:  0.011146306991577148

block_gen_time in "generate_blocks_for_one_layer_block"  0.02448892593383789


block_gen_time in "generate_blocks_for_one_layer_block"  0.026180267333984375


block_gen_time in "generate_blocks_for_one_layer_block"  0.03468012809753418

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1138181686401367  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

connection checking time:  0.04183816909790039
block generation total time  0.08534932136535645
average batch blocks generation time:  0.005334332585334778
block dataloader generation time/epoch 0.1859891414642334
pseudo mini batch 0 input nodes size: 458
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1138114929199219  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1138114929199219  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1162567138671875  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1162571907043457  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1149559020996094  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({5: 2, 4: 2, 2: 1, 6: 1, 7: 1, 9: 1, 3: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1149678230285645  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1149678230285645  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.2355222702026367  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.2355237007141113  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810137748718262  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 1 input nodes size: 494
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.48099946975708  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.48099946975708  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4836368560791016  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4836373329162598  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481191635131836  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 3, 9: 1, 2: 1, 5: 1, 1: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4812026023864746  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4812026023864746  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5833449363708496  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.583345890045166  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4812169075012207  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 2 input nodes size: 492
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4812026023864746  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4812026023864746  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4838294982910156  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4838299751281738  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4811921119689941  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 6: 2, 12: 1, 2: 1, 10: 1, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4812049865722656  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4812049865722656  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6122732162475586  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.612274169921875  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481222152709961  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 3 input nodes size: 293
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481205940246582  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481205940246582  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4830365180969238  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.483036994934082  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804096221923828  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3, 4: 2, 3: 1, 6: 1, 2: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804177284240723  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804177284240723  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5470476150512695  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.547048568725586  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804282188415527  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 4 input nodes size: 96
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804201126098633  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804201126098633  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809327125549316  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809331893920898  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4791021347045898  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 2, 6: 2, 1: 2, 5: 2, 2: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.47910737991333  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.47910737991333  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5131936073303223  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5131945610046387  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.479114055633545  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 5 input nodes size: 279
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.479109764099121  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.479109764099121  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4805994033813477  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4805998802185059  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800868034362793  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 4, 1: 2, 4: 1, 6: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800949096679688  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800949096679688  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5406041145324707  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.540605068206787  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4801054000854492  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 6 input nodes size: 444
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800972938537598  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800972938537598  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.483109474182129  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.483109951019287  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816198348999023  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({8: 2, 6: 2, 5: 1, 30: 1, 9: 1, 3: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816336631774902  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816336631774902  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6302533149719238  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6302542686462402  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816527366638184  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 7 input nodes size: 319
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816365242004395  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816365242004395  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.483339786529541  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4833402633666992  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4803276062011719  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({5: 2, 3: 2, 10: 1, 1: 1, 8: 1, 2: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4803376197814941  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4803376197814941  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5715274810791016  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.571528434753418  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4803500175476074  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 8 input nodes size: 465
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4803380966186523  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4803380966186523  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4828205108642578  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.482820987701416  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4811172485351562  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 12: 1, 30: 1, 1: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4811301231384277  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4811301231384277  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6090726852416992  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6090736389160156  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481147289276123  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 9 input nodes size: 603
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4811310768127441  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4811310768127441  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4843502044677734  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4843506813049316  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481867790222168  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({5: 2, 7: 1, 21: 1, 3: 1, 2: 1, 11: 1, 9: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4818835258483887  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4818835258483887  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.652052402496338  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6520533561706543  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481905460357666  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 10 input nodes size: 330
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4818849563598633  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4818849563598633  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4836468696594238  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.483647346496582  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804277420043945  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 4: 2, 1: 2, 19: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804368019104004  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804368019104004  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5634055137634277  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5634064674377441  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804482460021973  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 11 input nodes size: 189
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480438232421875  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480438232421875  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4817390441894531  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4817395210266113  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799771308898926  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3, 3: 2, 4: 2, 2: 2})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799842834472656  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799842834472656  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5310983657836914  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5310993194580078  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799938201904297  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 12 input nodes size: 373
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.479987621307373  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.479987621307373  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4819788932800293  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4819793701171875  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806780815124512  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 4, 4: 2, 7: 1, 3: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480687141418457  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480687141418457  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5606040954589844  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5606050491333008  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806995391845703  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 13 input nodes size: 321
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806890487670898  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806890487670898  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4831995964050293  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4832000732421875  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481208324432373  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 3, 5: 2, 4: 2, 1: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481217384338379  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481217384338379  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5591225624084473  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5591235160827637  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4812288284301758  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 14 input nodes size: 233
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4812188148498535  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4812188148498535  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4825196266174316  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4825201034545898  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800090789794922  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 1: 2, 2: 2, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800162315368652  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800162315368652  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.533836841583252  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5338377952575684  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480024814605713  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 15 input nodes size: 226
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800167083740234  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800167083740234  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4813175201416016  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4813179969787598  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800167083740234  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 3, 3: 3, 4: 2, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.48002290725708  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.48002290725708  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5306973457336426  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.530698299407959  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800305366516113  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800305366516113  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1139941215515137  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07355666160583496 |0.0006526410579681396 |0.056011542677879333 |8.723139762878418e-05 |0.101787269115448 |0.0016641616821289062 |
----------------------------------------------------------pseudo_mini_loss sum 86.65425872802734
Total (block generation + training)time/epoch 4.017334222793579
Training time/epoch 3.831207036972046
Training time without block to device /epoch 3.8207647800445557
Training time without total dataloading part /epoch 2.5278408527374268
load block tensor time/epoch 1.1769065856933594
block to device time/epoch 0.010442256927490234
input features size transfer per epoch 2.384185791015625e-06
blocks size to device per epoch 1.3113021850585938e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  8534
Number of first layer input nodes during this epoch:  5615
Number of first layer output nodes during this epoch:  2239
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1138181686401367  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.167 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.167 GB
Metis partitioning: 0.001 seconds, peak memory: 16.167 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.009 seconds
REG metis partition end ----................................
REG construction  time spent:  0.008934974670410156
pure dgl.metis_partition the time spent:  0.011206626892089844

block_gen_time in "generate_blocks_for_one_layer_block"  0.024068832397460938


block_gen_time in "generate_blocks_for_one_layer_block"  0.026044607162475586


block_gen_time in "generate_blocks_for_one_layer_block"  0.03490447998046875

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1138181686401367  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

connection checking time:  0.04245257377624512
block generation total time  0.08501791954040527
average batch blocks generation time:  0.00531361997127533
block dataloader generation time/epoch 0.1861189603805542
pseudo mini batch 0 input nodes size: 416
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1138114929199219  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1138114929199219  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.116032600402832  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1160330772399902  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.114731788635254  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({6: 2, 3: 2, 2: 1, 12: 1, 10: 1, 1: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1147446632385254  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1147446632385254  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.2371091842651367  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.2371106147766113  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807915687561035  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 1 input nodes size: 574
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807753562927246  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807753562927246  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.483839988708496  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4838404655456543  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481618881225586  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 4: 2, 5: 2, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816317558288574  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816317558288574  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6082305908203125  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.608231544494629  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816489219665527  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 2 input nodes size: 584
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816327095031738  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816327095031738  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4856629371643066  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4856634140014648  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4825983047485352  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 2, 5: 2, 2: 2, 7: 1, 9: 1, 21: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4826140403747559  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4826140403747559  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.641744613647461  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6417455673217773  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4826350212097168  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 3 input nodes size: 534
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4826149940490723  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4826149940490723  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4856796264648438  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.485680103302002  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481649398803711  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2, 2: 2, 12: 1, 10: 1, 9: 1, 3: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816622734069824  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816622734069824  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6142334938049316  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.614234447479248  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816794395446777  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 4 input nodes size: 386
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816632270812988  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816632270812988  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4837241172790527  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.483724594116211  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806594848632812  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3, 4: 2, 7: 1, 2: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480668544769287  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480668544769287  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5613369941711426  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.561337947845459  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806809425354004  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 5 input nodes size: 187
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.48067045211792  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.48067045211792  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481971263885498  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4819717407226562  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799103736877441  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 5, 5: 1, 6: 1, 4: 1, 3: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799175262451172  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799175262451172  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5315494537353516  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.531550407409668  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799270629882812  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 6 input nodes size: 558
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799208641052246  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799208641052246  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4828996658325195  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4829001426696777  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4815988540649414  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 9: 1, 5: 1, 30: 1, 4: 1, 2: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816126823425293  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816126823425293  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6211738586425781  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6211748123168945  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481630802154541  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 7 input nodes size: 191
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816126823425293  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816126823425293  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4829134941101074  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4829139709472656  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799346923828125  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 4, 3: 1, 5: 1, 1: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799408912658691  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799408912658691  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5219359397888184  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5219368934631348  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799485206604004  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 8 input nodes size: 455
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799423217773438  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799423217773438  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4823713302612305  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4823718070983887  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810705184936523  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({6: 2, 8: 2, 9: 1, 4: 1, 3: 1, 30: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810843467712402  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810843467712402  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6320624351501465  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.632063388824463  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4811034202575684  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 9 input nodes size: 263
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810872077941895  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810872077941895  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4831600189208984  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4831604957580566  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807310104370117  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 2, 5: 2, 6: 2, 8: 1, 4: 1, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807391166687012  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807391166687012  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.554616928100586  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5546178817749023  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807496070861816  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 10 input nodes size: 194
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807415008544922  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807415008544922  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4820423126220703  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4820427894592285  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799695014953613  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3, 2: 2, 3: 1, 6: 1, 5: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799776077270508  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799776077270508  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5382256507873535  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.53822660446167  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799880981445312  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 11 input nodes size: 317
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799799919128418  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799799919128418  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816722869873047  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481672763824463  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4803714752197266  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 2: 2, 5: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480379581451416  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480379581451416  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.544541358947754  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5445423126220703  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4803900718688965  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 12 input nodes size: 306
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480381965637207  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480381965637207  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.482015609741211  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4820160865783691  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480323314666748  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 4, 1: 1, 6: 1, 5: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480332374572754  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480332374572754  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.549135684967041  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5491366386413574  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4803438186645508  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 13 input nodes size: 420
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4803338050842285  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4803338050842285  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4825763702392578  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.482576847076416  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480942726135254  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 2, 1: 2, 3: 2, 19: 1, 6: 1, 2: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809527397155762  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809527397155762  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5765166282653809  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5765175819396973  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809660911560059  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 14 input nodes size: 238
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809536933898926  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809536933898926  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4822545051574707  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.482254981994629  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800119400024414  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 4, 2: 2, 3: 1, 5: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480018138885498  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480018138885498  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5298728942871094  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5298738479614258  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800257682800293  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 15 input nodes size: 270
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800195693969727  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800195693969727  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4814610481262207  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481461524963379  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4801602363586426  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 2, 1: 2, 3: 2, 2: 2, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480168342590332  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480168342590332  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5380573272705078  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5380582809448242  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4801788330078125  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4801788330078125  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1141424179077148  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07276229560375214 |0.0006451010704040527 |0.05621735751628876 |8.843839168548584e-05 |0.10444808006286621 |0.003345966339111328 |
----------------------------------------------------------pseudo_mini_loss sum 142.3855743408203
Total (block generation + training)time/epoch 4.0411070585250854
Training time/epoch 3.8785130977630615
Training time without block to device /epoch 3.8681914806365967
Training time without total dataloading part /epoch 2.5754079818725586
load block tensor time/epoch 1.1641967296600342
block to device time/epoch 0.010321617126464844
input features size transfer per epoch 2.384185791015625e-06
blocks size to device per epoch 1.3113021850585938e-06
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  8844
Number of first layer input nodes during this epoch:  5893
Number of first layer output nodes during this epoch:  2274
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1139636039733887  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.167 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.167 GB
Metis partitioning: 0.001 seconds, peak memory: 16.167 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.009 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009453535079956055
pure dgl.metis_partition the time spent:  0.011595726013183594

block_gen_time in "generate_blocks_for_one_layer_block"  0.024013280868530273


block_gen_time in "generate_blocks_for_one_layer_block"  0.025995969772338867


block_gen_time in "generate_blocks_for_one_layer_block"  0.0349888801574707

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1139636039733887  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

connection checking time:  0.04267716407775879
block generation total time  0.08499813079833984
average batch blocks generation time:  0.00531238317489624
block dataloader generation time/epoch 0.18805948893229166
pseudo mini batch 0 input nodes size: 454
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.113955020904541  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.113955020904541  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1170153617858887  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1170158386230469  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1155738830566406  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 6: 2, 10: 1, 1: 1, 4: 1, 2: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1155858039855957  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1155858039855957  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.2288150787353516  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.2288165092468262  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816288948059082  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 1 input nodes size: 408
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481614589691162  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481614589691162  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.483792781829834  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4837932586669922  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807324409484863  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 2, 1: 2, 3: 2, 12: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807424545288086  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807424545288086  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5668892860412598  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5668902397155762  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807558059692383  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 2 input nodes size: 421
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480743408203125  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480743408203125  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4829912185668945  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4829916954040527  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4808130264282227  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 2, 5: 2, 2: 2, 9: 1, 11: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4808239936828613  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4808239936828613  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5839557647705078  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5839567184448242  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4808392524719238  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 3 input nodes size: 451
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4808268547058105  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4808268547058105  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4832348823547363  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4832353591918945  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809870719909668  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({5: 2, 4: 2, 10: 1, 1: 1, 2: 1, 21: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810009002685547  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810009002685547  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6237010955810547  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.623702049255371  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810199737548828  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 4 input nodes size: 601
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481003761291504  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481003761291504  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4842123985290527  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.484212875366211  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481804370880127  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 3, 3: 3, 30: 1, 7: 1, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4818191528320312  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4818191528320312  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6385021209716797  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.638503074645996  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4818382263183594  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 5 input nodes size: 263
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4818181991577148  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4818181991577148  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.483222484588623  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4832229614257812  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800138473510742  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 2, 3: 1, 1: 1, 5: 1, 10: 1, 6: 1, 2: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800219535827637  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800219535827637  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.552809238433838  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5528101921081543  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800324440002441  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 6 input nodes size: 393
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800243377685547  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800243377685547  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4821224212646484  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4821228981018066  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807181358337402  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 2, 6: 1, 4: 1, 1: 1, 12: 1, 2: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807281494140625  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807281494140625  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.570363998413086  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5703649520874023  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807415008544922  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 7 input nodes size: 310
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480729103088379  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480729103088379  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4831328392028809  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.483133316040039  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481034755706787  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2, 3: 2, 4: 2, 5: 1, 6: 1, 2: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810428619384766  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810428619384766  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5493721961975098  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5493731498718262  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481053352355957  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 8 input nodes size: 440
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810452461242676  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810452461242676  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4833941459655762  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4833946228027344  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809904098510742  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({8: 2, 6: 2, 30: 1, 3: 1, 9: 1, 5: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481004238128662  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481004238128662  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.630016803741455  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6300177574157715  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810233116149902  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 9 input nodes size: 276
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810070991516113  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810070991516113  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.482480525970459  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4824810028076172  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4801316261291504  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 2, 4: 2, 6: 1, 8: 1, 5: 1, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4801397323608398  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4801397323608398  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5503392219543457  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.550340175628662  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4801502227783203  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 10 input nodes size: 365
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4801421165466309  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4801421165466309  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.482090950012207  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4820914268493652  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806175231933594  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 4, 1: 2, 9: 1, 4: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806265830993652  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806265830993652  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5644683837890625  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.564469337463379  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806389808654785  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 11 input nodes size: 205
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480628490447998  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480628490447998  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4819293022155762  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4819297790527344  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.47998046875  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 3, 3: 3, 1: 2, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799866676330566  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799866676330566  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5220818519592285  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.522082805633545  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.479994297027588  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 12 input nodes size: 372
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799880981445312  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799880981445312  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4819741249084473  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4819746017456055  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806733131408691  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 4, 7: 1, 19: 1, 4: 1, 3: 1, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480682373046875  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480682373046875  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5687952041625977  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.568796157836914  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806947708129883  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 13 input nodes size: 298
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806842803955078  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806842803955078  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4832000732421875  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4832005500793457  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4812140464782715  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({5: 3, 3: 2, 2: 2, 4: 1, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4812231063842773  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4812231063842773  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5553436279296875  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.555344581604004  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4812345504760742  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 14 input nodes size: 145
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481224536895752  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481224536895752  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4819989204406738  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481999397277832  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4794831275939941  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 2, 1: 2, 3: 2, 5: 1, 6: 1, 2: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4794883728027344  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4794883728027344  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.512603759765625  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5126047134399414  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4794950485229492  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 15 input nodes size: 313
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4794907569885254  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4794907569885254  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4811620712280273  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4811625480651855  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4803876876831055  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 2, 5: 2, 1: 2, 2: 2, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4803967475891113  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4803967475891113  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5584335327148438  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5584344863891602  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804081916809082  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804081916809082  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1143717765808105  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07329308986663818 |0.0006441622972488403 |0.05620706081390381 |8.891522884368896e-05 |0.10495871305465698 |0.0036618709564208984 |
----------------------------------------------------------pseudo_mini_loss sum 103.36512756347656
Total (block generation + training)time/epoch 4.056031386057536
Training time/epoch 3.893821954727173
Training time without block to device /epoch 3.8835153579711914
Training time without total dataloading part /epoch 2.5837368965148926
load block tensor time/epoch 1.172689437866211
block to device time/epoch 0.010306596755981445
input features size transfer per epoch 2.384185791015625e-06
blocks size to device per epoch 1.3113021850585938e-06
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  8626
Number of first layer input nodes during this epoch:  5715
Number of first layer output nodes during this epoch:  2232
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1141953468322754  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.167 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.167 GB
Metis partitioning: 0.001 seconds, peak memory: 16.167 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.009 seconds
REG metis partition end ----................................
REG construction  time spent:  0.01007843017578125
pure dgl.metis_partition the time spent:  0.01099395751953125

block_gen_time in "generate_blocks_for_one_layer_block"  0.023319721221923828


block_gen_time in "generate_blocks_for_one_layer_block"  0.02571725845336914


block_gen_time in "generate_blocks_for_one_layer_block"  0.03461122512817383

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1141953468322754  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

connection checking time:  0.04241013526916504
block generation total time  0.0836482048034668
average batch blocks generation time:  0.005228012800216675
block dataloader generation time/epoch 0.18831032514572144
pseudo mini batch 0 input nodes size: 440
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.114184856414795  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.114184856414795  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1170153617858887  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1170158386230469  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1153440475463867  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 2: 1, 6: 1, 12: 1, 1: 1, 10: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1153559684753418  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1153559684753418  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.2371411323547363  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.237142562866211  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4813990592956543  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 1 input nodes size: 586
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4813847541809082  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4813847541809082  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.484513282775879  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.484513759613037  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816827774047852  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 2, 6: 1, 3: 1, 21: 1, 9: 1, 10: 1, 2: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816985130310059  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816985130310059  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6494250297546387  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.649425983428955  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4817194938659668  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 2 input nodes size: 216
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816994667053223  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816994667053223  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4830002784729004  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4830007553100586  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4798717498779297  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 2, 5: 2, 1: 2, 4: 1, 2: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4798779487609863  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4798779487609863  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5267090797424316  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.526710033416748  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4798855781555176  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 3 input nodes size: 518
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.479879379272461  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.479879379272461  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.482645034790039  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4826455116271973  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481344223022461  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({5: 2, 7: 1, 9: 1, 2: 1, 3: 1, 6: 1, 4: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4813570976257324  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4813570976257324  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6190247535705566  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.619025707244873  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4813742637634277  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 4 input nodes size: 568
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4813580513000488  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4813580513000488  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4843902587890625  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4843907356262207  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816246032714844  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 4: 2, 19: 1, 12: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816393852233887  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816393852233887  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.635481834411621  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6354827880859375  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816594123840332  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 5 input nodes size: 293
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816412925720215  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816412925720215  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.483205795288086  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4832062721252441  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4801735877990723  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 2, 2: 2, 1: 2, 6: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4801826477050781  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4801826477050781  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5535740852355957  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.553575038909912  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480194091796875  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 6 input nodes size: 176
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4801840782165527  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4801840782165527  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481123924255371  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4811244010925293  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4795594215393066  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2, 2: 2, 5: 2, 3: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4795656204223633  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4795656204223633  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5225415229797363  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5225424766540527  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4795732498168945  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 7 input nodes size: 333
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.479567050933838  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.479567050933838  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4813451766967773  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4813456535339355  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480405330657959  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2, 3: 2, 2: 1, 9: 1, 6: 1, 5: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804143905639648  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804143905639648  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5600614547729492  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5600624084472656  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804258346557617  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 8 input nodes size: 448
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804158210754395  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804158210754395  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4831395149230957  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.483139991760254  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4813613891601562  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({8: 2, 6: 2, 9: 1, 30: 1, 3: 1, 5: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4813752174377441  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4813752174377441  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6306400299072266  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.630640983581543  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4813942909240723  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 9 input nodes size: 541
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4813780784606934  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4813780784606934  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4842662811279297  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.484266757965088  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4815425872802734  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2, 4: 2, 7: 1, 5: 1, 8: 1, 3: 1, 2: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481555461883545  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481555461883545  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6007013320922852  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6007022857666016  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4815726280212402  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 10 input nodes size: 186
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4815564155578613  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4815564155578613  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4828572273254395  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4828577041625977  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799690246582031  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 3, 1: 2, 6: 2, 2: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799752235412598  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799752235412598  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.527130126953125  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5271310806274414  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.479982852935791  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 11 input nodes size: 260
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799766540527344  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799766540527344  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4813647270202637  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4813652038574219  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800639152526855  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3, 3: 3, 2: 1, 6: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480072021484375  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480072021484375  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5454721450805664  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5454730987548828  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800825119018555  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 12 input nodes size: 249
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480074405670166  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480074405670166  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4814038276672363  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4814043045043945  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480015754699707  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 4, 3: 1, 7: 1, 4: 1, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.48002290725708  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.48002290725708  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5315632820129395  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5315642356872559  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800314903259277  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 13 input nodes size: 301
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800233840942383  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800233840942383  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4818077087402344  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4818081855773926  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480478286743164  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 5, 3: 2, 1: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804863929748535  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804863929748535  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5413908958435059  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5413918495178223  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480496883392334  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 14 input nodes size: 276
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804887771606445  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804887771606445  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4819622039794922  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4819626808166504  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480177879333496  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 3, 4: 2, 3: 2, 1: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4801859855651855  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4801859855651855  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5418648719787598  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5418658256530762  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480196475982666  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 15 input nodes size: 208
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4801883697509766  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4801883697509766  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4814891815185547  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481489658355713  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480015754699707  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({5: 2, 3: 2, 4: 2, 2: 1, 6: 1, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800238609313965  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800238609313965  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5426902770996094  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5426912307739258  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480034351348877  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480034351348877  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1139979362487793  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07178637385368347 |0.0006502866744995117 |0.05613914132118225 |8.67694616317749e-05 |0.10339944064617157 |0.003880023956298828 |
----------------------------------------------------------pseudo_mini_loss sum 65.98342895507812
Total (block generation + training)time/epoch 4.050383448600769
Training time/epoch 3.844259023666382
Training time without block to device /epoch 3.8338544368743896
Training time without total dataloading part /epoch 2.5578856468200684
load block tensor time/epoch 1.1485819816589355
block to device time/epoch 0.010404586791992188
input features size transfer per epoch 2.384185791015625e-06
blocks size to device per epoch 1.3113021850585938e-06
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  8486
Number of first layer input nodes during this epoch:  5599
Number of first layer output nodes during this epoch:  2211
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1138229370117188  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.167 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.167 GB
Metis partitioning: 0.001 seconds, peak memory: 16.167 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.009 seconds
REG metis partition end ----................................
REG construction  time spent:  0.010921001434326172
pure dgl.metis_partition the time spent:  0.011059284210205078

block_gen_time in "generate_blocks_for_one_layer_block"  0.02422356605529785


block_gen_time in "generate_blocks_for_one_layer_block"  0.026243209838867188


block_gen_time in "generate_blocks_for_one_layer_block"  0.03654360771179199

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1138229370117188  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

connection checking time:  0.04332399368286133
block generation total time  0.08701038360595703
average batch blocks generation time:  0.0054381489753723145
block dataloader generation time/epoch 0.18813586235046387
pseudo mini batch 0 input nodes size: 423
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.113814353942871  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.113814353942871  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.116072654724121  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1160731315612793  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.114771842956543  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 2, 2: 2, 9: 1, 3: 1, 5: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.114783763885498  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.114783763885498  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.2222185134887695  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.2222199440002441  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4808268547058105  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 1 input nodes size: 587
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4808125495910645  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4808125495910645  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4839463233947754  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4839468002319336  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816880226135254  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2, 3: 2, 5: 1, 11: 1, 6: 1, 7: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4817018508911133  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4817018508911133  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6149992942810059  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6150002479553223  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481719970703125  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 2 input nodes size: 494
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4817018508911133  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4817018508911133  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4843392372131348  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.484339714050293  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4812054634094238  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 2, 6: 2, 4: 1, 2: 1, 12: 1, 1: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4812183380126953  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4812183380126953  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6153392791748047  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.615340232849121  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4812355041503906  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 3 input nodes size: 339
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4812192916870117  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4812192916870117  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4830293655395508  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.483029842376709  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4803919792175293  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 2: 2, 4: 2, 5: 1, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804010391235352  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804010391235352  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5616626739501953  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5616636276245117  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804134368896484  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 4 input nodes size: 451
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480402946472168  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480402946472168  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4828109741210938  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.482811450958252  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810009002685547  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({8: 2, 6: 2, 5: 1, 30: 1, 3: 1, 9: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810147285461426  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810147285461426  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6314802169799805  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6314811706542969  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810338020324707  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 5 input nodes size: 319
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810175895690918  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810175895690918  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4831113815307617  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.48311185836792  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480703353881836  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 2, 6: 2, 5: 2, 3: 2, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807124137878418  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807124137878418  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5554051399230957  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.555406093597412  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807238578796387  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 6 input nodes size: 405
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807138442993164  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807138442993164  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4831218719482422  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4831223487854004  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810280799865723  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 2, 1: 2, 4: 2, 2: 1, 10: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810380935668945  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810380935668945  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5723228454589844  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5723237991333008  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810514450073242  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 7 input nodes size: 281
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481039047241211  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481039047241211  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4831328392028809  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.483133316040039  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480724811553955  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 3, 3: 2, 5: 2, 4: 1, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480733871459961  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480733871459961  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.553567886352539  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5535688400268555  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807453155517578  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 8 input nodes size: 57
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807353019714355  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807353019714355  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810400009155273  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810404777526855  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4789462089538574  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2, 4: 2, 3: 1, 6: 1, 2: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4789505004882812  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4789505004882812  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4969091415405273  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4969100952148438  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4789562225341797  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 9 input nodes size: 610
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4789538383483887  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4789538383483887  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.482210636138916  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4822111129760742  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4819059371948242  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 2, 3: 2, 2: 2, 19: 1, 30: 1, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4819207191467285  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4819207191467285  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.638716220855713  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6387171745300293  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481940746307373  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 10 input nodes size: 466
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4819226264953613  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4819226264953613  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4844107627868652  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4844112396240234  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481153964996338  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 4: 2, 5: 2, 2: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481165885925293  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481165885925293  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5968198776245117  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5968208312988281  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4811820983886719  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 11 input nodes size: 263
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4811677932739258  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4811677932739258  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.482572078704834  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4825725555419922  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.48008394241333  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3, 2: 2, 4: 1, 7: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800920486450195  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800920486450195  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5362529754638672  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5362539291381836  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4801025390625  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 12 input nodes size: 488
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800944328308105  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800944328308105  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.483191967010498  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4831924438476562  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4817876815795898  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 2, 8: 1, 9: 1, 5: 1, 1: 1, 3: 1, 2: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4817986488342285  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4817986488342285  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.588193416595459  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5881943702697754  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4818129539489746  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 13 input nodes size: 444
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4817986488342285  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4817986488342285  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4841690063476562  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4841694831848145  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810714721679688  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 3, 1: 3, 7: 1, 6: 1, 3: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481081485748291  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481081485748291  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5773425102233887  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.577343463897705  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810948371887207  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 14 input nodes size: 175
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810824394226074  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810824394226074  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4820170402526855  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4820175170898438  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4796466827392578  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 4, 3: 2, 5: 1, 4: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4796538352966309  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4796538352966309  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5305161476135254  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5305171012878418  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.479663372039795  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 15 input nodes size: 420
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4796571731567383  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4796571731567383  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4818997383117676  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4819002151489258  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809651374816895  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 3, 1: 2, 6: 1, 3: 1, 21: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809770584106445  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809770584106445  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.598386287689209  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5983872413635254  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809932708740234  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809932708740234  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1149568557739258  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0721118301153183 |0.0006499141454696655 |0.05932892858982086 |8.83936882019043e-05 |0.11907802522182465 |0.003286600112915039 |
----------------------------------------------------------pseudo_mini_loss sum 33.97395324707031
Total (block generation + training)time/epoch 4.10750184059143
Training time/epoch 4.148422479629517
Training time without block to device /epoch 4.138023853302002
Training time without total dataloading part /epoch 2.8592121601104736
load block tensor time/epoch 1.1537892818450928
block to device time/epoch 0.010398626327514648
input features size transfer per epoch 2.384185791015625e-06
blocks size to device per epoch 1.3113021850585938e-06
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  9355
Number of first layer input nodes during this epoch:  6222
Number of first layer output nodes during this epoch:  2446
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.114774227142334  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.167 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.167 GB
Metis partitioning: 0.001 seconds, peak memory: 16.167 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.009 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009479999542236328
pure dgl.metis_partition the time spent:  0.011523246765136719

block_gen_time in "generate_blocks_for_one_layer_block"  0.024005889892578125


block_gen_time in "generate_blocks_for_one_layer_block"  0.026285886764526367


block_gen_time in "generate_blocks_for_one_layer_block"  0.035204172134399414

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.114774227142334  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

connection checking time:  0.042168617248535156
block generation total time  0.0854959487915039
average batch blocks generation time:  0.005343496799468994
block dataloader generation time/epoch 0.18878920873006186
pseudo mini batch 0 input nodes size: 470
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1147594451904297  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1147594451904297  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1172685623168945  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1172690391540527  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1150259971618652  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 6: 2, 1: 1, 10: 1, 4: 1, 2: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1150379180908203  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1150379180908203  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.2313904762268066  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.2313919067382812  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810776710510254  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 1 input nodes size: 538
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810633659362793  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810633659362793  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.483935832977295  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4839363098144531  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.48142671585083  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 2, 3: 1, 6: 1, 5: 1, 2: 1, 21: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4814414978027344  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4814414978027344  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6394147872924805  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6394157409667969  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481461524963379  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 2 input nodes size: 497
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4814434051513672  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4814434051513672  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4840970039367676  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4840974807739258  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481224536895752  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 2, 1: 1, 5: 1, 10: 1, 9: 1, 11: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4812374114990234  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4812374114990234  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6083412170410156  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.608342170715332  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4812545776367188  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 3 input nodes size: 197
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4812383651733398  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4812383651733398  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.482539176940918  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4825396537780762  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4798855781555176  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 3, 2: 3, 3: 3})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4798917770385742  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4798917770385742  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.526320457458496  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5263214111328125  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4798994064331055  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 4 input nodes size: 412
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4798932075500488  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4798932075500488  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4820928573608398  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.482093334197998  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807920455932617  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({5: 2, 4: 2, 3: 2, 6: 1, 2: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4808030128479004  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4808030128479004  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5858092308044434  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5858101844787598  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480818271636963  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 5 input nodes size: 339
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4808058738708496  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4808058738708496  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4831080436706543  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4831085205078125  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809083938598633  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 4, 6: 1, 7: 1, 3: 1, 2: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809174537658691  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809174537658691  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5600876808166504  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5600886344909668  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809298515319824  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 6 input nodes size: 349
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480919361114502  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480919361114502  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.483119010925293  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4831194877624512  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4808168411254883  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2, 5: 2, 2: 2, 3: 2, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4808268547058105  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4808268547058105  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5656418800354004  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5656428337097168  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4808392524719238  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 7 input nodes size: 227
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4808273315429688  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4808273315429688  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4821281433105469  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.482128620147705  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799284934997559  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 2, 2: 2, 1: 2, 4: 1, 5: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.479935646057129  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.479935646057129  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5308079719543457  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.530808925628662  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.479945182800293  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 8 input nodes size: 427
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799389839172363  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799389839172363  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4822187423706055  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4822192192077637  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809179306030273  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({8: 2, 6: 2, 9: 1, 4: 1, 3: 1, 5: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809317588806152  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809317588806152  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6250476837158203  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6250486373901367  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809508323669434  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 9 input nodes size: 187
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809346199035645  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809346199035645  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4822354316711426  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4822359085083008  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799556732177734  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 4: 2, 1: 1, 2: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.47996187210083  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.47996187210083  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5237317085266113  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5237326622009277  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799695014953613  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 10 input nodes size: 287
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799633026123047  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799633026123047  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4814958572387695  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4814963340759277  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4801950454711914  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 4, 3: 2, 4: 2, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4802031517028809  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4802031517028809  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5399484634399414  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5399494171142578  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4802136421203613  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 11 input nodes size: 286
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4802055358886719  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4802055358886719  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4817323684692383  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4817328453063965  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4801998138427734  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({5: 2, 2: 2, 1: 1, 6: 1, 3: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4802088737487793  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4802088737487793  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5526189804077148  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5526199340820312  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4802203178405762  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 12 input nodes size: 399
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480210304260254  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480210304260254  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4823403358459473  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4823408126831055  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4808135032653809  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 2, 4: 2, 1: 2, 5: 1, 6: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4808244705200195  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4808244705200195  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5798821449279785  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.579883098602295  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480839729309082  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 13 input nodes size: 332
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4808273315429688  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4808273315429688  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4825997352600098  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.482600212097168  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804697036743164  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 2, 1: 2, 2: 2, 8: 1, 5: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804787635803223  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804787635803223  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5605120658874512  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5605130195617676  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804902076721191  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 14 input nodes size: 457
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804801940917969  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804801940917969  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4832096099853516  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4832100868225098  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4814372062683105  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 1: 2, 4: 1, 2: 1, 12: 1, 19: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4814491271972656  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4814491271972656  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5901517868041992  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5901527404785156  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4814653396606445  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 15 input nodes size: 402
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4814510345458984  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4814510345458984  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4835972785949707  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.483597755432129  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480867862701416  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 2, 4: 2, 5: 2, 6: 1, 7: 1, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4808788299560547  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4808788299560547  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5812830924987793  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5812840461730957  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4808940887451172  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4808940887451172  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1148576736450195  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07201306521892548 |0.0006552338600158691 |0.057436466217041016 |8.691847324371338e-05 |0.11124514043331146 |0.0033152103424072266 |
----------------------------------------------------------pseudo_mini_loss sum 31.986913681030273
Total (block generation + training)time/epoch 4.1204313437143965
Training time/epoch 3.9929070472717285
Training time without block to device /epoch 3.9824233055114746
Training time without total dataloading part /epoch 2.7036116123199463
load block tensor time/epoch 1.1522090435028076
block to device time/epoch 0.010483741760253906
input features size transfer per epoch 2.384185791015625e-06
blocks size to device per epoch 1.3113021850585938e-06
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  8766
Number of first layer input nodes during this epoch:  5806
Number of first layer output nodes during this epoch:  2282
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1146759986877441  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.167 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.167 GB
Metis partitioning: 0.001 seconds, peak memory: 16.167 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.009 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009261369705200195
pure dgl.metis_partition the time spent:  0.010953426361083984

block_gen_time in "generate_blocks_for_one_layer_block"  0.02404475212097168


block_gen_time in "generate_blocks_for_one_layer_block"  0.025944948196411133


block_gen_time in "generate_blocks_for_one_layer_block"  0.03505396842956543

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1146759986877441  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

connection checking time:  0.0432889461517334
block generation total time  0.08504366874694824
average batch blocks generation time:  0.005315229296684265
block dataloader generation time/epoch 0.1881723063332694
pseudo mini batch 0 input nodes size: 448
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1146631240844727  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1146631240844727  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1170549392700195  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1170554161071777  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1149086952209473  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({6: 2, 8: 2, 3: 1, 4: 1, 30: 1, 5: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1149225234985352  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1149225234985352  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.264322280883789  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.2643237113952637  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809651374816895  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 1 input nodes size: 351
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809489250183105  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809489250183105  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4830589294433594  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4830594062805176  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806671142578125  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({5: 2, 4: 2, 3: 1, 6: 1, 2: 1, 8: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806771278381348  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806771278381348  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5714240074157715  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.571424961090088  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806904792785645  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 2 input nodes size: 347
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806780815124512  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806780815124512  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.483069896697998  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4830703735351562  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809598922729492  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 3, 3: 2, 5: 2, 2: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480968952178955  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480968952178955  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.566819667816162  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5668206214904785  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809813499450684  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 3 input nodes size: 320
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480970859527588  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480970859527588  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4830808639526367  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.483081340789795  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806890487670898  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 4: 2, 19: 1, 1: 1, 6: 1, 2: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806981086730957  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806981086730957  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5583853721618652  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5583863258361816  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807095527648926  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 4 input nodes size: 440
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806995391845703  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806995391845703  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4830913543701172  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4830918312072754  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809813499450684  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 1: 1, 4: 1, 12: 1, 2: 1, 10: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809942245483398  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809942245483398  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.60310697555542  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6031079292297363  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810113906860352  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 5 input nodes size: 653
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809951782226562  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809951782226562  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4844813346862793  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4844818115234375  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4820895195007324  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 2, 11: 1, 7: 1, 5: 1, 9: 1, 3: 1, 2: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4821033477783203  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4821033477783203  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6296672821044922  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6296682357788086  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.482121467590332  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 6 input nodes size: 404
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4821033477783203  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4821033477783203  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.484260082244873  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4842605590820312  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.48077392578125  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 2, 21: 1, 10: 1, 12: 1, 3: 1, 2: 1, 5: 1, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480785846710205  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480785846710205  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.607222557067871  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6072235107421875  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480802059173584  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 7 input nodes size: 179
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480787754058838  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480787754058838  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481743335723877  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4817438125610352  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4795866012573242  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 4, 3: 3, 5: 2})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4795928001403809  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4795928001403809  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5238518714904785  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.523852825164795  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.479600429534912  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 8 input nodes size: 692
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4795942306518555  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4795942306518555  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4840960502624512  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4840965270996094  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.483140468597412  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 4: 2, 9: 1, 2: 1, 30: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4831562042236328  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4831562042236328  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.652306079864502  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6523070335388184  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4831771850585938  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 9 input nodes size: 268
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4831571578979492  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4831571578979492  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4845881462097168  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.484588623046875  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480086326599121  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 1: 2, 4: 1, 5: 1, 2: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800944328308105  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800944328308105  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5391998291015625  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.539200782775879  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480104923248291  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 10 input nodes size: 240
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800968170166016  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800968170166016  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4813976287841797  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481398105621338  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.479966640472412  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 4, 6: 2, 5: 1, 1: 1, 3: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799747467041016  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799747467041016  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5383315086364746  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.538332462310791  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.479985237121582  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 11 input nodes size: 368
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799771308898926  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799771308898926  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4819416999816895  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4819421768188477  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806408882141113  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({5: 2, 1: 2, 7: 1, 2: 1, 4: 1, 6: 1, 3: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806509017944336  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806509017944336  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5673284530639648  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5673294067382812  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806642532348633  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 12 input nodes size: 332
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.48065185546875  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.48065185546875  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4831891059875488  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.483189582824707  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481224536895752  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 3, 1: 1, 4: 1, 7: 1, 9: 1, 6: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4812345504760742  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4812345504760742  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5738167762756348  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5738177299499512  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4812488555908203  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 13 input nodes size: 320
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4812383651733398  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4812383651733398  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4832029342651367  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.483203411102295  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480665683746338  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 2: 2, 1: 2, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806737899780273  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806737899780273  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5389904975891113  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5389914512634277  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806842803955078  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 14 input nodes size: 159
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806761741638184  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806761741638184  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4815254211425781  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4815258979797363  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4795608520507812  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 3, 1: 2, 4: 2, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.479567050933838  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.479567050933838  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5215258598327637  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.52152681350708  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4795746803283691  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 15 input nodes size: 213
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4795684814453125  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4795684814453125  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4808692932128906  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4808697700500488  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800200462341309  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 4, 1: 3, 5: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800262451171875  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800262451171875  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5290460586547852  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5290470123291016  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800338745117188  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800338745117188  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.113997459411621  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07022160291671753 |0.0006452351808547974 |0.05612599849700928 |8.504092693328857e-05 |0.10633617639541626 |0.0037598609924316406 |
----------------------------------------------------------pseudo_mini_loss sum 17.9510440826416
Total (block generation + training)time/epoch 4.11032577923366
Training time/epoch 3.8651058673858643
Training time without block to device /epoch 3.8547821044921875
Training time without total dataloading part /epoch 2.604515314102173
load block tensor time/epoch 1.1235456466674805
block to device time/epoch 0.010323762893676758
input features size transfer per epoch 2.384185791015625e-06
blocks size to device per epoch 1.3113021850585938e-06
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  8667
Number of first layer input nodes during this epoch:  5734
Number of first layer output nodes during this epoch:  2247
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1138181686401367  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.167 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.167 GB
Metis partitioning: 0.001 seconds, peak memory: 16.167 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.009 seconds
REG metis partition end ----................................
REG construction  time spent:  0.00849008560180664
pure dgl.metis_partition the time spent:  0.01112055778503418

block_gen_time in "generate_blocks_for_one_layer_block"  0.02376389503479004


block_gen_time in "generate_blocks_for_one_layer_block"  0.02580547332763672


block_gen_time in "generate_blocks_for_one_layer_block"  0.035065650939941406

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1138181686401367  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

connection checking time:  0.04209113121032715
block generation total time  0.08463501930236816
average batch blocks generation time:  0.00528968870639801
block dataloader generation time/epoch 0.18768295645713806
pseudo mini batch 0 input nodes size: 420
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1138114929199219  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1138114929199219  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1160540580749512  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1160545349121094  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.114753246307373  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({6: 2, 3: 2, 10: 1, 2: 1, 12: 1, 1: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1147651672363281  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1147651672363281  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.2382283210754395  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.238229751586914  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4808111190795898  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 1 input nodes size: 447
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807968139648438  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807968139648438  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4831833839416504  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4831838607788086  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480940818786621  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 5, 5: 2, 2: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809517860412598  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809517860412598  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.58146333694458  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5814642906188965  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809660911560059  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 2 input nodes size: 480
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809517860412598  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809517860412598  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4835143089294434  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4835147857666016  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4811277389526367  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({5: 2, 9: 1, 1: 1, 21: 1, 4: 1, 10: 1, 3: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481142520904541  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481142520904541  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.636457920074463  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6364588737487793  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4811625480651855  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 3 input nodes size: 351
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4811444282531738  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4811444282531738  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.483083724975586  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4830842018127441  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4805212020874023  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 3, 5: 2, 10: 1, 7: 1, 3: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480532169342041  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480532169342041  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.579813003540039  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5798139572143555  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4805474281311035  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 4 input nodes size: 560
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4805350303649902  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4805350303649902  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4835247993469238  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.483525276184082  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4815855026245117  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 4: 2, 19: 1, 30: 1, 2: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4815983772277832  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4815983772277832  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6225528717041016  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.622553825378418  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816155433654785  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 5 input nodes size: 296
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4815993309020996  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4815993309020996  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4831795692443848  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.483180046081543  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4801898002624512  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 4, 4: 2, 1: 2})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4801969528198242  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4801969528198242  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5375633239746094  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5375642776489258  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4802055358886719  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 6 input nodes size: 301
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4801974296569824  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4801974296569824  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.482722282409668  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4827227592468262  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4811420440673828  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 4, 2: 1, 5: 1, 3: 1, 9: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4811501502990723  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4811501502990723  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.545699119567871  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5457000732421875  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4811606407165527  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 7 input nodes size: 401
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4811525344848633  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4811525344848633  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4832935333251953  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4832940101623535  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807686805725098  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 3, 5: 2, 3: 2, 1: 1, 2: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480778694152832  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480778694152832  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5646486282348633  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5646495819091797  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807920455932617  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 8 input nodes size: 447
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807796478271484  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807796478271484  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.483166217803955  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4831666946411133  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481025218963623  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({6: 2, 8: 2, 5: 1, 3: 1, 30: 1, 9: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481039047241211  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481039047241211  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6313042640686035  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.63130521774292  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481058120727539  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 9 input nodes size: 217
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810419082641602  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810419082641602  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4823427200317383  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4823431968688965  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799561500549316  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 2, 2: 2, 3: 2, 8: 1, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.479964256286621  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.479964256286621  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5342216491699219  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5342226028442383  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799747467041016  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 10 input nodes size: 391
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.479966640472412  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.479966640472412  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4820542335510254  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4820547103881836  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807534217834473  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({6: 3, 4: 2, 7: 1, 5: 1, 1: 1, 2: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807634353637695  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807634353637695  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5749077796936035  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.57490873336792  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807767868041992  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 11 input nodes size: 304
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480764389038086  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480764389038086  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4831786155700684  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4831790924072266  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481091022491455  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 3, 1: 2, 2: 1, 6: 1, 3: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810991287231445  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810991287231445  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.550917625427246  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5509185791015625  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481109619140625  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 12 input nodes size: 319
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4811015129089355  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4811015129089355  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4831891059875488  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.483189582824707  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807748794555664  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 2, 1: 2, 7: 1, 4: 1, 3: 1, 6: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807839393615723  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807839393615723  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5588874816894531  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5588884353637695  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807963371276855  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 13 input nodes size: 375
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480785846710205  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480785846710205  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4832000732421875  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4832005500793457  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4811124801635742  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 2, 2: 2, 3: 1, 9: 1, 5: 1, 1: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4811224937438965  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4811224937438965  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5697474479675293  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5697484016418457  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4811358451843262  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 14 input nodes size: 192
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481123447418213  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481123447418213  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.482424259185791  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4824247360229492  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800100326538086  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 2: 2, 1: 2, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800162315368652  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800162315368652  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5227422714233398  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5227432250976562  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800238609313965  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 15 input nodes size: 305
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800176620483398  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800176620483398  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816460609436035  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816465377807617  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4803452491760254  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 3, 1: 2, 3: 2, 4: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4803543090820312  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4803543090820312  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5491423606872559  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5491433143615723  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4803657531738281  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4803657531738281  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1143293380737305  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07476678490638733 |0.0006429851055145264 |0.05614325404167175 |8.86768102645874e-05 |0.10361942648887634 |0.0036363601684570312 |
----------------------------------------------------------pseudo_mini_loss sum 8.304447174072266
Total (block generation + training)time/epoch 4.10651370882988
Training time/epoch 3.895455837249756
Training time without block to device /epoch 3.8851680755615234
Training time without total dataloading part /epoch 2.56125807762146
load block tensor time/epoch 1.1962685585021973
block to device time/epoch 0.010287761688232422
input features size transfer per epoch 2.384185791015625e-06
blocks size to device per epoch 1.3113021850585938e-06
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  8754
Number of first layer input nodes during this epoch:  5806
Number of first layer output nodes during this epoch:  2274
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.114152431488037  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.167 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.167 GB
Metis partitioning: 0.001 seconds, peak memory: 16.167 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.009 seconds
REG metis partition end ----................................
REG construction  time spent:  0.008738040924072266
pure dgl.metis_partition the time spent:  0.011296272277832031

block_gen_time in "generate_blocks_for_one_layer_block"  0.023580074310302734


block_gen_time in "generate_blocks_for_one_layer_block"  0.02598714828491211


block_gen_time in "generate_blocks_for_one_layer_block"  0.03573942184448242

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.114152431488037  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

connection checking time:  0.04267263412475586
block generation total time  0.08530664443969727
average batch blocks generation time:  0.005331665277481079
block dataloader generation time/epoch 0.18743080563015407
pseudo mini batch 0 input nodes size: 433
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1141419410705566  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1141419410705566  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1170153617858887  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1170158386230469  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.115386962890625  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 6: 1, 12: 1, 10: 1, 2: 1, 1: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1153998374938965  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1153998374938965  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.2371349334716797  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.2371363639831543  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4814438819885254  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 1 input nodes size: 601
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4814276695251465  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4814276695251465  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4846363067626953  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4846367835998535  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4817628860473633  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({5: 1, 8: 1, 6: 1, 9: 1, 4: 1, 3: 1, 10: 1, 2: 1, 21: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481778621673584  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481778621673584  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.656148910522461  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6561498641967773  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4818005561828613  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 2 input nodes size: 604
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4817800521850586  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4817800521850586  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.485666275024414  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4856667518615723  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4824576377868652  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 12: 1, 7: 1, 2: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4824714660644531  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4824714660644531  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6347770690917969  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6347780227661133  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4824895858764648  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 3 input nodes size: 463
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4824714660644531  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4824714660644531  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.485680103302002  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4856805801391602  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4817938804626465  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({5: 2, 4: 2, 6: 1, 2: 1, 9: 1, 3: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4818058013916016  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4818058013916016  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6018905639648438  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6018915176391602  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4818220138549805  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 4 input nodes size: 341
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4818077087402344  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4818077087402344  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.483628273010254  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.483628749847412  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480419635772705  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({6: 2, 5: 2, 8: 2, 9: 1, 3: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804315567016602  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804315567016602  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5918350219726562  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5918359756469727  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480447769165039  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 5 input nodes size: 523
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480433464050293  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480433464050293  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4836421012878418  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.483642578125  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4818215370178223  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 4: 2, 5: 1, 1: 1, 6: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4818363189697266  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4818363189697266  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6367206573486328  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6367216110229492  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481856346130371  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 6 input nodes size: 119
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4818382263183594  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4818382263183594  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4824738502502441  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4824743270874023  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4792652130126953  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 5, 2: 1, 5: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4792704582214355  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4792704582214355  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.507084846496582  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5070858001708984  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4792771339416504  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 7 input nodes size: 257
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4792728424072266  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4792728424072266  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806451797485352  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806456565856934  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800095558166504  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 5, 3: 2, 4: 1, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480015754699707  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480015754699707  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.529862403869629  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5298633575439453  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800233840942383  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 8 input nodes size: 147
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800171852111816  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800171852111816  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480802059173584  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4808025360107422  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4794297218322754  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 2: 2, 1: 2, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4794349670410156  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4794349670410156  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.508718490600586  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5087194442749023  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4794416427612305  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 9 input nodes size: 338
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4794373512268066  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4794373512268066  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4812421798706055  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4812426567077637  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804573059082031  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 4, 4: 2, 7: 1, 2: 1, 3: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480466365814209  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480466365814209  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5540757179260254  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5540766716003418  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804778099060059  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 10 input nodes size: 375
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804677963256836  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804677963256836  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4831647872924805  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4831652641296387  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4813599586486816  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({6: 2, 4: 2, 2: 2, 3: 1, 1: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481369972229004  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481369972229004  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5688843727111816  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.568885326385498  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4813833236694336  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 11 input nodes size: 308
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4813709259033203  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4813709259033203  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4831757545471191  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4831762313842773  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804787635803223  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 2, 5: 2, 3: 2, 4: 1, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804868698120117  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804868698120117  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5480265617370605  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.548027515411377  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804973602294922  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 12 input nodes size: 307
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804892539978027  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804892539978027  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4821281433105469  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.482128620147705  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480323314666748  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({5: 2, 4: 2, 3: 2, 6: 2, 19: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480332374572754  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480332374572754  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5630168914794922  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5630178451538086  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4803438186645508  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 13 input nodes size: 458
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4803338050842285  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4803338050842285  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4827790260314941  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4827795028686523  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.48114013671875  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 4, 2: 2, 3: 1, 5: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481152057647705  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481152057647705  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5883703231811523  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5883712768554688  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481168270111084  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 14 input nodes size: 245
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481153964996338  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481153964996338  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.482461929321289  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4824624061584473  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800167083740234  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 4, 1: 3, 5: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800238609313965  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800238609313965  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5322790145874023  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5322799682617188  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800333976745605  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 15 input nodes size: 356
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480027198791504  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480027198791504  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4819278717041016  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4819283485412598  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806199073791504  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 2, 5: 1, 3: 1, 9: 1, 7: 1, 10: 1, 1: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806289672851562  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806289672851562  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.563568115234375  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5635690689086914  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806404113769531  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806404113769531  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1146039962768555  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0692998468875885 |0.0006439685821533203 |0.05588601529598236 |8.685886859893799e-05 |0.10593417286872864 |0.0038759708404541016 |
----------------------------------------------------------pseudo_mini_loss sum 8.077279090881348
Total (block generation + training)time/epoch 4.097578763961792
Training time/epoch 3.840543746948242
Training time without block to device /epoch 3.830240249633789
Training time without total dataloading part /epoch 2.594388723373413
load block tensor time/epoch 1.108797550201416
block to device time/epoch 0.010303497314453125
input features size transfer per epoch 2.384185791015625e-06
blocks size to device per epoch 1.3113021850585938e-06
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  8855
Number of first layer input nodes during this epoch:  5875
Number of first layer output nodes during this epoch:  2301
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.114424705505371  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.167 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.167 GB
Metis partitioning: 0.001 seconds, peak memory: 16.167 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.009 seconds
REG metis partition end ----................................
REG construction  time spent:  0.00845789909362793
pure dgl.metis_partition the time spent:  0.011192560195922852

block_gen_time in "generate_blocks_for_one_layer_block"  0.024261474609375


block_gen_time in "generate_blocks_for_one_layer_block"  0.025732755661010742


block_gen_time in "generate_blocks_for_one_layer_block"  0.03493976593017578

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.114424705505371  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

connection checking time:  0.04190635681152344
block generation total time  0.08493399620056152
average batch blocks generation time:  0.005308374762535095
block dataloader generation time/epoch 0.18685379028320312
pseudo mini batch 0 input nodes size: 588
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1144142150878906  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1144142150878906  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1175532341003418  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1175537109375  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1156525611877441  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 4: 1, 30: 1, 5: 1, 19: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1156682968139648  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1156682968139648  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.283005714416504  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.2830071449279785  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4817161560058594  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 1 input nodes size: 394
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816961288452148  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816961288452148  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4837994575500488  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.483799934387207  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806604385375977  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3, 2: 2, 5: 1, 3: 1, 4: 1, 8: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.48067045211792  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.48067045211792  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5652837753295898  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5652847290039062  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806838035583496  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 2 input nodes size: 459
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806714057922363  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806714057922363  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4838104248046875  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4838109016418457  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4817070960998535  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({5: 2, 2: 1, 4: 1, 3: 1, 10: 1, 21: 1, 1: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4817209243774414  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4817209243774414  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6244301795959473  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6244311332702637  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4817399978637695  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 3 input nodes size: 220
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4817237854003906  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4817237854003906  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4830245971679688  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.483025074005127  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4798855781555176  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2, 2: 2, 3: 1, 6: 1, 4: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.479893684387207  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.479893684387207  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.534069538116455  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5340704917907715  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799041748046875  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 4 input nodes size: 46
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.479896068572998  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.479896068572998  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4801416397094727  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4801421165466309  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4788408279418945  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 3, 3: 2, 1: 1, 6: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4788451194763184  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4788451194763184  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5007939338684082  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5007948875427246  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4788508415222168  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 5 input nodes size: 336
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4788484573364258  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4788484573364258  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480642318725586  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806427955627441  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4803967475891113  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 3, 1: 3, 4: 2, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804058074951172  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804058074951172  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.546879768371582  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5468807220458984  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480417251586914  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 6 input nodes size: 300
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804072380065918  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804072380065918  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.482008934020996  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4820094108581543  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480215072631836  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({5: 3, 6: 2, 2: 2, 3: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4802241325378418  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4802241325378418  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5669455528259277  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5669465065002441  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4802355766296387  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 7 input nodes size: 157
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4802255630493164  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4802255630493164  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810638427734375  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810643196105957  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4794621467590332  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 2, 3: 2, 4: 2, 1: 2})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4794683456420898  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4794683456420898  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5160365104675293  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5160374641418457  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.479475975036621  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 8 input nodes size: 417
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4794697761535645  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4794697761535645  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816961288452148  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481696605682373  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4808578491210938  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 2, 6: 2, 12: 1, 4: 1, 10: 1, 2: 1, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4808697700500488  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4808697700500488  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6025638580322266  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.602564811706543  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4808859825134277  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 9 input nodes size: 458
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4808716773986816  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4808716773986816  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4833168983459473  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4833173751831055  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810905456542969  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 11: 1, 5: 1, 6: 1, 2: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4811005592346191  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4811005592346191  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5760726928710938  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5760736465454102  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4811139106750488  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 10 input nodes size: 373
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4811015129089355  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4811015129089355  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4830927848815918  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.48309326171875  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806475639343262  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3, 7: 2, 2: 2, 4: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806575775146484  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806575775146484  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5690159797668457  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.569016933441162  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806709289550781  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 11 input nodes size: 613
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806585311889648  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806585311889648  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.483931064605713  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.483931541442871  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4819397926330566  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 2, 4: 2, 7: 2, 6: 1, 9: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4819536209106445  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4819536209106445  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6218452453613281  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6218461990356445  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4819717407226562  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 12 input nodes size: 440
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4819536209106445  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4819536209106445  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4843025207519531  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4843029975891113  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481029987335205  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({6: 2, 8: 2, 4: 1, 3: 1, 5: 1, 30: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481043815612793  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481043815612793  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.628401279449463  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6284022331237793  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481062889099121  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 13 input nodes size: 300
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810466766357422  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810466766357422  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4826483726501465  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4826488494873047  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480299472808838  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 2: 2, 4: 2, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4803075790405273  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4803075790405273  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5463166236877441  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5463175773620605  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4803180694580078  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 14 input nodes size: 221
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4803099632263184  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4803099632263184  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816107749938965  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816112518310547  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800090789794922  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 3, 1: 2, 4: 2, 6: 1, 3: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800171852111816  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800171852111816  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5341038703918457  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.534104824066162  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480027675628662  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 15 input nodes size: 258
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800195693969727  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800195693969727  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4813971519470215  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4813976287841797  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800963401794434  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 2, 1: 2, 3: 2, 4: 2, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4801044464111328  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4801044464111328  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.53654146194458  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5365424156188965  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4801149368286133  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4801149368286133  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1140785217285156  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.069035604596138 |0.0006454437971115112 |0.05496303737163544 |8.487701416015625e-05 |0.10478070378303528 |0.0018155574798583984 |
----------------------------------------------------------pseudo_mini_loss sum 6.670267581939697
Total (block generation + training)time/epoch 4.085668587684632
Training time/epoch 3.7967028617858887
Training time without block to device /epoch 3.7863757610321045
Training time without total dataloading part /epoch 2.5590734481811523
load block tensor time/epoch 1.104569673538208
block to device time/epoch 0.01032710075378418
input features size transfer per epoch 2.384185791015625e-06
blocks size to device per epoch 1.3113021850585938e-06
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  8442
Number of first layer input nodes during this epoch:  5580
Number of first layer output nodes during this epoch:  2189
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1138997077941895  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.167 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.167 GB
Metis partitioning: 0.001 seconds, peak memory: 16.167 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.009 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009190082550048828
pure dgl.metis_partition the time spent:  0.010980844497680664

block_gen_time in "generate_blocks_for_one_layer_block"  0.02319955825805664


block_gen_time in "generate_blocks_for_one_layer_block"  0.02585315704345703


block_gen_time in "generate_blocks_for_one_layer_block"  0.03515267372131348

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1138997077941895  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

connection checking time:  0.04218554496765137
block generation total time  0.08420538902282715
average batch blocks generation time:  0.005262836813926697
block dataloader generation time/epoch 0.18687599355524237
pseudo mini batch 0 input nodes size: 429
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1138911247253418  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1138911247253418  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1170153617858887  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1170158386230469  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1156377792358398  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({6: 2, 8: 2, 4: 1, 3: 1, 5: 1, 30: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1156516075134277  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.1156516075134277  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.2639970779418945  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.2639985084533691  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816975593566895  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 1 input nodes size: 228
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816813468933105  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816813468933105  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4829821586608887  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4829826354980469  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4798579216003418  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 3, 3: 2, 1: 1, 5: 1, 8: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4798660278320312  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4798660278320312  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.53688383102417  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5368847846984863  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4798765182495117  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 2 input nodes size: 222
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4798684120178223  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4798684120178223  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4811692237854004  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4811697006225586  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4798684120178223  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 2, 7: 1, 10: 1, 3: 1, 6: 1, 5: 1, 4: 1, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4798765182495117  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4798765182495117  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5493216514587402  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5493226051330566  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4798870086669922  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 3 input nodes size: 266
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4798789024353027  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4798789024353027  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4812989234924316  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4812994003295898  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799981117248535  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 4, 5: 2, 4: 2, 3: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480006217956543  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480006217956543  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5418610572814941  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5418620109558105  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4800167083740234  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 4 input nodes size: 249
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480008602142334  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480008602142334  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4813380241394043  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4813385009765625  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799180030822754  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 4: 2, 19: 1, 1: 1, 5: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799261093139648  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799261093139648  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5456809997558594  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5456819534301758  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799365997314453  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 5 input nodes size: 232
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799284934997559  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799284934997559  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481229305267334  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4812297821044922  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4798998832702637  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2, 4: 2, 3: 2, 2: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799060821533203  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799060821533203  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5293197631835938  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5293207168579102  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4799137115478516  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 6 input nodes size: 443
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.479907512664795  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.479907512664795  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4822726249694824  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4822731018066406  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809718132019043  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3, 2: 3, 4: 2, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809818267822266  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809818267822266  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5718884468078613  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5718894004821777  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4809951782226562  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 7 input nodes size: 335
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480982780456543  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480982780456543  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4831194877624512  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4831199645996094  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807543754577637  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 2: 2, 4: 2, 6: 1, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807634353637695  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807634353637695  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5593218803405762  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5593228340148926  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807758331298828  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 8 input nodes size: 446
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807653427124023  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4807653427124023  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4831466674804688  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.483147144317627  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810099601745605  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 1: 1, 6: 1, 4: 1, 12: 1, 10: 1, 2: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481022834777832  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.481022834777832  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6049084663391113  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6049094200134277  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810400009155273  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 9 input nodes size: 549
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810237884521484  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4810237884521484  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.483954906463623  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4839553833007812  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4815735816955566  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 2, 4: 2, 5: 2, 9: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4815864562988281  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4815864562988281  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6095848083496094  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.6095857620239258  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816036224365234  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 10 input nodes size: 377
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4815874099731445  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4815874099731445  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.48360013961792  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4836006164550781  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806690216064453  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 2, 1: 2, 6: 1, 2: 1, 11: 1, 7: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806780815124512  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806780815124512  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5652012825012207  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.565202236175537  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4806904792785645  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 11 input nodes size: 340
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480679988861084  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480679988861084  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4824953079223633  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4824957847595215  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.480482578277588  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 3, 3: 2, 5: 2, 1: 1, 2: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804916381835938  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804916381835938  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5598130226135254  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.5598139762878418  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4805030822753906  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 12 input nodes size: 564
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804930686950684  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4804930686950684  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.483504295349121  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4835047721862793  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4816889762878418  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 2, 12: 1, 21: 1, 5: 1, 2: 1, 30: 1, 10: 1, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4817047119140625  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60302734375 GB
    Memory Allocated: 1.4817047119140625  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.6621499061584473  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.6621508598327637  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4817266464233398  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 13 input nodes size: 303
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481706142425537  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481706142425537  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4833240509033203  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4833245277404785  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4803128242492676  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({5: 2, 2: 2, 6: 1, 1: 1, 4: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4803218841552734  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4803218841552734  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5590057373046875  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.559006690979004  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4803333282470703  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 14 input nodes size: 269
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480323314666748  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480323314666748  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4817595481872559  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481760025024414  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4801416397094727  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 3, 2: 2, 1: 2, 5: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480149745941162  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480149745941162  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.542649745941162  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5426506996154785  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4801602363586426  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 15 input nodes size: 487
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4801521301269531  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4801521301269531  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4827523231506348  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.482752799987793  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481316089630127  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3, 3: 2, 2: 2, 9: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4813270568847656  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4813270568847656  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5826406478881836  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5826416015625  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4813413619995117  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4813413619995117  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.115304946899414  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07239370048046112 |0.0006659924983978271 |0.05729840695858002 |8.945167064666748e-05 |0.10860179364681244 |0.0033271312713623047 |
----------------------------------------------------------pseudo_mini_loss sum 8.010932922363281
Total (block generation + training)time/epoch 4.091076504100453
Training time/epoch 3.9579379558563232
Training time without block to device /epoch 3.947282075881958
Training time without total dataloading part /epoch 2.6591615676879883
load block tensor time/epoch 1.158299207687378
block to device time/epoch 0.010655879974365234
input features size transfer per epoch 2.384185791015625e-06
blocks size to device per epoch 1.3113021850585938e-06
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  8664
Number of first layer input nodes during this epoch:  5739
Number of first layer output nodes during this epoch:  2249
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.115128993988037  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.167 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.167 GB
Metis partitioning: 0.001 seconds, peak memory: 16.167 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.009 seconds
REG metis partition end ----................................
REG construction  time spent:  0.00881648063659668
pure dgl.metis_partition the time spent:  0.011199474334716797

block_gen_time in "generate_blocks_for_one_layer_block"  0.023944377899169922


block_gen_time in "generate_blocks_for_one_layer_block"  0.02618575096130371


block_gen_time in "generate_blocks_for_one_layer_block"  0.0347902774810791

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.115128993988037  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

connection checking time:  0.04193711280822754
block generation total time  0.08492040634155273
average batch blocks generation time:  0.005307525396347046
block dataloader generation time/epoch 0.1866629719734192
pseudo mini batch 0 input nodes size: 469
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1151142120361328  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1151142120361328  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1176180839538574  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1176185607910156  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1150178909301758  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({5: 2, 12: 1, 1: 1, 2: 1, 4: 1, 21: 1, 9: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.11503267288208  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.11503267288208  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.2703857421875  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.2703871726989746  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810791015625  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 1 input nodes size: 373
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810609817504883  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810609817504883  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4830522537231445  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4830527305603027  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.48054838180542  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2, 3: 1, 2: 1, 6: 1, 5: 1, 7: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4805574417114258  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4805574417114258  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5624213218688965  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.562422275543213  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480569839477539  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 2 input nodes size: 420
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4805593490600586  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4805593490600586  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.483069896697998  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4830703735351562  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810786247253418  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 2, 6: 2, 2: 1, 12: 1, 4: 1, 1: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810914993286133  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810914993286133  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.6054401397705078  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.6054410934448242  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4811086654663086  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 3 input nodes size: 430
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810924530029297  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810924530029297  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4833879470825195  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4833884239196777  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.48087739944458  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 2: 1, 6: 1, 5: 1, 1: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4808874130249023  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4808874130249023  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5707263946533203  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5707273483276367  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480900764465332  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 4 input nodes size: 432
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4808883666992188  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4808883666992188  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4831948280334473  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4831953048706055  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4808993339538574  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 4, 4: 2, 5: 1, 9: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4809112548828125  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4809112548828125  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5900306701660156  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.590031623840332  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4809274673461914  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 5 input nodes size: 160
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4809131622314453  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4809131622314453  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4817676544189453  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4817681312561035  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4794611930847168  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2, 2: 2, 5: 1, 7: 1, 6: 1, 3: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4794673919677734  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4794673919677734  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5208625793457031  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5208635330200195  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4794750213623047  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 6 input nodes size: 513
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.479468822479248  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.479468822479248  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4822077751159668  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.482208251953125  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4813532829284668  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 2, 4: 2, 2: 2, 6: 1, 7: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4813661575317383  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4813661575317383  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5982685089111328  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5982694625854492  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4813833236694336  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 7 input nodes size: 425
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4813671112060547  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4813671112060547  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4836363792419434  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4836368560791016  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4808974266052246  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 4, 2: 2, 3: 1, 10: 1, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4809074401855469  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4809074401855469  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.575864315032959  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5758652687072754  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4809207916259766  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 8 input nodes size: 457
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4809083938598633  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4809083938598633  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4833483695983887  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4833488464355469  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810791015625  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({8: 2, 6: 2, 3: 1, 30: 1, 9: 1, 4: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481092929840088  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481092929840088  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.6313347816467285  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.631335735321045  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481112003326416  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 9 input nodes size: 207
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481095790863037  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481095790863037  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4823966026306152  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4823970794677734  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799566268920898  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 2: 2, 1: 1, 4: 1, 8: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799647331237793  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799647331237793  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5375056266784668  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5375065803527832  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799752235412598  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 10 input nodes size: 130
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799671173095703  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799671173095703  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480661392211914  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4806618690490723  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.479360580444336  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 4, 2: 2, 4: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4793658256530762  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4793658256530762  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5112004280090332  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5112013816833496  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.479372501373291  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 11 input nodes size: 392
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4793682098388672  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4793682098388672  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4814610481262207  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481461524963379  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480766773223877  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 2: 2, 9: 1, 5: 1, 1: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4807767868041992  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4807767868041992  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.568540096282959  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5685410499572754  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480790138244629  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 12 input nodes size: 225
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4807777404785156  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4807777404785156  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4820785522460938  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.482079029083252  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799857139587402  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 2: 2, 4: 2, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799928665161133  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799928665161133  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5323915481567383  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5323925018310547  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800024032592773  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 13 input nodes size: 211
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799962043762207  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799962043762207  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4812970161437988  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481297492980957  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799962043762207  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3, 5: 2, 3: 2, 2: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800024032592773  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800024032592773  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5278477668762207  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.527848720550537  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800100326538086  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 14 input nodes size: 93
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480003833770752  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480003833770752  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4805006980895996  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4805011749267578  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4791998863220215  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 3, 1: 2, 2: 1, 5: 1, 6: 1, 3: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4792051315307617  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4792051315307617  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5124554634094238  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5124564170837402  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4792118072509766  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 15 input nodes size: 607
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4792075157165527  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4792075157165527  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4824481010437012  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4824485778808594  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4819512367248535  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 2, 4: 1, 19: 1, 5: 1, 6: 1, 1: 1, 30: 1, 2: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4819660186767578  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4819660186767578  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.6414589881896973  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.6414599418640137  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4819860458374023  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4819860458374023  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1159496307373047  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0700509250164032 |0.0006441771984100342 |0.055220767855644226 |8.636713027954102e-05 |0.1037764698266983 |0.003225088119506836 |
----------------------------------------------------------pseudo_mini_loss sum 4.799466133117676
Total (block generation + training)time/epoch 4.082560896873474
Training time/epoch 3.804447889328003
Training time without block to device /epoch 3.7941410541534424
Training time without total dataloading part /epoch 2.54856276512146
load block tensor time/epoch 1.1208148002624512
block to device time/epoch 0.010306835174560547
input features size transfer per epoch 2.384185791015625e-06
blocks size to device per epoch 1.3113021850585938e-06
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  8416
Number of first layer input nodes during this epoch:  5544
Number of first layer output nodes during this epoch:  2198
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.115778923034668  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.167 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.167 GB
Metis partitioning: 0.001 seconds, peak memory: 16.167 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.009 seconds
REG metis partition end ----................................
REG construction  time spent:  0.011338472366333008
pure dgl.metis_partition the time spent:  0.011344671249389648

block_gen_time in "generate_blocks_for_one_layer_block"  0.024269819259643555


block_gen_time in "generate_blocks_for_one_layer_block"  0.025861024856567383


block_gen_time in "generate_blocks_for_one_layer_block"  0.03523564338684082

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.115778923034668  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

connection checking time:  0.04249906539916992
block generation total time  0.08536648750305176
average batch blocks generation time:  0.005335405468940735
block dataloader generation time/epoch 0.1866152469928448
pseudo mini batch 0 input nodes size: 423
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.115760326385498  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.115760326385498  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.118018627166748  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1180191040039062  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1147780418395996  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 10: 1, 4: 1, 2: 1, 6: 1, 1: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.114790916442871  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.114790916442871  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.2371435165405273  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.237144947052002  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4808287620544434  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 1 input nodes size: 636
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4808125495910645  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4808125495910645  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.484208106994629  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.484208583831787  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481949806213379  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({6: 2, 4: 2, 5: 1, 21: 1, 10: 1, 9: 1, 2: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4819655418395996  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4819655418395996  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.6616358757019043  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.6616368293762207  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481987476348877  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 2 input nodes size: 468
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4819669723510742  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4819669723510742  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4844655990600586  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4844660758972168  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810700416564941  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({5: 2, 3: 2, 6: 1, 11: 1, 2: 1, 4: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810829162597656  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810829162597656  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.6014351844787598  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.6014361381530762  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481100082397461  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 3 input nodes size: 280
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481083869934082  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481083869934082  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4825787544250488  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.482579231262207  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800801277160645  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 5, 3: 1, 7: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480088233947754  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480088233947754  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5449433326721191  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5449442863464355  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800987243652344  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 4 input nodes size: 266
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480090618133545  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480090618133545  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4815106391906738  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481511116027832  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480015754699707  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({6: 2, 1: 2, 3: 2, 2: 1, 10: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480024814605713  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480024814605713  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.556936264038086  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5569372177124023  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800362586975098  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 5 input nodes size: 417
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800262451171875  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800262451171875  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.482252597808838  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.482253074645996  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480832576751709  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 1: 2, 4: 2, 5: 1, 2: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4808425903320312  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4808425903320312  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.566728115081787  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5667290687561035  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480855941772461  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 6 input nodes size: 270
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4808435440063477  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4808435440063477  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4822850227355957  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.482285499572754  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800586700439453  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 3, 5: 1, 2: 1, 7: 1, 6: 1, 9: 1, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800677299499512  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800677299499512  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5560932159423828  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5560941696166992  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480079174041748  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 7 input nodes size: 449
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800691604614258  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800691604614258  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4831295013427734  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4831299781799316  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4816880226135254  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({5: 2, 1: 2, 4: 2, 2: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4816999435424805  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4816999435424805  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.589470386505127  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5894713401794434  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4817161560058594  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 8 input nodes size: 446
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4817018508911133  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4817018508911133  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4840831756591797  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.484083652496338  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481022834777832  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({8: 2, 6: 2, 4: 1, 9: 1, 5: 1, 30: 1, 3: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.48103666305542  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.48103666305542  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.6292243003845215  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.629225254058838  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481055736541748  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 9 input nodes size: 208
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810395240783691  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810395240783691  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4823403358459473  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4823408126831055  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799590110778809  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 2, 3: 2, 1: 2, 5: 1, 8: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.479966163635254  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.479966163635254  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5334100723266602  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5334110260009766  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.479975700378418  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 10 input nodes size: 163
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799695014953613  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799695014953613  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480839729309082  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4808402061462402  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.479538917541504  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2, 2: 2, 4: 2, 6: 1, 7: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4795441627502441  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4795441627502441  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5169172286987305  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5169181823730469  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.479550838470459  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 11 input nodes size: 212
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4795465469360352  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4795465469360352  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4808473587036133  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4808478355407715  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799771308898926  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 2: 2, 1: 2, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799833297729492  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799833297729492  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5232110023498535  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.52321195602417  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799909591674805  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 12 input nodes size: 597
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799847602844238  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799847602844238  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4831719398498535  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4831724166870117  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4818711280822754  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 5: 1, 30: 1, 4: 1, 19: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481886863708496  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481886863708496  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.6500229835510254  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.6500239372253418  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481907844543457  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 13 input nodes size: 223
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4818878173828125  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4818878173828125  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4831886291503906  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4831891059875488  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480001449584961  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 5, 4: 2, 5: 2})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800095558166504  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800095558166504  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5363950729370117  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5363960266113281  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800200462341309  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 14 input nodes size: 412
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800119400024414  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800119400024414  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4822115898132324  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4822120666503906  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4809107780456543  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 5, 5: 2, 3: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4809207916259766  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4809207916259766  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.567842960357666  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5678439140319824  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4809341430664062  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 15 input nodes size: 204
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480921745300293  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480921745300293  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.482222557067871  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4822230339050293  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.48002290725708  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 2: 2, 4: 2, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800291061401367  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800291061401367  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5274658203125  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5274667739868164  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480036735534668  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480036735534668  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1140003204345703  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07179249823093414 |0.0006604790687561035 |0.05561588704586029 |8.900463581085205e-05 |0.10580390691757202 |0.0018086433410644531 |
----------------------------------------------------------pseudo_mini_loss sum 5.150688171386719
Total (block generation + training)time/epoch 4.077660799026489
Training time/epoch 3.8326480388641357
Training time without block to device /epoch 3.822080373764038
Training time without total dataloading part /epoch 2.585949420928955
load block tensor time/epoch 1.1486799716949463
block to device time/epoch 0.010567665100097656
input features size transfer per epoch 2.384185791015625e-06
blocks size to device per epoch 1.3113021850585938e-06
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  8640
Number of first layer input nodes during this epoch:  5674
Number of first layer output nodes during this epoch:  2279
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1138181686401367  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.167 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.167 GB
Metis partitioning: 0.001 seconds, peak memory: 16.167 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.009 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009232759475708008
pure dgl.metis_partition the time spent:  0.01124262809753418

block_gen_time in "generate_blocks_for_one_layer_block"  0.02358865737915039


block_gen_time in "generate_blocks_for_one_layer_block"  0.02581501007080078


block_gen_time in "generate_blocks_for_one_layer_block"  0.03544187545776367

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1138181686401367  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

connection checking time:  0.04212141036987305
block generation total time  0.08484554290771484
average batch blocks generation time:  0.005302846431732178
block dataloader generation time/epoch 0.18656461579459055
pseudo mini batch 0 input nodes size: 485
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1138114929199219  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1138114929199219  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1164007186889648  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.116401195526123  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1150999069213867  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({6: 2, 3: 2, 12: 1, 1: 1, 2: 1, 4: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1151127815246582  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1151127815246582  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.2494664192199707  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.2494678497314453  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4811596870422363  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 1 input nodes size: 630
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4811434745788574  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4811434745788574  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4845070838928223  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4845075607299805  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4819178581237793  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 5: 2, 9: 1, 6: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4819316864013672  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4819316864013672  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.6274480819702148  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.6274490356445312  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481949806213379  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 2 input nodes size: 457
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4819316864013672  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4819316864013672  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4843716621398926  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4843721389770508  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810080528259277  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 3, 5: 2, 9: 1, 3: 1, 2: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810199737548828  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810199737548828  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5971689224243164  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5971698760986328  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810361862182617  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 3 input nodes size: 161
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810218811035156  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810218811035156  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4818816184997559  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481882095336914  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4794416427612305  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 4, 2: 2, 5: 1, 1: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4794487953186035  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4794487953186035  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.532224178314209  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5322251319885254  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4794583320617676  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 4 input nodes size: 580
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.479452133178711  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.479452133178711  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.482548713684082  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4825491905212402  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4816889762878418  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 4: 2, 19: 1, 30: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481703758239746  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481703758239746  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.6404318809509277  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.6404328346252441  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4817237854003906  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 5 input nodes size: 168
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481705665588379  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481705665588379  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.482602596282959  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4826030731201172  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.479506015777588  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 4, 6: 1, 3: 1, 1: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4795122146606445  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4795122146606445  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5185494422912598  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5185503959655762  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4795198440551758  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 6 input nodes size: 498
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4795136451721191  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4795136451721191  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4821724891662598  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.482172966003418  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4812755584716797  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 2, 10: 2, 4: 2, 21: 1, 3: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481290340423584  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481290340423584  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.6354784965515137  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.63547945022583  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4813103675842285  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 7 input nodes size: 253
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4812922477722168  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4812922477722168  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4831352233886719  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.48313570022583  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4804763793945312  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3, 3: 2, 7: 1, 2: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4804844856262207  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4804844856262207  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5414619445800781  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5414628982543945  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4804949760437012  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 8 input nodes size: 426
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4804868698120117  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4804868698120117  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4831457138061523  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4831461906433105  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4813027381896973  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({6: 2, 8: 2, 4: 1, 30: 1, 3: 1, 5: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4813165664672852  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4813165664672852  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.628293514251709  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.6282944679260254  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4813356399536133  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 9 input nodes size: 217
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4813194274902344  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4813194274902344  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4826202392578125  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4826207160949707  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799613952636719  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 2, 4: 2, 8: 1, 1: 1, 2: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799695014953613  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799695014953613  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.534522533416748  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5345234870910645  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799799919128418  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 10 input nodes size: 110
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799718856811523  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799718856811523  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4805593490600586  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4805598258972168  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4792585372924805  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 2, 1: 2, 4: 2, 5: 1, 2: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4792637825012207  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4792637825012207  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5121302604675293  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5121312141418457  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4792704582214355  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 11 input nodes size: 412
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4792661666870117  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4792661666870117  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4814658164978027  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481466293334961  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4808783531188965  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 3, 5: 2, 1: 2, 3: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4808883666992188  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4808883666992188  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5642576217651367  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5642585754394531  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4809017181396484  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 12 input nodes size: 249
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4808893203735352  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4808893203735352  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4831914901733398  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.483191967010498  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4809918403625488  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 3, 5: 1, 6: 1, 3: 1, 4: 1, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4809999465942383  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4809999465942383  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5367670059204102  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5367679595947266  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810104370117188  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 13 input nodes size: 277
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810023307800293  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810023307800293  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4832019805908203  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4832024574279785  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4808998107910156  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 4, 6: 2, 9: 1, 3: 1, 2: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480907917022705  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480907917022705  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.549492359161377  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5494933128356934  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4809184074401855  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 14 input nodes size: 320
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480910301208496  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480910301208496  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4832124710083008  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.483212947845459  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810128211975098  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2, 2: 2, 3: 2, 4: 2, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810218811035156  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810218811035156  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.553544521331787  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5535454750061035  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810333251953125  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 15 input nodes size: 406
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810233116149902  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810233116149902  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4832229614257812  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4832234382629395  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4809207916259766  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 3, 7: 2, 1: 2, 5: 1, 3: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4809308052062988  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4809308052062988  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5713348388671875  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.571335792541504  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4809441566467285  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4809441566467285  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1149077415466309  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06935577094554901 |0.0006493180990219116 |0.056850284337997437 |8.61436128616333e-05 |0.1108701080083847 |0.0035164356231689453 |
----------------------------------------------------------pseudo_mini_loss sum 3.7121877670288086
Total (block generation + training)time/epoch 4.080983740942819
Training time/epoch 3.938161849975586
Training time without block to device /epoch 3.9277727603912354
Training time without total dataloading part /epoch 2.6884210109710693
load block tensor time/epoch 1.1096923351287842
block to device time/epoch 0.010389089584350586
input features size transfer per epoch 2.384185791015625e-06
blocks size to device per epoch 1.3113021850585938e-06
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  8588
Number of first layer input nodes during this epoch:  5649
Number of first layer output nodes during this epoch:  2255
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1147265434265137  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.167 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.167 GB
Metis partitioning: 0.001 seconds, peak memory: 16.167 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.009 seconds
REG metis partition end ----................................
REG construction  time spent:  0.008816957473754883
pure dgl.metis_partition the time spent:  0.011134147644042969

block_gen_time in "generate_blocks_for_one_layer_block"  0.02389979362487793


block_gen_time in "generate_blocks_for_one_layer_block"  0.025835275650024414


block_gen_time in "generate_blocks_for_one_layer_block"  0.03498101234436035

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1147265434265137  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

connection checking time:  0.04243016242980957
block generation total time  0.0847160816192627
average batch blocks generation time:  0.0052947551012039185
block dataloader generation time/epoch 0.186262845993042
pseudo mini batch 0 input nodes size: 401
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1147136688232422  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1147136688232422  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1170158386230469  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.117016315460205  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1148161888122559  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 2, 5: 2, 4: 2, 2: 1, 9: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1148271560668945  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1148271560668945  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.2191715240478516  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.2191729545593262  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4808688163757324  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 1 input nodes size: 447
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4808564186096191  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4808564186096191  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4832429885864258  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.483243465423584  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480940818786621  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 3, 3: 3, 7: 1, 1: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4809508323669434  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4809508323669434  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.573169231414795  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5731701850891113  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480964183807373  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 2 input nodes size: 506
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4809517860412598  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4809517860412598  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4836530685424805  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4836535453796387  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4812664985656738  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 2, 6: 2, 2: 1, 1: 1, 12: 1, 10: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4812793731689453  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4812793731689453  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.6170153617858887  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.617016315460205  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4812965393066406  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 3 input nodes size: 443
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4812803268432617  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4812803268432617  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4836454391479492  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4836459159851074  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4809441566467285  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({5: 2, 3: 2, 4: 2, 21: 1, 2: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.48095703125  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.48095703125  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.6084904670715332  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.6084914207458496  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4809741973876953  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 4 input nodes size: 442
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4809579849243164  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4809579849243164  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4833178520202637  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4833183288574219  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4809527397155762  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({6: 2, 8: 2, 5: 1, 30: 1, 4: 1, 3: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480966567993164  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480966567993164  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.6299171447753906  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.629918098449707  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4809856414794922  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 5 input nodes size: 257
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4809694290161133  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4809694290161133  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4831113815307617  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.48311185836792  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4807515144348145  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 6: 2, 5: 2, 8: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4807605743408203  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4807605743408203  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5598716735839844  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5598726272583008  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4807720184326172  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 6 input nodes size: 219
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480762004852295  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480762004852295  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.482062816619873  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4820632934570312  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799208641052246  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2, 5: 2, 2: 2, 4: 1, 3: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.479928970336914  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.479928970336914  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5389666557312012  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5389676094055176  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799394607543945  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 7 input nodes size: 268
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.479931354522705  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.479931354522705  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4813623428344727  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4813628196716309  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800615310668945  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 4, 2: 3, 4: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480069637298584  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480069637298584  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5345430374145508  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5345439910888672  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800801277160645  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 8 input nodes size: 644
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480072021484375  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480072021484375  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4835100173950195  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4835104942321777  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.482079029083252  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 2, 6: 1, 9: 1, 7: 1, 1: 1, 5: 1, 19: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4820947647094727  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4820947647094727  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.6407456398010254  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.6407465934753418  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4821157455444336  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 9 input nodes size: 304
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.482095718383789  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.482095718383789  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4837188720703125  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4837193489074707  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480280876159668  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({5: 2, 4: 2, 1: 2, 7: 1, 3: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4802889823913574  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4802889823913574  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.550581455230713  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5505824089050293  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480299472808838  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 10 input nodes size: 572
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4802913665771484  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4802913665771484  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.483729362487793  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4837298393249512  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4821062088012695  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 4: 2, 1: 1, 12: 1, 30: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4821209907531738  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4821209907531738  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.636220932006836  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.6362218856811523  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4821410179138184  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 11 input nodes size: 252
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4821228981018066  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4821228981018066  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4834685325622559  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.483469009399414  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800305366516113  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 1: 2, 5: 1, 4: 1, 2: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480036735534668  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480036735534668  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5293560028076172  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5293569564819336  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800443649291992  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 12 input nodes size: 95
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800381660461426  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800381660461426  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4805455207824707  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480545997619629  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4791998863220215  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 2, 1: 2, 3: 2, 5: 1, 2: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4792051315307617  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4792051315307617  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5037188529968262  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5037198066711426  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4792118072509766  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 13 input nodes size: 258
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4792075157165527  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4792075157165527  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4805850982666016  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4805855751037598  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800777435302734  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 3, 3: 2, 4: 1, 10: 1, 6: 1, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480085849761963  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480085849761963  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5440340042114258  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5440349578857422  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800963401794434  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 14 input nodes size: 365
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480088233947754  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480088233947754  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.48203706741333  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4820375442504883  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4806594848632812  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 6, 1: 2, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480668544769287  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480668544769287  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.557751178741455  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5577521324157715  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4806809425354004  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 15 input nodes size: 285
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.48067045211792  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.48067045211792  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.482192039489746  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4821925163269043  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.48024320602417  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 4, 1: 1, 5: 1, 2: 1, 3: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4802522659301758  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4802522659301758  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5542521476745605  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.554253101348877  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4802637100219727  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4802637100219727  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.114227294921875  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07179506123065948 |0.0006553679704666138 |0.05585525929927826 |8.758902549743652e-05 |0.10522806644439697 |0.003834962844848633 |
----------------------------------------------------------pseudo_mini_loss sum 3.1526272296905518
Total (block generation + training)time/epoch 4.079006274541219
Training time/epoch 3.869168281555176
Training time without block to device /epoch 3.85868239402771
Training time without total dataloading part /epoch 2.5825695991516113
load block tensor time/epoch 1.1487209796905518
block to device time/epoch 0.01048588752746582
input features size transfer per epoch 2.384185791015625e-06
blocks size to device per epoch 1.3113021850585938e-06
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  8699
Number of first layer input nodes during this epoch:  5758
Number of first layer output nodes during this epoch:  2269
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1140456199645996  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.167 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.167 GB
Metis partitioning: 0.001 seconds, peak memory: 16.167 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.009 seconds
REG metis partition end ----................................
REG construction  time spent:  0.01038980484008789
pure dgl.metis_partition the time spent:  0.011146068572998047

block_gen_time in "generate_blocks_for_one_layer_block"  0.023706674575805664


block_gen_time in "generate_blocks_for_one_layer_block"  0.025652408599853516


block_gen_time in "generate_blocks_for_one_layer_block"  0.03542900085449219

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1140456199645996  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

connection checking time:  0.04215884208679199
block generation total time  0.08478808403015137
average batch blocks generation time:  0.0052992552518844604
block dataloader generation time/epoch 0.18673071265220642
pseudo mini batch 0 input nodes size: 517
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1140351295471191  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1140351295471191  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1167950630187988  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.116795539855957  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1152734756469727  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 4: 2, 30: 1, 19: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1152863502502441  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1152863502502441  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.2491564750671387  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.2491579055786133  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481330394744873  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 1 input nodes size: 340
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4813141822814941  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4813141822814941  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4831295013427734  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4831299781799316  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4803695678710938  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 3, 3: 3, 12: 1, 1: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4803786277770996  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4803786277770996  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5604972839355469  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5604982376098633  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480391025543213  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 2 input nodes size: 124
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4803805351257324  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4803805351257324  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810428619384766  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810433387756348  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4792275428771973  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 3, 4: 3, 1: 2, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4792327880859375  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4792327880859375  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5087275505065918  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5087285041809082  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4792394638061523  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 3 input nodes size: 365
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4792351722717285  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4792351722717285  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4811840057373047  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481184482574463  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4805216789245605  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 3, 2: 3, 1: 1, 7: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4805316925048828  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4805316925048828  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5650954246520996  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.565096378326416  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4805450439453125  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 4 input nodes size: 421
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4805326461791992  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4805326461791992  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4830856323242188  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.483086109161377  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4811367988586426  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 2, 6: 2, 2: 1, 10: 1, 1: 1, 4: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481149673461914  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481149673461914  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.6044878959655762  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.6044888496398926  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4811668395996094  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 5 input nodes size: 611
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4811506271362305  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4811506271362305  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.484412670135498  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4844131469726562  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4818596839904785  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 5: 2, 4: 1, 6: 1, 11: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4818735122680664  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4818735122680664  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.626378059387207  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.6263790130615234  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4818916320800781  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 6 input nodes size: 364
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4818735122680664  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4818735122680664  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4838171005249023  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4838175773620605  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4805550575256348  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 2, 3: 2, 4: 2, 5: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480565071105957  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480565071105957  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.567530632019043  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5675315856933594  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4805784225463867  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 7 input nodes size: 375
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4805660247802734  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4805660247802734  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4825682640075684  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4825687408447266  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4806246757507324  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 2, 1: 1, 4: 1, 10: 1, 6: 1, 7: 1, 3: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4806346893310547  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4806346893310547  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5778870582580566  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.577888011932373  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4806480407714844  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 8 input nodes size: 499
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480635643005371  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480635643005371  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.483299732208252  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4833002090454102  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481297492980957  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2, 4: 2, 7: 1, 2: 1, 8: 1, 3: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481309413909912  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481309413909912  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5920538902282715  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.592054843902588  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481325626373291  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 9 input nodes size: 225
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481311321258545  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481311321258545  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.482612133026123  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4826126098632812  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799480438232422  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 4, 3: 2, 2: 2, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799542427062988  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799542427062988  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.525557041168213  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5255579948425293  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.47996187210083  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 10 input nodes size: 189
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799556732177734  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799556732177734  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4812564849853516  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4812569618225098  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799556732177734  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3, 4: 2, 5: 2, 6: 1, 3: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799628257751465  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799628257751465  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5340189933776855  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.534019947052002  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799723625183105  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 11 input nodes size: 436
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.479966163635254  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.479966163635254  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4822940826416016  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4822945594787598  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4809932708740234  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 4, 5: 2, 6: 1, 1: 1, 21: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810051918029785  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810051918029785  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.6030688285827637  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.60306978225708  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810214042663574  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 12 input nodes size: 444
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810070991516113  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810070991516113  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.483377456665039  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4833779335021973  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810495376586914  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({8: 2, 6: 2, 30: 1, 4: 1, 9: 1, 3: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810633659362793  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810633659362793  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.6300039291381836  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.6300048828125  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810824394226074  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 13 input nodes size: 238
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810662269592285  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810662269592285  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4823670387268066  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4823675155639648  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.479996681213379  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({5: 3, 3: 2, 6: 1, 2: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800047874450684  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800047874450684  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5432476997375488  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5432486534118652  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800152778625488  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 14 input nodes size: 354
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800071716308594  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800071716308594  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4818973541259766  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4818978309631348  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4805965423583984  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 2, 4: 1, 3: 1, 2: 1, 6: 1, 7: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4806065559387207  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4806065559387207  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5654692649841309  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5654702186584473  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4806199073791504  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 15 input nodes size: 248
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480607509613037  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480607509613037  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4819316864013672  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4819321632385254  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.48004150390625  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 2: 2, 1: 2, 4: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480048656463623  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480048656463623  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.533165454864502  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5331664085388184  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480058193206787  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480058193206787  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1140217781066895  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07192268967628479 |0.0006433576345443726 |0.05686582624912262 |8.510053157806396e-05 |0.10962747037410736 |0.0016210079193115234 |
----------------------------------------------------------pseudo_mini_loss sum 2.77439284324646
Total (block generation + training)time/epoch 4.082650408148766
Training time/epoch 3.9434475898742676
Training time without block to device /epoch 3.9331538677215576
Training time without total dataloading part /epoch 2.6668753623962402
load block tensor time/epoch 1.1507630348205566
block to device time/epoch 0.010293722152709961
input features size transfer per epoch 2.384185791015625e-06
blocks size to device per epoch 1.3113021850585938e-06
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  8684
Number of first layer input nodes during this epoch:  5750
Number of first layer output nodes during this epoch:  2254
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.113844394683838  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.167 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.167 GB
Metis partitioning: 0.001 seconds, peak memory: 16.167 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.009 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009514093399047852
pure dgl.metis_partition the time spent:  0.01095438003540039

block_gen_time in "generate_blocks_for_one_layer_block"  0.023174762725830078


block_gen_time in "generate_blocks_for_one_layer_block"  0.025774240493774414


block_gen_time in "generate_blocks_for_one_layer_block"  0.034560441970825195

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.113844394683838  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

connection checking time:  0.04169440269470215
block generation total time  0.08350944519042969
average batch blocks generation time:  0.0052193403244018555
block dataloader generation time/epoch 0.18654851352467255
pseudo mini batch 0 input nodes size: 500
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.113837718963623  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.113837718963623  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1165070533752441  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1165075302124023  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.115182876586914  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({5: 2, 9: 1, 11: 1, 1: 1, 4: 1, 2: 1, 21: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1151976585388184  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1151976585388184  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.274869441986084  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.2748708724975586  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4812445640563965  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 1 input nodes size: 538
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4812264442443848  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4812264442443848  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4840989112854004  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4840993881225586  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4814295768737793  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 30: 1, 19: 1, 4: 1, 12: 1, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4814434051513672  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4814434051513672  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.629465103149414  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.6294660568237305  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481461524963379  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 2 input nodes size: 425
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4814434051513672  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4814434051513672  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4841127395629883  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4841132164001465  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4812402725219727  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({6: 2, 3: 2, 2: 1, 12: 1, 4: 1, 1: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4812531471252441  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4812531471252441  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.60365629196167  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.6036572456359863  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4812703132629395  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 3 input nodes size: 416
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4812541007995605  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4812541007995605  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4834752082824707  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.483475685119629  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4808058738708496  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 4: 2, 5: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4808158874511719  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4808158874511719  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.573580265045166  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5735812187194824  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4808292388916016  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 4 input nodes size: 473
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4808168411254883  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4808168411254883  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4834861755371094  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4834866523742676  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4812650680541992  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 3, 5: 3, 2: 2, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481276035308838  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481276035308838  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5835442543029785  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.583545207977295  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481290340423584  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 5 input nodes size: 207
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481276035308838  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481276035308838  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.482576847076416  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4825773239135742  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.479907512664795  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 3, 5: 3, 1: 1, 4: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799156188964844  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799156188964844  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5403666496276855  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.540367603302002  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799261093139648  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 6 input nodes size: 263
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799180030822754  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799180030822754  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4813222885131836  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4813227653503418  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800214767456055  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 4, 2: 2, 3: 2, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800286293029785  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800286293029785  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5302767753601074  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5302777290344238  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800372123718262  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 7 input nodes size: 383
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800291061401367  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800291061401367  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4820737838745117  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.48207426071167  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4806694984436035  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3, 2: 3, 4: 2})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4806785583496094  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4806785583496094  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5543217658996582  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5543227195739746  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4806909561157227  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 8 input nodes size: 446
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4806804656982422  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4806804656982422  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4830617904663086  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4830622673034668  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810171127319336  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({6: 2, 8: 2, 9: 1, 3: 1, 30: 1, 5: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810309410095215  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810309410095215  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.6288957595825195  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.628896713256836  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810500144958496  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 9 input nodes size: 266
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810338020324707  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810338020324707  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4824538230895996  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4824542999267578  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800724983215332  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 3, 5: 2, 6: 1, 4: 1, 8: 1, 3: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800806045532227  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800806045532227  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5494909286499023  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5494918823242188  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800910949707031  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 10 input nodes size: 168
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800829887390137  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800829887390137  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4809799194335938  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480980396270752  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4795598983764648  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({6: 2, 1: 2, 5: 1, 10: 1, 9: 1, 2: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.479567050933838  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.479567050933838  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5375275611877441  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5375285148620605  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.479576587677002  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 11 input nodes size: 503
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4795703887939453  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4795703887939453  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4822559356689453  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4822564125061035  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4813590049743652  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 4, 2: 3, 7: 2})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4813718795776367  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4813718795776367  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.611619472503662  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.6116204261779785  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481389045715332  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 12 input nodes size: 139
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4813728332519531  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4813728332519531  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4821152687072754  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4821157455444336  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4794297218322754  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 5, 2: 1, 4: 1, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4794349670410156  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4794349670410156  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5146303176879883  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5146312713623047  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4794416427612305  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 13 input nodes size: 271
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4794373512268066  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4794373512268066  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480884075164795  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4808845520019531  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4801416397094727  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 2, 1: 2, 4: 2, 3: 1, 5: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480149745941162  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480149745941162  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.54227876663208  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5422797203063965  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4801602363586426  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 14 input nodes size: 211
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4801521301269531  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4801521301269531  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4814529418945312  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4814534187316895  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480006217956543  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 2: 2, 4: 1, 5: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480013370513916  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480013370513916  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.533644199371338  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5336451530456543  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.48002290725708  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 15 input nodes size: 308
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800167083740234  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800167083740234  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481661319732666  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4816617965698242  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480360507965088  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3, 3: 2, 2: 1, 9: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4803695678710938  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4803695678710938  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5506949424743652  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5506958961486816  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4803810119628906  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4803810119628906  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.114344596862793  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06984497606754303 |0.0006445497274398804 |0.05525507032871246 |8.501112461090088e-05 |0.10410448908805847 |0.003409862518310547 |
----------------------------------------------------------pseudo_mini_loss sum 2.397665023803711
Total (block generation + training)time/epoch 4.077434904435101
Training time/epoch 3.8102359771728516
Training time without block to device /epoch 3.7999231815338135
Training time without total dataloading part /epoch 2.55452299118042
load block tensor time/epoch 1.1175196170806885
block to device time/epoch 0.010312795639038086
input features size transfer per epoch 2.384185791015625e-06
blocks size to device per epoch 1.3113021850585938e-06
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  8406
Number of first layer input nodes during this epoch:  5517
Number of first layer output nodes during this epoch:  2209
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.114168643951416  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.167 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.167 GB
Metis partitioning: 0.001 seconds, peak memory: 16.167 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.009 seconds
REG metis partition end ----................................
REG construction  time spent:  0.008287906646728516
pure dgl.metis_partition the time spent:  0.010703086853027344

block_gen_time in "generate_blocks_for_one_layer_block"  0.024211645126342773


block_gen_time in "generate_blocks_for_one_layer_block"  0.02610921859741211


block_gen_time in "generate_blocks_for_one_layer_block"  0.03523612022399902

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.114168643951416  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

connection checking time:  0.04279923439025879
block generation total time  0.0855569839477539
average batch blocks generation time:  0.005347311496734619
block dataloader generation time/epoch 0.18637397554185656
pseudo mini batch 0 input nodes size: 473
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1141581535339355  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1141581535339355  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1170153617858887  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1170158386230469  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.115370750427246  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({5: 2, 3: 2, 4: 1, 9: 1, 2: 1, 6: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1153836250305176  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1153836250305176  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.2356352806091309  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.2356367111206055  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4814276695251465  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 1 input nodes size: 347
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4814114570617676  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4814114570617676  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4832639694213867  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.483264446258545  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4804067611694336  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 3, 1: 2, 2: 1, 5: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4804158210754395  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4804158210754395  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.559330940246582  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5593318939208984  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4804282188415527  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 2 input nodes size: 430
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4804177284240723  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4804177284240723  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.482713222503662  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4827136993408203  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480860710144043  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 10: 1, 2: 1, 4: 1, 1: 1, 6: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480872631072998  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480872631072998  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.6021199226379395  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.6021208763122559  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480888843536377  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 3 input nodes size: 492
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4808745384216309  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4808745384216309  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4835014343261719  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.48350191116333  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481205940246582  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 2, 3: 2, 6: 1, 9: 1, 5: 1, 1: 1, 2: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481217861175537  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481217861175537  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5928120613098145  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5928130149841309  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481234073638916  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 4 input nodes size: 466
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.48121976852417  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.48121976852417  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4837079048156738  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.483708381652832  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810810089111328  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 2, 9: 1, 1: 1, 5: 1, 2: 1, 10: 1, 21: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810938835144043  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810938835144043  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.6199021339416504  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.6199030876159668  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4811110496520996  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 5 input nodes size: 589
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810948371887207  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810948371887207  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4842395782470703  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4842400550842285  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4817514419555664  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3, 3: 3, 5: 1, 6: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4817652702331543  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4817652702331543  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.623751163482666  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.6237521171569824  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481783390045166  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 6 input nodes size: 331
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4817652702331543  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4817652702331543  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.483532428741455  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4835329055786133  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4803876876831055  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3, 3: 2, 4: 1, 5: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4803967475891113  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4803967475891113  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.554234504699707  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5542354583740234  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4804081916809082  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 7 input nodes size: 300
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480398178100586  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480398178100586  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4819998741149902  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4820003509521484  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4802327156066895  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 3, 6: 2, 4: 2, 5: 1, 3: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480240821838379  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480240821838379  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5504822731018066  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.550483226776123  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4802513122558594  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 8 input nodes size: 421
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.48024320602417  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.48024320602417  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4831433296203613  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4831438064575195  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481541633605957  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({8: 2, 6: 2, 5: 1, 4: 1, 3: 1, 9: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481555461883545  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481555461883545  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.6256752014160156  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.625676155090332  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481574535369873  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 9 input nodes size: 303
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4815583229064941  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4815583229064941  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4831762313842773  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4831767082214355  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480276107788086  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({5: 3, 3: 2, 2: 2, 8: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4802851676940918  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4802851676940918  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5628056526184082  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5628066062927246  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4802966117858887  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 10 input nodes size: 143
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4802865982055664  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4802865982055664  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810500144958496  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4810504913330078  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4794321060180664  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 3, 4: 2, 1: 1, 5: 1, 6: 1, 3: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4794373512268066  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4794373512268066  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5143160820007324  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5143170356750488  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4794440269470215  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 11 input nodes size: 243
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4794397354125977  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4794397354125977  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4807405471801758  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480741024017334  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799771308898926  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 3, 1: 3, 4: 2, 3: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799833297729492  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799833297729492  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5300407409667969  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5300416946411133  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799909591674805  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 12 input nodes size: 336
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799847602844238  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799847602844238  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.481778621673584  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4817790985107422  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4804778099060059  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 1: 1, 4: 1, 2: 1, 19: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4804868698120117  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4804868698120117  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5555658340454102  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5555667877197266  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4804983139038086  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 13 input nodes size: 189
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4804883003234863  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4804883003234863  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4817891120910645  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4817895889282227  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4799952507019043  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 6, 4: 2})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480001449584961  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480001449584961  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5179204940795898  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5179214477539062  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800090789794922  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 14 input nodes size: 388
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800028800964355  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800028800964355  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.48207426071167  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4820747375488281  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4807734489440918  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 2, 4: 2, 10: 1, 7: 1, 5: 1, 6: 1, 3: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480783462524414  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.480783462524414  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5818982124328613  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5818991661071777  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4807968139648438  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

pseudo mini batch 15 input nodes size: 209
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4807844161987305  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4807844161987305  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4820852279663086  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4820857048034668  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800138473510742  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 3, 4: 1, 1: 1, 7: 1, 5: 1, 6: 1, 3: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800219535827637  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800219535827637  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5370244979858398  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.5370254516601562  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800324440002441  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.4800324440002441  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.60693359375 GB
    Memory Allocated: 1.1139960289001465  GigaBytes
Max Memory Allocated: 1.9155206680297852  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06991405785083771 |0.0006474554538726807 |0.055291369557380676 |8.845329284667969e-05 |0.10465946793556213 |0.0031278133392333984 |
----------------------------------------------------------pseudo_mini_loss sum 2.102466344833374
Total (block generation + training)time/epoch 4.073206557167901
Training time/epoch 3.8177454471588135
Training time without block to device /epoch 3.8073861598968506
Training time without total dataloading part /epoch 2.5637564659118652
load block tensor time/epoch 1.1186249256134033
block to device time/epoch 0.01035928726196289
input features size transfer per epoch 2.384185791015625e-06
blocks size to device per epoch 1.3113021850585938e-06
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  8548
Number of first layer input nodes during this epoch:  5660
Number of first layer output nodes during this epoch:  2217
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(1433, 1433, batch_first=True)
      (fc_self): Linear(in_features=1433, out_features=2048, bias=False)
      (fc_neigh): Linear(in_features=1433, out_features=2048, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(2048, 2048, batch_first=True)
      (fc_self): Linear(in_features=2048, out_features=2048, bias=False)
      (fc_neigh): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (2): SAGEConv(
      (lstm): LSTM(2048, 2048, batch_first=True)
      (fc_self): Linear(in_features=2048, out_features=7, bias=False)
      (fc_neigh): Linear(in_features=2048, out_features=7, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  97867856
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([5732, 1433])
layers.0.lstm.weight_hh_l0, torch.Size([5732, 1433])
layers.0.lstm.bias_ih_l0, torch.Size([5732])
layers.0.lstm.bias_hh_l0, torch.Size([5732])
layers.0.fc_self.weight, torch.Size([2048, 1433])
layers.0.fc_neigh.weight, torch.Size([2048, 1433])
layers.1.lstm.weight_ih_l0, torch.Size([8192, 2048])
layers.1.lstm.weight_hh_l0, torch.Size([8192, 2048])
layers.1.lstm.bias_ih_l0, torch.Size([8192])
layers.1.lstm.bias_hh_l0, torch.Size([8192])
layers.1.fc_self.weight, torch.Size([2048, 2048])
layers.1.fc_neigh.weight, torch.Size([2048, 2048])
layers.2.lstm.weight_ih_l0, torch.Size([8192, 2048])
layers.2.lstm.weight_hh_l0, torch.Size([8192, 2048])
layers.2.lstm.bias_ih_l0, torch.Size([8192])
layers.2.lstm.bias_hh_l0, torch.Size([8192])
layers.2.fc_self.weight, torch.Size([7, 2048])
layers.2.fc_neigh.weight, torch.Size([7, 2048])
----------------------------------------
un-trainable parameters
