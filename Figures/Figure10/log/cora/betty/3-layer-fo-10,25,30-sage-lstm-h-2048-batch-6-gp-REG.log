main start at this time 1733091979.3334544
-----------------------------------------before load data 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

----------------------------------------start of run function 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  1433
----------------------------------------before model to device 
 Nvidia-smi: 0.3560791015625 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 0.88623046875 GB
    Memory Allocated: 0.3674592971801758  GigaBytes
Max Memory Allocated: 0.3674592971801758  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 0.88818359375 GB
    Memory Allocated: 0.3674592971801758  GigaBytes
Max Memory Allocated: 0.3674592971801758  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 13.818 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 13.818 GB
Metis partitioning: 0.001 seconds, peak memory: 13.818 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.003 seconds
REG metis partition end ----................................
REG construction  time spent:  0.02123260498046875
pure dgl.metis_partition the time spent:  0.005299568176269531
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.010873556137084961

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.012675046920776367

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.01896834373474121

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 0.88818359375 GB
    Memory Allocated: 0.3674592971801758  GigaBytes
Max Memory Allocated: 0.3674592971801758  GigaBytes

connection checking time:  0.016736745834350586
block generation total time  0.04251694679260254
average batch blocks generation time:  0.00708615779876709
pseudo mini batch 0 input nodes size: 517
----------------------------------------before load block subtensor 
 Nvidia-smi: 0.88818359375 GB
    Memory Allocated: 0.3674592971801758  GigaBytes
Max Memory Allocated: 0.3674592971801758  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 0.88818359375 GB
    Memory Allocated: 0.3674592971801758  GigaBytes
Max Memory Allocated: 0.3674592971801758  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 0.90771484375 GB
    Memory Allocated: 0.37021923065185547  GigaBytes
Max Memory Allocated: 0.37021923065185547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 0.90771484375 GB
    Memory Allocated: 0.37021970748901367  GigaBytes
Max Memory Allocated: 0.37021970748901367  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 0.90771484375 GB
    Memory Allocated: 0.37021970748901367  GigaBytes
Max Memory Allocated: 0.37021970748901367  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 9, 3: 6, 4: 3, 5: 3, 1: 2, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 0.90771484375 GB
    Memory Allocated: 0.37023258209228516  GigaBytes
Max Memory Allocated: 0.37023258209228516  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 0.90771484375 GB
    Memory Allocated: 0.37023258209228516  GigaBytes
Max Memory Allocated: 0.37023258209228516  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.09326171875 GB
    Memory Allocated: 0.5176286697387695  GigaBytes
Max Memory Allocated: 0.5185437202453613  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.09326171875 GB
    Memory Allocated: 0.5176305770874023  GigaBytes
Max Memory Allocated: 0.5185437202453613  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.53857421875 GB
    Memory Allocated: 0.7507076263427734  GigaBytes
Max Memory Allocated: 0.9199495315551758  GigaBytes

pseudo mini batch 1 input nodes size: 932
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.53857421875 GB
    Memory Allocated: 0.7506914138793945  GigaBytes
Max Memory Allocated: 0.9199495315551758  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.53857421875 GB
    Memory Allocated: 0.7506914138793945  GigaBytes
Max Memory Allocated: 0.9199495315551758  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.53857421875 GB
    Memory Allocated: 0.7558913230895996  GigaBytes
Max Memory Allocated: 0.9199495315551758  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.53857421875 GB
    Memory Allocated: 0.7558917999267578  GigaBytes
Max Memory Allocated: 0.9199495315551758  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.53857421875 GB
    Memory Allocated: 0.7531313896179199  GigaBytes
Max Memory Allocated: 0.9199495315551758  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 7, 6: 3, 1: 2, 2: 2, 5: 2, 4: 2, 9: 1, 10: 1, 7: 1, 11: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 1.53857421875 GB
    Memory Allocated: 0.7531547546386719  GigaBytes
Max Memory Allocated: 0.9199495315551758  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.53857421875 GB
    Memory Allocated: 0.7531547546386719  GigaBytes
Max Memory Allocated: 0.9199495315551758  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.59521484375 GB
    Memory Allocated: 1.0174150466918945  GigaBytes
Max Memory Allocated: 1.0186333656311035  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.59521484375 GB
    Memory Allocated: 1.0174164772033691  GigaBytes
Max Memory Allocated: 1.0186333656311035  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.84521484375 GB
    Memory Allocated: 0.7531871795654297  GigaBytes
Max Memory Allocated: 1.2664613723754883  GigaBytes

pseudo mini batch 2 input nodes size: 916
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.84521484375 GB
    Memory Allocated: 0.7531547546386719  GigaBytes
Max Memory Allocated: 1.2664613723754883  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.84521484375 GB
    Memory Allocated: 0.7531547546386719  GigaBytes
Max Memory Allocated: 1.2664613723754883  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.84521484375 GB
    Memory Allocated: 0.7580447196960449  GigaBytes
Max Memory Allocated: 1.2664613723754883  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.84521484375 GB
    Memory Allocated: 0.7580451965332031  GigaBytes
Max Memory Allocated: 1.2664613723754883  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.84521484375 GB
    Memory Allocated: 0.7528448104858398  GigaBytes
Max Memory Allocated: 1.2664613723754883  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 4, 1: 4, 2: 4, 3: 4, 9: 2, 5: 2, 10: 1, 7: 1, 21: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 1.84521484375 GB
    Memory Allocated: 0.7528672218322754  GigaBytes
Max Memory Allocated: 1.2664613723754883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.84521484375 GB
    Memory Allocated: 0.7528672218322754  GigaBytes
Max Memory Allocated: 1.2664613723754883  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.88818359375 GB
    Memory Allocated: 1.02494478225708  GigaBytes
Max Memory Allocated: 1.2664613723754883  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.88818359375 GB
    Memory Allocated: 1.0249462127685547  GigaBytes
Max Memory Allocated: 1.2664613723754883  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.88818359375 GB
    Memory Allocated: 0.7528996467590332  GigaBytes
Max Memory Allocated: 1.2738690376281738  GigaBytes

pseudo mini batch 3 input nodes size: 976
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.88818359375 GB
    Memory Allocated: 0.7528691291809082  GigaBytes
Max Memory Allocated: 1.2738690376281738  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.88818359375 GB
    Memory Allocated: 0.7528691291809082  GigaBytes
Max Memory Allocated: 1.2738690376281738  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.88818359375 GB
    Memory Allocated: 0.7580795288085938  GigaBytes
Max Memory Allocated: 1.2738690376281738  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.88818359375 GB
    Memory Allocated: 0.758080005645752  GigaBytes
Max Memory Allocated: 1.2738690376281738  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.88818359375 GB
    Memory Allocated: 0.7531895637512207  GigaBytes
Max Memory Allocated: 1.2738690376281738  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 4, 2: 4, 3: 3, 8: 3, 6: 3, 30: 2, 5: 2, 7: 1, 9: 1, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 1.88818359375 GB
    Memory Allocated: 0.7532186508178711  GigaBytes
Max Memory Allocated: 1.2738690376281738  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.88818359375 GB
    Memory Allocated: 0.7532186508178711  GigaBytes
Max Memory Allocated: 1.2738690376281738  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.89404296875 GB
    Memory Allocated: 1.0909876823425293  GigaBytes
Max Memory Allocated: 1.2738690376281738  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.89404296875 GB
    Memory Allocated: 1.090989112854004  GigaBytes
Max Memory Allocated: 1.2738690376281738  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.95849609375 GB
    Memory Allocated: 0.7532587051391602  GigaBytes
Max Memory Allocated: 1.3395380973815918  GigaBytes

pseudo mini batch 4 input nodes size: 532
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.95849609375 GB
    Memory Allocated: 0.7532224655151367  GigaBytes
Max Memory Allocated: 1.3395380973815918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.95849609375 GB
    Memory Allocated: 0.7532224655151367  GigaBytes
Max Memory Allocated: 1.3395380973815918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.95849609375 GB
    Memory Allocated: 0.756859302520752  GigaBytes
Max Memory Allocated: 1.3395380973815918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.95849609375 GB
    Memory Allocated: 0.7568597793579102  GigaBytes
Max Memory Allocated: 1.3395380973815918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.95849609375 GB
    Memory Allocated: 0.7516489028930664  GigaBytes
Max Memory Allocated: 1.3395380973815918  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 6, 4: 5, 5: 3, 3: 3, 6: 2, 2: 2, 19: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 1.95849609375 GB
    Memory Allocated: 0.7516627311706543  GigaBytes
Max Memory Allocated: 1.3395380973815918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.95849609375 GB
    Memory Allocated: 0.7516627311706543  GigaBytes
Max Memory Allocated: 1.3395380973815918  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.95849609375 GB
    Memory Allocated: 0.9047503471374512  GigaBytes
Max Memory Allocated: 1.3395380973815918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.95849609375 GB
    Memory Allocated: 0.9047517776489258  GigaBytes
Max Memory Allocated: 1.3395380973815918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.95849609375 GB
    Memory Allocated: 0.7516818046569824  GigaBytes
Max Memory Allocated: 1.3395380973815918  GigaBytes

pseudo mini batch 5 input nodes size: 647
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.95849609375 GB
    Memory Allocated: 0.7516655921936035  GigaBytes
Max Memory Allocated: 1.3395380973815918  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.95849609375 GB
    Memory Allocated: 0.7516655921936035  GigaBytes
Max Memory Allocated: 1.3395380973815918  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.95849609375 GB
    Memory Allocated: 0.755119800567627  GigaBytes
Max Memory Allocated: 1.3395380973815918  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.95849609375 GB
    Memory Allocated: 0.7551202774047852  GigaBytes
Max Memory Allocated: 1.3395380973815918  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.95849609375 GB
    Memory Allocated: 0.7514829635620117  GigaBytes
Max Memory Allocated: 1.3395380973815918  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 5, 2: 4, 4: 4, 3: 3, 5: 3, 6: 2, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 1.95849609375 GB
    Memory Allocated: 0.7514986991882324  GigaBytes
Max Memory Allocated: 1.3395380973815918  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.95849609375 GB
    Memory Allocated: 0.7514986991882324  GigaBytes
Max Memory Allocated: 1.3395380973815918  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.95849609375 GB
    Memory Allocated: 0.9216818809509277  GigaBytes
Max Memory Allocated: 1.3395380973815918  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.95849609375 GB
    Memory Allocated: 0.9216833114624023  GigaBytes
Max Memory Allocated: 1.3395380973815918  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.95849609375 GB
    Memory Allocated: 0.7515196800231934  GigaBytes
Max Memory Allocated: 1.3395380973815918  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4806933403015137  GigaBytes
Max Memory Allocated: 1.8481526374816895  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.1161065101623535  GigaBytes
Max Memory Allocated: 1.8481526374816895  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06640982627868652 |0.001571973164876302 |0.24251981576283774 |0.0024189154307047525 |0.20851099491119385 |0.13779711723327637 |
----------------------------------------------------------pseudo_mini_loss sum 1.947807788848877
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  7221
Number of first layer input nodes during this epoch:  4520
Number of first layer output nodes during this epoch:  2034
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.115994930267334  GigaBytes
Max Memory Allocated: 1.8481526374816895  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.121 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.121 GB
Metis partitioning: 0.000 seconds, peak memory: 16.121 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.003 seconds
REG metis partition end ----................................
REG construction  time spent:  0.012408018112182617
pure dgl.metis_partition the time spent:  0.005356788635253906
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.010613679885864258

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.013030052185058594

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.0193326473236084

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.115994930267334  GigaBytes
Max Memory Allocated: 1.8481526374816895  GigaBytes

connection checking time:  0.017669200897216797
block generation total time  0.04297637939453125
average batch blocks generation time:  0.007162729899088542
pseudo mini batch 0 input nodes size: 752
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.1159744262695312  GigaBytes
Max Memory Allocated: 1.8481526374816895  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.1159744262695312  GigaBytes
Max Memory Allocated: 1.8481526374816895  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.1204800605773926  GigaBytes
Max Memory Allocated: 1.8481526374816895  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.1204805374145508  GigaBytes
Max Memory Allocated: 1.8481526374816895  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.1170258522033691  GigaBytes
Max Memory Allocated: 1.8481526374816895  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 6, 4: 6, 3: 4, 5: 3, 6: 2, 1: 1, 30: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.117044448852539  GigaBytes
Max Memory Allocated: 1.8481526374816895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.117044448852539  GigaBytes
Max Memory Allocated: 1.8481526374816895  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.332794189453125  GigaBytes
Max Memory Allocated: 1.8481526374816895  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.3327960968017578  GigaBytes
Max Memory Allocated: 1.8481526374816895  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4824271202087402  GigaBytes
Max Memory Allocated: 1.8481526374816895  GigaBytes

pseudo mini batch 1 input nodes size: 875
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4824028015136719  GigaBytes
Max Memory Allocated: 1.8481526374816895  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4824028015136719  GigaBytes
Max Memory Allocated: 1.8481526374816895  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4870738983154297  GigaBytes
Max Memory Allocated: 1.8481526374816895  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.487074375152588  GigaBytes
Max Memory Allocated: 1.8481526374816895  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4825682640075684  GigaBytes
Max Memory Allocated: 1.8481526374816895  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 5, 3: 5, 2: 2, 4: 2, 5: 1, 6: 1, 11: 1, 9: 1, 7: 1, 10: 1, 21: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.482590675354004  GigaBytes
Max Memory Allocated: 1.8481526374816895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.482590675354004  GigaBytes
Max Memory Allocated: 1.8481526374816895  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.7436823844909668  GigaBytes
Max Memory Allocated: 1.8481526374816895  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.7436838150024414  GigaBytes
Max Memory Allocated: 1.8481526374816895  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4826221466064453  GigaBytes
Max Memory Allocated: 1.9926371574401855  GigaBytes

pseudo mini batch 2 input nodes size: 902
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4825916290283203  GigaBytes
Max Memory Allocated: 1.9926371574401855  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4825916290283203  GigaBytes
Max Memory Allocated: 1.9926371574401855  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4874072074890137  GigaBytes
Max Memory Allocated: 1.9926371574401855  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4874076843261719  GigaBytes
Max Memory Allocated: 1.9926371574401855  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4827361106872559  GigaBytes
Max Memory Allocated: 1.9926371574401855  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 4: 4, 2: 3, 6: 3, 5: 3, 9: 1, 1: 1, 12: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4827594757080078  GigaBytes
Max Memory Allocated: 1.9926371574401855  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4827594757080078  GigaBytes
Max Memory Allocated: 1.9926371574401855  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.7478952407836914  GigaBytes
Max Memory Allocated: 1.9926371574401855  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.747896671295166  GigaBytes
Max Memory Allocated: 1.9926371574401855  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4827919006347656  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

pseudo mini batch 3 input nodes size: 689
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4827594757080078  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4827594757080078  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4864377975463867  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.486438274383545  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4816222190856934  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 5: 4, 6: 3, 4: 3, 1: 2, 8: 2, 2: 2, 30: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4816436767578125  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4816436767578125  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.713486671447754  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.7134881019592285  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4816722869873047  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

pseudo mini batch 4 input nodes size: 826
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4816479682922363  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4816479682922363  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4865679740905762  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4865684509277344  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4828896522521973  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 6, 1: 5, 4: 4, 7: 2, 5: 2, 9: 1, 3: 1, 6: 1, 8: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4829092025756836  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4829092025756836  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.7034196853637695  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.7034211158752441  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.482935905456543  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

pseudo mini batch 5 input nodes size: 603
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4829096794128418  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4829096794128418  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.486546516418457  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4865469932556152  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4816265106201172  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 6, 1: 6, 3: 4, 4: 3, 5: 2, 7: 1, 6: 1, 19: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4816412925720215  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4816412925720215  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.6494622230529785  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.6494636535644531  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.481661319732666  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.481661319732666  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.116288661956787  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06644864877065022 |0.0006981690724690756 |0.08811295032501221 |9.679794311523438e-05 |0.22005558013916016 |0.0033037662506103516 |
----------------------------------------------------------pseudo_mini_loss sum 53.74395751953125
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  7371
Number of first layer input nodes during this epoch:  4647
Number of first layer output nodes during this epoch:  2064
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.116175651550293  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.129 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.129 GB
Metis partitioning: 0.001 seconds, peak memory: 16.129 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.003 seconds
REG metis partition end ----................................
REG construction  time spent:  0.009299993515014648
pure dgl.metis_partition the time spent:  0.0054209232330322266
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.010646343231201172

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.012664556503295898

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.023391246795654297

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.116175651550293  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

connection checking time:  0.016580581665039062
block generation total time  0.04670214653015137
average batch blocks generation time:  0.0077836910883585615
block dataloader generation time/epoch 0.09507369995117188
pseudo mini batch 0 input nodes size: 815
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.116157054901123  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.116157054901123  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.1205081939697266  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.1205086708068848  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.1168713569641113  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 6, 2: 5, 3: 3, 5: 3, 6: 2, 1: 2, 19: 1, 7: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.1168909072875977  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.1168909072875977  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.3473610877990723  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.347362995147705  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4814887046813965  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

pseudo mini batch 1 input nodes size: 1080
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4814624786376953  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4814624786376953  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4872279167175293  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4872283935546875  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4828767776489258  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 8, 4: 3, 2: 2, 6: 2, 9: 2, 7: 1, 5: 1, 30: 1, 12: 1, 11: 1, 10: 1, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4829058647155762  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4829058647155762  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.8111920356750488  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.8111934661865234  GigaBytes
Max Memory Allocated: 1.9970102310180664  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4829449653625488  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

pseudo mini batch 2 input nodes size: 859
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4829068183898926  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4829068183898926  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4875988960266113  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4875993728637695  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4818334579467773  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 5: 4, 8: 3, 4: 3, 1: 2, 6: 2, 12: 1, 21: 1, 2: 1, 30: 1, 10: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.481860637664795  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.481860637664795  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.7905068397521973  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.7905082702636719  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4818987846374512  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

pseudo mini batch 3 input nodes size: 664
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4818663597106934  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4818663597106934  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4855031967163086  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4855036735534668  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4808111190795898  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 8, 1: 3, 3: 3, 5: 3, 6: 2, 10: 1, 7: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.480827808380127  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.480827808380127  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.6637415885925293  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.663743019104004  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4808506965637207  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

pseudo mini batch 4 input nodes size: 591
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4808282852172852  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4808282852172852  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4839835166931152  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4839839935302734  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4803466796875  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 6, 4: 5, 1: 4, 3: 3, 5: 2, 7: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.480360507965088  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.480360507965088  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.6315665245056152  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.6315679550170898  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4803786277770996  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

pseudo mini batch 5 input nodes size: 481
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.480360507965088  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.480360507965088  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4829282760620117  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.48292875289917  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4797730445861816  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 8, 3: 5, 4: 4, 2: 3, 6: 2, 5: 2})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4797849655151367  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4797849655151367  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.6111865043640137  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.6111879348754883  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4798011779785156  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4798011779785156  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.1152143478393555  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06480157375335693 |0.000817577044169108 |0.08779736359914143 |0.00012028217315673828 |0.1963198184967041 |0.004624128341674805 |
----------------------------------------------------------pseudo_mini_loss sum 96.35228729248047
Total (block generation + training)time/epoch 2.308331251144409
Training time/epoch 2.2129950523376465
Training time without block to device /epoch 2.208089590072632
Training time without total dataloading part /epoch 1.7100489139556885
load block tensor time/epoch 0.3888094425201416
block to device time/epoch 0.0049054622650146484
input features size transfer per epoch 8.940696716308594e-07
blocks size to device per epoch 4.917383193969727e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  7156
Number of first layer input nodes during this epoch:  4490
Number of first layer output nodes during this epoch:  2002
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.1150999069213867  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.129 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.129 GB
Metis partitioning: 0.001 seconds, peak memory: 16.129 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.004 seconds
REG metis partition end ----................................
REG construction  time spent:  0.010905027389526367
pure dgl.metis_partition the time spent:  0.006246805191040039
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.013084888458251953

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.0146026611328125

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.021450519561767578

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.1150999069213867  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

connection checking time:  0.018034934997558594
block generation total time  0.04913806915283203
average batch blocks generation time:  0.008189678192138672
block dataloader generation time/epoch 0.09903156757354736
pseudo mini batch 0 input nodes size: 903
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.1150851249694824  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.1150851249694824  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.119905948638916  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.1199064254760742  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.1173381805419922  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 8, 4: 5, 5: 3, 6: 2, 7: 2, 9: 1, 1: 1, 3: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.117358684539795  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.117358684539795  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.362884521484375  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.3628864288330078  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4819602966308594  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

pseudo mini batch 1 input nodes size: 977
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4819321632385254  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4819321632385254  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4871478080749512  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4871482849121094  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4823269844055176  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 2: 3, 4: 3, 5: 2, 10: 2, 6: 2, 12: 1, 9: 1, 1: 1, 7: 1, 21: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4823541641235352  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4823541641235352  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.7951669692993164  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.795168399810791  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.482391357421875  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

pseudo mini batch 2 input nodes size: 901
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4823570251464844  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4823570251464844  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4871668815612793  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4871673583984375  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4819512367248535  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 7, 2: 4, 4: 3, 1: 3, 5: 2, 12: 1, 7: 1, 9: 1, 30: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.481973648071289  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.481973648071289  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.738309383392334  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.7383108139038086  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4820051193237305  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

pseudo mini batch 3 input nodes size: 552
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4819746017456055  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4819746017456055  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4851245880126953  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4851250648498535  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4803147315979004  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 6, 1: 4, 5: 4, 2: 4, 6: 3, 3: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4803276062011719  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4803276062011719  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.623274803161621  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.6232762336730957  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4803447723388672  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

pseudo mini batch 4 input nodes size: 688
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4803285598754883  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4803285598754883  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.484001636505127  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4840021133422852  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.480851650238037  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 5, 1: 5, 4: 3, 8: 3, 6: 2, 5: 2, 9: 1, 19: 1, 30: 1, 2: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4808731079101562  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4808731079101562  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.717214584350586  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.7172160148620605  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4809026718139648  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

pseudo mini batch 5 input nodes size: 534
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4808783531188965  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4808783531188965  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4845151901245117  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.48451566696167  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.480842113494873  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 6, 3: 6, 2: 5, 4: 2, 5: 2, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4808549880981445  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4808549880981445  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.612114429473877  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.6121158599853516  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4808721542358398  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4808721542358398  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.1162853240966797  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06423930327097575 |0.0007984638214111328 |0.08893990516662598 |0.00011261304219563802 |0.20403162638346353 |0.003620624542236328 |
----------------------------------------------------------pseudo_mini_loss sum 194.56863403320312
Total (block generation + training)time/epoch 2.3386625051498413
Training time/epoch 2.265822649002075
Training time without block to device /epoch 2.2610318660736084
Training time without total dataloading part /epoch 1.7621254920959473
load block tensor time/epoch 0.3854358196258545
block to device time/epoch 0.004790782928466797
input features size transfer per epoch 8.940696716308594e-07
blocks size to device per epoch 4.917383193969727e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  7228
Number of first layer input nodes during this epoch:  4555
Number of first layer output nodes during this epoch:  2013
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.116170883178711  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.133 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.133 GB
Metis partitioning: 0.001 seconds, peak memory: 16.133 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.004 seconds
REG metis partition end ----................................
REG construction  time spent:  0.010883331298828125
pure dgl.metis_partition the time spent:  0.006226539611816406
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.013059616088867188

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.01747918128967285

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.02136516571044922

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.116170883178711  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

connection checking time:  0.01853632926940918
block generation total time  0.05190396308898926
average batch blocks generation time:  0.008650660514831543
block dataloader generation time/epoch 0.10143876075744629
pseudo mini batch 0 input nodes size: 710
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.1161541938781738  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.1161541938781738  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.1199445724487305  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.1199450492858887  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.1163077354431152  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 5, 1: 5, 4: 3, 6: 3, 5: 2, 3: 2, 7: 1, 19: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.1163244247436523  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.1163244247436523  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.3022799491882324  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.3022818565368652  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4831433296203613  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

pseudo mini batch 1 input nodes size: 1043
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4831209182739258  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4831209182739258  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4886889457702637  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4886894226074219  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.484898567199707  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 5: 3, 6: 3, 4: 3, 2: 2, 9: 2, 10: 1, 21: 1, 1: 1, 11: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4849286079406738  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4849286079406738  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.8172492980957031  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.8172507286071777  GigaBytes
Max Memory Allocated: 2.059480667114258  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4849705696105957  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

pseudo mini batch 2 input nodes size: 813
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4849319458007812  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4849319458007812  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.489272117614746  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4892725944519043  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4837040901184082  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 4: 5, 2: 4, 1: 3, 5: 2, 10: 1, 30: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4837236404418945  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4837236404418945  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.7135519981384277  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.7135534286499023  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.483750343322754  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

pseudo mini batch 3 input nodes size: 607
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4837241172790527  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4837241172790527  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4873437881469727  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4873442649841309  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4830036163330078  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 5, 1: 4, 4: 4, 8: 3, 6: 2, 5: 2, 2: 2, 30: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4830212593078613  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4830212593078613  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.688549518585205  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.6885509490966797  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.483046054840088  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

pseudo mini batch 4 input nodes size: 806
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4830236434936523  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4830236434936523  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4873638153076172  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4873642921447754  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4837441444396973  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 7, 2: 6, 7: 3, 1: 3, 5: 2, 3: 2, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4837636947631836  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4837636947631836  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.6964950561523438  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.6964964866638184  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.483790397644043  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

pseudo mini batch 5 input nodes size: 602
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4837641716003418  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4837641716003418  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4873838424682617  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.48738431930542  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4830436706542969  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 6, 3: 5, 5: 4, 1: 4, 6: 2, 9: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4830594062805176  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4830594062805176  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.6525955200195312  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.6525969505310059  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4830803871154785  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4830803871154785  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.1162714958190918  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06438803672790527 |0.0008193651835123698 |0.09010676542917888 |0.000122984250386556 |0.2066855033238729 |0.004275083541870117 |
----------------------------------------------------------pseudo_mini_loss sum 104.40461730957031
Total (block generation + training)time/epoch 2.3574827512105307
Training time/epoch 2.2887184619903564
Training time without block to device /epoch 2.2838022708892822
Training time without total dataloading part /epoch 1.7857666015625
load block tensor time/epoch 0.38632822036743164
block to device time/epoch 0.004916191101074219
input features size transfer per epoch 8.940696716308594e-07
blocks size to device per epoch 4.917383193969727e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  7248
Number of first layer input nodes during this epoch:  4581
Number of first layer output nodes during this epoch:  2013
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.1161603927612305  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.139 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.139 GB
Metis partitioning: 0.001 seconds, peak memory: 16.139 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.005 seconds
REG metis partition end ----................................
REG construction  time spent:  0.010801553726196289
pure dgl.metis_partition the time spent:  0.007435321807861328
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.013065099716186523

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.01616835594177246

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.021425962448120117

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.1161603927612305  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

connection checking time:  0.01821613311767578
block generation total time  0.0506594181060791
average batch blocks generation time:  0.008443236351013184
block dataloader generation time/epoch 0.1025688648223877
pseudo mini batch 0 input nodes size: 932
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.1161398887634277  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.1161398887634277  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.1211156845092773  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.1211161613464355  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.1174960136413574  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 5, 2: 4, 5: 3, 4: 3, 1: 2, 19: 1, 7: 1, 6: 1, 12: 1, 9: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.1175212860107422  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.1175212860107422  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.3960518836975098  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.3960537910461426  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4821267127990723  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

pseudo mini batch 1 input nodes size: 703
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4820942878723145  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4820942878723145  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4858474731445312  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4858479499816895  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4808716773986816  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 6, 2: 5, 4: 4, 5: 3, 3: 2, 6: 1, 7: 1, 9: 1, 21: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4808902740478516  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4808902740478516  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.6917333602905273  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.691734790802002  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4809160232543945  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

pseudo mini batch 2 input nodes size: 1013
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4808917045593262  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4808917045593262  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4862995147705078  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.486299991607666  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.482546329498291  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 4: 4, 6: 3, 5: 3, 2: 2, 10: 2, 9: 1, 12: 1, 1: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4825716018676758  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4825716018676758  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.7823128700256348  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.7823143005371094  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4826068878173828  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

pseudo mini batch 3 input nodes size: 415
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4825725555419922  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4825725555419922  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4857630729675293  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4857635498046875  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4803552627563477  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 5, 4: 5, 1: 4, 3: 4, 5: 3, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4803662300109863  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4803662300109863  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.5871171951293945  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.5871186256408691  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4803814888000488  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

pseudo mini batch 4 input nodes size: 685
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4803690910339355  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4803690910339355  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4840259552001953  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4840264320373535  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4808354377746582  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 2: 3, 8: 3, 6: 3, 4: 3, 1: 2, 5: 2, 9: 1, 30: 1, 7: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4808568954467773  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4808568954467773  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.7208385467529297  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.7208399772644043  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.480886459350586  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

pseudo mini batch 5 input nodes size: 771
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4808621406555176  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4808621406555176  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4858036041259766  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4858040809631348  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4821467399597168  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 6, 1: 5, 3: 5, 4: 3, 6: 2, 7: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4821643829345703  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4821643829345703  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.6771483421325684  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.677149772644043  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.66943359375 GB
    Memory Allocated: 1.4821882247924805  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4821882247924805  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1176013946533203  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06465005874633789 |0.0008041858673095703 |0.09258460998535156 |0.00011452039082845052 |0.21979888280232748 |0.005151033401489258 |
----------------------------------------------------------pseudo_mini_loss sum 187.50584411621094
Total (block generation + training)time/epoch 2.3899608850479126
Training time/epoch 2.381253242492676
Training time without block to device /epoch 2.3764281272888184
Training time without total dataloading part /epoch 1.8801391124725342
load block tensor time/epoch 0.38790035247802734
block to device time/epoch 0.004825115203857422
input features size transfer per epoch 8.940696716308594e-07
blocks size to device per epoch 4.917383193969727e-07
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  7182
Number of first layer input nodes during this epoch:  4519
Number of first layer output nodes during this epoch:  2008
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1174869537353516  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.233 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.233 GB
Metis partitioning: 0.000 seconds, peak memory: 16.233 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.004 seconds
REG metis partition end ----................................
REG construction  time spent:  0.01159214973449707
pure dgl.metis_partition the time spent:  0.005973100662231445
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.013068437576293945

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.014263629913330078

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.020842552185058594

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1174869537353516  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

connection checking time:  0.018456459045410156
block generation total time  0.04817461967468262
average batch blocks generation time:  0.00802910327911377
block dataloader generation time/epoch 0.10261411666870117
pseudo mini batch 0 input nodes size: 437
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.117462158203125  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.117462158203125  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.119795322418213  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.119795799255371  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.114853858947754  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 6, 2: 5, 4: 4, 3: 3, 5: 2, 9: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1148648262023926  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1148648262023926  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.2211089134216309  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.2211108207702637  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.481672763824463  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

pseudo mini batch 1 input nodes size: 950
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4816603660583496  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4816603660583496  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.486732006072998  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4867324829101562  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4843988418579102  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 6: 4, 4: 3, 2: 2, 5: 2, 10: 2, 12: 1, 11: 1, 1: 1, 7: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.484422206878662  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.484422206878662  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7709054946899414  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.770906925201416  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.48445463180542  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

pseudo mini batch 2 input nodes size: 908
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.484422206878662  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.484422206878662  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.489269733428955  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4892702102661133  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4841980934143066  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 6, 5: 4, 3: 3, 2: 3, 7: 2, 6: 2, 1: 1, 9: 1, 10: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4842205047607422  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4842205047607422  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7561163902282715  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.756117820739746  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4842519760131836  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

pseudo mini batch 3 input nodes size: 573
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4842214584350586  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4842214584350586  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4878582954406738  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.487858772277832  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4830107688903809  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 5, 2: 4, 3: 4, 8: 3, 5: 2, 4: 2, 6: 2, 30: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483027458190918  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483027458190918  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.679029941558838  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.6790313720703125  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4830513000488281  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

pseudo mini batch 4 input nodes size: 812
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4830307960510254  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4830307960510254  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.48736572265625  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4873661994934082  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4837288856506348  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 4: 5, 1: 4, 2: 3, 5: 2, 19: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483748435974121  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483748435974121  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7174320220947266  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7174334526062012  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4837751388549805  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

pseudo mini batch 5 input nodes size: 810
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4837489128112793  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4837489128112793  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4880733489990234  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4880738258361816  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4837384223937988  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 8, 3: 4, 1: 3, 5: 3, 4: 2, 6: 2, 21: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4837579727172852  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4837579727172852  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7111096382141113  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.711111068725586  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4837846755981445  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4837846755981445  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1169757843017578  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06464048226674397 |0.0008294185002644857 |0.09200990200042725 |0.0001193682352701823 |0.21537903944651285 |0.00442194938659668 |
----------------------------------------------------------pseudo_mini_loss sum 80.6413803100586
Total (block generation + training)time/epoch 2.4031418323516847
Training time/epoch 2.352884292602539
Training time without block to device /epoch 2.347907781600952
Training time without total dataloading part /epoch 1.8494718074798584
load block tensor time/epoch 0.38784289360046387
block to device time/epoch 0.004976511001586914
input features size transfer per epoch 8.940696716308594e-07
blocks size to device per epoch 4.917383193969727e-07
 Run 0| Epoch 6 |
Number of nodes for computation during this epoch:  7135
Number of first layer input nodes during this epoch:  4490
Number of first layer output nodes during this epoch:  1993
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1168746948242188  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.233 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.233 GB
Metis partitioning: 0.001 seconds, peak memory: 16.233 GB
Split the graph: 0.002 seconds
Construct subgraphs: 0.004 seconds
REG metis partition end ----................................
REG construction  time spent:  0.010745525360107422
pure dgl.metis_partition the time spent:  0.00683903694152832
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.013104677200317383

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.01475071907043457

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.021257877349853516

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1168746948242188  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

connection checking time:  0.018088102340698242
block generation total time  0.04911327362060547
average batch blocks generation time:  0.008185545603434244
block dataloader generation time/epoch 0.10273146629333496
pseudo mini batch 0 input nodes size: 896
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1168479919433594  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1168479919433594  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.121631145477295  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1216316223144531  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1173067092895508  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 7, 4: 6, 3: 3, 1: 2, 6: 1, 7: 1, 12: 1, 30: 1, 10: 1, 19: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.117332935333252  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.117332935333252  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4076194763183594  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4076213836669922  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4827227592468262  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

pseudo mini batch 1 input nodes size: 653
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4826903343200684  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4826903343200684  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4863271713256836  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4863276481628418  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.481544017791748  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({6: 4, 3: 4, 5: 4, 8: 3, 4: 3, 1: 3, 9: 1, 7: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4815654754638672  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4815654754638672  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7194023132324219  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7194037437438965  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4815950393676758  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

pseudo mini batch 2 input nodes size: 479
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4815707206726074  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4815707206726074  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4841279983520508  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.484128475189209  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4804911613464355  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 7, 2: 6, 3: 5, 5: 3, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4805030822753906  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4805030822753906  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.601600170135498  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.6016016006469727  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4805192947387695  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

pseudo mini batch 3 input nodes size: 513
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4805049896240234  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4805049896240234  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4841418266296387  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4841423034667969  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4815845489501953  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 7, 2: 5, 1: 4, 4: 3, 6: 2, 5: 2})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4815983772277832  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4815983772277832  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.6283130645751953  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.62831449508667  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.481616497039795  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

pseudo mini batch 4 input nodes size: 960
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4815983772277832  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4815983772277832  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4867234230041504  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4867238998413086  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4830865859985352  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 4: 3, 6: 3, 1: 2, 5: 2, 10: 2, 2: 2, 12: 1, 9: 1, 11: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483109951019287  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483109951019287  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7644734382629395  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.764474868774414  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483142375946045  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

pseudo mini batch 5 input nodes size: 784
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483109951019287  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483109951019287  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4872956275939941  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4872961044311523  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.482170581817627  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 6, 2: 5, 5: 4, 1: 2, 9: 2, 7: 1, 6: 1, 21: 1, 3: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.482192039489746  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.482192039489746  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.724630355834961  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7246317863464355  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4822216033935547  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4822216033935547  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1168489456176758  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06658204396565755 |0.0007860263188680013 |0.08720993995666504 |0.000110626220703125 |0.19740692774454752 |0.0034017562866210938 |
----------------------------------------------------------pseudo_mini_loss sum 41.1174201965332
Total (block generation + training)time/epoch 2.3901695013046265
Training time/epoch 2.2218639850616455
Training time without block to device /epoch 2.2171478271484375
Training time without total dataloading part /epoch 1.7117667198181152
load block tensor time/epoch 0.3994922637939453
block to device time/epoch 0.004716157913208008
input features size transfer per epoch 8.940696716308594e-07
blocks size to device per epoch 4.917383193969727e-07
 Run 0| Epoch 7 |
Number of nodes for computation during this epoch:  6931
Number of first layer input nodes during this epoch:  4285
Number of first layer output nodes during this epoch:  1984
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1167407035827637  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.233 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.233 GB
Metis partitioning: 0.001 seconds, peak memory: 16.233 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.004 seconds
REG metis partition end ----................................
REG construction  time spent:  0.010518312454223633
pure dgl.metis_partition the time spent:  0.006097078323364258
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.013057470321655273

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.014566183090209961

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.021001338958740234

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1167407035827637  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

connection checking time:  0.018388748168945312
block generation total time  0.04862499237060547
average batch blocks generation time:  0.008104165395100912
block dataloader generation time/epoch 0.10255970273699079
pseudo mini batch 0 input nodes size: 552
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1167120933532715  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1167120933532715  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1203489303588867  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.120349407196045  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1161632537841797  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({6: 4, 2: 4, 3: 4, 4: 4, 5: 4, 1: 3, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.116178035736084  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.116178035736084  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.2743096351623535  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.2743115425109863  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.482985019683838  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

pseudo mini batch 1 input nodes size: 954
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4829668998718262  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4829668998718262  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4880599975585938  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.488060474395752  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4844231605529785  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 4: 5, 5: 3, 6: 3, 2: 2, 11: 1, 1: 1, 12: 1, 9: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4844465255737305  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4844465255737305  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7679862976074219  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7679877281188965  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4844789505004883  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

pseudo mini batch 2 input nodes size: 862
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4844465255737305  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4844465255737305  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4890484809875488  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.489048957824707  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4839553833007812  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 5, 3: 4, 2: 3, 4: 3, 5: 3, 9: 1, 19: 1, 21: 1, 7: 1, 10: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4839768409729004  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4839768409729004  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.744478702545166  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7444801330566406  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4840073585510254  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

pseudo mini batch 3 input nodes size: 669
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4839792251586914  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4839792251586914  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4876160621643066  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4876165390014648  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4830141067504883  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 3, 8: 3, 2: 3, 4: 3, 5: 3, 1: 3, 6: 2, 30: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4830327033996582  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4830327033996582  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7019901275634766  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7019915580749512  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4830584526062012  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

pseudo mini batch 4 input nodes size: 865
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4830341339111328  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4830341339111328  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4876518249511719  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.48765230178833  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4840149879455566  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 8, 4: 4, 1: 3, 3: 3, 7: 2, 6: 2, 9: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4840354919433594  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4840354919433594  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7195067405700684  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.719508171081543  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4840631484985352  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

pseudo mini batch 5 input nodes size: 704
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4840350151062012  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4840350151062012  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4877934455871582  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4877939224243164  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4831757545471191  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 1: 5, 2: 5, 4: 3, 5: 2, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4831924438476562  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4831924438476562  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.6699519157409668  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.6699533462524414  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.48321533203125  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.48321533203125  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1164064407348633  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06497450669606526 |0.0008060534795125326 |0.0897521177927653 |0.0001133282979329427 |0.2062524954477946 |0.0035848617553710938 |
----------------------------------------------------------pseudo_mini_loss sum 55.12208557128906
Total (block generation + training)time/epoch 2.389280046735491
Training time/epoch 2.2822868824005127
Training time without block to device /epoch 2.2774505615234375
Training time without total dataloading part /epoch 1.7802925109863281
load block tensor time/epoch 0.3898470401763916
block to device time/epoch 0.004836320877075195
input features size transfer per epoch 8.940696716308594e-07
blocks size to device per epoch 4.917383193969727e-07
 Run 0| Epoch 8 |
Number of nodes for computation during this epoch:  7288
Number of first layer input nodes during this epoch:  4606
Number of first layer output nodes during this epoch:  2020
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1163020133972168  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.233 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.233 GB
Metis partitioning: 0.001 seconds, peak memory: 16.233 GB
Split the graph: 0.002 seconds
Construct subgraphs: 0.004 seconds
REG metis partition end ----................................
REG construction  time spent:  0.010597467422485352
pure dgl.metis_partition the time spent:  0.006905317306518555
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.013174772262573242

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.18919777870178223

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.021624088287353516

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1163020133972168  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

connection checking time:  0.018595218658447266
block generation total time  0.22399663925170898
average batch blocks generation time:  0.037332773208618164
block dataloader generation time/epoch 0.1245967447757721
pseudo mini batch 0 input nodes size: 539
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.116279125213623  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.116279125213623  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1199159622192383  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1199164390563965  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1161575317382812  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 7, 2: 7, 5: 4, 4: 2, 3: 2, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1161704063415527  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1161704063415527  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.2515473365783691  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.251549243927002  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4829802513122559  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

pseudo mini batch 1 input nodes size: 952
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.482964038848877  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.482964038848877  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4880461692810059  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.488046646118164  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4844093322753906  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 6: 3, 2: 3, 4: 3, 5: 3, 9: 1, 7: 1, 11: 1, 10: 1, 12: 1, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4844326972961426  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4844326972961426  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.759902000427246  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7599034309387207  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4844651222229004  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

pseudo mini batch 2 input nodes size: 998
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4844326972961426  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4844326972961426  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.489760398864746  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4897608757019043  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4846782684326172  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 2: 4, 4: 3, 1: 3, 10: 2, 7: 1, 19: 1, 21: 1, 30: 1, 5: 1, 9: 1, 6: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4847073554992676  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4847073554992676  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.8207650184631348  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.8207664489746094  GigaBytes
Max Memory Allocated: 2.066112518310547  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4847474098205566  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

pseudo mini batch 3 input nodes size: 582
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4847111701965332  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4847111701965332  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4879817962646484  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4879822731018066  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.482654094696045  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 6, 3: 4, 6: 4, 5: 3, 8: 3, 2: 1, 1: 1, 30: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4826745986938477  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4826745986938477  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7013678550720215  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.701369285583496  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4827022552490234  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

pseudo mini batch 4 input nodes size: 665
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.482679843902588  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.482679843902588  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4863166809082031  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4863171577453613  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483046054840088  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 5, 1: 5, 4: 4, 2: 3, 6: 2, 5: 2, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4830617904663086  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4830617904663086  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.65181303024292  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.6518144607543945  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483083724975586  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

pseudo mini batch 5 input nodes size: 794
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4830632209777832  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4830632209777832  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.487302303314209  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4873027801513672  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4836654663085938  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 7, 3: 5, 4: 4, 1: 3, 7: 2, 5: 2})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4836831092834473  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4836831092834473  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.684359073638916  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.6843605041503906  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4837069511413574  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4837069511413574  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1168980598449707  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0663908322652181 |0.0008113781611124674 |0.09041901429494222 |0.00011420249938964844 |0.20647144317626953 |0.0032312870025634766 |
----------------------------------------------------------pseudo_mini_loss sum 32.63112258911133
Total (block generation + training)time/epoch 2.4120319485664368
Training time/epoch 2.2923147678375244
Training time without block to device /epoch 2.2874464988708496
Training time without total dataloading part /epoch 1.7852592468261719
load block tensor time/epoch 0.3983449935913086
block to device time/epoch 0.004868268966674805
input features size transfer per epoch 8.940696716308594e-07
blocks size to device per epoch 4.917383193969727e-07
 Run 0| Epoch 9 |
Number of nodes for computation during this epoch:  7219
Number of first layer input nodes during this epoch:  4530
Number of first layer output nodes during this epoch:  2033
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1167845726013184  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.233 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.233 GB
Metis partitioning: 0.001 seconds, peak memory: 16.233 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.003 seconds
REG metis partition end ----................................
REG construction  time spent:  0.010624408721923828
pure dgl.metis_partition the time spent:  0.005789041519165039
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.01309061050415039

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.014394044876098633

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.0205233097076416

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1167845726013184  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

connection checking time:  0.018100261688232422
block generation total time  0.048007965087890625
average batch blocks generation time:  0.008001327514648438
block dataloader generation time/epoch 0.12203280131022136
pseudo mini batch 0 input nodes size: 416
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1167597770690918  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1167597770690918  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.118980884552002  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1189813613891602  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1147418022155762  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 5, 3: 5, 2: 5, 5: 4, 4: 2, 6: 2})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1147527694702148  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1147527694702148  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.2216796875  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.2216815948486328  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4815607070922852  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

pseudo mini batch 1 input nodes size: 946
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4815483093261719  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4815483093261719  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4865984916687012  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4865989685058594  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.484377384185791  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 5, 5: 3, 6: 3, 4: 3, 10: 2, 2: 2, 12: 1, 9: 1, 1: 1, 11: 1, 21: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4844045639038086  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4844045639038086  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7945141792297363  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.794515609741211  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4844417572021484  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

pseudo mini batch 2 input nodes size: 959
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4844074249267578  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4844074249267578  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4895272254943848  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.489527702331543  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4844770431518555  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 5, 3: 5, 4: 4, 7: 2, 5: 2, 12: 1, 6: 1, 1: 1, 9: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4845004081726074  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4845004081726074  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7556424140930176  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7556438446044922  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4845328330993652  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

pseudo mini batch 3 input nodes size: 654
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4845004081726074  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4845004081726074  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4881372451782227  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4881377220153809  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4830174446105957  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 5, 1: 4, 8: 3, 5: 3, 9: 2, 4: 2, 6: 2, 7: 1, 30: 1, 2: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4830389022827148  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4830389022827148  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7129335403442383  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.712934970855713  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.483067512512207  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

pseudo mini batch 4 input nodes size: 689
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4830431938171387  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4830431938171387  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4867215156555176  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4867219924926758  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4830846786499023  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 6, 4: 5, 3: 4, 1: 3, 5: 2, 6: 2, 19: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4831023216247559  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4831023216247559  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.6799259185791016  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.6799273490905762  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4831271171569824  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

pseudo mini batch 5 input nodes size: 797
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4831047058105469  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4831047058105469  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4873862266540527  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.487386703491211  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4837079048156738  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 6, 4: 6, 2: 6, 3: 2, 6: 1, 5: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4837255477905273  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4837255477905273  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.6826543807983398  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.6826558113098145  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4837493896484375  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4837493896484375  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1169404983520508  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06533952554066975 |0.0008101860682169596 |0.08692177136739095 |0.00011448065439860026 |0.1947632630666097 |0.0034749507904052734 |
----------------------------------------------------------pseudo_mini_loss sum 31.18539047241211
Total (block generation + training)time/epoch 2.399632109536065
Training time/epoch 2.1987860202789307
Training time without block to device /epoch 2.193924903869629
Training time without total dataloading part /epoch 1.6942720413208008
load block tensor time/epoch 0.39203715324401855
block to device time/epoch 0.004861116409301758
input features size transfer per epoch 8.940696716308594e-07
blocks size to device per epoch 4.917383193969727e-07
 Run 0| Epoch 10 |
Number of nodes for computation during this epoch:  7100
Number of first layer input nodes during this epoch:  4461
Number of first layer output nodes during this epoch:  1984
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1168270111083984  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.233 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.233 GB
Metis partitioning: 0.001 seconds, peak memory: 16.233 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.004 seconds
REG metis partition end ----................................
REG construction  time spent:  0.010415792465209961
pure dgl.metis_partition the time spent:  0.006308794021606445
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.013058662414550781

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.0142669677734375

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.021663188934326172

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1168270111083984  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

connection checking time:  0.018648147583007812
block generation total time  0.04898881912231445
average batch blocks generation time:  0.008164803187052408
block dataloader generation time/epoch 0.12005929946899414
pseudo mini batch 0 input nodes size: 863
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1168022155761719  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1168022155761719  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1214094161987305  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1214098930358887  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1171278953552246  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 7, 1: 5, 4: 3, 2: 3, 5: 2, 6: 1, 30: 1, 19: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1171493530273438  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1171493530273438  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.3731770515441895  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.3731789588928223  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4817514419555664  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

pseudo mini batch 1 input nodes size: 975
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4817228317260742  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4817228317260742  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4869279861450195  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4869284629821777  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.482320785522461  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 4: 5, 5: 3, 6: 3, 2: 2, 9: 2, 12: 1, 10: 1, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4823451042175293  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4823451042175293  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7691097259521484  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.769111156463623  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4823784828186035  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

pseudo mini batch 2 input nodes size: 759
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.482344150543213  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.482344150543213  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4870362281799316  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4870367050170898  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4818310737609863  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 7, 1: 4, 5: 3, 4: 2, 3: 2, 9: 1, 6: 1, 10: 1, 21: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4818496704101562  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4818496704101562  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7055182456970215  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.705519676208496  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4818754196166992  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

pseudo mini batch 3 input nodes size: 807
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4818511009216309  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4818511009216309  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.486159324645996  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4861598014831543  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4814672470092773  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 1: 3, 5: 3, 4: 3, 6: 2, 8: 2, 2: 1, 11: 1, 30: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4814887046813965  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4814887046813965  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7422819137573242  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7422833442687988  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.481518268585205  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

pseudo mini batch 4 input nodes size: 467
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.481490135192871  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.481490135192871  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4839835166931152  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4839839935302734  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.47967529296875  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 6, 3: 4, 1: 4, 2: 3, 5: 2, 6: 2, 10: 1, 8: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4796881675720215  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4796881675720215  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.6167912483215332  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.6167926788330078  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4797053337097168  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

pseudo mini batch 5 input nodes size: 838
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.479689121246338  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.479689121246338  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4843811988830566  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4843816757202148  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4818878173828125  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 9, 1: 3, 7: 3, 4: 3, 6: 2, 5: 2, 3: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4819064140319824  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4819064140319824  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.6939053535461426  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.6939067840576172  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.481931209564209  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.481931209564209  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1173443794250488  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06624106566111247 |0.0008494059244791666 |0.08941185474395752 |0.0001123348871866862 |0.20341316858927408 |0.00323486328125 |
----------------------------------------------------------pseudo_mini_loss sum 23.10042953491211
Total (block generation + training)time/epoch 2.3969233751297
Training time/epoch 2.2701237201690674
Training time without block to device /epoch 2.2650272846221924
Training time without total dataloading part /epoch 1.7608590126037598
load block tensor time/epoch 0.3974463939666748
block to device time/epoch 0.005096435546875
input features size transfer per epoch 8.940696716308594e-07
blocks size to device per epoch 4.917383193969727e-07
 Run 0| Epoch 11 |
Number of nodes for computation during this epoch:  7452
Number of first layer input nodes during this epoch:  4709
Number of first layer output nodes during this epoch:  2079
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1172394752502441  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.233 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.233 GB
Metis partitioning: 0.001 seconds, peak memory: 16.233 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.004 seconds
REG metis partition end ----................................
REG construction  time spent:  0.010882377624511719
pure dgl.metis_partition the time spent:  0.006268501281738281
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.01309967041015625

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.014498710632324219

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.02186751365661621

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1172394752502441  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

connection checking time:  0.018663406372070312
block generation total time  0.04946589469909668
average batch blocks generation time:  0.00824431578318278
block dataloader generation time/epoch 0.11856293678283691
pseudo mini batch 0 input nodes size: 688
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1172127723693848  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1172127723693848  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1208858489990234  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1208863258361816  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1161937713623047  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 1: 5, 2: 4, 4: 4, 5: 3, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1162104606628418  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1162104606628418  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.292931079864502  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.2929329872131348  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4830260276794434  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

pseudo mini batch 1 input nodes size: 892
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4830036163330078  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4830036163330078  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4877657890319824  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4877662658691406  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4840927124023438  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 4, 4: 4, 2: 4, 1: 2, 5: 2, 6: 2, 10: 2, 9: 1, 21: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.484117031097412  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.484117031097412  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.772263526916504  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7722649574279785  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4841513633728027  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

pseudo mini batch 2 input nodes size: 1072
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.484118938446045  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.484118938446045  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4898419380187988  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.489842414855957  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4850797653198242  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 7, 5: 4, 1: 2, 6: 2, 2: 2, 12: 1, 19: 1, 11: 1, 7: 1, 4: 1, 30: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4851078987121582  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4851078987121582  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.8006539344787598  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.8006553649902344  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4851460456848145  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

pseudo mini batch 3 input nodes size: 307
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.485109806060791  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.485109806060791  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4873466491699219  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.48734712600708  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.481623649597168  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 7, 4: 5, 2: 4, 5: 3, 3: 2, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4816327095031738  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4816327095031738  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.5648603439331055  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.56486177444458  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4816441535949707  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

pseudo mini batch 4 input nodes size: 728
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4816341400146484  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4816341400146484  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.485520839691162  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4855213165283203  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4832839965820312  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 5, 3: 4, 6: 3, 8: 3, 5: 2, 1: 2, 4: 2, 10: 1, 30: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4833064079284668  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4833064079284668  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7323288917541504  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.732330322265625  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4833359718322754  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

pseudo mini batch 5 input nodes size: 947
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4833097457885742  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4833097457885742  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4883651733398438  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.488365650177002  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.48447847366333  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 6, 4: 6, 7: 3, 3: 3, 1: 2, 6: 2, 5: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4845008850097656  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4845008850097656  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7398967742919922  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.7398982048034668  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.484532356262207  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.484532356262207  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1177234649658203  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0642552375793457 |0.0008247296015421549 |0.08727419376373291 |0.0001218716303507487 |0.19345454374949136 |0.004690885543823242 |
----------------------------------------------------------pseudo_mini_loss sum 16.885345458984375
Total (block generation + training)time/epoch 2.3877644538879395
Training time/epoch 2.192124843597412
Training time without block to device /epoch 2.187176465988159
Training time without total dataloading part /epoch 1.6897945404052734
load block tensor time/epoch 0.3855314254760742
block to device time/epoch 0.00494837760925293
input features size transfer per epoch 8.940696716308594e-07
blocks size to device per epoch 4.917383193969727e-07
 Run 0| Epoch 12 |
Number of nodes for computation during this epoch:  7372
Number of first layer input nodes during this epoch:  4634
Number of first layer output nodes during this epoch:  2072
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1176133155822754  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.233 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.233 GB
Metis partitioning: 0.001 seconds, peak memory: 16.233 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.004 seconds
REG metis partition end ----................................
REG construction  time spent:  0.01075601577758789
pure dgl.metis_partition the time spent:  0.00638580322265625
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.013065099716186523

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.014440059661865234

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.0213167667388916

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1176133155822754  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

connection checking time:  0.018451213836669922
block generation total time  0.04882192611694336
average batch blocks generation time:  0.008136987686157227
block dataloader generation time/epoch 0.1173142393430074
pseudo mini batch 0 input nodes size: 693
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1175823211669922  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1175823211669922  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1212821006774902  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1212825775146484  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.1162266731262207  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 4, 2: 3, 1: 3, 3: 3, 6: 3, 8: 2, 5: 2, 30: 1, 10: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.116246223449707  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.116246223449707  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.3434057235717773  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.3434076309204102  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4808382987976074  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

pseudo mini batch 1 input nodes size: 914
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.480813980102539  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.480813980102539  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4856934547424316  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4856939315795898  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4819936752319336  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 1: 3, 4: 3, 5: 2, 12: 2, 2: 2, 6: 2, 10: 2, 21: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4820199012756348  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73193359375 GB
    Memory Allocated: 1.4820199012756348  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.776512622833252  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.7765140533447266  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4820561408996582  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

pseudo mini batch 2 input nodes size: 865
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4820237159729004  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4820237159729004  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4866414070129395  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4866418838500977  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4817619323730469  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 6, 5: 4, 3: 3, 1: 3, 4: 3, 7: 2, 6: 1, 9: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4817824363708496  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4817824363708496  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.7159857749938965  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.715987205505371  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4818110466003418  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

pseudo mini batch 3 input nodes size: 755
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4817824363708496  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4817824363708496  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4858131408691406  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4858136177062988  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4811954498291016  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 8, 1: 5, 4: 4, 2: 4, 19: 1, 9: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4812140464782715  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4812140464782715  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.6943135261535645  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.694314956665039  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4812397956848145  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

pseudo mini batch 4 input nodes size: 513
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.481215476989746  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.481215476989746  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4848523139953613  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4848527908325195  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4808216094970703  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 5, 3: 5, 4: 5, 1: 2, 5: 2, 6: 2, 8: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4808344841003418  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4808344841003418  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.613180160522461  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.6131815910339355  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.480851650238037  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

pseudo mini batch 5 input nodes size: 771
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4808354377746582  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4808354377746582  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4849514961242676  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4849519729614258  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4813146591186523  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 5, 5: 5, 1: 4, 4: 3, 6: 3, 7: 2, 3: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4813332557678223  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4813332557678223  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.6927690505981445  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.6927704811096191  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4813590049743652  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4813590049743652  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.116772174835205  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06596036752065022 |0.0008341073989868164 |0.08976773420969646 |0.00011297067006429036 |0.20575372378031412 |0.0032927989959716797 |
----------------------------------------------------------pseudo_mini_loss sum 7.057847023010254
Total (block generation + training)time/epoch 2.3875022729237876
Training time/epoch 2.280926465988159
Training time without block to device /epoch 2.2759218215942383
Training time without total dataloading part /epoch 1.777099370956421
load block tensor time/epoch 0.39576220512390137
block to device time/epoch 0.0050046443939208984
input features size transfer per epoch 8.940696716308594e-07
blocks size to device per epoch 4.917383193969727e-07
 Run 0| Epoch 13 |
Number of nodes for computation during this epoch:  7147
Number of first layer input nodes during this epoch:  4511
Number of first layer output nodes during this epoch:  1984
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1166644096374512  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.233 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.233 GB
Metis partitioning: 0.001 seconds, peak memory: 16.233 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.004 seconds
REG metis partition end ----................................
REG construction  time spent:  0.010934114456176758
pure dgl.metis_partition the time spent:  0.006642341613769531
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.01302647590637207

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.014466047286987305

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.02101612091064453

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1166644096374512  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

connection checking time:  0.018305301666259766
block generation total time  0.048508644104003906
average batch blocks generation time:  0.008084774017333984
block dataloader generation time/epoch 0.11618476647597092
pseudo mini batch 0 input nodes size: 494
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1166396141052246  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1166396141052246  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.119277000427246  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1192774772644043  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1151609420776367  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 8, 2: 5, 4: 4, 3: 3, 5: 2, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1151728630065918  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1151728630065918  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.241105556488037  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.24110746383667  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4819788932800293  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

pseudo mini batch 1 input nodes size: 949
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4819645881652832  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4819645881652832  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4870309829711914  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4870314598083496  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.48439359664917  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 6: 3, 4: 3, 5: 3, 2: 2, 10: 1, 11: 1, 9: 1, 7: 1, 1: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4844169616699219  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4844169616699219  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.7600159645080566  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.7600173950195312  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4844493865966797  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

pseudo mini batch 2 input nodes size: 1140
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4844169616699219  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4844169616699219  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4905028343200684  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4905033111572266  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4854364395141602  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({5: 4, 4: 4, 3: 3, 1: 3, 2: 2, 9: 2, 7: 1, 10: 1, 30: 1, 6: 1, 19: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4854674339294434  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4854674339294434  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.850024700164795  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.8500261306762695  GigaBytes
Max Memory Allocated: 2.069282054901123  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4855103492736816  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

pseudo mini batch 3 input nodes size: 615
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4854698181152344  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4854698181152344  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4891066551208496  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4891071319580078  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4830207824707031  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 2: 4, 8: 3, 6: 3, 5: 3, 4: 2, 9: 1, 30: 1, 1: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4830412864685059  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4830412864685059  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.6966948509216309  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.6966962814331055  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4830689430236816  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

pseudo mini batch 4 input nodes size: 469
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.483046531677246  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.483046531677246  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4855504035949707  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.485550880432129  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4819135665893555  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 8, 3: 4, 1: 3, 4: 2, 6: 2, 5: 2, 10: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4819254875183105  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4819254875183105  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.6077122688293457  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.6077136993408203  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4819416999816895  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

pseudo mini batch 5 input nodes size: 860
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4819273948669434  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4819273948669434  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4873833656311035  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4873838424682617  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.484879493713379  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 7, 1: 4, 3: 4, 2: 4, 5: 1, 21: 1, 6: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4848999977111816  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4848999977111816  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.7311630249023438  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.7311644554138184  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4849276542663574  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4849276542663574  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1181187629699707  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06613790988922119 |0.0008138815561930338 |0.09142414728800456 |0.00011841456095377605 |0.21747060616811117 |0.003260374069213867 |
----------------------------------------------------------pseudo_mini_loss sum 5.359809398651123
Total (block generation + training)time/epoch 2.393622325016902
Training time/epoch 2.364306688308716
Training time without block to device /epoch 2.3594233989715576
Training time without total dataloading part /epoch 1.8573393821716309
load block tensor time/epoch 0.39682745933532715
block to device time/epoch 0.004883289337158203
input features size transfer per epoch 8.940696716308594e-07
blocks size to device per epoch 4.917383193969727e-07
 Run 0| Epoch 14 |
Number of nodes for computation during this epoch:  7239
Number of first layer input nodes during this epoch:  4527
Number of first layer output nodes during this epoch:  2050
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1180081367492676  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.233 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.233 GB
Metis partitioning: 0.001 seconds, peak memory: 16.233 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.004 seconds
REG metis partition end ----................................
REG construction  time spent:  0.010877847671508789
pure dgl.metis_partition the time spent:  0.006517648696899414
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.013112306594848633

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.014443397521972656

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.02071404457092285

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1180081367492676  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

connection checking time:  0.01807999610900879
block generation total time  0.04826974868774414
average batch blocks generation time:  0.008044958114624023
block dataloader generation time/epoch 0.11524731772286552
pseudo mini batch 0 input nodes size: 674
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1179795265197754  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1179795265197754  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1216163635253906  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1216168403625488  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1161603927612305  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 5, 4: 4, 5: 4, 1: 4, 8: 3, 6: 2, 30: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.116182804107666  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.116182804107666  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.3515286445617676  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.3515305519104004  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4807801246643066  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

pseudo mini batch 1 input nodes size: 956
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4807538986206055  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4807538986206055  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4858574867248535  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4858579635620117  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4822206497192383  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 4: 4, 6: 3, 9: 2, 1: 2, 2: 2, 5: 2, 12: 1, 10: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4822449684143066  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4822449684143066  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.76973295211792  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.7697343826293945  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4822783470153809  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

pseudo mini batch 2 input nodes size: 802
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4822440147399902  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4822440147399902  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.486525535583496  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4865260124206543  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.481421947479248  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 5, 2: 4, 3: 4, 1: 3, 5: 3, 21: 1, 19: 1, 10: 1, 30: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4814472198486328  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4814472198486328  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.76192045211792  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.7619218826293945  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4814825057983398  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

pseudo mini batch 3 input nodes size: 839
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4814519882202148  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4814519882202148  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4859309196472168  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.485931396484375  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.481649398803711  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 5, 4: 5, 5: 3, 7: 3, 1: 3, 3: 2, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4816689491271973  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4816689491271973  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.7050652503967285  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.7050666809082031  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4816956520080566  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

pseudo mini batch 4 input nodes size: 574
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4816694259643555  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4816694259643555  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4851503372192383  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4851508140563965  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4806714057922363  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 6, 2: 5, 3: 4, 6: 4, 9: 1, 5: 1, 10: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4806861877441406  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4806861877441406  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.6405816078186035  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.6405830383300781  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4807062149047852  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

pseudo mini batch 5 input nodes size: 451
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4806880950927734  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4806880950927734  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4830961227416992  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4830965995788574  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4796152114868164  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 9, 3: 5, 4: 4, 5: 2, 1: 2, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4796271324157715  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4796271324157715  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.5972599983215332  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.5972614288330078  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4796433448791504  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4796433448791504  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1150565147399902  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0653386910756429 |0.0007976690928141276 |0.088288148244222 |0.00011285146077473958 |0.20083312193552652 |0.003025531768798828 |
----------------------------------------------------------pseudo_mini_loss sum 4.806183338165283
Total (block generation + training)time/epoch 2.389935851097107
Training time/epoch 2.2388393878936768
Training time without block to device /epoch 2.234053373336792
Training time without total dataloading part /epoch 1.7384302616119385
load block tensor time/epoch 0.3920321464538574
block to device time/epoch 0.004786014556884766
input features size transfer per epoch 8.940696716308594e-07
blocks size to device per epoch 4.917383193969727e-07
 Run 0| Epoch 15 |
Number of nodes for computation during this epoch:  6930
Number of first layer input nodes during this epoch:  4296
Number of first layer output nodes during this epoch:  1973
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1149401664733887  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.233 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.233 GB
Metis partitioning: 0.001 seconds, peak memory: 16.233 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.004 seconds
REG metis partition end ----................................
REG construction  time spent:  0.010016441345214844
pure dgl.metis_partition the time spent:  0.006229877471923828
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.01305246353149414

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.014302968978881836

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.02041935920715332

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1149401664733887  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

connection checking time:  0.01808905601501465
block generation total time  0.0477747917175293
average batch blocks generation time:  0.007962465286254883
block dataloader generation time/epoch 0.11426833470662436
pseudo mini batch 0 input nodes size: 625
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1149253845214844  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1149253845214844  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1182622909545898  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.118262767791748  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.115854263305664  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 7, 5: 5, 2: 4, 4: 4, 3: 2, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1158690452575684  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1158690452575684  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.2699360847473145  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.2699379920959473  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4826850891113281  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

pseudo mini batch 1 input nodes size: 899
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4826669692993164  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4826669692993164  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4874663352966309  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.487466812133789  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4841294288635254  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 5, 4: 4, 2: 3, 5: 3, 1: 2, 10: 2, 6: 2, 21: 1, 9: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4841537475585938  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4841537475585938  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.769822120666504  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.7698235511779785  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4841880798339844  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

pseudo mini batch 2 input nodes size: 817
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4841556549072266  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4841556549072266  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4885172843933105  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4885177612304688  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.483717918395996  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 5, 3: 4, 4: 4, 7: 3, 5: 3, 1: 1, 9: 1, 6: 1, 11: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4837374687194824  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4837374687194824  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.7126126289367676  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.7126140594482422  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4837641716003418  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

pseudo mini batch 3 input nodes size: 792
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4837379455566406  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4837379455566406  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4879660606384277  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.487966537475586  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4836044311523438  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 7, 2: 6, 4: 3, 6: 2, 1: 2, 12: 1, 5: 1, 30: 1, 19: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4836249351501465  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4836249351501465  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.7276029586791992  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.7276043891906738  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4836535453796387  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

pseudo mini batch 4 input nodes size: 624
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4836254119873047  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4836254119873047  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.48726224899292  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4872627258300781  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4830341339111328  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 5, 6: 4, 2: 3, 8: 3, 5: 2, 4: 2, 1: 1, 30: 1, 10: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.483055591583252  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.483055591583252  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.7113423347473145  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.711343765258789  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4830842018127441  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

pseudo mini batch 5 input nodes size: 638
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4830598831176758  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4830598831176758  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4864659309387207  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.486466407775879  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4828290939331055  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 7, 4: 5, 2: 4, 3: 3, 9: 1, 5: 1, 7: 1, 6: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4828448295593262  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4828448295593262  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.6463274955749512  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.6463289260864258  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4828667640686035  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4828667640686035  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1160578727722168  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0657883087793986 |0.0007909138997395834 |0.09031665325164795 |0.00011046727498372395 |0.21190802256266275 |0.0033636093139648438 |
----------------------------------------------------------pseudo_mini_loss sum 3.803241014480591
Total (block generation + training)time/epoch 2.392089573542277
Training time/epoch 2.3215301036834717
Training time without block to device /epoch 2.316784620285034
Training time without total dataloading part /epoch 1.8173744678497314
load block tensor time/epoch 0.3947298526763916
block to device time/epoch 0.0047454833984375
input features size transfer per epoch 8.940696716308594e-07
blocks size to device per epoch 4.917383193969727e-07
 Run 0| Epoch 16 |
Number of nodes for computation during this epoch:  7006
Number of first layer input nodes during this epoch:  4395
Number of first layer output nodes during this epoch:  1954
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1159477233886719  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.233 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.233 GB
Metis partitioning: 0.000 seconds, peak memory: 16.233 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.004 seconds
REG metis partition end ----................................
REG construction  time spent:  0.01015925407409668
pure dgl.metis_partition the time spent:  0.006094932556152344
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.01303720474243164

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.014478206634521484

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.021392822265625

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1159477233886719  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

connection checking time:  0.018201351165771484
block generation total time  0.048908233642578125
average batch blocks generation time:  0.008151372273763021
block dataloader generation time/epoch 0.11353158950805664
pseudo mini batch 0 input nodes size: 605
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.115926742553711  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.115926742553711  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1195635795593262  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1195640563964844  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1161575317382812  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 4, 3: 4, 6: 4, 8: 3, 2: 3, 5: 2, 4: 2, 30: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1161770820617676  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1161770820617676  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.3354549407958984  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.3354568481445312  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4815611839294434  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

pseudo mini batch 1 input nodes size: 907
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.481536865234375  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.481536865234375  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4863791465759277  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.486379623413086  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4827423095703125  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 5, 4: 4, 1: 3, 5: 3, 2: 2, 6: 2, 9: 2, 10: 1, 12: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.482764720916748  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.482764720916748  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.7416276931762695  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.7416291236877441  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4827961921691895  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

pseudo mini batch 2 input nodes size: 765
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4827656745910645  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4827656745910645  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4868497848510742  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4868502616882324  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4820075035095215  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 6, 4: 5, 3: 4, 5: 3, 1: 2, 7: 1, 6: 1, 11: 1, 9: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4820261001586914  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4820261001586914  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.695725917816162  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.6957273483276367  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4820518493652344  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

pseudo mini batch 3 input nodes size: 799
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.482027530670166  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.482027530670166  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.486541748046875  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4865422248840332  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4824576377868652  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 7, 4: 4, 1: 4, 2: 2, 12: 1, 30: 1, 10: 1, 7: 1, 19: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4824771881103516  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4824771881103516  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.7116122245788574  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.711613655090332  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.482503890991211  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

pseudo mini batch 4 input nodes size: 787
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4824776649475098  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4824776649475098  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4866790771484375  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4866795539855957  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4821648597717285  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 5, 2: 5, 5: 4, 6: 3, 1: 3, 7: 2, 3: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4821834564208984  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4821834564208984  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.68829345703125  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.6882948875427246  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4822092056274414  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

pseudo mini batch 5 input nodes size: 601
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.482184886932373  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.482184886932373  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4858217239379883  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4858222007751465  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4816203117370605  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 7, 3: 5, 1: 4, 5: 3, 4: 2, 6: 1, 10: 1, 21: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4816370010375977  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4816370010375977  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.6724300384521484  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.672431468963623  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4816608428955078  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4816608428955078  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.116288185119629  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06500474611918132 |0.0008086363474527994 |0.09191250801086426 |0.00011324882507324219 |0.2150099277496338 |0.0028734207153320312 |
----------------------------------------------------------pseudo_mini_loss sum 3.989272356033325
Total (block generation + training)time/epoch 2.3956462144851685
Training time/epoch 2.3464012145996094
Training time without block to device /epoch 2.3415493965148926
Training time without total dataloading part /epoch 1.8450875282287598
load block tensor time/epoch 0.3900284767150879
block to device time/epoch 0.004851818084716797
input features size transfer per epoch 8.940696716308594e-07
blocks size to device per epoch 4.917383193969727e-07
 Run 0| Epoch 17 |
Number of nodes for computation during this epoch:  7113
Number of first layer input nodes during this epoch:  4464
Number of first layer output nodes during this epoch:  1998
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1161813735961914  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.233 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.233 GB
Metis partitioning: 0.001 seconds, peak memory: 16.233 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.004 seconds
REG metis partition end ----................................
REG construction  time spent:  0.010367393493652344
pure dgl.metis_partition the time spent:  0.00646662712097168
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.013051748275756836

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.014413118362426758

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.02124476432800293

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1161813735961914  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

connection checking time:  0.018508434295654297
block generation total time  0.04870963096618652
average batch blocks generation time:  0.008118271827697754
block dataloader generation time/epoch 0.1128699779510498
pseudo mini batch 0 input nodes size: 522
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1161603927612305  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1161603927612305  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1189470291137695  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1189475059509277  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1153101921081543  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 7, 1: 6, 5: 5, 6: 2, 3: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1153230667114258  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1153230667114258  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.2517671585083008  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.2517690658569336  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4821300506591797  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

pseudo mini batch 1 input nodes size: 956
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4821138381958008  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4821138381958008  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4872870445251465  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4872875213623047  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4845004081726074  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 6, 4: 4, 5: 3, 2: 3, 6: 3, 9: 1, 11: 1, 12: 1, 1: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4845237731933594  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4845237731933594  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.7665319442749023  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.766533374786377  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4845561981201172  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

pseudo mini batch 2 input nodes size: 935
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4845237731933594  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4845237731933594  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4895153045654297  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.489515781402588  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.484342098236084  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 9, 1: 3, 4: 3, 2: 2, 30: 1, 19: 1, 5: 1, 9: 1, 12: 1, 21: 1, 10: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4843683242797852  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4843683242797852  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.7798676490783691  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.7798690795898438  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4844045639038086  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

pseudo mini batch 3 input nodes size: 768
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4843721389770508  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4843721389770508  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4884719848632812  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4884724617004395  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.483480453491211  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({6: 4, 2: 4, 8: 3, 3: 3, 5: 3, 7: 1, 10: 1, 9: 1, 1: 1, 30: 1, 4: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.483503818511963  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.483503818511963  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.7407622337341309  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.7407636642456055  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4835352897644043  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

pseudo mini batch 4 input nodes size: 706
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4835071563720703  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4835071563720703  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4873671531677246  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4873676300048828  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4832673072814941  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 6, 2: 5, 1: 4, 3: 4, 6: 2, 7: 2, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4832839965820312  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4832839965820312  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.672788143157959  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.6727895736694336  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.483306884765625  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

pseudo mini batch 5 input nodes size: 732
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4832844734191895  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4832844734191895  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.48738431930542  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4873847961425781  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4835243225097656  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 7, 1: 5, 2: 4, 3: 3, 5: 2, 9: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4835410118103027  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4835410118103027  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.664182186126709  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.6641836166381836  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4835638999938965  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4835638999938965  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1167550086975098  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06427641709645589 |0.000809947649637858 |0.08813087145487468 |0.00011308987935384114 |0.19841591517130533 |0.003835439682006836 |
----------------------------------------------------------pseudo_mini_loss sum 2.977959394454956
Total (block generation + training)time/epoch 2.3917323561275707
Training time/epoch 2.226616144180298
Training time without block to device /epoch 2.2217564582824707
Training time without total dataloading part /epoch 1.72379469871521
load block tensor time/epoch 0.38565850257873535
block to device time/epoch 0.0048596858978271484
input features size transfer per epoch 8.940696716308594e-07
blocks size to device per epoch 4.917383193969727e-07
 Run 0| Epoch 18 |
Number of nodes for computation during this epoch:  7303
Number of first layer input nodes during this epoch:  4619
Number of first layer output nodes during this epoch:  2024
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1166434288024902  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

REG start----................................
auxiliary_graph remove nodes with degree zero and non output nodes---
auxiliary_graph_no_diag---
Convert a graph into a bidirected graph: 0.000 seconds, peak memory: 16.233 GB
Construct multi-constraint weights: 0.000 seconds, peak memory: 16.233 GB
Metis partitioning: 0.001 seconds, peak memory: 16.233 GB
Split the graph: 0.001 seconds
Construct subgraphs: 0.004 seconds
REG metis partition end ----................................
REG construction  time spent:  0.01070094108581543
pure dgl.metis_partition the time spent:  0.006228923797607422
check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.013095617294311523

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.014590978622436523

check connections block*********************************

block_gen_time in "generate_blocks_for_one_layer_block"  0.021158456802368164

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1166434288024902  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

connection checking time:  0.018435955047607422
block generation total time  0.04884505271911621
average batch blocks generation time:  0.008140842119852701
block dataloader generation time/epoch 0.11371741029951307
pseudo mini batch 0 input nodes size: 737
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1166205406188965  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1166205406188965  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1205549240112305  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.1205554008483887  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.116455078125  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 4, 3: 4, 8: 3, 2: 3, 6: 3, 5: 2, 1: 1, 10: 1, 9: 1, 30: 1, 19: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.116478443145752  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.116478443145752  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.3796615600585938  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.3796634674072266  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.481081485748291  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

pseudo mini batch 1 input nodes size: 564
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4810552597045898  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4810552597045898  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.484692096710205  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4846925735473633  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.480757713317871  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({4: 6, 2: 6, 5: 5, 1: 3, 6: 3, 3: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4807724952697754  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4807724952697754  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.6379437446594238  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.6379451751708984  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.48079252243042  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

pseudo mini batch 2 input nodes size: 638
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4807744026184082  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4807744026184082  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4841804504394531  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4841809272766113  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.480543613433838  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 7, 3: 6, 2: 5, 7: 2, 4: 1, 9: 1, 5: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4805583953857422  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4805583953857422  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.6379022598266602  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.6379036903381348  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4805784225463867  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

pseudo mini batch 3 input nodes size: 683
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.480560302734375  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.480560302734375  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4842066764831543  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4842071533203125  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4808006286621094  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({1: 5, 4: 5, 3: 4, 2: 3, 5: 3, 6: 2, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.48081636428833  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.48081636428833  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.65549898147583  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.6555004119873047  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4808382987976074  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

pseudo mini batch 4 input nodes size: 955
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4808177947998047  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4808177947998047  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4859161376953125  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4859166145324707  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4822697639465332  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({3: 8, 4: 3, 10: 2, 6: 2, 2: 2, 12: 2, 9: 1, 5: 1, 1: 1, 30: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4822969436645508  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4822969436645508  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.787071704864502  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.7870731353759766  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4823341369628906  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

pseudo mini batch 5 input nodes size: 864
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4822998046875  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4822998046875  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.4869918823242188  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.486992359161377  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.481893539428711  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

the counter of in-degree of the smallest block in current batch !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({2: 6, 1: 3, 4: 3, 5: 3, 3: 3, 9: 1, 6: 1, 21: 1, 11: 1, 7: 1})

----------------------------------------after blocks to device 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.48191499710083  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.48191499710083  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.7393808364868164  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.739382266998291  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.481945514678955  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.481945514678955  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.73583984375 GB
    Memory Allocated: 1.117358684539795  GigaBytes
Max Memory Allocated: 2.097747325897217  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06399269898732503 |0.0007968743642171224 |0.08803737163543701 |0.00011229515075683594 |0.2017207145690918 |0.004246711730957031 |
----------------------------------------------------------pseudo_mini_loss sum 3.1592752933502197
Total (block generation + training)time/epoch 2.390637901094225
Training time/epoch 2.243711233139038
Training time without block to device /epoch 2.2389299869537354
Training time without total dataloading part /epoch 1.743468999862671
load block tensor time/epoch 0.3839561939239502
block to device time/epoch 0.004781246185302734
input features size transfer per epoch 8.940696716308594e-07
blocks size to device per epoch 4.917383193969727e-07
 Run 0| Epoch 19 |
Number of nodes for computation during this epoch:  7061
Number of first layer input nodes during this epoch:  4441
Number of first layer output nodes during this epoch:  1967
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(1433, 1433, batch_first=True)
      (fc_self): Linear(in_features=1433, out_features=2048, bias=False)
      (fc_neigh): Linear(in_features=1433, out_features=2048, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(2048, 2048, batch_first=True)
      (fc_self): Linear(in_features=2048, out_features=2048, bias=False)
      (fc_neigh): Linear(in_features=2048, out_features=2048, bias=False)
    )
    (2): SAGEConv(
      (lstm): LSTM(2048, 2048, batch_first=True)
      (fc_self): Linear(in_features=2048, out_features=7, bias=False)
      (fc_neigh): Linear(in_features=2048, out_features=7, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  97867856
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([5732, 1433])
layers.0.lstm.weight_hh_l0, torch.Size([5732, 1433])
layers.0.lstm.bias_ih_l0, torch.Size([5732])
layers.0.lstm.bias_hh_l0, torch.Size([5732])
layers.0.fc_self.weight, torch.Size([2048, 1433])
layers.0.fc_neigh.weight, torch.Size([2048, 1433])
layers.1.lstm.weight_ih_l0, torch.Size([8192, 2048])
layers.1.lstm.weight_hh_l0, torch.Size([8192, 2048])
layers.1.lstm.bias_ih_l0, torch.Size([8192])
layers.1.lstm.bias_hh_l0, torch.Size([8192])
layers.1.fc_self.weight, torch.Size([2048, 2048])
layers.1.fc_neigh.weight, torch.Size([2048, 2048])
layers.2.lstm.weight_ih_l0, torch.Size([8192, 2048])
layers.2.lstm.weight_hh_l0, torch.Size([8192, 2048])
layers.2.lstm.bias_ih_l0, torch.Size([8192])
layers.2.lstm.bias_hh_l0, torch.Size([8192])
layers.2.fc_self.weight, torch.Size([7, 2048])
layers.2.fc_neigh.weight, torch.Size([7, 2048])
----------------------------------------
un-trainable parameters
